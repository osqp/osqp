import{b as ut,U as j}from"./index-D4bXoNM3.js";import{s as Ut}from"./glide-data-editor-CudlNmdp.js";import"./trash-D5wptdZI.js";const Gt=Ut("div")({name:"NumberOverlayEditorStyle",class:"gdg-n15fjm3e",propsAsIs:!1});function wt(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function"){var n=0;for(a=Object.getOwnPropertySymbols(t);n<a.length;n++)e.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(r[a[n]]=t[a[n]])}return r}var lt;function et(){}function ct(t){return!!(t||"").match(/\d/)}function it(t){return t==null}function Nt(t){return it(t)||function(e){return typeof e=="number"&&isNaN(e)}(t)||typeof t=="number"&&!isFinite(t)}function Dt(t){return t.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}function bt(t,e){e===void 0&&(e=!0);var r=t[0]==="-",a=r&&e,n=(t=t.replace("-","")).split(".");return{beforeDecimal:n[0],afterDecimal:n[1]||"",hasNegation:r,addNegation:a}}function Ot(t,e,r){for(var a="",n=r?"0":"",l=0;l<=e-1;l++)a+=t[l]||n;return a}function Et(t,e){return Array(e+1).join(t)}function It(t){var e=t+"",r=e[0]==="-"?"-":"";r&&(e=e.substring(1));var a=e.split(/[eE]/g),n=a[0],l=a[1];if(!(l=Number(l)))return r+n;var f=1+l,d=(n=n.replace(".","")).length;return f<0?n="0."+Et("0",Math.abs(f))+n:f>=d?n+=Et("0",f-d):n=(n.substring(0,f)||"0")+"."+n.substring(f),r+n}function Tt(t,e,r){if(["","-"].indexOf(t)!==-1)return t;var a=(t.indexOf(".")!==-1||r)&&e,n=bt(t),l=n.beforeDecimal,f=n.afterDecimal,d=n.hasNegation,D=parseFloat("0."+(f||"0")),y=(f.length<=e?"0."+f:D.toFixed(e)).split("."),h=l;return l&&Number(y[0])&&(h=l.split("").reverse().reduce(function(v,I,g){return v.length>g?(Number(v[0])+Number(I)).toString()+v.substring(1,v.length):I+v},y[0])),(d?"-":"")+h+(a?".":"")+Ot(y[1]||"",e,r)}function ot(t,e){if(t.value=t.value,t!==null){if(t.createTextRange){var r=t.createTextRange();return r.move("character",e),r.select(),!0}return t.selectionStart||t.selectionStart===0?(t.focus(),t.setSelectionRange(e,e),!0):(t.focus(),!1)}}(function(t){t.event="event",t.props="prop"})(lt||(lt={}));var Ct,dt,yt,jt=(Ct=function(t,e){for(var r=0,a=0,n=t.length,l=e.length;t[r]===e[r]&&r<n;)r++;for(;t[n-1-a]===e[l-1-a]&&l-a>r&&n-a>r;)a++;return{from:{start:r,end:n-a},to:{start:r,end:l-a}}},yt=void 0,function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return dt&&t.length===dt.length&&t.every(function(r,a){return r===dt[a]})?yt:(dt=t,yt=Ct.apply(void 0,t))});function Vt(t){return Math.max(t.selectionStart,t.selectionEnd)}function $t(t){var e=t.currentValue,r=t.formattedValue,a=t.currentValueIndex,n=t.formattedValueIndex;return e[a]===r[n]}function At(t,e,r,a){var n,l,f,d=t.length;if(n=e,l=0,f=d,e=Math.min(Math.max(n,l),f),a==="left"){for(;e>=0&&!r[e];)e--;e===-1&&(e=r.indexOf(!0))}else{for(;e<=d&&!r[e];)e++;e>d&&(e=r.lastIndexOf(!0))}return e===-1&&(e=d),e}function Zt(t){for(var e=Array.from({length:t.length+1}).map(function(){return!0}),r=0,a=e.length;r<a;r++)e[r]=!!(ct(t[r])||ct(t[r-1]));return e}function Rt(t,e,r,a,n,l){l===void 0&&(l=et);var f=function(g){var w=j.useRef(g);w.current=g;var C=j.useRef(function(){for(var p=[],R=arguments.length;R--;)p[R]=arguments[R];return w.current.apply(w,p)});return C.current}(function(g,w){var C,p;return Nt(g)?(p="",C=""):typeof g=="number"||w?(p=typeof g=="number"?It(g):g,C=a(p)):(p=n(g,void 0),C=a(p)),{formattedValue:C,numAsString:p}}),d=j.useState(function(){return f(it(t)?e:t,r)}),D=d[0],y=d[1],h=t,v=r;it(t)&&(h=D.numAsString,v=!0);var I=f(h,v);return j.useMemo(function(){y(I)},[I.formattedValue]),[D,function(g,w){g.formattedValue!==D.formattedValue&&y({formattedValue:g.formattedValue,numAsString:g.value}),l(g,w)}]}function qt(t){return t.replace(/[^0-9]/g,"")}function zt(t){return t}function Ht(t){var e=t.type;e===void 0&&(e="text");var r=t.displayType;r===void 0&&(r="input");var a=t.customInput,n=t.renderText,l=t.getInputRef,f=t.format;f===void 0&&(f=zt);var d=t.removeFormatting;d===void 0&&(d=qt);var D=t.defaultValue,y=t.valueIsNumericString,h=t.onValueChange,v=t.isAllowed,I=t.onChange;I===void 0&&(I=et);var g=t.onKeyDown;g===void 0&&(g=et);var w=t.onMouseUp;w===void 0&&(w=et);var C=t.onFocus;C===void 0&&(C=et);var p=t.onBlur;p===void 0&&(p=et);var R=t.value,$=t.getCaretBoundary;$===void 0&&($=Zt);var K=t.isValidInputCharacter;K===void 0&&(K=ct);var U=t.isCharacterSame,M=wt(t,["type","displayType","customInput","renderText","getInputRef","format","removeFormatting","defaultValue","valueIsNumericString","onValueChange","isAllowed","onChange","onKeyDown","onMouseUp","onFocus","onBlur","value","getCaretBoundary","isValidInputCharacter","isCharacterSame"]),rt=Rt(R,D,!!y,f,d,h),Y=rt[0],V=Y.formattedValue,Z=Y.numAsString,at=rt[1],H=j.useRef(),c=j.useRef({formattedValue:V,numAsString:Z}),s=function(o,u){c.current={formattedValue:o.formattedValue,numAsString:o.value},at(o,u)},S=j.useState(!1),m=S[0],O=S[1],i=j.useRef(null),E=j.useRef({setCaretTimeout:null,focusTimeout:null});j.useEffect(function(){return O(!0),function(){clearTimeout(E.current.setCaretTimeout),clearTimeout(E.current.focusTimeout)}},[]);var B=f,A=function(o,u){var b=parseFloat(u);return{formattedValue:o,value:u,floatValue:isNaN(b)?void 0:b}},k=function(o,u,b){o.selectionStart===0&&o.selectionEnd===o.value.length||(ot(o,u),E.current.setCaretTimeout=setTimeout(function(){o.value===b&&o.selectionStart!==u&&ot(o,u)},0))},F=function(o,u,b){return At(o,u,$(o),b)},mt=function(o,u,b){var x=$(u),W=function(T,N,L,q,_,ht,G){G===void 0&&(G=$t);var z=_.findIndex(function(Kt){return Kt}),J=T.slice(0,z);N||L.startsWith(J)||(N=J,L=J+L,q+=J.length);for(var Q=L.length,st=T.length,ft={},X=new Array(Q),nt=0;nt<Q;nt++){X[nt]=-1;for(var tt=0,Pt=st;tt<Pt;tt++)if(G({currentValue:L,lastValue:N,formattedValue:T,currentValueIndex:nt,formattedValueIndex:tt})&&ft[tt]!==!0){X[nt]=tt,ft[tt]=!0;break}}for(var P=q;P<Q&&(X[P]===-1||!ht(L[P]));)P++;var vt=P===Q||X[P]===-1?st:X[P];for(P=q-1;P>0&&X[P]===-1;)P--;var St=P===-1||X[P]===-1?0:X[P]+1;return St>vt?vt:q-St<vt-q?St:vt}(u,V,o,b,x,K,U);return W=At(u,W,x)};j.useEffect(function(){var o=c.current,u=o.formattedValue,b=o.numAsString;V===u&&Z===b||s(A(V,Z),{event:void 0,source:lt.props})},[V,Z]);var Mt=i.current?Vt(i.current):void 0;(typeof window<"u"?j.useLayoutEffect:j.useEffect)(function(){var o=i.current;if(V!==c.current.formattedValue&&o){var u=mt(c.current.formattedValue,V,Mt);o.value=V,k(o,u,V)}},[V]);var kt=function(o,u,b){var x=u.target,W=H.current?function(G,z){var J=Math.min(G.selectionStart,z);return{from:{start:J,end:G.selectionEnd},to:{start:J,end:z}}}(H.current,x.selectionEnd):jt(V,o),T=Object.assign(Object.assign({},W),{lastValue:V}),N=d(o,T),L=B(N);if(N=d(L,void 0),v&&!v(A(L,N))){var q=u.target,_=Vt(q),ht=mt(o,V,_);return q.value=V,k(q,ht,V),!1}return function(G){var z=G.formattedValue;z===void 0&&(z="");var J,Q=G.input,st=G.source,ft=G.event,X=G.numAsString;if(Q){var nt=G.inputValue||Q.value,tt=Vt(Q);Q.value=z,(J=mt(nt,z,tt))!==void 0&&k(Q,J,z)}z!==V&&s(A(z,X),{event:ft,source:st})}({formattedValue:L,numAsString:N,inputValue:o,event:u,source:b,input:u.target}),!0},pt=function(o,u){u===void 0&&(u=0);var b=o.selectionStart,x=o.selectionEnd;H.current={selectionStart:b,selectionEnd:x+u}},Wt=!m||typeof navigator>"u"||navigator.platform&&/iPhone|iPod/.test(navigator.platform)?void 0:"numeric",xt=Object.assign({inputMode:Wt},M,{type:e,value:V,onChange:function(o){var u=o.target.value;kt(u,o,lt.event)&&I(o),H.current=void 0},onKeyDown:function(o){var u,b=o.target,x=o.key,W=b.selectionStart,T=b.selectionEnd,N=b.value;N===void 0&&(N=""),x==="ArrowLeft"||x==="Backspace"?u=Math.max(W-1,0):x==="ArrowRight"?u=Math.min(W+1,N.length):x==="Delete"&&(u=W);var L=0;x==="Delete"&&W===T&&(L=1);var q=x==="ArrowLeft"||x==="ArrowRight";if(u===void 0||W!==T&&!q)return g(o),void pt(b,L);var _=u;q?(_=F(N,u,x==="ArrowLeft"?"left":"right"))!==u&&o.preventDefault():x!=="Delete"||K(N[u])?x!=="Backspace"||K(N[u])||(_=F(N,u,"left")):_=F(N,u,"right"),_!==u&&k(b,_,N),g(o),pt(b,L)},onMouseUp:function(o){var u=o.target,b=function(){var x=u.selectionStart,W=u.selectionEnd,T=u.value;if(T===void 0&&(T=""),x===W){var N=F(T,x);N!==x&&k(u,N,T)}};b(),requestAnimationFrame(function(){b()}),w(o),pt(u)},onFocus:function(o){o.persist&&o.persist();var u=o.target,b=o.currentTarget;i.current=u,E.current.focusTimeout=setTimeout(function(){var x=u.selectionStart,W=u.selectionEnd,T=u.value;T===void 0&&(T="");var N=F(T,x);N===x||x===0&&W===T.length||k(u,N,T),C(Object.assign(Object.assign({},o),{currentTarget:b}))},0)},onBlur:function(o){i.current=null,clearTimeout(E.current.focusTimeout),clearTimeout(E.current.setCaretTimeout),p(o)}});if(r==="text")return n?ut.createElement(ut.Fragment,null,n(V,M)||null):ut.createElement("span",Object.assign({},M,{ref:l}),V);if(a){var Lt=a;return ut.createElement(Lt,Object.assign({},xt,{ref:l}))}return ut.createElement("input",Object.assign({},xt,{ref:l}))}function Bt(t,e){var r=e.decimalScale,a=e.fixedDecimalScale,n=e.prefix;n===void 0&&(n="");var l=e.suffix;l===void 0&&(l="");var f=e.allowNegative,d=e.thousandsGroupStyle;if(d===void 0&&(d="thousand"),t===""||t==="-")return t;var D=gt(e),y=D.thousandSeparator,h=D.decimalSeparator,v=r!==0&&t.indexOf(".")!==-1||r&&a,I=bt(t,f),g=I.beforeDecimal,w=I.afterDecimal,C=I.addNegation;return r!==void 0&&(w=Ot(w,r,!!a)),y&&(g=function(p,R,$){var K=function(M){switch(M){case"lakh":return/(\d+?)(?=(\d\d)+(\d)(?!\d))(\.\d+)?/g;case"wan":return/(\d)(?=(\d{4})+(?!\d))/g;default:return/(\d)(?=(\d{3})+(?!\d))/g}}($),U=p.search(/[1-9]/);return U=U===-1?p.length:U,p.substring(0,U)+p.substring(U,p.length).replace(K,"$1"+R)}(g,y,d)),n&&(g=n+g),l&&(w+=l),C&&(g="-"+g),t=g+(v&&h||"")+w}function gt(t){var e=t.decimalSeparator;e===void 0&&(e=".");var r=t.thousandSeparator,a=t.allowedDecimalSeparators;return r===!0&&(r=","),a||(a=[e,"."]),{decimalSeparator:e,thousandSeparator:r,allowedDecimalSeparators:a}}function Jt(t,e,r){var a;e===void 0&&(e=function(i){return{from:{start:0,end:0},to:{start:0,end:i.length},lastValue:""}}(t));var n=r.allowNegative,l=r.prefix;l===void 0&&(l="");var f=r.suffix;f===void 0&&(f="");var d=r.decimalScale,D=e.from,y=e.to,h=y.start,v=y.end,I=gt(r),g=I.allowedDecimalSeparators,w=I.decimalSeparator,C=t[v]===w;if(ct(t)&&(t===l||t===f)&&e.lastValue==="")return t;if(v-h===1&&g.indexOf(t[h])!==-1){var p=d===0?"":w;t=t.substring(0,h)+p+t.substring(h+1,t.length)}var R=function(i,E,B){var A=!1,k=!1;l.startsWith("-")?A=!1:i.startsWith("--")?(A=!1,k=!0):f.startsWith("-")&&i.length===f.length?A=!1:i[0]==="-"&&(A=!0);var F=A?1:0;return k&&(F=2),F&&(i=i.substring(F),E-=F,B-=F),{value:i,start:E,end:B,hasNegation:A}},$=R(t,h,v),K=$.hasNegation;t=(a=$).value,h=a.start,v=a.end;var U=R(e.lastValue,D.start,D.end),M=U.start,rt=U.end,Y=U.value,V=t.substring(h,v);!(t.length&&Y.length&&(M>Y.length-f.length||rt<l.length))||V&&f.startsWith(V)||(t=Y);var Z=0;t.startsWith(l)?Z+=l.length:h<l.length&&(Z=h),v-=Z;var at=(t=t.substring(Z)).length,H=t.length-f.length;t.endsWith(f)?at=H:(v>H||v>t.length-f.length)&&(at=v),t=t.substring(0,at),t=function(i,E){i===void 0&&(i="");var B=new RegExp("(-)"),A=new RegExp("(-)(.)*(-)"),k=B.test(i),F=A.test(i);return i=i.replace(/-/g,""),k&&!F&&E&&(i="-"+i),i}(K?"-"+t:t,n),t=(t.match(function(i){return new RegExp("(^-)|[0-9]|"+Dt(i),"g")}(w))||[]).join("");var c=t.indexOf(w),s=bt(t=t.replace(new RegExp(Dt(w),"g"),function(i,E){return E===c?".":""}),n),S=s.beforeDecimal,m=s.afterDecimal,O=s.addNegation;return y.end-y.start<D.end-D.start&&S===""&&C&&!parseFloat(m)&&(t=O?"-":""),t}function Qt(t){t=function(c){var s=gt(c),S=s.thousandSeparator,m=s.decimalSeparator,O=c.prefix;O===void 0&&(O="");var i=c.allowNegative;if(i===void 0&&(i=!0),S===m)throw new Error(`
        Decimal separator can't be same as thousand separator.
        thousandSeparator: `+S+` (thousandSeparator = {true} is same as thousandSeparator = ",")
        decimalSeparator: `+m+` (default value for decimalSeparator is .)
     `);return O.startsWith("-")&&i&&(console.error(`
      Prefix can't start with '-' when allowNegative is true.
      prefix: `+O+`
      allowNegative: `+i+`
    `),i=!1),Object.assign(Object.assign({},c),{allowNegative:i})}(t),t.decimalSeparator,t.allowedDecimalSeparators,t.thousandsGroupStyle;var e=t.suffix,r=t.allowNegative,a=t.allowLeadingZeros,n=t.onKeyDown;n===void 0&&(n=et);var l=t.onBlur;l===void 0&&(l=et);var f=t.thousandSeparator,d=t.decimalScale,D=t.fixedDecimalScale,y=t.prefix;y===void 0&&(y="");var h=t.defaultValue,v=t.value,I=t.valueIsNumericString,g=t.onValueChange,w=wt(t,["decimalSeparator","allowedDecimalSeparators","thousandsGroupStyle","suffix","allowNegative","allowLeadingZeros","onKeyDown","onBlur","thousandSeparator","decimalScale","fixedDecimalScale","prefix","defaultValue","value","valueIsNumericString","onValueChange"]),C=gt(t),p=C.decimalSeparator,R=C.allowedDecimalSeparators,$=function(c){return Bt(c,t)},K=function(c,s){return Jt(c,s,t)},U=it(v)?h:v,M=I??function(c,s,S){return c===""||!(s!=null&&s.match(/\d/))&&!(S!=null&&S.match(/\d/))&&typeof c=="string"&&!isNaN(Number(c))}(U,y,e);it(v)?it(h)||(M=M||typeof h=="number"):M=M||typeof v=="number";var rt=function(c){return Nt(c)?c:(typeof c=="number"&&(c=It(c)),M&&typeof d=="number"?Tt(c,d,!!D):c)},Y=Rt(rt(v),rt(h),!!M,$,K,g),V=Y[0],Z=V.numAsString,at=V.formattedValue,H=Y[1];return Object.assign(Object.assign({},w),{value:at,valueIsNumericString:!1,isValidInputCharacter:function(c){return c===p||ct(c)},isCharacterSame:function(c){var s=c.currentValue,S=c.lastValue,m=c.formattedValue,O=c.currentValueIndex,i=c.formattedValueIndex,E=s[O],B=m[i],A=jt(S,s).to,k=function(F){return K(F).indexOf(".")+y.length};return!(v===0&&D&&d&&s[A.start]===p&&k(s)<O&&k(m)>i)&&(!!(O>=A.start&&O<A.end&&R&&R.includes(E)&&B===p)||E===B)},onValueChange:H,format:$,removeFormatting:K,getCaretBoundary:function(c){return function(s,S){var m=S.prefix;m===void 0&&(m="");var O=S.suffix;O===void 0&&(O="");var i=Array.from({length:s.length+1}).map(function(){return!0}),E=s[0]==="-";i.fill(!1,0,m.length+(E?1:0));var B=s.length;return i.fill(!1,B-O.length+1,B+1),i}(c,t)},onKeyDown:function(c){var s=c.target,S=c.key,m=s.selectionStart,O=s.selectionEnd,i=s.value;if(i===void 0&&(i=""),(S==="Backspace"||S==="Delete")&&O<y.length)c.preventDefault();else if(m===O){S==="Backspace"&&i[0]==="-"&&m===y.length+1&&r&&ot(s,1),d&&D&&(S==="Backspace"&&i[m-1]===p?(ot(s,m-1),c.preventDefault()):S==="Delete"&&i[m]===p&&c.preventDefault()),R!=null&&R.includes(S)&&i[m]===p&&ot(s,m+1);var E=f===!0?",":f;S==="Backspace"&&i[m-1]===E&&ot(s,m-1),S==="Delete"&&i[m]===E&&ot(s,m+1),n(c)}else n(c)},onBlur:function(c){var s=Z;if(s.match(/\d/g)||(s=""),a||(s=function(m){if(!m)return m;var O=m[0]==="-";O&&(m=m.substring(1,m.length));var i=m.split("."),E=i[0].replace(/^0+/,"")||"0",B=i[1]||"";return(O?"-":"")+E+(B?"."+B:"")}(s)),D&&d&&(s=Tt(s,d,D)),s!==Z){var S=Bt(s,t);H({formattedValue:S,value:s,floatValue:parseFloat(s)},{event:c,source:lt.event})}l(c)}})}function Xt(t){var e=Qt(t);return ut.createElement(Ht,Object.assign({},e))}function Ft(){var e,r,a;return((a=(r=(e=Intl.NumberFormat())==null?void 0:e.formatToParts(1.1))==null?void 0:r.find(n=>n.type==="decimal"))==null?void 0:a.value)??"."}const Yt=t=>{const{value:e,onChange:r,disabled:a,highlight:n,validatedSelection:l,fixedDecimals:f,allowNegative:d,thousandSeparator:D,decimalSeparator:y}=t,h=j.useRef();return j.useLayoutEffect(()=>{var v;if(l!==void 0){const I=typeof l=="number"?[l,null]:l;(v=h.current)==null||v.setSelectionRange(I[0],I[1])}},[l]),j.createElement(Gt,null,j.createElement(Xt,{autoFocus:!0,getInputRef:h,className:"gdg-input",onFocus:v=>v.target.setSelectionRange(n?0:v.target.value.length,v.target.value.length),disabled:a===!0,decimalScale:f,allowNegative:d,thousandSeparator:D??(Ft()==="."?",":"."),decimalSeparator:y??Ft(),value:Object.is(e,-0)?"-":e??"",onValueChange:r}))};export{Yt as default};
