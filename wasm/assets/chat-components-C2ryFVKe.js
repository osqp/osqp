import{s as j}from"./chunk-DZLz74EQ.js";import{c as C}from"./jotai-BTnrNcC1.js";import{t as _}from"./react-BcIddLXZ.js";import{gt as S,mn as M,w as I}from"./cells-A69p56PE.js";import{t as N}from"./compiler-runtime-Cr9loedd.js";import{o as W}from"./utils-DEDX0RLo.js";import{t as q}from"./jsx-runtime-mwDPpfh_.js";import{t as T}from"./cn-ZXtYmczU.js";import{t as v}from"./button-ZC2axIBq.js";import{rt as $}from"./dist-MHIqsPCF.js";import{n as z}from"./useTheme-Biy2QI0v.js";import{t as A}from"./between-horizontal-start-CC0exyFi.js";import{h as E}from"./select-5fcaZwou.js";import{t as L}from"./file-text-CFgIi1A4.js";import{t as w}from"./file-Cz8xVTWu.js";import{t as R}from"./image-DW_EcY4T.js";import{t as D}from"./copy-LsxoSTiV.js";import{t as F}from"./LazyAnyLanguageCodeMirror-BovGLUi6.js";import{n as O}from"./add-missing-import-Bc1Nj8aC.js";import{o as P}from"./focus-BaSDCTOl.js";import{r as Q}from"./dist-__vbIzp1.js";var y=j(N(),1),h=j(_(),1),o=j(q(),1),B=[$.lineWrapping],G=new Set(["python","markdown","sql","json","yaml","toml","shell","javascript","typescript","jsx","tsx","css","html"]);function H(s,e){return s?s==="python"?{language:s,code:e}:s==="sql"?{language:"python",code:S.fromQuery(e)}:s==="markdown"?{language:"python",code:M.fromMarkdown(e)}:s==="shell"||s==="bash"?{language:"python",code:`import subprocess
subprocess.run("${e}")`}:{language:"python",code:`_${s} = """
${e}
"""`}:{language:"python",code:e}}var J=s=>{let e=(0,y.c)(9),{code:t,language:a}=s,{createNewCell:m}=I(),r=P(),l=C(W),n;e[0]!==l||e[1]!==t||e[2]!==m||e[3]!==a||e[4]!==r?(n=()=>{let p=H(a,t);a==="sql"&&O({autoInstantiate:l,createNewCell:m,fromCellId:r}),m({code:p.code,before:!1,cellId:r??"__end__"})},e[0]=l,e[1]=t,e[2]=m,e[3]=a,e[4]=r,e[5]=n):n=e[5];let i=n,c;e[6]===Symbol.for("react.memo_cache_sentinel")?(c=(0,o.jsx)(A,{className:"ml-2 h-4 w-4"}),e[6]=c):c=e[6];let d;return e[7]===i?d=e[8]:(d=(0,o.jsxs)(v,{size:"xs",variant:"outline",onClick:i,children:["Add to Notebook",c]}),e[7]=i,e[8]=d),d},K=s=>{let e=(0,y.c)(17),{code:t,language:a}=s,{theme:m}=z(),[r,l]=(0,h.useState)(t);r!==t&&l(t);let n;e[0]===r?n=e[1]:(n=async()=>{await D(r)},e[0]=r,e[1]=n);let i=n,c=m==="dark"?"dark":"light",d=a&&G.has(a)?a:void 0,p;e[2]!==c||e[3]!==d||e[4]!==r?(p=(0,o.jsx)(h.Suspense,{children:(0,o.jsx)(F,{theme:c,language:d,className:"cm border rounded overflow-hidden",extensions:B,value:r,onChange:l})}),e[2]=c,e[3]=d,e[4]=r,e[5]=p):p=e[5];let u;e[6]===i?u=e[7]:(u=(0,o.jsx)(U,{size:"xs",variant:"outline",onClick:i,children:"Copy"}),e[6]=i,e[7]=u);let f;e[8]!==a||e[9]!==r?(f=(0,o.jsx)(J,{code:r,language:a}),e[8]=a,e[9]=r,e[10]=f):f=e[10];let x;e[11]!==u||e[12]!==f?(x=(0,o.jsxs)("div",{className:"flex justify-end mt-2 space-x-2",children:[u,f]}),e[11]=u,e[12]=f,e[13]=x):x=e[13];let g;return e[14]!==p||e[15]!==x?(g=(0,o.jsxs)("div",{className:"relative",children:[p,x]}),e[14]=p,e[15]=x,e[16]=g):g=e[16],g},U=s=>{let e=(0,y.c)(9),t,a;e[0]===s?(t=e[1],a=e[2]):({onClick:t,...a}=s,e[0]=s,e[1]=t,e[2]=a);let[m,r]=(0,h.useState)(!1),l;e[3]===t?l=e[4]:(l=c=>{t==null||t(c),r(!0),setTimeout(()=>r(!1),1e3)},e[3]=t,e[4]=l);let n=m?"Copied":"Copy",i;return e[5]!==a||e[6]!==l||e[7]!==n?(i=(0,o.jsx)(v,{...a,onClick:l,children:n}),e[5]=a,e[6]=l,e[7]=n,e[8]=i):i=e[8],i},V={code:({children:s,className:e})=>{let t=e==null?void 0:e.replace("language-","");if(t&&typeof s=="string"){let a=s.trim();return(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"text-xs text-muted-foreground pl-1",children:t}),(0,o.jsx)(K,{code:a,language:t})]})}return(0,o.jsx)("code",{className:e,children:s})}};const k=(0,h.memo)(s=>{let e=(0,y.c)(2),{content:t}=s,a;return e[0]===t?a=e[1]:(a=(0,o.jsx)(Q,{components:V,className:"mo-markdown-renderer",children:t}),e[0]=t,e[1]=a),a});k.displayName="MarkdownRenderer";var b=j(N(),1);const X=s=>{var r;let e=(0,b.c)(6),{attachment:t}=s;if((r=t.mediaType)!=null&&r.startsWith("image/")){let l;return e[0]!==t.filename||e[1]!==t.url?(l=(0,o.jsx)("img",{src:t.url,alt:t.filename,className:"max-h-[100px] max-w-[100px] object-contain mb-1.5"}),e[0]=t.filename,e[1]=t.url,e[2]=l):l=e[2],l}let a;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=(0,o.jsx)(w,{className:"h-3 w-3 mt-0.5"}),e[3]=a):a=e[3];let m;return e[4]===t.filename?m=e[5]:(m=(0,o.jsxs)("div",{className:"flex flex-row gap-1 items-center text-xs",children:[a,t.filename]}),e[4]=t.filename,e[5]=m),m},Y=s=>{let e=(0,b.c)(12),{file:t,className:a,onRemove:m}=s,[r,l]=(0,h.useState)(!1),n;e[0]===a?n=e[1]:(n=T("py-1 px-1.5 bg-muted rounded-md cursor-pointer flex flex-row gap-1 items-center text-xs",a),e[0]=a,e[1]=n);let i,c;e[2]===Symbol.for("react.memo_cache_sentinel")?(i=()=>l(!0),c=()=>l(!1),e[2]=i,e[3]=c):(i=e[2],c=e[3]);let d;e[4]!==t||e[5]!==r||e[6]!==m?(d=r?(0,o.jsx)(E,{className:"h-3 w-3 mt-0.5",onClick:m}):Z(t),e[4]=t,e[5]=r,e[6]=m,e[7]=d):d=e[7];let p;return e[8]!==t.name||e[9]!==n||e[10]!==d?(p=(0,o.jsxs)("div",{className:n,onMouseEnter:i,onMouseLeave:c,children:[d,t.name]}),e[8]=t.name,e[9]=n,e[10]=d,e[11]=p):p=e[11],p};function Z(s){let e="h-3 w-3 mt-0.5";return s.type.startsWith("image/")?(0,o.jsx)(R,{className:e}):s.type.startsWith("text/")?(0,o.jsx)(L,{className:e}):(0,o.jsx)(w,{className:e})}export{Y as n,k as r,X as t};
