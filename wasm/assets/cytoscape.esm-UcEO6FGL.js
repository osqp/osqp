function va(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Nt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rt(e,t,n){return t&&function(r,a){for(var i=0;i<a.length;i++){var o=a[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,io(o.key),o)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function it(e,t){var n=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ya(e))||t){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var l=n.next();return o=l.done,l},e:function(l){s=!0,i=l},f:function(){try{o||n.return==null||n.return()}finally{if(s)throw i}}}}function ao(e,t,n){return(t=io(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Le(e,t){return function(n){if(Array.isArray(n))return n}(e)||function(n,r){var a=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(a!=null){var i,o,s,l,u=[],c=!0,d=!1;try{if(s=(a=a.call(n)).next,r===0){if(Object(a)!==a)return;c=!1}else for(;!(c=(i=s.call(a)).done)&&(u.push(i.value),u.length!==r);c=!0);}catch(h){d=!0,o=h}finally{try{if(!c&&a.return!=null&&(l=a.return(),Object(l)!==l))return}finally{if(d)throw o}}return u}}(e,t)||ya(e,t)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function yr(e){return function(t){if(Array.isArray(t))return va(t)}(e)||function(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}(e)||ya(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function io(e){var t=function(n,r){if(typeof n!="object"||!n)return n;var a=n[Symbol.toPrimitive];if(a!==void 0){var i=a.call(n,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(e,"string");return typeof t=="symbol"?t:t+""}function Ye(e){return Ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ye(e)}function ya(e,t){if(e){if(typeof e=="string")return va(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?va(e,t):void 0}}var je=typeof window>"u"?null:window,oo=je?je.navigator:null;je&&je.document;var so,lo,uo,co,ho,fo,po,go,ma,vo,ba,yo,mo,bo,xo,wo,Eo,ko,To,Co,Po,So,Bo,_o,Do,Ao,Mo,Io,fd=Ye(""),No=Ye({}),pd=Ye(function(){}),gd=typeof HTMLElement>"u"?"undefined":Ye(HTMLElement),Yn=function(e){return e&&e.instanceString&&Ie(e.instanceString)?e.instanceString():null},pe=function(e){return e!=null&&Ye(e)==fd},Ie=function(e){return e!=null&&Ye(e)===pd},Ce=function(e){return!lt(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},xe=function(e){return e!=null&&Ye(e)===No&&!Ce(e)&&e.constructor===Object},oe=function(e){return e!=null&&Ye(e)===Ye(1)&&!isNaN(e)},mr=function(e){return gd==="undefined"?void 0:e!=null&&e instanceof HTMLElement},lt=function(e){return jn(e)||Ro(e)},jn=function(e){return Yn(e)==="collection"&&e._private.single},Ro=function(e){return Yn(e)==="collection"&&!e._private.single},xa=function(e){return Yn(e)==="core"},Lo=function(e){return Yn(e)==="stylesheet"},Lt=function(e){return e==null||!(e!==""&&!e.match(/^\s+$/))},vd=function(e){return function(t){return t!=null&&Ye(t)===No}(e)&&Ie(e.then)},gn=function(e,t){t||(t=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var r=[],a=0;a<arguments.length;a++)r.push(arguments[a]);return r.join("$")});var n=function(){var r,a=arguments,i=t.apply(this,a),o=n.cache;return(r=o[i])||(r=o[i]=e.apply(this,a)),r};return n.cache={},n},wa=gn(function(e){return e.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}),br=gn(function(e){return e.replace(/(-\w)/g,function(t){return t[1].toUpperCase()})}),zo=gn(function(e,t){return e+t[0].toUpperCase()+t.substring(1)},function(e,t){return e+"$"+t}),Oo=function(e){return Lt(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},zt=function(e,t){return e.slice(-1*t.length)===t},Xe="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",yd="rgb[a]?\\(("+Xe+"[%]?)\\s*,\\s*("+Xe+"[%]?)\\s*,\\s*("+Xe+"[%]?)(?:\\s*,\\s*("+Xe+"))?\\)",md="rgb[a]?\\((?:"+Xe+"[%]?)\\s*,\\s*(?:"+Xe+"[%]?)\\s*,\\s*(?:"+Xe+"[%]?)(?:\\s*,\\s*(?:"+Xe+"))?\\)",bd="hsl[a]?\\(("+Xe+")\\s*,\\s*("+Xe+"[%])\\s*,\\s*("+Xe+"[%])(?:\\s*,\\s*("+Xe+"))?\\)",xd="hsl[a]?\\((?:"+Xe+")\\s*,\\s*(?:"+Xe+"[%])\\s*,\\s*(?:"+Xe+"[%])(?:\\s*,\\s*(?:"+Xe+"))?\\)",Vo=function(e,t){return e<t?-1:e>t?1:0},ge=Object.assign!=null?Object.assign.bind(Object):function(e){for(var t=arguments,n=1;n<t.length;n++){var r=t[n];if(r!=null)for(var a=Object.keys(r),i=0;i<a.length;i++){var o=a[i];e[o]=r[o]}}return e},Fo=function(e){return(Ce(e)?e:null)||function(t){return wd[t.toLowerCase()]}(e)||function(t){if((t.length===4||t.length===7)&&t[0]==="#"){var n,r,a,i=16;return t.length===4?(n=parseInt(t[1]+t[1],i),r=parseInt(t[2]+t[2],i),a=parseInt(t[3]+t[3],i)):(n=parseInt(t[1]+t[2],i),r=parseInt(t[3]+t[4],i),a=parseInt(t[5]+t[6],i)),[n,r,a]}}(e)||function(t){var n,r=new RegExp("^"+yd+"$").exec(t);if(r){n=[];for(var a=[],i=1;i<=3;i++){var o=r[i];if(o[o.length-1]==="%"&&(a[i]=!0),o=parseFloat(o),a[i]&&(o=o/100*255),o<0||o>255)return;n.push(Math.floor(o))}var s=a[1]||a[2]||a[3],l=a[1]&&a[2]&&a[3];if(s&&!l)return;var u=r[4];if(u!==void 0){if((u=parseFloat(u))<0||u>1)return;n.push(u)}}return n}(e)||function(t){var n,r,a,i,o,s,l,u;function c(f,g,v){return v<0&&(v+=1),v>1&&(v-=1),v<1/6?f+6*(g-f)*v:v<.5?g:v<2/3?f+(g-f)*(2/3-v)*6:f}var d=new RegExp("^"+bd+"$").exec(t);if(d){if((r=parseInt(d[1]))<0?r=(360- -1*r%360)%360:r>360&&(r%=360),r/=360,(a=parseFloat(d[2]))<0||a>100||(a/=100,(i=parseFloat(d[3]))<0||i>100)||(i/=100,(o=d[4])!==void 0&&((o=parseFloat(o))<0||o>1)))return;if(a===0)s=l=u=Math.round(255*i);else{var h=i<.5?i*(1+a):i+a-i*a,p=2*i-h;s=Math.round(255*c(p,h,r+1/3)),l=Math.round(255*c(p,h,r)),u=Math.round(255*c(p,h,r-1/3))}n=[s,l,u,o]}return n}(e)},wd={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Yo=function(e){for(var t=e.map,n=e.keys,r=n.length,a=0;a<r;a++){var i=n[a];if(xe(i))throw Error("Tried to set map with object key");a<n.length-1?(t[i]==null&&(t[i]={}),t=t[i]):t[i]=e.value}},jo=function(e){for(var t=e.map,n=e.keys,r=n.length,a=0;a<r;a++){var i=n[a];if(xe(i))throw Error("Tried to get map with object key");if((t=t[i])==null)return t}return t},xr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function qn(){return lo?so:(lo=1,so=function(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")})}function wr(){if(fo)return ho;fo=1;var e=function(){if(co)return uo;co=1;var r=typeof xr=="object"&&xr&&xr.Object===Object&&xr;return uo=r}(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return ho=n}function Ed(){if(yo)return ba;yo=1;var e=function(){if(vo)return ma;vo=1;var n=/\s/;return ma=function(r){for(var a=r.length;a--&&n.test(r.charAt(a)););return a},ma}(),t=/^\s+/;return ba=function(n){return n&&n.slice(0,e(n)+1).replace(t,"")},ba}function Ea(){if(bo)return mo;bo=1;var e=wr().Symbol;return mo=e}function Xo(){if(Co)return To;Co=1;var e=Ea(),t=function(){if(wo)return xo;wo=1;var a=Ea(),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,l=a?a.toStringTag:void 0;return xo=function(u){var c=o.call(u,l),d=u[l];try{u[l]=void 0;var h=!0}catch{}var p=s.call(u);return h&&(c?u[l]=d:delete u[l]),p}}(),n=function(){if(ko)return Eo;ko=1;var a=Object.prototype.toString;return Eo=function(i){return a.call(i)}}(),r=e?e.toStringTag:void 0;return To=function(a){return a==null?a===void 0?"[object Undefined]":"[object Null]":r&&r in Object(a)?t(a):n(a)}}function Wn(){if(_o)return Bo;_o=1;var e=Xo(),t=So?Po:(So=1,Po=function(n){return n!=null&&typeof n=="object"});return Bo=function(n){return typeof n=="symbol"||t(n)&&e(n)=="[object Symbol]"}}var Hn=Xn(function(){if(Io)return Mo;Io=1;var e=qn(),t=function(){if(go)return po;go=1;var i=wr();return po=function(){return i.Date.now()}}(),n=function(){if(Ao)return Do;Ao=1;var i=Ed(),o=qn(),s=Wn(),l=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,c=/^0o[0-7]+$/i,d=parseInt;return Do=function(h){if(typeof h=="number")return h;if(s(h))return NaN;if(o(h)){var p=typeof h.valueOf=="function"?h.valueOf():h;h=o(p)?p+"":p}if(typeof h!="string")return h===0?h:+h;h=i(h);var f=u.test(h);return f||c.test(h)?d(h.slice(2),f?2:8):l.test(h)?NaN:+h}}(),r=Math.max,a=Math.min;return Mo=function(i,o,s){var l,u,c,d,h,p,f=0,g=!1,v=!1,y=!0;if(typeof i!="function")throw new TypeError("Expected a function");function b(x){var S=l,P=u;return l=u=void 0,f=x,d=i.apply(P,S)}function m(x){var S=x-p;return p===void 0||S>=o||S<0||v&&x-f>=c}function w(){var x=t();if(m(x))return k(x);h=setTimeout(w,function(S){var P=o-(S-p);return v?a(P,c-(S-f)):P}(x))}function k(x){return h=void 0,y&&l?b(x):(l=u=void 0,d)}function E(){var x=t(),S=m(x);if(l=arguments,u=this,p=x,S){if(h===void 0)return function(P){return f=P,h=setTimeout(w,o),g?b(P):d}(p);if(v)return clearTimeout(h),h=setTimeout(w,o),b(p)}return h===void 0&&(h=setTimeout(w,o)),d}return o=n(o)||0,e(s)&&(g=!!s.leading,c=(v="maxWait"in s)?r(n(s.maxWait)||0,o):c,y="trailing"in s?!!s.trailing:y),E.cancel=function(){h!==void 0&&clearTimeout(h),f=0,l=p=u=h=void 0},E.flush=function(){return h===void 0?d:k(t())},E}}()),ka=je?je.performance:null,qo=ka&&ka.now?function(){return ka.now()}:function(){return Date.now()},kd=function(){if(je){if(je.requestAnimationFrame)return function(e){je.requestAnimationFrame(e)};if(je.mozRequestAnimationFrame)return function(e){je.mozRequestAnimationFrame(e)};if(je.webkitRequestAnimationFrame)return function(e){je.webkitRequestAnimationFrame(e)};if(je.msRequestAnimationFrame)return function(e){je.msRequestAnimationFrame(e)}}return function(e){e&&setTimeout(function(){e(qo())},1e3/60)}}(),Er=function(e){return kd(e)},St=qo,Jt=9261,vn=5381,Wo=function(e){for(var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jt;!(t=e.next()).done;)n=65599*n+t.value|0;return n},Gn=function(e){return 65599*(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jt)+e|0},Kn=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vn;return(t<<5)+t+e|0},Ot=function(e){return 2097152*e[0]+e[1]},kr=function(e,t){return[Gn(e[0],t[0]),Kn(e[1],t[1])]},Ho=function(e,t){var n={value:0,done:!1},r=0,a=e.length;return Wo({next:function(){return r<a?n.value=e[r++]:n.done=!0,n}},t)},en=function(e,t){var n={value:0,done:!1},r=0,a=e.length;return Wo({next:function(){return r<a?n.value=e.charCodeAt(r++):n.done=!0,n}},t)},Go=function(){return Td(arguments)},Td=function(e){for(var t,n=0;n<e.length;n++){var r=e[n];t=n===0?en(r):en(r,t)}return t};function Cd(e,t,n){if(n===0)return e;var r=(t.x1+t.x2)/2,a=(t.y1+t.y2)/2,i=t.w/t.h,o=1/i,s=function(u,c,d,h,p){var f=p*Math.PI/180;return{x:Math.cos(f)*(u-d)-Math.sin(f)*(c-h)+d,y:Math.sin(f)*(u-d)+Math.cos(f)*(c-h)+h}}(e.x,e.y,r,a,n),l=function(u,c,d,h,p,f){return{x:(u-d)*p+d,y:(c-h)*f+h}}(s.x,s.y,r,a,i,o);return{x:l.x,y:l.y}}var Ko=!0,Pd=console.warn!=null,Sd=console.trace!=null,Ta=Number.MAX_SAFE_INTEGER||9007199254740991,Uo=function(){return!0},Tr=function(){return!1},Zo=function(){return 0},Ca=function(){},Me=function(e){throw new Error(e)},$o=function(e){if(e===void 0)return Ko;Ko=!!e},ke=function(e){$o()&&(Pd?console.warn(e):(console.log(e),Sd&&console.trace()))},Et=function(e){return e==null?e:Ce(e)?e.slice():xe(e)?function(t){return ge({},t)}(e):e},Qo=function(e,t){for(t=e="";e++<36;t+=51*e&52?(15^e?8^Math.random()*(20^e?16:4):4).toString(16):"-");return t},Bd={},Jo=function(){return Bd},Ke=function(e){var t=Object.keys(e);return function(n){for(var r={},a=0;a<t.length;a++){var i=t[a],o=n==null?void 0:n[i];r[i]=o===void 0?e[i]:o}return r}},Vt=function(e,t,n){for(var r=e.length-1;r>=0;r--)e[r]===t&&e.splice(r,1)},Pa=function(e){e.splice(0,e.length)},ot=function(e,t,n){return n&&(t=zo(n,t)),e[t]},Bt=function(e,t,n,r){n&&(t=zo(n,t)),e[t]=r},_t=typeof Map<"u"?Map:function(){return Rt(function e(){Nt(this,e),this._obj={}},[{key:"set",value:function(e,t){return this._obj[e]=t,this}},{key:"delete",value:function(e){return this._obj[e]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(e){return this._obj[e]!==void 0}},{key:"get",value:function(e){return this._obj[e]}}])}(),_d=function(){return Rt(function e(t){if(Nt(this,e),this._obj=Object.create(null),this.size=0,t!=null){var n;n=t.instanceString!=null&&t.instanceString()===this.instanceString()?t.toArray():t;for(var r=0;r<n.length;r++)this.add(n[r])}},[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(e){var t=this._obj;t[e]!==1&&(t[e]=1,this.size++)}},{key:"delete",value:function(e){var t=this._obj;t[e]===1&&(t[e]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(e){return this._obj[e]===1}},{key:"toArray",value:function(){var e=this;return Object.keys(this._obj).filter(function(t){return e.has(t)})}},{key:"forEach",value:function(e,t){return this.toArray().forEach(e,t)}}])}(),yn=(typeof Set>"u"?"undefined":Ye(Set))!=="undefined"?Set:_d,Cr=function(e,t){var n=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e!==void 0&&t!==void 0&&xa(e)){var r=t.group;if(r==null&&(r=t.data&&t.data.source!=null&&t.data.target!=null?"edges":"nodes"),r==="nodes"||r==="edges"){this.length=1,this[0]=this;var a=this._private={cy:e,single:!0,data:t.data||{},position:t.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:r,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!t.selected,selectable:t.selectable===void 0||!!t.selectable,locked:!!t.locked,grabbed:!1,grabbable:t.grabbable===void 0||!!t.grabbable,pannable:t.pannable===void 0?r==="edges":!!t.pannable,active:!1,classes:new yn,animation:{current:[],queue:[]},rscratch:{},scratch:t.scratch||{},edges:[],children:[],parent:t.parent&&t.parent.isNode()?t.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(a.position.x==null&&(a.position.x=0),a.position.y==null&&(a.position.y=0),t.renderedPosition){var i=t.renderedPosition,o=e.pan(),s=e.zoom();a.position={x:(i.x-o.x)/s,y:(i.y-o.y)/s}}var l=[];Ce(t.classes)?l=t.classes:pe(t.classes)&&(l=t.classes.split(/\s+/));for(var u=0,c=l.length;u<c;u++){var d=l[u];d&&d!==""&&a.classes.add(d)}this.createEmitter(),(n===void 0||n)&&this.restore();var h=t.style||t.css;h&&(ke("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(h))}else Me("An element must be of type `nodes` or `edges`; you specified `"+r+"`")}else Me("An element must have a core reference and parameters set")},es=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(t,n,r){var a;xe(t)&&!lt(t)&&(t=(a=t).roots||a.root,n=a.visit,r=a.directed),r=arguments.length!==2||Ie(n)?r:n,n=Ie(n)?n:function(){};for(var i,o=this._private.cy,s=t=pe(t)?this.filter(t):t,l=[],u=[],c={},d={},h={},p=0,f=this.byGroup(),g=f.nodes,v=f.edges,y=0;y<s.length;y++){var b=s[y],m=b.id();b.isNode()&&(l.unshift(b),e.bfs&&(h[m]=!0,u.push(b)),d[m]=0)}for(var w,k=function(){var T=e.bfs?l.shift():l.pop(),D=T.id();if(e.dfs){if(h[D])return 0;h[D]=!0,u.push(T)}var A,B=d[D],M=c[D],I=M!=null?M.source():null,R=M!=null?M.target():null,_=M==null?void 0:T.same(I)?R[0]:I[0];if((A=n(T,M,_,p++,B))===!0)return i=T,1;if(A===!1)return 1;for(var z=T.connectedEdges().filter(function(G){return(!r||G.source().same(T))&&v.has(G)}),V=0;V<z.length;V++){var L=z[V],X=L.connectedNodes().filter(function(G){return!G.same(T)&&g.has(G)}),W=X.id();X.length===0||h[W]||(X=X[0],l.push(X),e.bfs&&(h[W]=!0,u.push(X)),c[W]=L,d[W]=d[D]+1)}};l.length!==0&&((w=k())===0||w!==1););for(var E=o.collection(),x=0;x<u.length;x++){var S=u[x],P=c[S.id()];P!=null&&E.push(P),E.push(S)}return{path:o.collection(E),found:o.collection(i)}}},Un={breadthFirstSearch:es({bfs:!0}),depthFirstSearch:es({dfs:!0})};Un.bfs=Un.breadthFirstSearch,Un.dfs=Un.depthFirstSearch;var ts,ns,rs,Sa={exports:{}},Dd=Sa.exports;function Ad(){return ts||(ts=1,e=Sa,(function(){var t,n,r,a,i,o,s,l,u,c,d,h,p,f,g;r=Math.floor,c=Math.min,n=function(v,y){return v<y?-1:v>y?1:0},u=function(v,y,b,m,w){var k;if(b==null&&(b=0),w==null&&(w=n),b<0)throw new Error("lo must be non-negative");for(m==null&&(m=v.length);b<m;)w(y,v[k=r((b+m)/2)])<0?m=k:b=k+1;return[].splice.apply(v,[b,b-b].concat(y)),y},o=function(v,y,b){return b==null&&(b=n),v.push(y),f(v,0,v.length-1,b)},i=function(v,y){var b,m;return y==null&&(y=n),b=v.pop(),v.length?(m=v[0],v[0]=b,g(v,0,y)):m=b,m},l=function(v,y,b){var m;return b==null&&(b=n),m=v[0],v[0]=y,g(v,0,b),m},s=function(v,y,b){var m;return b==null&&(b=n),v.length&&b(v[0],y)<0&&(y=(m=[v[0],y])[0],v[0]=m[1],g(v,0,b)),y},a=function(v,y){var b,m,w,k,E,x;for(y==null&&(y=n),E=[],m=0,w=(k=(function(){x=[];for(var S=0,P=r(v.length/2);0<=P?S<P:S>P;0<=P?S++:S--)x.push(S);return x}).apply(this).reverse()).length;m<w;m++)b=k[m],E.push(g(v,b,y));return E},p=function(v,y,b){var m;if(b==null&&(b=n),(m=v.indexOf(y))!==-1)return f(v,0,m,b),g(v,m,b)},d=function(v,y,b){var m,w,k,E,x;if(b==null&&(b=n),!(w=v.slice(0,y)).length)return w;for(a(w,b),k=0,E=(x=v.slice(y)).length;k<E;k++)m=x[k],s(w,m,b);return w.sort(b).reverse()},h=function(v,y,b){var m,w,k,E,x,S,P,T,D;if(b==null&&(b=n),10*y<=v.length){if(!(k=v.slice(0,y).sort(b)).length)return k;for(w=k[k.length-1],E=0,S=(P=v.slice(y)).length;E<S;E++)b(m=P[E],w)<0&&(u(k,m,0,null,b),k.pop(),w=k[k.length-1]);return k}for(a(v,b),D=[],x=0,T=c(y,v.length);0<=T?x<T:x>T;0<=T?++x:--x)D.push(i(v,b));return D},f=function(v,y,b,m){var w,k,E;for(m==null&&(m=n),w=v[b];b>y&&m(w,k=v[E=b-1>>1])<0;)v[b]=k,b=E;return v[b]=w},g=function(v,y,b){var m,w,k,E,x;for(b==null&&(b=n),w=v.length,x=y,k=v[y],m=2*y+1;m<w;)(E=m+1)<w&&!(b(v[m],v[E])<0)&&(m=E),v[y]=v[m],m=2*(y=m)+1;return v[y]=k,f(v,x,y,b)},t=function(){function v(y){this.cmp=y??n,this.nodes=[]}return v.push=o,v.pop=i,v.replace=l,v.pushpop=s,v.heapify=a,v.updateItem=p,v.nlargest=d,v.nsmallest=h,v.prototype.push=function(y){return o(this.nodes,y,this.cmp)},v.prototype.pop=function(){return i(this.nodes,this.cmp)},v.prototype.peek=function(){return this.nodes[0]},v.prototype.contains=function(y){return this.nodes.indexOf(y)!==-1},v.prototype.replace=function(y){return l(this.nodes,y,this.cmp)},v.prototype.pushpop=function(y){return s(this.nodes,y,this.cmp)},v.prototype.heapify=function(){return a(this.nodes,this.cmp)},v.prototype.updateItem=function(y){return p(this.nodes,y,this.cmp)},v.prototype.clear=function(){return this.nodes=[]},v.prototype.empty=function(){return this.nodes.length===0},v.prototype.size=function(){return this.nodes.length},v.prototype.clone=function(){var y;return(y=new v).nodes=this.nodes.slice(0),y},v.prototype.toArray=function(){return this.nodes.slice(0)},v.prototype.insert=v.prototype.push,v.prototype.top=v.prototype.peek,v.prototype.front=v.prototype.peek,v.prototype.has=v.prototype.contains,v.prototype.copy=v.prototype.clone,v}(),e.exports=t}).call(Dd)),Sa.exports;var e}var Ba,Zn=Xn(rs?ns:(rs=1,ns=Ad())),Md=Ke({root:null,weight:function(e){return 1},directed:!1}),Id={dijkstra:function(e){if(!xe(e)){var t=arguments;e={root:t[0],weight:t[1],directed:t[2]}}var n=Md(e),r=n.root,a=n.weight,i=n.directed,o=this,s=a,l=pe(r)?this.filter(r)[0]:r[0],u={},c={},d={},h=this.byGroup(),p=h.nodes,f=h.edges;f.unmergeBy(function(M){return M.isLoop()});for(var g=function(M){return u[M.id()]},v=function(M,I){u[M.id()]=I,y.updateItem(M)},y=new Zn(function(M,I){return g(M)-g(I)}),b=0;b<p.length;b++){var m=p[b];u[m.id()]=m.same(l)?0:1/0,y.push(m)}for(var w=function(M,I){for(var R,_=(i?M.edgesTo(I):M.edgesWith(I)).intersect(f),z=1/0,V=0;V<_.length;V++){var L=_[V],X=s(L);(X<z||!R)&&(z=X,R=L)}return{edge:R,dist:z}};y.size()>0;){var k=y.pop(),E=g(k),x=k.id();if(d[x]=E,E!==1/0)for(var S=k.neighborhood().intersect(p),P=0;P<S.length;P++){var T=S[P],D=T.id(),A=w(k,T),B=E+A.dist;B<g(T)&&(v(T,B),c[D]={node:k,edge:A.edge})}}return{distanceTo:function(M){var I=pe(M)?p.filter(M)[0]:M[0];return d[I.id()]},pathTo:function(M){var I=pe(M)?p.filter(M)[0]:M[0],R=[],_=I,z=_.id();if(I.length>0)for(R.unshift(I);c[z];){var V=c[z];R.unshift(V.edge),R.unshift(V.node),z=(_=V.node).id()}return o.spawn(R)}}}},Nd={kruskal:function(e){e=e||function(b){return 1};for(var t=this.byGroup(),n=t.nodes,r=t.edges,a=n.length,i=new Array(a),o=n,s=function(b){for(var m=0;m<i.length;m++)if(i[m].has(b))return m},l=0;l<a;l++)i[l]=this.spawn(n[l]);for(var u=r.sort(function(b,m){return e(b)-e(m)}),c=0;c<u.length;c++){var d=u[c],h=d.source()[0],p=d.target()[0],f=s(h),g=s(p),v=i[f],y=i[g];f!==g&&(o.merge(d),v.merge(y),i.splice(g,1))}return o}},Rd=Ke({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),Ld={aStar:function(e){var t=this.cy(),n=Rd(e),r=n.root,a=n.goal,i=n.heuristic,o=n.directed,s=n.weight;r=t.collection(r)[0],a=t.collection(a)[0];var l,u,c=r.id(),d=a.id(),h={},p={},f={},g=new Zn(function(V,L){return p[V.id()]-p[L.id()]}),v=new yn,y={},b={},m=function(V,L){g.push(V),v.add(L)},w=function(){l=g.pop(),u=l.id(),v.delete(u)},k=function(V){return v.has(V)};m(r,c),h[c]=0,p[c]=i(r);for(var E=0;g.size()>0;){if(w(),E++,u===d){for(var x=[],S=a,P=d,T=b[P];x.unshift(S),T!=null&&x.unshift(T),(S=y[P])!=null;)T=b[P=S.id()];return{found:!0,distance:h[u],path:this.spawn(x),steps:E}}f[u]=!0;for(var D=l._private.edges,A=0;A<D.length;A++){var B=D[A];if(this.hasElementWithId(B.id())&&(!o||B.data("source")===u)){var M=B.source(),I=B.target(),R=M.id()!==u?M:I,_=R.id();if(this.hasElementWithId(_)&&!f[_]){var z=h[u]+s(B);k(_)?z<h[_]&&(h[_]=z,p[_]=z+i(R),y[_]=l,b[_]=B):(h[_]=z,p[_]=z+i(R),m(R,_),y[_]=l,b[_]=B)}}}}return{found:!1,distance:void 0,path:void 0,steps:E}}},zd=Ke({weight:function(e){return 1},directed:!1}),Od={floydWarshall:function(e){for(var t=this.cy(),n=zd(e),r=n.weight,a=n.directed,i=r,o=this.byGroup(),s=o.nodes,l=o.edges,u=s.length,c=u*u,d=function(L){return s.indexOf(L)},h=function(L){return s[L]},p=new Array(c),f=0;f<c;f++){var g=f%u,v=(f-g)/u;p[f]=v===g?0:1/0}for(var y=new Array(c),b=new Array(c),m=0;m<l.length;m++){var w=l[m],k=w.source()[0],E=w.target()[0];if(k!==E){var x=d(k),S=d(E),P=x*u+S,T=i(w);if(p[P]>T&&(p[P]=T,y[P]=S,b[P]=w),!a){var D=S*u+x;!a&&p[D]>T&&(p[D]=T,y[D]=x,b[D]=w)}}}for(var A=0;A<u;A++)for(var B=0;B<u;B++)for(var M=B*u+A,I=0;I<u;I++){var R=B*u+I,_=A*u+I;p[M]+p[_]<p[R]&&(p[R]=p[M]+p[_],y[R]=y[M])}var z=function(L){return d(function(X){return(pe(X)?t.filter(X):X)[0]}(L))},V={distance:function(L,X){var W=z(L),G=z(X);return p[W*u+G]},path:function(L,X){var W=z(L),G=z(X),U=h(W);if(W===G)return U.collection();if(y[W*u+G]==null)return t.collection();var Q,F=t.collection(),O=W;for(F.merge(U);W!==G;)O=W,W=y[W*u+G],Q=b[O*u+W],F.merge(Q),F.merge(h(W));return F}};return V}},Vd=Ke({weight:function(e){return 1},directed:!1,root:null}),Fd={bellmanFord:function(e){var t=this,n=Vd(e),r=n.weight,a=n.directed,i=n.root,o=r,s=this,l=this.cy(),u=this.byGroup(),c=u.edges,d=u.nodes,h=d.length,p=new _t,f=!1,g=[];i=l.collection(i)[0],c.unmergeBy(function(ce){return ce.isLoop()});for(var v=c.length,y=function(ce){var te=p.get(ce.id());return te||(te={},p.set(ce.id(),te)),te},b=function(ce){return(pe(ce)?l.$(ce):ce)[0]},m=0;m<h;m++){var w=d[m],k=y(w);w.same(i)?k.dist=0:k.dist=1/0,k.pred=null,k.edge=null}for(var E=!1,x=function(ce,te,se,de,ue,C){var N=de.dist+C;N<ue.dist&&!se.same(de.edge)&&(ue.dist=N,ue.pred=ce,ue.edge=se,E=!0)},S=1;S<h;S++){E=!1;for(var P=0;P<v;P++){var T=c[P],D=T.source(),A=T.target(),B=o(T),M=y(D),I=y(A);x(D,0,T,M,I,B),a||x(A,0,T,I,M,B)}if(!E)break}if(E)for(var R=[],_=0;_<v;_++){var z=c[_],V=z.source(),L=z.target(),X=o(z),W=y(V).dist,G=y(L).dist;if(W+X<G||!a&&G+X<W){if(f||(ke("Graph contains a negative weight cycle for Bellman-Ford"),f=!0),e.findNegativeWeightCycles===!1)break;var U=[];W+X<G&&U.push(V),!a&&G+X<W&&U.push(L);for(var Q=U.length,F=0;F<Q;F++){var O=U[F],Y=[O];Y.push(y(O).edge);for(var $=y(O).pred;Y.indexOf($)===-1;)Y.push($),Y.push(y($).edge),$=y($).pred;for(var J=(Y=Y.slice(Y.indexOf($)))[0].id(),ne=0,le=2;le<Y.length;le+=2)Y[le].id()<J&&(J=Y[le].id(),ne=le);(Y=Y.slice(ne).concat(Y.slice(0,ne))).push(Y[0]);var fe=Y.map(function(ce){return ce.id()}).join(",");R.indexOf(fe)===-1&&(g.push(s.spawn(Y)),R.push(fe))}}}return{distanceTo:function(ce){return y(b(ce)).dist},pathTo:function(ce){for(var te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i,se=[],de=b(ce);;){if(de==null)return t.spawn();var ue=y(de),C=ue.edge,N=ue.pred;if(se.unshift(de[0]),de.same(te)&&se.length>0)break;C!=null&&se.unshift(C),de=N}return s.spawn(se)},hasNegativeWeightCycle:f,negativeWeightCycles:g}}},Yd=Math.sqrt(2),jd=function(e,t,n){n.length===0&&Me("Karger-Stein must be run on a connected (sub)graph");for(var r=n[e],a=r[1],i=r[2],o=t[a],s=t[i],l=n,u=l.length-1;u>=0;u--){var c=l[u],d=c[1],h=c[2];(t[d]===o&&t[h]===s||t[d]===s&&t[h]===o)&&l.splice(u,1)}for(var p=0;p<l.length;p++){var f=l[p];f[1]===s?(l[p]=f.slice(),l[p][1]=o):f[2]===s&&(l[p]=f.slice(),l[p][2]=o)}for(var g=0;g<t.length;g++)t[g]===s&&(t[g]=o);return l},_a=function(e,t,n,r){for(;n>r;){var a=Math.floor(Math.random()*t.length);t=jd(a,e,t),n--}return t},Xd={kargerStein:function(){var e=this,t=this.byGroup(),n=t.nodes,r=t.edges;r.unmergeBy(function(R){return R.isLoop()});var a=n.length,i=r.length,o=Math.ceil(Math.pow(Math.log(a)/Math.LN2,2)),s=Math.floor(a/Yd);if(!(a<2)){for(var l=[],u=0;u<i;u++){var c=r[u];l.push([u,n.indexOf(c.source()),n.indexOf(c.target())])}for(var d=1/0,h=[],p=new Array(a),f=new Array(a),g=new Array(a),v=function(R,_){for(var z=0;z<a;z++)_[z]=R[z]},y=0;y<=o;y++){for(var b=0;b<a;b++)f[b]=b;var m=_a(f,l.slice(),a,s),w=m.slice();v(f,g);var k=_a(f,m,s,2),E=_a(g,w,s,2);k.length<=E.length&&k.length<d?(d=k.length,h=k,v(f,p)):E.length<=k.length&&E.length<d&&(d=E.length,h=E,v(g,p))}for(var x=this.spawn(h.map(function(R){return r[R[0]]})),S=this.spawn(),P=this.spawn(),T=p[0],D=0;D<p.length;D++){var A=p[D],B=n[D];A===T?S.merge(B):P.merge(B)}var M=function(R){var _=e.spawn();return R.forEach(function(z){_.merge(z),z.connectedEdges().forEach(function(V){e.contains(V)&&!x.contains(V)&&_.merge(V)})}),_},I=[M(S),M(P)];return{cut:x,components:I,partition1:S,partition2:P}}Me("At least 2 nodes are required for Karger-Stein algorithm")}},Pr=function(e,t,n){return{x:e.x*t+n.x,y:e.y*t+n.y}},as=function(e,t,n){return{x:(e.x-n.x)/t,y:(e.y-n.y)/t}},mn=function(e){return{x:e[0],y:e[1]}},Sr=function(e,t){return Math.atan2(t,e)-Math.PI/2},Da=Math.log2||function(e){return Math.log(e)/Math.log(2)},Aa=function(e){return e>0?1:e<0?-1:0},tn=function(e,t){return Math.sqrt(nn(e,t))},nn=function(e,t){var n=t.x-e.x,r=t.y-e.y;return n*n+r*r},qd=function(e){for(var t=e.length,n=0,r=0;r<t;r++)n+=e[r];for(var a=0;a<t;a++)e[a]=e[a]/n;return e},We=function(e,t,n,r){return(1-r)*(1-r)*e+2*(1-r)*r*t+r*r*n},bn=function(e,t,n,r){return{x:We(e.x,t.x,n.x,r),y:We(e.y,t.y,n.y,r)}},$n=function(e,t,n){return Math.max(e,Math.min(n,t))},nt=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},Wd=function(e,t){e.x1=Math.min(e.x1,t.x1),e.x2=Math.max(e.x2,t.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,t.y1),e.y2=Math.max(e.y2,t.y2),e.h=e.y2-e.y1},is=function(e,t,n){e.x1=Math.min(e.x1,t),e.x2=Math.max(e.x2,t),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,n),e.y2=Math.max(e.y2,n),e.h=e.y2-e.y1},Br=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=t,e.x2+=t,e.y1-=t,e.y2+=t,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},_r=function(e){var t,n,r,a,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0];if(i.length===1)t=n=r=a=i[0];else if(i.length===2)t=r=i[0],a=n=i[1];else if(i.length===4){var o=Le(i,4);t=o[0],n=o[1],r=o[2],a=o[3]}return e.x1-=a,e.x2+=n,e.y1-=t,e.y2+=r,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},os=function(e,t){e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},Ma=function(e,t){return!(e.x1>t.x2)&&!(t.x1>e.x2)&&!(e.x2<t.x1)&&!(t.x2<e.x1)&&!(e.y2<t.y1)&&!(t.y2<e.y1)&&!(e.y1>t.y2)&&!(t.y1>e.y2)},Ft=function(e,t,n){return e.x1<=t&&t<=e.x2&&e.y1<=n&&n<=e.y2},ss=function(e,t){return Ft(e,t.x,t.y)},ls=function(e,t){return Ft(e,t.x1,t.y1)&&Ft(e,t.x2,t.y2)},Hd=(Ba=Math.hypot)!==null&&Ba!==void 0?Ba:function(e,t){return Math.sqrt(e*e+t*t)};function Gd(e,t,n,r,a,i){var o=function(l,u){if(l.length<3)throw new Error("Need at least 3 vertices");var c=function(M,I){return{x:M.x+I.x,y:M.y+I.y}},d=function(M,I){return{x:M.x-I.x,y:M.y-I.y}},h=function(M,I){return{x:M.x*I,y:M.y*I}},p=function(M,I){return M.x*I.y-M.y*I.x},f=function(M){var I=Hd(M.x,M.y);return I===0?{x:0,y:0}:{x:M.x/I,y:M.y/I}},g=function(M,I,R,_){var z=d(I,M),V=d(_,R),L=p(z,V);if(Math.abs(L)<1e-9)return c(M,h(z,.5));var X=p(d(R,M),V)/L;return c(M,h(z,X))},v=l.map(function(M){return{x:M.x,y:M.y}});(function(M){for(var I=0,R=0;R<M.length;R++){var _=M[R],z=M[(R+1)%M.length];I+=_.x*z.y-z.x*_.y}return I/2})(v)<0&&v.reverse();for(var y=v.length,b=[],m=0;m<y;m++){var w=v[m],k=v[(m+1)%y],E=d(k,w),x=f({x:E.y,y:-E.x});b.push(x)}for(var S=b.map(function(M,I){return{p1:c(v[I],h(M,u)),p2:c(v[(I+1)%y],h(M,u))}}),P=[],T=0;T<y;T++){var D=S[(T-1+y)%y],A=S[T],B=g(D.p1,D.p2,A.p1,A.p2);P.push(B)}return P}(Qd(e,t,n,r,a),i),s=nt();return o.forEach(function(l){return is(s,l.x,l.y)}),s}var us=function(e,t,n,r,a,i,o){var s,l,u=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",c=u==="auto"?jt(a,i):u,d=a/2,h=i/2,p=(c=Math.min(c,d,h))!==d,f=c!==h;if(p){var g=r-h-o;if((s=Yt(e,t,n,r,n-d+c-o,g,n+d-c+o,g,!1)).length>0)return s}if(f){var v=n+d+o;if((s=Yt(e,t,n,r,v,r-h+c-o,v,r+h-c+o,!1)).length>0)return s}if(p){var y=r+h+o;if((s=Yt(e,t,n,r,n-d+c-o,y,n+d-c+o,y,!1)).length>0)return s}if(f){var b=n-d-o;if((s=Yt(e,t,n,r,b,r-h+c-o,b,r+h-c+o,!1)).length>0)return s}var m=n-d+c,w=r-h+c;if((l=Qn(e,t,n,r,m,w,c+o)).length>0&&l[0]<=m&&l[1]<=w)return[l[0],l[1]];var k=n+d-c,E=r-h+c;if((l=Qn(e,t,n,r,k,E,c+o)).length>0&&l[0]>=k&&l[1]<=E)return[l[0],l[1]];var x=n+d-c,S=r+h-c;if((l=Qn(e,t,n,r,x,S,c+o)).length>0&&l[0]>=x&&l[1]>=S)return[l[0],l[1]];var P=n-d+c,T=r+h-c;return(l=Qn(e,t,n,r,P,T,c+o)).length>0&&l[0]<=P&&l[1]>=T?[l[0],l[1]]:[]},Kd=function(e,t,n,r,a,i,o){var s=o,l=Math.min(n,a),u=Math.max(n,a),c=Math.min(r,i),d=Math.max(r,i);return l-s<=e&&e<=u+s&&c-s<=t&&t<=d+s},Ud=function(e,t,n,r,a,i,o,s,l){var u=Math.min(n,o,a)-l,c=Math.max(n,o,a)+l,d=Math.min(r,s,i)-l,h=Math.max(r,s,i)+l;return!(e<u||e>c||t<d||t>h)},Zd=function(e,t,n,r,a,i,o,s){var l=[];(function(v,y,b,m,w){var k,E,x,S,P,T,D,A;v===0&&(v=1e-5),x=-27*(m/=v)+(y/=v)*(9*(b/=v)-y*y*2),k=(E=(3*b-y*y)/9)*E*E+(x/=54)*x,w[1]=0,D=y/3,k>0?(P=(P=x+Math.sqrt(k))<0?-Math.pow(-P,1/3):Math.pow(P,1/3),T=(T=x-Math.sqrt(k))<0?-Math.pow(-T,1/3):Math.pow(T,1/3),w[0]=-D+P+T,D+=(P+T)/2,w[4]=w[2]=-D,D=Math.sqrt(3)*(-T+P)/2,w[3]=D,w[5]=-D):(w[5]=w[3]=0,k===0?(A=x<0?-Math.pow(-x,1/3):Math.pow(x,1/3),w[0]=2*A-D,w[4]=w[2]=-(A+D)):(S=(E=-E)*E*E,S=Math.acos(x/Math.sqrt(S)),A=2*Math.sqrt(E),w[0]=-D+A*Math.cos(S/3),w[2]=-D+A*Math.cos((S+2*Math.PI)/3),w[4]=-D+A*Math.cos((S+4*Math.PI)/3)))})(1*n*n-4*n*a+2*n*o+4*a*a-4*a*o+o*o+r*r-4*r*i+2*r*s+4*i*i-4*i*s+s*s,9*n*a-3*n*n-3*n*o-6*a*a+3*a*o+9*r*i-3*r*r-3*r*s-6*i*i+3*i*s,3*n*n-6*n*a+n*o-n*e+2*a*a+2*a*e-o*e+3*r*r-6*r*i+r*s-r*t+2*i*i+2*i*t-s*t,1*n*a-n*n+n*e-a*e+r*i-r*r+r*t-i*t,l);for(var u=[],c=0;c<6;c+=2)Math.abs(l[c+1])<1e-7&&l[c]>=0&&l[c]<=1&&u.push(l[c]);u.push(1),u.push(0);for(var d,h,p,f=-1,g=0;g<u.length;g++)d=Math.pow(1-u[g],2)*n+2*(1-u[g])*u[g]*a+u[g]*u[g]*o,h=Math.pow(1-u[g],2)*r+2*(1-u[g])*u[g]*i+u[g]*u[g]*s,p=Math.pow(d-e,2)+Math.pow(h-t,2),f>=0?p<f&&(f=p):f=p;return f},$d=function(e,t,n,r,a,i){var o=[e-n,t-r],s=[a-n,i-r],l=s[0]*s[0]+s[1]*s[1],u=o[0]*o[0]+o[1]*o[1],c=o[0]*s[0]+o[1]*s[1],d=c*c/l;return c<0?u:d>l?(e-a)*(e-a)+(t-i)*(t-i):u-d},st=function(e,t,n){for(var r,a,i,o,s=0,l=0;l<n.length/2;l++)if(r=n[2*l],a=n[2*l+1],l+1<n.length/2?(i=n[2*(l+1)],o=n[2*(l+1)+1]):(i=n[2*(l+1-n.length/2)],o=n[2*(l+1-n.length/2)+1]),!(r==e&&i==e)){if(!(r>=e&&e>=i||r<=e&&e<=i))continue;(e-r)/(i-r)*(o-a)+a>t&&s++}return s%2!=0},Dt=function(e,t,n,r,a,i,o,s,l){var u,c=new Array(n.length);s[0]!=null?(u=Math.atan(s[1]/s[0]),s[0]<0?u+=Math.PI/2:u=-u-Math.PI/2):u=s;for(var d,h=Math.cos(-u),p=Math.sin(-u),f=0;f<c.length/2;f++)c[2*f]=i/2*(n[2*f]*h-n[2*f+1]*p),c[2*f+1]=o/2*(n[2*f+1]*h+n[2*f]*p),c[2*f]+=r,c[2*f+1]+=a;if(l>0){var g=Ar(c,-l);d=Dr(g)}else d=c;return st(e,t,d)},Dr=function(e){for(var t,n,r,a,i,o,s,l,u=new Array(e.length/2),c=0;c<e.length/4;c++){t=e[4*c],n=e[4*c+1],r=e[4*c+2],a=e[4*c+3],c<e.length/4-1?(i=e[4*(c+1)],o=e[4*(c+1)+1],s=e[4*(c+1)+2],l=e[4*(c+1)+3]):(i=e[0],o=e[1],s=e[2],l=e[3]);var d=Yt(t,n,r,a,i,o,s,l,!0);u[2*c]=d[0],u[2*c+1]=d[1]}return u},Ar=function(e,t){for(var n,r,a,i,o=new Array(2*e.length),s=0;s<e.length/2;s++){n=e[2*s],r=e[2*s+1],s<e.length/2-1?(a=e[2*(s+1)],i=e[2*(s+1)+1]):(a=e[0],i=e[1]);var l=i-r,u=-(a-n),c=Math.sqrt(l*l+u*u),d=l/c,h=u/c;o[4*s]=n+d*t,o[4*s+1]=r+h*t,o[4*s+2]=a+d*t,o[4*s+3]=i+h*t}return o},rn=function(e,t,n,r,a,i,o){return e-=a,t-=i,(e/=n/2+o)*e+(t/=r/2+o)*t<=1},Qn=function(e,t,n,r,a,i,o){var s=[n-e,r-t],l=[e-a,t-i],u=s[0]*s[0]+s[1]*s[1],c=2*(l[0]*s[0]+l[1]*s[1]),d=c*c-4*u*(l[0]*l[0]+l[1]*l[1]-o*o);if(d<0)return[];var h=(-c+Math.sqrt(d))/(2*u),p=(-c-Math.sqrt(d))/(2*u),f=Math.min(h,p),g=Math.max(h,p),v=[];if(f>=0&&f<=1&&v.push(f),g>=0&&g<=1&&v.push(g),v.length===0)return[];var y=v[0]*s[0]+e,b=v[0]*s[1]+t;return v.length>1?v[0]==v[1]?[y,b]:[y,b,v[1]*s[0]+e,v[1]*s[1]+t]:[y,b]},Ia=function(e,t,n){return t<=e&&e<=n||n<=e&&e<=t?e:e<=t&&t<=n||n<=t&&t<=e?t:n},Yt=function(e,t,n,r,a,i,o,s,l){var u=e-a,c=n-e,d=o-a,h=t-i,p=r-t,f=s-i,g=d*h-f*u,v=c*h-p*u,y=f*c-d*p;if(y!==0){var b=g/y,m=v/y,w=-.001;return w<=b&&b<=1.001&&w<=m&&m<=1.001||l?[e+b*c,t+b*p]:[]}return g===0||v===0?Ia(e,n,o)===o?[o,s]:Ia(e,n,a)===a?[a,i]:Ia(a,o,n)===n?[n,r]:[]:[]},Qd=function(e,t,n,r,a){var i=[],o=r/2,s=a/2,l=t,u=n;i.push({x:l+o*e[0],y:u+s*e[1]});for(var c=1;c<e.length/2;c++)i.push({x:l+o*e[2*c],y:u+s*e[2*c+1]});return i},Jn=function(e,t,n,r,a,i,o,s){var l,u,c,d,h,p,f=[],g=new Array(n.length),v=!0;if(i==null&&(v=!1),v){for(var y=0;y<g.length/2;y++)g[2*y]=n[2*y]*i+r,g[2*y+1]=n[2*y+1]*o+a;if(s>0){var b=Ar(g,-s);u=Dr(b)}else u=g}else u=n;for(var m=0;m<u.length/2;m++)c=u[2*m],d=u[2*m+1],m<u.length/2-1?(h=u[2*(m+1)],p=u[2*(m+1)+1]):(h=u[0],p=u[1]),(l=Yt(e,t,r,a,c,d,h,p)).length!==0&&f.push(l[0],l[1]);return f},Mr=function(e,t,n){var r=[e[0]-t[0],e[1]-t[1]],a=Math.sqrt(r[0]*r[0]+r[1]*r[1]),i=(a-n)/a;return i<0&&(i=1e-5),[t[0]+i*r[0],t[1]+i*r[1]]},rt=function(e,t){var n=Na(e,t);return n=cs(n)},cs=function(e){for(var t,n,r=e.length/2,a=1/0,i=1/0,o=-1/0,s=-1/0,l=0;l<r;l++)t=e[2*l],n=e[2*l+1],a=Math.min(a,t),o=Math.max(o,t),i=Math.min(i,n),s=Math.max(s,n);for(var u=2/(o-a),c=2/(s-i),d=0;d<r;d++)t=e[2*d]=e[2*d]*u,n=e[2*d+1]=e[2*d+1]*c,a=Math.min(a,t),o=Math.max(o,t),i=Math.min(i,n),s=Math.max(s,n);if(i<-1)for(var h=0;h<r;h++)n=e[2*h+1]=e[2*h+1]+(-1-i);return e},Na=function(e,t){var n=1/e*2*Math.PI,r=e%2==0?Math.PI/2+n/2:Math.PI/2;r+=t;for(var a,i=new Array(2*e),o=0;o<e;o++)a=o*n+r,i[2*o]=Math.cos(a),i[2*o+1]=Math.sin(-a);return i},jt=function(e,t){return Math.min(e/4,t/4,8)},ds=function(e,t){return Math.min(e/10,t/10,8)},Ra=function(e,t){return{heightOffset:Math.min(15,.05*t),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}};function La(e,t){function n(l){for(var u=[],c=0;c<l.length;c++){var d=l[c],h=l[(c+1)%l.length],p={x:h.x-d.x,y:h.y-d.y},f={x:-p.y,y:p.x},g=Math.sqrt(f.x*f.x+f.y*f.y);u.push({x:f.x/g,y:f.y/g})}return u}function r(l,u){var c,d=1/0,h=-1/0,p=it(l);try{for(p.s();!(c=p.n()).done;){var f=c.value,g=f.x*u.x+f.y*u.y;d=Math.min(d,g),h=Math.max(h,g)}}catch(v){p.e(v)}finally{p.f()}return{min:d,max:h}}function a(l,u){return!(l.max<u.min||u.max<l.min)}var i,o=it([].concat(yr(n(e)),yr(n(t))));try{for(o.s();!(i=o.n()).done;){var s=i.value;if(!a(r(e,s),r(t,s)))return!1}}catch(l){o.e(l)}finally{o.f()}return!0}var Jd=Ke({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),eh={pageRank:function(e){for(var t=Jd(e),n=t.dampingFactor,r=t.precision,a=t.iterations,i=t.weight,o=this._private.cy,s=this.byGroup(),l=s.nodes,u=s.edges,c=l.length,d=c*c,h=u.length,p=new Array(d),f=new Array(c),g=(1-n)/c,v=0;v<c;v++){for(var y=0;y<c;y++)p[v*c+y]=0;f[v]=0}for(var b=0;b<h;b++){var m=u[b],w=m.data("source"),k=m.data("target");if(w!==k){var E=l.indexOfId(w),x=l.indexOfId(k),S=i(m);p[x*c+E]+=S,f[E]+=S}}for(var P=1/c+g,T=0;T<c;T++)if(f[T]===0)for(var D=0;D<c;D++)p[D*c+T]=P;else for(var A=0;A<c;A++){var B=A*c+T;p[B]=p[B]/f[T]+g}for(var M,I=new Array(c),R=new Array(c),_=0;_<c;_++)I[_]=1;for(var z=0;z<a;z++){for(var V=0;V<c;V++)R[V]=0;for(var L=0;L<c;L++)for(var X=0;X<c;X++){var W=L*c+X;R[L]+=p[W]*I[X]}qd(R),M=I,I=R,R=M;for(var G=0,U=0;U<c;U++){var Q=M[U]-I[U];G+=Q*Q}if(G<r)break}return{rank:function(F){return F=o.collection(F)[0],I[l.indexOf(F)]}}}},hs=Ke({root:null,weight:function(e){return 1},directed:!1,alpha:0}),xn={degreeCentralityNormalized:function(e){e=hs(e);var t=this.cy(),n=this.nodes(),r=n.length;if(e.directed){for(var a={},i={},o=0,s=0,l=0;l<r;l++){var u=n[l],c=u.id();e.root=u;var d=this.degreeCentrality(e);o<d.indegree&&(o=d.indegree),s<d.outdegree&&(s=d.outdegree),a[c]=d.indegree,i[c]=d.outdegree}return{indegree:function(y){return o==0?0:(pe(y)&&(y=t.filter(y)),a[y.id()]/o)},outdegree:function(y){return s===0?0:(pe(y)&&(y=t.filter(y)),i[y.id()]/s)}}}for(var h={},p=0,f=0;f<r;f++){var g=n[f];e.root=g;var v=this.degreeCentrality(e);p<v.degree&&(p=v.degree),h[g.id()]=v.degree}return{degree:function(y){return p===0?0:(pe(y)&&(y=t.filter(y)),h[y.id()]/p)}}},degreeCentrality:function(e){e=hs(e);var t=this.cy(),n=this,r=e,a=r.root,i=r.weight,o=r.directed,s=r.alpha;if(a=t.collection(a)[0],o){for(var l=a.connectedEdges(),u=l.filter(function(k){return k.target().same(a)&&n.has(k)}),c=l.filter(function(k){return k.source().same(a)&&n.has(k)}),d=u.length,h=c.length,p=0,f=0,g=0;g<u.length;g++)p+=i(u[g]);for(var v=0;v<c.length;v++)f+=i(c[v]);return{indegree:Math.pow(d,1-s)*Math.pow(p,s),outdegree:Math.pow(h,1-s)*Math.pow(f,s)}}for(var y=a.connectedEdges().intersection(n),b=y.length,m=0,w=0;w<y.length;w++)m+=i(y[w]);return{degree:Math.pow(b,1-s)*Math.pow(m,s)}}};xn.dc=xn.degreeCentrality,xn.dcn=xn.degreeCentralityNormalised=xn.degreeCentralityNormalized;var fs=Ke({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),wn={closenessCentralityNormalized:function(e){for(var t=fs(e),n=t.harmonic,r=t.weight,a=t.directed,i=this.cy(),o={},s=0,l=this.nodes(),u=this.floydWarshall({weight:r,directed:a}),c=0;c<l.length;c++){for(var d=0,h=l[c],p=0;p<l.length;p++)if(c!==p){var f=u.distance(h,l[p]);d+=n?1/f:f}n||(d=1/d),s<d&&(s=d),o[h.id()]=d}return{closeness:function(g){return s==0?0:(g=pe(g)?i.filter(g)[0].id():g.id(),o[g]/s)}}},closenessCentrality:function(e){var t=fs(e),n=t.root,r=t.weight,a=t.directed,i=t.harmonic;n=this.filter(n)[0];for(var o=this.dijkstra({root:n,weight:r,directed:a}),s=0,l=this.nodes(),u=0;u<l.length;u++){var c=l[u];if(!c.same(n)){var d=o.distanceTo(c);s+=i?1/d:d}}return i?s:1/s}};wn.cc=wn.closenessCentrality,wn.ccn=wn.closenessCentralityNormalised=wn.closenessCentralityNormalized;var th=Ke({weight:null,directed:!1}),za={betweennessCentrality:function(e){for(var t=th(e),n=t.directed,r=t.weight,a=r!=null,i=this.cy(),o=this.nodes(),s={},l={},u=0,c=function(b,m){l[b]=m,m>u&&(u=m)},d=function(b){return l[b]},h=0;h<o.length;h++){var p=o[h],f=p.id();s[f]=n?p.outgoers().nodes():p.openNeighborhood().nodes(),c(f,0)}for(var g=function(){for(var b=o[v].id(),m=[],w={},k={},E={},x=new Zn(function(G,U){return E[G]-E[U]}),S=0;S<o.length;S++){var P=o[S].id();w[P]=[],k[P]=0,E[P]=1/0}for(k[b]=1,E[b]=0,x.push(b);!x.empty();){var T=x.pop();if(m.push(T),a)for(var D=0;D<s[T].length;D++){var A=s[T][D],B=i.getElementById(T),M=void 0;M=B.edgesTo(A).length>0?B.edgesTo(A)[0]:A.edgesTo(B)[0];var I=r(M);A=A.id(),E[A]>E[T]+I&&(E[A]=E[T]+I,x.nodes.indexOf(A)<0?x.push(A):x.updateItem(A),k[A]=0,w[A]=[]),E[A]==E[T]+I&&(k[A]=k[A]+k[T],w[A].push(T))}else for(var R=0;R<s[T].length;R++){var _=s[T][R].id();E[_]==1/0&&(x.push(_),E[_]=E[T]+1),E[_]==E[T]+1&&(k[_]=k[_]+k[T],w[_].push(T))}}for(var z={},V=0;V<o.length;V++)z[o[V].id()]=0;for(;m.length>0;){for(var L=m.pop(),X=0;X<w[L].length;X++){var W=w[L][X];z[W]=z[W]+k[W]/k[L]*(1+z[L])}L!=o[v].id()&&c(L,d(L)+z[L])}},v=0;v<o.length;v++)g();var y={betweenness:function(b){var m=i.collection(b).id();return d(m)},betweennessNormalized:function(b){if(u==0)return 0;var m=i.collection(b).id();return d(m)/u}};return y.betweennessNormalised=y.betweennessNormalized,y}};za.bc=za.betweennessCentrality;var nh=Ke({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(e){return 1}]}),rh=function(e,t){for(var n=0,r=0;r<t.length;r++)n+=t[r](e);return n},ps=function(e,t){for(var n,r=0;r<t;r++){n=0;for(var a=0;a<t;a++)n+=e[a*t+r];for(var i=0;i<t;i++)e[i*t+r]=e[i*t+r]/n}},ah=function(e,t,n){for(var r=new Array(n*n),a=0;a<n;a++){for(var i=0;i<n;i++)r[a*n+i]=0;for(var o=0;o<n;o++)for(var s=0;s<n;s++)r[a*n+s]+=e[a*n+o]*t[o*n+s]}return r},ih=function(e,t,n){for(var r=e.slice(0),a=1;a<n;a++)e=ah(e,r,t);return e},oh=function(e,t,n){for(var r=new Array(t*t),a=0;a<t*t;a++)r[a]=Math.pow(e[a],n);return ps(r,t),r},sh=function(e,t,n,r){for(var a=0;a<n;a++)if(Math.round(e[a]*Math.pow(10,r))/Math.pow(10,r)!==Math.round(t[a]*Math.pow(10,r))/Math.pow(10,r))return!1;return!0},lh=function(e,t){for(var n=0;n<e.length;n++)if(!t[n]||e[n].id()!==t[n].id())return!1;return!0},gs=function(e){for(var t=this.nodes(),n=this.edges(),r=this.cy(),a=function(w){return nh(w)}(e),i={},o=0;o<t.length;o++)i[t[o].id()]=o;for(var s,l=t.length,u=l*l,c=new Array(u),d=0;d<u;d++)c[d]=0;for(var h=0;h<n.length;h++){var p=n[h],f=i[p.source().id()],g=i[p.target().id()],v=rh(p,a.attributes);c[f*l+g]+=v,c[g*l+f]+=v}(function(w,k,E){for(var x=0;x<k;x++)w[x*k+x]=E})(c,l,a.multFactor),ps(c,l);for(var y=!0,b=0;y&&b<a.maxIterations;)y=!1,s=ih(c,l,a.expandFactor),c=oh(s,l,a.inflateFactor),sh(c,s,u,4)||(y=!0),b++;var m=function(w,k,E,x){for(var S=[],P=0;P<k;P++){for(var T=[],D=0;D<k;D++)Math.round(1e3*w[P*k+D])/1e3>0&&T.push(E[D]);T.length!==0&&S.push(x.collection(T))}return S}(c,l,t,r);return m=function(w){for(var k=0;k<w.length;k++)for(var E=0;E<w.length;E++)k!=E&&lh(w[k],w[E])&&w.splice(E,1);return w}(m),m},uh={markovClustering:gs,mcl:gs},ch=function(e){return e},vs=function(e,t){return Math.abs(t-e)},ys=function(e,t,n){return e+vs(t,n)},ms=function(e,t,n){return e+Math.pow(n-t,2)},dh=function(e){return Math.sqrt(e)},hh=function(e,t,n){return Math.max(e,vs(t,n))},er=function(e,t,n,r,a){for(var i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:ch,o=r,s=0;s<e;s++)o=a(o,t(s),n(s));return i(o)},En={euclidean:function(e,t,n){return e>=2?er(e,t,n,0,ms,dh):er(e,t,n,0,ys)},squaredEuclidean:function(e,t,n){return er(e,t,n,0,ms)},manhattan:function(e,t,n){return er(e,t,n,0,ys)},max:function(e,t,n){return er(e,t,n,-1/0,hh)}};function Ir(e,t,n,r,a,i){var o;return o=Ie(e)?e:En[e]||En.euclidean,t===0&&Ie(e)?o(a,i):o(t,n,r,a,i)}En["squared-euclidean"]=En.squaredEuclidean,En.squaredeuclidean=En.squaredEuclidean;var fh=Ke({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),Oa=function(e){return fh(e)},Nr=function(e,t,n,r,a){var i=a!=="kMedoids"?function(l){return n[l]}:function(l){return r[l](n)},o=n,s=t;return Ir(e,r.length,i,function(l){return r[l](t)},o,s)},Va=function(e,t,n){for(var r=n.length,a=new Array(r),i=new Array(r),o=new Array(t),s=null,l=0;l<r;l++)a[l]=e.min(n[l]).value,i[l]=e.max(n[l]).value;for(var u=0;u<t;u++){s=[];for(var c=0;c<r;c++)s[c]=Math.random()*(i[c]-a[c])+a[c];o[u]=s}return o},bs=function(e,t,n,r,a){for(var i=1/0,o=0,s=0;s<t.length;s++){var l=Nr(n,e,t[s],r,a);l<i&&(i=l,o=s)}return o},xs=function(e,t,n){for(var r=[],a=null,i=0;i<t.length;i++)n[(a=t[i]).id()]===e&&r.push(a);return r},ph=function(e,t,n){return Math.abs(t-e)<=n},gh=function(e,t,n){for(var r=0;r<e.length;r++)for(var a=0;a<e[r].length;a++)if(Math.abs(e[r][a]-t[r][a])>n)return!1;return!0},vh=function(e,t,n){for(var r=0;r<n;r++)if(e===t[r])return!0;return!1},ws=function(e,t){var n=new Array(t);if(e.length<50)for(var r=0;r<t;r++){for(var a=e[Math.floor(Math.random()*e.length)];vh(a,n,r);)a=e[Math.floor(Math.random()*e.length)];n[r]=a}else for(var i=0;i<t;i++)n[i]=e[Math.floor(Math.random()*e.length)];return n},Es=function(e,t,n){for(var r=0,a=0;a<t.length;a++)r+=Nr("manhattan",t[a],e,n,"kMedoids");return r},yh=function(e,t,n,r,a){for(var i,o,s=0;s<t.length;s++)for(var l=0;l<e.length;l++)r[s][l]=Math.pow(n[s][l],a.m);for(var u=0;u<e.length;u++)for(var c=0;c<a.attributes.length;c++){i=0,o=0;for(var d=0;d<t.length;d++)i+=r[d][u]*a.attributes[c](t[d]),o+=r[d][u];e[u][c]=i/o}},mh=function(e,t,n,r,a){for(var i=0;i<e.length;i++)t[i]=e[i].slice();for(var o,s,l,u=2/(a.m-1),c=0;c<n.length;c++)for(var d=0;d<r.length;d++){o=0;for(var h=0;h<n.length;h++)s=Nr(a.distance,r[d],n[c],a.attributes,"cmeans"),l=Nr(a.distance,r[d],n[h],a.attributes,"cmeans"),o+=Math.pow(s/l,u);e[d][c]=1/o}},ks=function(e){var t,n,r,a,i,o=this.cy(),s=this.nodes(),l=Oa(e);a=new Array(s.length);for(var u=0;u<s.length;u++)a[u]=new Array(l.k);r=new Array(s.length);for(var c=0;c<s.length;c++)r[c]=new Array(l.k);for(var d=0;d<s.length;d++){for(var h=0,p=0;p<l.k;p++)r[d][p]=Math.random(),h+=r[d][p];for(var f=0;f<l.k;f++)r[d][f]=r[d][f]/h}n=new Array(l.k);for(var g=0;g<l.k;g++)n[g]=new Array(l.attributes.length);i=new Array(s.length);for(var v=0;v<s.length;v++)i[v]=new Array(l.k);for(var y=!0,b=0;y&&b<l.maxIterations;)y=!1,yh(n,s,r,i,l),mh(r,a,n,s,l),gh(r,a,l.sensitivityThreshold)||(y=!0),b++;return t=function(m,w,k,E){for(var x,S,P=new Array(k.k),T=0;T<P.length;T++)P[T]=[];for(var D=0;D<w.length;D++){x=-1/0,S=-1;for(var A=0;A<w[0].length;A++)w[D][A]>x&&(x=w[D][A],S=A);P[S].push(m[D])}for(var B=0;B<P.length;B++)P[B]=E.collection(P[B]);return P}(s,r,l,o),{clusters:t,degreeOfMembership:r}},bh={kMeans:function(e){var t,n=this.cy(),r=this.nodes(),a=null,i=Oa(e),o=new Array(i.k),s={};i.testMode?typeof i.testCentroids=="number"?(i.testCentroids,t=Va(r,i.k,i.attributes)):t=Ye(i.testCentroids)==="object"?i.testCentroids:Va(r,i.k,i.attributes):t=Va(r,i.k,i.attributes);for(var l=!0,u=0;l&&u<i.maxIterations;){for(var c=0;c<r.length;c++)s[(a=r[c]).id()]=bs(a,t,i.distance,i.attributes,"kMeans");l=!1;for(var d=0;d<i.k;d++){var h=xs(d,r,s);if(h.length!==0){for(var p=i.attributes.length,f=t[d],g=new Array(p),v=new Array(p),y=0;y<p;y++){v[y]=0;for(var b=0;b<h.length;b++)a=h[b],v[y]+=i.attributes[y](a);g[y]=v[y]/h.length,ph(g[y],f[y],i.sensitivityThreshold)||(l=!0)}t[d]=g,o[d]=n.collection(h)}}u++}return o},kMedoids:function(e){var t,n,r=this.cy(),a=this.nodes(),i=null,o=Oa(e),s=new Array(o.k),l={},u=new Array(o.k);o.testMode?typeof o.testCentroids=="number"||(t=Ye(o.testCentroids)==="object"?o.testCentroids:ws(a,o.k)):t=ws(a,o.k);for(var c=!0,d=0;c&&d<o.maxIterations;){for(var h=0;h<a.length;h++)l[(i=a[h]).id()]=bs(i,t,o.distance,o.attributes,"kMedoids");c=!1;for(var p=0;p<t.length;p++){var f=xs(p,a,l);if(f.length!==0){u[p]=Es(t[p],f,o.attributes);for(var g=0;g<f.length;g++)(n=Es(f[g],f,o.attributes))<u[p]&&(u[p]=n,t[p]=f[g],c=!0);s[p]=r.collection(f)}}d++}return s},fuzzyCMeans:ks,fcm:ks},xh=Ke({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),wh={single:"min",complete:"max"},Ts=function(e,t,n,r,a){for(var i,o=0,s=1/0,l=a.attributes,u=function(x,S){return Ir(a.distance,l.length,function(P){return l[P](x)},function(P){return l[P](S)},x,S)},c=0;c<e.length;c++){var d=e[c].key,h=n[d][r[d]];h<s&&(o=d,s=h)}if(a.mode==="threshold"&&s>=a.threshold||a.mode==="dendrogram"&&e.length===1)return!1;var p,f=t[o],g=t[r[o]];p=a.mode==="dendrogram"?{left:f,right:g,key:f.key}:{value:f.value.concat(g.value),key:f.key},e[f.index]=p,e.splice(g.index,1),t[f.key]=p;for(var v=0;v<e.length;v++){var y=e[v];f.key===y.key?i=1/0:a.linkage==="min"?(i=n[f.key][y.key],n[f.key][y.key]>n[g.key][y.key]&&(i=n[g.key][y.key])):a.linkage==="max"?(i=n[f.key][y.key],n[f.key][y.key]<n[g.key][y.key]&&(i=n[g.key][y.key])):i=a.linkage==="mean"?(n[f.key][y.key]*f.size+n[g.key][y.key]*g.size)/(f.size+g.size):a.mode==="dendrogram"?u(y.value,f.value):u(y.value[0],f.value[0]),n[f.key][y.key]=n[y.key][f.key]=i}for(var b=0;b<e.length;b++){var m=e[b].key;if(r[m]===f.key||r[m]===g.key){for(var w=m,k=0;k<e.length;k++){var E=e[k].key;n[m][E]<n[m][w]&&(w=E)}r[m]=w}e[b].index=b}return f.key=g.key=f.index=g.index=null,!0},kn=function(e,t,n){e&&(e.value?t.push(e.value):(e.left&&kn(e.left,t),e.right&&kn(e.right,t)))},Fa=function(e,t){if(!e)return"";if(e.left&&e.right){var n=Fa(e.left,t),r=Fa(e.right,t),a=t.add({group:"nodes",data:{id:n+","+r}});return t.add({group:"edges",data:{source:n,target:a.id()}}),t.add({group:"edges",data:{source:r,target:a.id()}}),a.id()}return e.value?e.value.id():void 0},Ya=function(e,t,n){if(!e)return[];var r=[],a=[],i=[];return t===0?(e.left&&kn(e.left,r),e.right&&kn(e.right,a),i=r.concat(a),[n.collection(i)]):t===1?e.value?[n.collection(e.value)]:(e.left&&kn(e.left,r),e.right&&kn(e.right,a),[n.collection(r),n.collection(a)]):e.value?[n.collection(e.value)]:(e.left&&(r=Ya(e.left,t-1,n)),e.right&&(a=Ya(e.right,t-1,n)),r.concat(a))},Cs=function(e){for(var t=this.cy(),n=this.nodes(),r=function(y){var b=xh(y),m=wh[b.linkage];return m!=null&&(b.linkage=m),b}(e),a=r.attributes,i=function(y,b){return Ir(r.distance,a.length,function(m){return a[m](y)},function(m){return a[m](b)},y,b)},o=[],s=[],l=[],u=[],c=0;c<n.length;c++){var d={value:r.mode==="dendrogram"?n[c]:[n[c]],key:c,index:c};o[c]=d,u[c]=d,s[c]=[],l[c]=0}for(var h=0;h<o.length;h++)for(var p=0;p<=h;p++){var f=void 0;f=r.mode==="dendrogram"?h===p?1/0:i(o[h].value,o[p].value):h===p?1/0:i(o[h].value[0],o[p].value[0]),s[h][p]=f,s[p][h]=f,f<s[h][l[h]]&&(l[h]=p)}for(var g,v=Ts(o,u,s,l,r);v;)v=Ts(o,u,s,l,r);return r.mode==="dendrogram"?(g=Ya(o[0],r.dendrogramDepth,t),r.addDendrogram&&Fa(o[0],t)):(g=new Array(o.length),o.forEach(function(y,b){y.key=y.index=null,g[b]=t.collection(y.value)})),g},Eh={hierarchicalClustering:Cs,hca:Cs},kh=Ke({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),Th=function(e,t,n,r){var a=function(i,o){return r[o](i)};return-Ir(e,r.length,function(i){return a(t,i)},function(i){return a(n,i)},t,n)},Ch=function(e,t){var n=null;return n=t==="median"?function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r.length,o=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],s=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];arguments.length>3&&arguments[3]!==void 0&&!arguments[3]?(i<r.length&&r.splice(i,r.length-i),a>0&&r.splice(0,a)):r=r.slice(a,i);for(var l=0,u=r.length-1;u>=0;u--){var c=r[u];s?isFinite(c)||(r[u]=-1/0,l++):r.splice(u,1)}o&&r.sort(function(p,f){return p-f});var d=r.length,h=Math.floor(d/2);return d%2!=0?r[h+1+l]:(r[h-1+l]+r[h+l])/2}(e):t==="mean"?function(r){for(var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r.length,o=0,s=0,l=a;l<i;l++){var u=r[l];isFinite(u)&&(o+=u,s++)}return o/s}(e):t==="min"?function(r){for(var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r.length,o=1/0,s=a;s<i;s++){var l=r[s];isFinite(l)&&(o=Math.min(l,o))}return o}(e):t==="max"?function(r){for(var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r.length,o=-1/0,s=a;s<i;s++){var l=r[s];isFinite(l)&&(o=Math.max(l,o))}return o}(e):t,n},Ps=function(e,t,n){for(var r=[],a=0;a<e;a++){for(var i=-1,o=-1/0,s=0;s<n.length;s++){var l=n[s];t[a*e+l]>o&&(i=l,o=t[a*e+l])}i>0&&r.push(i)}for(var u=0;u<n.length;u++)r[n[u]]=n[u];return r},Ss=function(e){for(var t,n,r,a,i,o,s=this.cy(),l=this.nodes(),u=function(ce){var te=ce.damping,se=ce.preference;.5<=te&&te<1||Me("Damping must range on [0.5, 1).  Got: ".concat(te));var de=["median","mean","min","max"];return de.some(function(ue){return ue===se})||oe(se)||Me("Preference must be one of [".concat(de.map(function(ue){return"'".concat(ue,"'")}).join(", "),"] or a number.  Got: ").concat(se)),kh(ce)}(e),c={},d=0;d<l.length;d++)c[l[d].id()]=d;n=(t=l.length)*t,r=new Array(n);for(var h=0;h<n;h++)r[h]=-1/0;for(var p=0;p<t;p++)for(var f=0;f<t;f++)p!==f&&(r[p*t+f]=Th(u.distance,l[p],l[f],u.attributes));a=Ch(r,u.preference);for(var g=0;g<t;g++)r[g*t+g]=a;i=new Array(n);for(var v=0;v<n;v++)i[v]=0;o=new Array(n);for(var y=0;y<n;y++)o[y]=0;for(var b=new Array(t),m=new Array(t),w=new Array(t),k=0;k<t;k++)b[k]=0,m[k]=0,w[k]=0;for(var E,x=new Array(t*u.minIterations),S=0;S<x.length;S++)x[S]=0;for(E=0;E<u.maxIterations;E++){for(var P=0;P<t;P++){for(var T=-1/0,D=-1/0,A=-1,B=0,M=0;M<t;M++)b[M]=i[P*t+M],(B=o[P*t+M]+r[P*t+M])>=T?(D=T,T=B,A=M):B>D&&(D=B);for(var I=0;I<t;I++)i[P*t+I]=(1-u.damping)*(r[P*t+I]-T)+u.damping*b[I];i[P*t+A]=(1-u.damping)*(r[P*t+A]-D)+u.damping*b[A]}for(var R=0;R<t;R++){for(var _=0,z=0;z<t;z++)b[z]=o[z*t+R],m[z]=Math.max(0,i[z*t+R]),_+=m[z];_-=m[R],m[R]=i[R*t+R],_+=m[R];for(var V=0;V<t;V++)o[V*t+R]=(1-u.damping)*Math.min(0,_-m[V])+u.damping*b[V];o[R*t+R]=(1-u.damping)*(_-m[R])+u.damping*b[R]}for(var L=0,X=0;X<t;X++){var W=o[X*t+X]+i[X*t+X]>0?1:0;x[E%u.minIterations*t+X]=W,L+=W}if(L>0&&(E>=u.minIterations-1||E==u.maxIterations-1)){for(var G=0,U=0;U<t;U++){w[U]=0;for(var Q=0;Q<u.minIterations;Q++)w[U]+=x[Q*t+U];w[U]!==0&&w[U]!==u.minIterations||G++}if(G===t)break}}for(var F=function(ce,te,se){for(var de=[],ue=0;ue<ce;ue++)te[ue*ce+ue]+se[ue*ce+ue]>0&&de.push(ue);return de}(t,i,o),O=function(ce,te,se){for(var de=Ps(ce,te,se),ue=0;ue<se.length;ue++){for(var C=[],N=0;N<de.length;N++)de[N]===se[ue]&&C.push(N);for(var j=-1,H=-1/0,K=0;K<C.length;K++){for(var q=0,Z=0;Z<C.length;Z++)q+=te[C[Z]*ce+C[K]];q>H&&(j=K,H=q)}se[ue]=C[j]}return Ps(ce,te,se)}(t,r,F),Y={},$=0;$<F.length;$++)Y[F[$]]=[];for(var J=0;J<l.length;J++){var ne=O[c[l[J].id()]];ne!=null&&Y[ne].push(l[J])}for(var le=new Array(F.length),fe=0;fe<F.length;fe++)le[fe]=s.collection(Y[F[fe]]);return le},Ph={affinityPropagation:Ss,ap:Ss},Sh=Ke({root:void 0,directed:!1}),Rr=function(){var e=this,t={},n=0,r=0,a=[],i=[],o={},s=function(u,c,d){u===d&&(r+=1),t[c]={id:n,low:n++,cutVertex:!1};var h,p,f,g,v=e.getElementById(c).connectedEdges().intersection(e);v.size()===0?a.push(e.spawn(e.getElementById(c))):v.forEach(function(y){h=y.source().id(),p=y.target().id(),(f=h===c?p:h)!==d&&(g=y.id(),o[g]||(o[g]=!0,i.push({x:c,y:f,edge:y})),f in t?t[c].low=Math.min(t[c].low,t[f].id):(s(u,f,c),t[c].low=Math.min(t[c].low,t[f].low),t[c].id<=t[f].low&&(t[c].cutVertex=!0,function(b,m){for(var w=i.length-1,k=[],E=e.spawn();i[w].x!=b||i[w].y!=m;)k.push(i.pop().edge),w--;k.push(i.pop().edge),k.forEach(function(x){var S=x.connectedNodes().intersection(e);E.merge(x),S.forEach(function(P){var T=P.id(),D=P.connectedEdges().intersection(e);E.merge(P),t[T].cutVertex?E.merge(D.filter(function(A){return A.isLoop()})):E.merge(D)})}),a.push(E)}(c,f))))})};e.forEach(function(u){if(u.isNode()){var c=u.id();c in t||(r=0,s(c,c),t[c].cutVertex=r>1)}});var l=Object.keys(t).filter(function(u){return t[u].cutVertex}).map(function(u){return e.getElementById(u)});return{cut:e.spawn(l),components:a}},Lr=function(){var e=this,t={},n=0,r=[],a=[],i=e.spawn(e),o=function(s){if(a.push(s),t[s]={index:n,low:n++,explored:!1},e.getElementById(s).connectedEdges().intersection(e).forEach(function(h){var p=h.target().id();p!==s&&(p in t||o(p),t[p].explored||(t[s].low=Math.min(t[s].low,t[p].low)))}),t[s].index===t[s].low){for(var l=e.spawn();;){var u=a.pop();if(l.merge(e.getElementById(u)),t[u].low=t[s].index,t[u].explored=!0,u===s)break}var c=l.edgesWith(l),d=l.merge(c);r.push(d),i=i.difference(d)}};return e.forEach(function(s){if(s.isNode()){var l=s.id();l in t||o(l)}}),{cut:i,components:r}},Bs={};[Un,Id,Nd,Ld,Od,Fd,Xd,eh,xn,wn,za,uh,bh,Eh,Ph,{hierholzer:function(e){if(!xe(e)){var t=arguments;e={root:t[0],directed:t[1]}}var n,r,a,i=Sh(e),o=i.root,s=i.directed,l=this,u=!1;o&&(a=pe(o)?this.filter(o)[0].id():o[0].id());var c={},d={};s?l.forEach(function(y){var b=y.id();if(y.isNode()){var m=y.indegree(!0),w=y.outdegree(!0),k=m-w,E=w-m;k==1?n?u=!0:n=b:E==1?r?u=!0:r=b:(E>1||k>1)&&(u=!0),c[b]=[],y.outgoers().forEach(function(x){x.isEdge()&&c[b].push(x.id())})}else d[b]=[void 0,y.target().id()]}):l.forEach(function(y){var b=y.id();y.isNode()?(y.degree(!0)%2&&(n?r?u=!0:r=b:n=b),c[b]=[],y.connectedEdges().forEach(function(m){return c[b].push(m.id())})):d[b]=[y.source().id(),y.target().id()]});var h={found:!1,trail:void 0};if(u)return h;if(r&&n)if(s){if(a&&r!=a)return h;a=r}else{if(a&&r!=a&&n!=a)return h;a||(a=r)}else a||(a=l[0].id());var p=function(y){for(var b,m,w,k=y,E=[y];c[k].length;)b=c[k].shift(),m=d[b][0],k!=(w=d[b][1])?(c[w]=c[w].filter(function(x){return x!=b}),k=w):s||k==m||(c[m]=c[m].filter(function(x){return x!=b}),k=m),E.unshift(b),E.unshift(k);return E},f=[],g=[];for(g=p(a);g.length!=1;)c[g[0]].length==0?(f.unshift(l.getElementById(g.shift())),f.unshift(l.getElementById(g.shift()))):g=p(g.shift()).concat(g);for(var v in f.unshift(l.getElementById(g.shift())),c)if(c[v].length)return h;return h.found=!0,h.trail=this.spawn(f,!0),h}},{hopcroftTarjanBiconnected:Rr,htbc:Rr,htb:Rr,hopcroftTarjanBiconnectedComponents:Rr},{tarjanStronglyConnected:Lr,tsc:Lr,tscc:Lr,tarjanStronglyConnectedComponents:Lr}].forEach(function(e){ge(Bs,e)});/*!
Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
Licensed under The MIT License (http://opensource.org/licenses/MIT)
*/var mt=function(e){if(!(this instanceof mt))return new mt(e);this.id="Thenable/1.0.7",this.state=0,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};mt.prototype={fulfill:function(e){return _s(this,1,"fulfillValue",e)},reject:function(e){return _s(this,2,"rejectReason",e)},then:function(e,t){var n=this,r=new mt;return n.onFulfilled.push(Ms(e,r,"fulfill")),n.onRejected.push(Ms(t,r,"reject")),Ds(n),r.proxy}};var _s=function(e,t,n,r){return e.state===0&&(e.state=t,e[n]=r,Ds(e)),e},Ds=function(e){e.state===1?As(e,"onFulfilled",e.fulfillValue):e.state===2&&As(e,"onRejected",e.rejectReason)},As=function(e,t,n){if(e[t].length!==0){var r=e[t];e[t]=[];var a=function(){for(var i=0;i<r.length;i++)r[i](n)};typeof setImmediate=="function"?setImmediate(a):setTimeout(a,0)}},Ms=function(e,t,n){return function(r){if(typeof e!="function")t[n].call(t,r);else{var a;try{a=e(r)}catch(i){return void t.reject(i)}Is(t,a)}}},Is=function(e,t){if(e!==t&&e.proxy!==t){var n;if(Ye(t)==="object"&&t!==null||typeof t=="function")try{n=t.then}catch(a){return void e.reject(a)}if(typeof n!="function")e.fulfill(t);else{var r=!1;try{n.call(t,function(a){r||(r=!0,a===t?e.reject(new TypeError("circular thenable chain")):Is(e,a))},function(a){r||(r=!0,e.reject(a))})}catch(a){r||e.reject(a)}}}else e.reject(new TypeError("cannot resolve promise with itself"))};mt.all=function(e){return new mt(function(t,n){for(var r=new Array(e.length),a=0,i=function(s,l){r[s]=l,++a===e.length&&t(r)},o=0;o<e.length;o++)(function(s){var l=e[s];l!=null&&l.then!=null?l.then(function(u){i(s,u)},function(u){n(u)}):i(s,l)})(o)})},mt.resolve=function(e){return new mt(function(t,n){t(e)})},mt.reject=function(e){return new mt(function(t,n){n(e)})};var Tn=typeof Promise<"u"?Promise:mt,ja=function(e,t,n){var r=xa(e),a=!r,i=this._private=ge({duration:1e3},t,n);if(i.target=e,i.style=i.style||i.css,i.started=!1,i.playing=!1,i.hooked=!1,i.applying=!1,i.progress=0,i.completes=[],i.frames=[],i.complete&&Ie(i.complete)&&i.completes.push(i.complete),a){var o=e.position();i.startPosition=i.startPosition||{x:o.x,y:o.y},i.startStyle=i.startStyle||e.cy().style().getAnimationStartStyle(e,i.style)}if(r){var s=e.pan();i.startPan={x:s.x,y:s.y},i.startZoom=e.zoom()}this.length=1,this[0]=this},an=ja.prototype;ge(an,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var t=e.target._private.animation;(e.queue?t.queue:t.current).push(this),lt(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var t=this._private;return e===void 0?t.progress*t.duration:this.progress(e/t.duration)},progress:function(e){var t=this._private,n=t.playing;return e===void 0?t.progress:(n&&this.pause(),t.progress=e,t.started=!1,n&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,t=e.playing;t&&this.pause(),e.progress=1-e.progress,e.started=!1;var n=function(s,l){var u=e[s];u!=null&&(e[s]=e[l],e[l]=u)};if(n("zoom","startZoom"),n("pan","startPan"),n("position","startPosition"),e.style)for(var r=0;r<e.style.length;r++){var a=e.style[r],i=a.name,o=e.startStyle[i];e.startStyle[i]=a,e.style[r]=o}return t&&this.play(),this},promise:function(e){var t,n=this._private;return e==="frame"?t=n.frames:t=n.completes,new Tn(function(r,a){t.push(function(){r()})})}}),an.complete=an.completed,an.run=an.play,an.running=an.playing;var Ns,Rs,Xa,Ls,zs,Os,Vs,Fs,Ys,js,Xs,qs,Ws,Hs,Gs,Ks,qa,Us,Zs,$s,Qs,Js,el,tl,Wa,nl,Ha,rl,Ga,al,il,ol,sl,ll,ul,cl,Ka,dl,Ua,hl,Za,fl,pl,gl,$a,vl,yl,ml,bl,xl,wl,El,kl,Tl,Qa,Cl,Pl,Sl,Bl,_l,Dl,Al,Ja,Ml,Il,Nl,Rl,Ll,ei,zl,Ol,Vl,ti,Fl,ni,Yl,jl,Xl,ri,ql,Wl,Hl,ai,Gl,ii,Kl,Bh={animated:function(){return function(){var e=this,t=e.length!==void 0?e:[e];if(!(this._private.cy||this).styleEnabled())return!1;var n=t[0];return n?n._private.animation.current.length>0:void 0}},clearQueue:function(){return function(){var e=this,t=e.length!==void 0?e:[e];if(!(this._private.cy||this).styleEnabled())return this;for(var n=0;n<t.length;n++)t[n]._private.animation.queue=[];return this}},delay:function(){return function(e,t){return(this._private.cy||this).styleEnabled()?this.animate({delay:e,duration:e,complete:t}):this}},delayAnimation:function(){return function(e,t){return(this._private.cy||this).styleEnabled()?this.animation({delay:e,duration:e,complete:t}):this}},animation:function(){return function(e,t){var n=this,r=n.length!==void 0,a=r?n:[n],i=this._private.cy||this,o=!r,s=!o;if(!i.styleEnabled())return this;var l=i.style();if(e=ge({},e,t),Object.keys(e).length===0)return new ja(a[0],e);switch(e.duration===void 0&&(e.duration=400),e.duration){case"slow":e.duration=600;break;case"fast":e.duration=200}if(s&&(e.style=l.getPropsList(e.style||e.css),e.css=void 0),s&&e.renderedPosition!=null){var u=e.renderedPosition,c=i.pan(),d=i.zoom();e.position=as(u,d,c)}if(o&&e.panBy!=null){var h=e.panBy,p=i.pan();e.pan={x:p.x+h.x,y:p.y+h.y}}var f=e.center||e.centre;if(o&&f!=null){var g=i.getCenterPan(f.eles,e.zoom);g!=null&&(e.pan=g)}if(o&&e.fit!=null){var v=e.fit,y=i.getFitViewport(v.eles||v.boundingBox,v.padding);y!=null&&(e.pan=y.pan,e.zoom=y.zoom)}if(o&&xe(e.zoom)){var b=i.getZoomedViewport(e.zoom);b!=null?(b.zoomed&&(e.zoom=b.zoom),b.panned&&(e.pan=b.pan)):e.zoom=null}return new ja(a[0],e)}},animate:function(){return function(e,t){var n=this,r=n.length!==void 0?n:[n];if(!(this._private.cy||this).styleEnabled())return this;t&&(e=ge({},e,t));for(var a=0;a<r.length;a++){var i=r[a],o=i.animated()&&(e.queue===void 0||e.queue);i.animation(e,o?{queue:!0}:void 0).play()}return this}},stop:function(){return function(e,t){var n=this,r=n.length!==void 0?n:[n],a=this._private.cy||this;if(!a.styleEnabled())return this;for(var i=0;i<r.length;i++){for(var o=r[i]._private,s=o.animation.current,l=0;l<s.length;l++){var u=s[l]._private;t&&(u.duration=0)}e&&(o.animation.queue=[]),t||(o.animation.current=[])}return a.notify("draw"),this}}};function zr(){if(Rs)return Ns;Rs=1;var e=Array.isArray;return Ns=e}function _h(){if(js)return Ys;js=1;var e,t=function(){if(Fs)return Vs;Fs=1;var r=wr()["__core-js_shared__"];return Vs=r}(),n=(e=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||""))?"Symbol(src)_1."+e:"";return Ys=function(r){return!!n&&n in r}}function Dh(){if(Hs)return Ws;Hs=1;var e=function(){if(Os)return zs;Os=1;var c=Xo(),d=qn();return zs=function(h){if(!d(h))return!1;var p=c(h);return p=="[object Function]"||p=="[object GeneratorFunction]"||p=="[object AsyncFunction]"||p=="[object Proxy]"}}(),t=_h(),n=qn(),r=function(){if(qs)return Xs;qs=1;var c=Function.prototype.toString;return Xs=function(d){if(d!=null){try{return c.call(d)}catch{}try{return d+""}catch{}}return""}}(),a=/^\[object .+?Constructor\]$/,i=Function.prototype,o=Object.prototype,s=i.toString,l=o.hasOwnProperty,u=RegExp("^"+s.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return Ws=function(c){return!(!n(c)||t(c))&&(e(c)?u:a).test(r(c))}}function oi(){if(Us)return qa;Us=1;var e=Dh(),t=(Ks||(Ks=1,Gs=function(n,r){return n==null?void 0:n[r]}),Gs);return qa=function(n,r){var a=t(n,r);return e(a)?a:void 0},qa}function Or(){if($s)return Zs;$s=1;var e=oi()(Object,"create");return Zs=e}function Ah(){if(ol)return il;ol=1;var e=function(){if(Js)return Qs;Js=1;var o=Or();return Qs=function(){this.__data__=o?o(null):{},this.size=0}}(),t=tl?el:(tl=1,el=function(o){var s=this.has(o)&&delete this.__data__[o];return this.size-=s?1:0,s}),n=function(){if(nl)return Wa;nl=1;var o=Or(),s=Object.prototype.hasOwnProperty;return Wa=function(l){var u=this.__data__;if(o){var c=u[l];return c==="__lodash_hash_undefined__"?void 0:c}return s.call(u,l)?u[l]:void 0},Wa}(),r=function(){if(rl)return Ha;rl=1;var o=Or(),s=Object.prototype.hasOwnProperty;return Ha=function(l){var u=this.__data__;return o?u[l]!==void 0:s.call(u,l)},Ha}(),a=function(){if(al)return Ga;al=1;var o=Or();return Ga=function(s,l){var u=this.__data__;return this.size+=this.has(s)?0:1,u[s]=o&&l===void 0?"__lodash_hash_undefined__":l,this},Ga}();function i(o){var s=-1,l=o==null?0:o.length;for(this.clear();++s<l;){var u=o[s];this.set(u[0],u[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=n,i.prototype.has=r,i.prototype.set=a,il=i}function Ul(){return cl?ul:(cl=1,ul=function(e,t){return e===t||e!=e&&t!=t})}function Vr(){if(dl)return Ka;dl=1;var e=Ul();return Ka=function(t,n){for(var r=t.length;r--;)if(e(t[r][0],n))return r;return-1},Ka}function Mh(){if(ml)return yl;ml=1;var e=ll?sl:(ll=1,sl=function(){this.__data__=[],this.size=0}),t=function(){if(hl)return Ua;hl=1;var o=Vr(),s=Array.prototype.splice;return Ua=function(l){var u=this.__data__,c=o(u,l);return!(c<0||(c==u.length-1?u.pop():s.call(u,c,1),--this.size,0))},Ua}(),n=function(){if(fl)return Za;fl=1;var o=Vr();return Za=function(s){var l=this.__data__,u=o(l,s);return u<0?void 0:l[u][1]},Za}(),r=function(){if(gl)return pl;gl=1;var o=Vr();return pl=function(s){return o(this.__data__,s)>-1}}(),a=function(){if(vl)return $a;vl=1;var o=Vr();return $a=function(s,l){var u=this.__data__,c=o(u,s);return c<0?(++this.size,u.push([s,l])):u[c][1]=l,this},$a}();function i(o){var s=-1,l=o==null?0:o.length;for(this.clear();++s<l;){var u=o[s];this.set(u[0],u[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=n,i.prototype.has=r,i.prototype.set=a,yl=i}function Ih(){if(El)return wl;El=1;var e=Ah(),t=Mh(),n=function(){if(xl)return bl;xl=1;var r=oi()(wr(),"Map");return bl=r}();return wl=function(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}}function Fr(){if(Cl)return Qa;Cl=1;var e=Tl?kl:(Tl=1,kl=function(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null});return Qa=function(t,n){var r=t.__data__;return e(n)?r[typeof n=="string"?"string":"hash"]:r.map},Qa}function Nh(){if(Nl)return Il;Nl=1;var e=Ih(),t=function(){if(Sl)return Pl;Sl=1;var o=Fr();return Pl=function(s){var l=o(this,s).delete(s);return this.size-=l?1:0,l}}(),n=function(){if(_l)return Bl;_l=1;var o=Fr();return Bl=function(s){return o(this,s).get(s)}}(),r=function(){if(Al)return Dl;Al=1;var o=Fr();return Dl=function(s){return o(this,s).has(s)}}(),a=function(){if(Ml)return Ja;Ml=1;var o=Fr();return Ja=function(s,l){var u=o(this,s),c=u.size;return u.set(s,l),this.size+=u.size==c?0:1,this},Ja}();function i(o){var s=-1,l=o==null?0:o.length;for(this.clear();++s<l;){var u=o[s];this.set(u[0],u[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=n,i.prototype.has=r,i.prototype.set=a,Il=i}function Rh(){if(zl)return ei;zl=1;var e=function(){if(Ll)return Rl;Ll=1;var t=Nh();function n(r,a){if(typeof r!="function"||a!=null&&typeof a!="function")throw new TypeError("Expected a function");var i=function(){var o=arguments,s=a?a.apply(this,o):o[0],l=i.cache;if(l.has(s))return l.get(s);var u=r.apply(this,o);return i.cache=l.set(s,u)||l,u};return i.cache=new(n.Cache||t),i}return n.Cache=t,Rl=n}();return ei=function(t){var n=e(t,function(a){return r.size===500&&r.clear(),a}),r=n.cache;return n},ei}function Zl(){if(Vl)return Ol;Vl=1;var e=Rh(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(a){var i=[];return a.charCodeAt(0)===46&&i.push(""),a.replace(t,function(o,s,l,u){i.push(l?u.replace(n,"$1"):s||o)}),i});return Ol=r}function $l(){return Fl||(Fl=1,ti=function(e,t){for(var n=-1,r=e==null?0:e.length,a=Array(r);++n<r;)a[n]=t(e[n],n,e);return a}),ti}function Ql(){if(Xl)return jl;Xl=1;var e=function(){if(Yl)return ni;Yl=1;var t=Ea(),n=$l(),r=zr(),a=Wn(),i=t?t.prototype:void 0,o=i?i.toString:void 0;return ni=function s(l){if(typeof l=="string")return l;if(r(l))return n(l,s)+"";if(a(l))return o?o.call(l):"";var u=l+"";return u=="0"&&1/l==-1/0?"-0":u},ni}();return jl=function(t){return t==null?"":e(t)}}function Jl(){if(ql)return ri;ql=1;var e=zr(),t=function(){if(Ls)return Xa;Ls=1;var a=zr(),i=Wn(),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;return Xa=function(l,u){if(a(l))return!1;var c=typeof l;return!(c!="number"&&c!="symbol"&&c!="boolean"&&l!=null&&!i(l))||s.test(l)||!o.test(l)||u!=null&&l in Object(u)},Xa}(),n=Zl(),r=Ql();return ri=function(a,i){return e(a)?a:t(a,i)?[a]:n(r(a))},ri}function si(){if(Hl)return Wl;Hl=1;var e=Wn();return Wl=function(t){if(typeof t=="string"||e(t))return t;var n=t+"";return n=="0"&&1/t==-1/0?"-0":n}}var eu,tu,li,nu,ui,ru,au,iu,ci,ou,di,su,Lh=function(){if(Kl)return ii;Kl=1;var e=function(){if(Gl)return ai;Gl=1;var t=Jl(),n=si();return ai=function(r,a){for(var i=0,o=(a=t(a,r)).length;r!=null&&i<o;)r=r[n(a[i++])];return i&&i==o?r:void 0},ai}();return ii=function(t,n,r){var a=t==null?void 0:e(t,n);return a===void 0?r:a},ii}(),zh=Xn(Lh);function Oh(){if(nu)return li;nu=1;var e=function(){if(tu)return eu;tu=1;var t=oi(),n=function(){try{var r=t(Object,"defineProperty");return r({},"",{}),r}catch{}}();return eu=n}();return li=function(t,n,r){n=="__proto__"&&e?e(t,n,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[n]=r},li}function Vh(){if(ou)return ci;ou=1;var e=function(){if(ru)return ui;ru=1;var i=Oh(),o=Ul(),s=Object.prototype.hasOwnProperty;return ui=function(l,u,c){var d=l[u];s.call(l,u)&&o(d,c)&&(c!==void 0||u in l)||i(l,u,c)},ui}(),t=Jl(),n=function(){if(iu)return au;iu=1;var i=/^(?:0|[1-9]\d*)$/;return au=function(o,s){var l=typeof o;return!!(s=s??9007199254740991)&&(l=="number"||l!="symbol"&&i.test(o))&&o>-1&&o%1==0&&o<s}}(),r=qn(),a=si();return ci=function(i,o,s,l){if(!r(i))return i;for(var u=-1,c=(o=t(o,i)).length,d=c-1,h=i;h!=null&&++u<c;){var p=a(o[u]),f=s;if(p==="__proto__"||p==="constructor"||p==="prototype")return i;if(u!=d){var g=h[p];(f=l?l(g,p,h):void 0)===void 0&&(f=r(g)?g:n(o[u+1])?[]:{})}e(h,p,f),h=h[p]}return i},ci}var lu,uu,cu,du,Fh=function(){if(su)return di;su=1;var e=Vh();return di=function(t,n,r){return t==null?t:e(t,n,r)},di}(),Yh=Xn(Fh),jh=function(){if(du)return cu;du=1;var e=$l(),t=(uu||(uu=1,lu=function(s,l){var u=-1,c=s.length;for(l||(l=Array(c));++u<c;)l[u]=s[u];return l}),lu),n=zr(),r=Wn(),a=Zl(),i=si(),o=Ql();return cu=function(s){return n(s)?e(s,i):r(s)?[s]:t(a(o(s)))}}(),Xh=Xn(jh),qh={data:function(e){return e=ge({},{field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(t){},beforeSet:function(t,n){},onSet:function(t){},canSet:function(t){return!0}},e),function(t,n){var r=e,a=this,i=a.length!==void 0,o=i?a:[a],s=i?a[0]:a;if(pe(t)){var l,u=t.indexOf(".")!==-1&&Xh(t);if(r.allowGetting&&n===void 0)return s&&(r.beforeGet(s),l=u&&s._private[r.field][t]===void 0?zh(s._private[r.field],u):s._private[r.field][t]),l;if(r.allowSetting&&n!==void 0&&!r.immutableKeys[t]){var c=ao({},t,n);r.beforeSet(a,c);for(var d=0,h=o.length;d<h;d++){var p=o[d];r.canSet(p)&&(u&&s._private[r.field][t]===void 0?Yh(p._private[r.field],u,n):p._private[r.field][t]=n)}r.updateStyle&&a.updateStyle(),r.onSet(a),r.settingTriggersEvent&&a[r.triggerFnName](r.settingEvent)}}else if(r.allowSetting&&xe(t)){var f,g,v=t,y=Object.keys(v);r.beforeSet(a,v);for(var b=0;b<y.length;b++)if(g=v[f=y[b]],!r.immutableKeys[f])for(var m=0;m<o.length;m++){var w=o[m];r.canSet(w)&&(w._private[r.field][f]=g)}r.updateStyle&&a.updateStyle(),r.onSet(a),r.settingTriggersEvent&&a[r.triggerFnName](r.settingEvent)}else if(r.allowBinding&&Ie(t)){var k=t;a.on(r.bindingEvent,k)}else if(r.allowGetting&&t===void 0){var E;return s&&(r.beforeGet(s),E=s._private[r.field]),E}return a}},removeData:function(e){return e=ge({},{field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}},e),function(t){var n=e,r=this,a=r.length!==void 0?r:[r];if(pe(t)){for(var i=t.split(/\s+/),o=i.length,s=0;s<o;s++){var l=i[s];if(!Lt(l)&&!n.immutableKeys[l])for(var u=0,c=a.length;u<c;u++)a[u]._private[n.field][l]=void 0}n.triggerEvent&&r[n.triggerFnName](n.event)}else if(t===void 0){for(var d=0,h=a.length;d<h;d++)for(var p=a[d]._private[n.field],f=Object.keys(p),g=0;g<f.length;g++){var v=f[g];!n.immutableKeys[v]&&(p[v]=void 0)}n.triggerEvent&&r[n.triggerFnName](n.event)}return r}}},Wh={eventAliasesOn:function(e){var t=e;t.addListener=t.listen=t.bind=t.on,t.unlisten=t.unbind=t.off=t.removeListener,t.trigger=t.emit,t.pon=t.promiseOn=function(n,r){var a=this,i=Array.prototype.slice.call(arguments,0);return new Tn(function(o,s){var l=i.concat([function(c){a.off.apply(a,u),o(c)}]),u=l.concat([]);a.on.apply(a,l)})}}},Te={};[Bh,qh,Wh].forEach(function(e){ge(Te,e)});var Hh={animate:Te.animate(),animation:Te.animation(),animated:Te.animated(),clearQueue:Te.clearQueue(),delay:Te.delay(),delayAnimation:Te.delayAnimation(),stop:Te.stop()},Yr={classes:function(e){var t=this;if(e===void 0){var n=[];return t[0]._private.classes.forEach(function(h){return n.push(h)}),n}Ce(e)||(e=(e||"").match(/\S+/g)||[]);for(var r=[],a=new yn(e),i=0;i<t.length;i++){for(var o=t[i],s=o._private,l=s.classes,u=!1,c=0;c<e.length;c++){var d=e[c];if(!l.has(d)){u=!0;break}}u||(u=l.size!==e.length),u&&(s.classes=a,r.push(o))}return r.length>0&&this.spawn(r).updateStyle().emit("class"),t},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var t=this[0];return t!=null&&t._private.classes.has(e)},toggleClass:function(e,t){Ce(e)||(e=e.match(/\S+/g)||[]);for(var n=this,r=t===void 0,a=[],i=0,o=n.length;i<o;i++)for(var s=n[i],l=s._private.classes,u=!1,c=0;c<e.length;c++){var d=e[c],h=l.has(d),p=!1;t||r&&!h?(l.add(d),p=!0):(!t||r&&h)&&(l.delete(d),p=!0),!u&&p&&(a.push(s),u=!0)}return a.length>0&&this.spawn(a).updateStyle().emit("class"),n},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,t){var n=this;if(t==null)t=250;else if(t===0)return n;return n.addClass(e),setTimeout(function(){n.removeClass(e)},t),n}};Yr.className=Yr.classNames=Yr.classes;var we={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:Xe,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};we.variable="(?:[\\w-.]|(?:\\\\"+we.metaChar+"))+",we.className="(?:[\\w-]|(?:\\\\"+we.metaChar+"))+",we.value=we.string+"|"+we.number,we.id=we.variable,function(){var e,t,n;for(e=we.comparatorOp.split("|"),n=0;n<e.length;n++)t=e[n],we.comparatorOp+="|@"+t;for(e=we.comparatorOp.split("|"),n=0;n<e.length;n++)(t=e[n]).indexOf("!")>=0||t!=="="&&(we.comparatorOp+="|\\!"+t)}();var hi=0,hu=1,fu=2,fi=3,pi=4,gi=5,vi=6,yi=7,jr=8,mi=9,bi=10,xi=11,pu=12,gu=13,wi=14,Ei=15,ki=16,Xr=17,qr=18,Wr=19,Cn=20,Ti=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(e,t){return function(n,r){return-1*Vo(n,r)}(e.selector,t.selector)}),Gh=function(){for(var e,t={},n=0;n<Ti.length;n++)t[(e=Ti[n]).selector]=e.matches;return t}(),Kh="("+Ti.map(function(e){return e.selector}).join("|")+")",Pn=function(e){return e.replace(new RegExp("\\\\("+we.metaChar+")","g"),function(t,n){return n})},Xt=function(e,t,n){e[e.length-1]=n},Ci=[{name:"group",query:!0,regex:"("+we.group+")",populate:function(e,t,n){var r=Le(n,1)[0];t.checks.push({type:hi,value:r==="*"?r:r+"s"})}},{name:"state",query:!0,regex:Kh,populate:function(e,t,n){var r=Le(n,1)[0];t.checks.push({type:yi,value:r})}},{name:"id",query:!0,regex:"\\#("+we.id+")",populate:function(e,t,n){var r=Le(n,1)[0];t.checks.push({type:jr,value:Pn(r)})}},{name:"className",query:!0,regex:"\\.("+we.className+")",populate:function(e,t,n){var r=Le(n,1)[0];t.checks.push({type:mi,value:Pn(r)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+we.variable+")\\s*\\]",populate:function(e,t,n){var r=Le(n,1)[0];t.checks.push({type:pi,field:Pn(r)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+we.variable+")\\s*("+we.comparatorOp+")\\s*("+we.value+")\\s*\\]",populate:function(e,t,n){var r=Le(n,3),a=r[0],i=r[1],o=r[2];o=new RegExp("^"+we.string+"$").exec(o)!=null?o.substring(1,o.length-1):parseFloat(o),t.checks.push({type:fi,field:Pn(a),operator:i,value:o})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+we.boolOp+")\\s*("+we.variable+")\\s*\\]",populate:function(e,t,n){var r=Le(n,2),a=r[0],i=r[1];t.checks.push({type:gi,field:Pn(i),operator:a})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+we.meta+")\\s*("+we.comparatorOp+")\\s*("+we.number+")\\s*\\]\\]",populate:function(e,t,n){var r=Le(n,3),a=r[0],i=r[1],o=r[2];t.checks.push({type:vi,field:Pn(a),operator:i,value:parseFloat(o)})}},{name:"nextQuery",separator:!0,regex:we.separator,populate:function(e,t){var n=e.currentSubject,r=e.edgeCount,a=e.compoundCount,i=e[e.length-1];return n!=null&&(i.subject=n,e.currentSubject=null),i.edgeCount=r,i.compoundCount=a,e.edgeCount=0,e.compoundCount=0,e[e.length++]={checks:[]}}},{name:"directedEdge",separator:!0,regex:we.directedEdge,populate:function(e,t){if(e.currentSubject==null){var n={checks:[]},r=t,a={checks:[]};return n.checks.push({type:xi,source:r,target:a}),Xt(e,0,n),e.edgeCount++,a}var i={checks:[]},o=t,s={checks:[]};return i.checks.push({type:pu,source:o,target:s}),Xt(e,0,i),e.edgeCount++,s}},{name:"undirectedEdge",separator:!0,regex:we.undirectedEdge,populate:function(e,t){if(e.currentSubject==null){var n={checks:[]},r=t,a={checks:[]};return n.checks.push({type:bi,nodes:[r,a]}),Xt(e,0,n),e.edgeCount++,a}var i={checks:[]},o=t,s={checks:[]};return i.checks.push({type:wi,node:o,neighbor:s}),Xt(e,0,i),s}},{name:"child",separator:!0,regex:we.child,populate:function(e,t){if(e.currentSubject==null){var n={checks:[]},r={checks:[]},a=e[e.length-1];return n.checks.push({type:Ei,parent:a,child:r}),Xt(e,0,n),e.compoundCount++,r}if(e.currentSubject===t){var i={checks:[]},o=e[e.length-1],s={checks:[]},l={checks:[]},u={checks:[]},c={checks:[]};return i.checks.push({type:Wr,left:o,right:s,subject:l}),l.checks=t.checks,t.checks=[{type:Cn}],c.checks.push({type:Cn}),s.checks.push({type:Xr,parent:c,child:u}),Xt(e,0,i),e.currentSubject=l,e.compoundCount++,u}var d={checks:[]},h={checks:[]},p=[{type:Xr,parent:d,child:h}];return d.checks=t.checks,t.checks=p,e.compoundCount++,h}},{name:"descendant",separator:!0,regex:we.descendant,populate:function(e,t){if(e.currentSubject==null){var n={checks:[]},r={checks:[]},a=e[e.length-1];return n.checks.push({type:ki,ancestor:a,descendant:r}),Xt(e,0,n),e.compoundCount++,r}if(e.currentSubject===t){var i={checks:[]},o=e[e.length-1],s={checks:[]},l={checks:[]},u={checks:[]},c={checks:[]};return i.checks.push({type:Wr,left:o,right:s,subject:l}),l.checks=t.checks,t.checks=[{type:Cn}],c.checks.push({type:Cn}),s.checks.push({type:qr,ancestor:c,descendant:u}),Xt(e,0,i),e.currentSubject=l,e.compoundCount++,u}var d={checks:[]},h={checks:[]},p=[{type:qr,ancestor:d,descendant:h}];return d.checks=t.checks,t.checks=p,e.compoundCount++,h}},{name:"subject",modifier:!0,regex:we.subject,populate:function(e,t){if(e.currentSubject!=null&&e.currentSubject!==t)return ke("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=t;var n=e[e.length-1].checks[0],r=n==null?null:n.type;r===xi?n.type=gu:r===bi&&(n.type=wi,n.node=n.nodes[1],n.neighbor=n.nodes[0],n.nodes=null)}}];Ci.forEach(function(e){return e.regexObj=new RegExp("^"+e.regex)});var Uh=function(e){for(var t,n,r,a=0;a<Ci.length;a++){var i=Ci[a],o=i.name,s=e.match(i.regexObj);if(s!=null){n=s,t=i,r=o;var l=s[0];e=e.substring(l.length);break}}return{expr:t,match:n,name:r,remaining:e}},Zh={parse:function(e){var t=this,n=t.inputText=e,r=t[0]={checks:[]};for(t.length=1,n=function(c){var d=c.match(/^\s+/);if(d){var h=d[0];c=c.substring(h.length)}return c}(n);;){var a=Uh(n);if(a.expr==null)return ke("The selector `"+e+"`is invalid"),!1;var i=a.match.slice(1),o=a.expr.populate(t,r,i);if(o===!1)return!1;if(o!=null&&(r=o),(n=a.remaining).match(/^\s*$/))break}var s=t[t.length-1];t.currentSubject!=null&&(s.subject=t.currentSubject),s.edgeCount=t.edgeCount,s.compoundCount=t.compoundCount;for(var l=0;l<t.length;l++){var u=t[l];if(u.compoundCount>0&&u.edgeCount>0)return ke("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(u.edgeCount>1)return ke("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;u.edgeCount===1&&ke("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},toString:function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(l){return l??""},t=function(l){return pe(l)?'"'+l+'"':e(l)},n=function(l){return" "+l+" "},r=function(l,u){var c=l.type,d=l.value;switch(c){case hi:var h=e(d);return h.substring(0,h.length-1);case fi:var p=l.field,f=l.operator;return"["+p+n(e(f))+t(d)+"]";case gi:var g=l.operator,v=l.field;return"["+e(g)+v+"]";case pi:return"["+l.field+"]";case vi:var y=l.operator;return"[["+l.field+n(e(y))+t(d)+"]]";case yi:return d;case jr:return"#"+d;case mi:return"."+d;case Xr:case Ei:return a(l.parent,u)+n(">")+a(l.child,u);case qr:case ki:return a(l.ancestor,u)+" "+a(l.descendant,u);case Wr:var b=a(l.left,u),m=a(l.subject,u),w=a(l.right,u);return b+(b.length>0?" ":"")+m+w;case Cn:return""}},a=function(l,u){return l.checks.reduce(function(c,d,h){return c+(u===l&&h===0?"$":"")+r(d,u)},"")},i="",o=0;o<this.length;o++){var s=this[o];i+=a(s,s.subject),this.length>1&&o<this.length-1&&(i+=", ")}return this.toStringCache=i,i}},vu=function(e,t,n){var r,a,i,o=pe(e),s=oe(e),l=pe(n),u=!1,c=!1,d=!1;switch(t.indexOf("!")>=0&&(t=t.replace("!",""),c=!0),t.indexOf("@")>=0&&(t=t.replace("@",""),u=!0),(o||l||u)&&(a=o||s?""+e:"",i=""+n),u&&(e=a=a.toLowerCase(),n=i=i.toLowerCase()),t){case"*=":r=a.indexOf(i)>=0;break;case"$=":r=a.indexOf(i,a.length-i.length)>=0;break;case"^=":r=a.indexOf(i)===0;break;case"=":r=e===n;break;case">":d=!0,r=e>n;break;case">=":d=!0,r=e>=n;break;case"<":d=!0,r=e<n;break;case"<=":d=!0,r=e<=n;break;default:r=!1}return!c||e==null&&d||(r=!r),r},Pi=function(e,t){return e.data(t)},Ne=[],De=function(e,t){return e.checks.every(function(n){return Ne[n.type](n,t)})};Ne[hi]=function(e,t){var n=e.value;return n==="*"||n===t.group()},Ne[yi]=function(e,t){return function(n,r){return Gh[n](r)}(e.value,t)},Ne[jr]=function(e,t){var n=e.value;return t.id()===n},Ne[mi]=function(e,t){var n=e.value;return t.hasClass(n)},Ne[vi]=function(e,t){var n=e.field,r=e.operator,a=e.value;return vu(function(i,o){return i[o]()}(t,n),r,a)},Ne[fi]=function(e,t){var n=e.field,r=e.operator,a=e.value;return vu(Pi(t,n),r,a)},Ne[gi]=function(e,t){var n=e.field,r=e.operator;return function(a,i){switch(i){case"?":return!!a;case"!":return!a;case"^":return a===void 0}}(Pi(t,n),r)},Ne[pi]=function(e,t){var n=e.field;return e.operator,Pi(t,n)!==void 0},Ne[bi]=function(e,t){var n=e.nodes[0],r=e.nodes[1],a=t.source(),i=t.target();return De(n,a)&&De(r,i)||De(r,a)&&De(n,i)},Ne[wi]=function(e,t){return De(e.node,t)&&t.neighborhood().some(function(n){return n.isNode()&&De(e.neighbor,n)})},Ne[xi]=function(e,t){return De(e.source,t.source())&&De(e.target,t.target())},Ne[pu]=function(e,t){return De(e.source,t)&&t.outgoers().some(function(n){return n.isNode()&&De(e.target,n)})},Ne[gu]=function(e,t){return De(e.target,t)&&t.incomers().some(function(n){return n.isNode()&&De(e.source,n)})},Ne[Ei]=function(e,t){return De(e.child,t)&&De(e.parent,t.parent())},Ne[Xr]=function(e,t){return De(e.parent,t)&&t.children().some(function(n){return De(e.child,n)})},Ne[ki]=function(e,t){return De(e.descendant,t)&&t.ancestors().some(function(n){return De(e.ancestor,n)})},Ne[qr]=function(e,t){return De(e.ancestor,t)&&t.descendants().some(function(n){return De(e.descendant,n)})},Ne[Wr]=function(e,t){return De(e.subject,t)&&De(e.left,t)&&De(e.right,t)},Ne[Cn]=function(){return!0},Ne[hu]=function(e,t){return e.value.has(t)},Ne[fu]=function(e,t){return(0,e.value)(t)};var $h={matches:function(e){for(var t=0;t<this.length;t++){var n=this[t];if(De(n,e))return!0}return!1},filter:function(e){var t=this;if(t.length===1&&t[0].checks.length===1&&t[0].checks[0].type===jr)return e.getElementById(t[0].checks[0].value).collection();var n=function(r){for(var a=0;a<t.length;a++){var i=t[a];if(De(i,r))return!0}return!1};return t.text()==null&&(n=function(){return!0}),e.filter(n)}},qt=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||pe(e)&&e.match(/^\s*$/)||(lt(e)?this.addQuery({checks:[{type:hu,value:e.collection()}]}):Ie(e)?this.addQuery({checks:[{type:fu,value:e}]}):pe(e)?this.parse(e)||(this.invalid=!0):Me("A selector must be created from a string; found "))},Wt=qt.prototype;[Zh,$h].forEach(function(e){return ge(Wt,e)}),Wt.text=function(){return this.inputText},Wt.size=function(){return this.length},Wt.eq=function(e){return this[e]},Wt.sameText=function(e){return!this.invalid&&!e.invalid&&this.text()===e.text()},Wt.addQuery=function(e){this[this.length++]=e},Wt.selector=Wt.toString;var Ht={allAre:function(e){var t=new qt(e);return this.every(function(n){return t.matches(n)})},is:function(e){var t=new qt(e);return this.some(function(n){return t.matches(n)})},some:function(e,t){for(var n=0;n<this.length;n++)if(t?e.apply(t,[this[n],n,this]):e(this[n],n,this))return!0;return!1},every:function(e,t){for(var n=0;n<this.length;n++)if(!(t?e.apply(t,[this[n],n,this]):e(this[n],n,this)))return!1;return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var t=this.length;return t===e.length&&(t===1?this[0]===e[0]:this.every(function(n){return e.hasElementWithId(n.id())}))},anySame:function(e){return e=this.cy().collection(e),this.some(function(t){return e.hasElementWithId(t.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var t=this.neighborhood();return e.every(function(n){return t.hasElementWithId(n.id())})},contains:function(e){e=this.cy().collection(e);var t=this;return e.every(function(n){return t.hasElementWithId(n.id())})}};Ht.allAreNeighbours=Ht.allAreNeighbors,Ht.has=Ht.contains,Ht.equal=Ht.equals=Ht.same;var Hr,yu,ht=function(e,t){return function(n,r,a,i){var o,s=n,l=this;if(s==null?o="":lt(s)&&s.length===1&&(o=s.id()),l.length===1&&o){var u=l[0]._private,c=u.traversalCache=u.traversalCache||{},d=c[t]=c[t]||[],h=en(o),p=d[h];return p||(d[h]=e.call(l,n,r,a,i))}return e.call(l,n,r,a,i)}},Sn={parent:function(e){var t=[];if(this.length===1){var n=this[0]._private.parent;if(n)return n}for(var r=0;r<this.length;r++){var a=this[r]._private.parent;a&&t.push(a)}return this.spawn(t,!0).filter(e)},parents:function(e){for(var t=[],n=this.parent();n.nonempty();){for(var r=0;r<n.length;r++){var a=n[r];t.push(a)}n=n.parent()}return this.spawn(t,!0).filter(e)},commonAncestors:function(e){for(var t,n=0;n<this.length;n++){var r=this[n].parents();t=(t=t||r).intersect(r)}return t.filter(e)},orphans:function(e){return this.stdFilter(function(t){return t.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(t){return t.isChild()}).filter(e)},children:ht(function(e){for(var t=[],n=0;n<this.length;n++)for(var r=this[n]._private.children,a=0;a<r.length;a++)t.push(r[a]);return this.spawn(t,!0).filter(e)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var t=[];return function n(r){for(var a=0;a<r.length;a++){var i=r[a];t.push(i),i.children().nonempty()&&n(i.children())}}(this.children()),this.spawn(t,!0).filter(e)}};function Si(e,t,n,r){for(var a=[],i=new yn,o=e.cy().hasCompoundNodes(),s=0;s<e.length;s++){var l=e[s];n?a.push(l):o&&r(a,i,l)}for(;a.length>0;){var u=a.shift();t(u),i.add(u.id()),o&&r(a,i,u)}return e}function mu(e,t,n){if(n.isParent())for(var r=n._private.children,a=0;a<r.length;a++){var i=r[a];t.has(i.id())||e.push(i)}}function bu(e,t,n){if(n.isChild()){var r=n._private.parent;t.has(r.id())||e.push(r)}}function Qh(e,t,n){bu(e,t,n),mu(e,t,n)}Sn.forEachDown=function(e){return Si(this,e,!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],mu)},Sn.forEachUp=function(e){return Si(this,e,!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],bu)},Sn.forEachUpAndDown=function(e){return Si(this,e,!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],Qh)},Sn.ancestors=Sn.parents,(Hr=yu={data:Te.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:Te.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:Te.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Te.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:Te.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:Te.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}}).attr=Hr.data,Hr.removeAttr=Hr.removeData;var bt,xu,Jh=yu,Gr={};function Bi(e){return function(t){var n=this;if(t===void 0&&(t=!0),n.length!==0&&n.isNode()&&!n.removed()){for(var r=0,a=n[0],i=a._private.edges,o=0;o<i.length;o++){var s=i[o];!t&&s.isLoop()||(r+=e(a,s))}return r}}}function Bn(e,t){return function(n){for(var r,a=this.nodes(),i=0;i<a.length;i++){var o=a[i][e](n);o===void 0||r!==void 0&&!t(o,r)||(r=o)}return r}}ge(Gr,{degree:Bi(function(e,t){return t.source().same(t.target())?2:1}),indegree:Bi(function(e,t){return t.target().same(e)?1:0}),outdegree:Bi(function(e,t){return t.source().same(e)?1:0})}),ge(Gr,{minDegree:Bn("degree",function(e,t){return e<t}),maxDegree:Bn("degree",function(e,t){return e>t}),minIndegree:Bn("indegree",function(e,t){return e<t}),maxIndegree:Bn("indegree",function(e,t){return e>t}),minOutdegree:Bn("outdegree",function(e,t){return e<t}),maxOutdegree:Bn("outdegree",function(e,t){return e>t})}),ge(Gr,{totalDegree:function(e){for(var t=0,n=this.nodes(),r=0;r<n.length;r++)t+=n[r].degree(e);return t}});var wu=function(e,t,n){for(var r=0;r<e.length;r++){var a=e[r];if(!a.locked()){var i=a._private.position,o={x:t.x!=null?t.x-i.x:0,y:t.y!=null?t.y-i.y:0};!a.isParent()||o.x===0&&o.y===0||a.children().shift(o,n),a.dirtyBoundingBoxCache()}}},Eu={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,t){wu(e,t,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};bt=xu={position:Te.data(Eu),silentPosition:Te.data(ge({},Eu,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,t){wu(e,t,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,t){if(xe(e))t?this.silentPosition(e):this.position(e);else if(Ie(e)){var n=e,r=this.cy();r.startBatch();for(var a=0;a<this.length;a++){var i,o=this[a];(i=n(o,a))&&(t?o.silentPosition(i):o.position(i))}r.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,t,n){var r;if(xe(e)?(r={x:oe(e.x)?e.x:0,y:oe(e.y)?e.y:0},n=t):pe(e)&&oe(t)&&((r={x:0,y:0})[e]=t),r!=null){var a=this.cy();a.startBatch();for(var i=0;i<this.length;i++){var o=this[i];if(!(a.hasCompoundNodes()&&o.isChild()&&o.ancestors().anySame(this))){var s=o.position(),l={x:s.x+r.x,y:s.y+r.y};n?o.silentPosition(l):o.position(l)}}a.endBatch()}return this},silentShift:function(e,t){return xe(e)?this.shift(e,!0):pe(e)&&oe(t)&&this.shift(e,t,!0),this},renderedPosition:function(e,t){var n=this[0],r=this.cy(),a=r.zoom(),i=r.pan(),o=xe(e)?e:void 0,s=o!==void 0||t!==void 0&&pe(e);if(n&&n.isNode()){if(!s){var l=n.position();return o=Pr(l,a,i),e===void 0?o:o[e]}for(var u=0;u<this.length;u++){var c=this[u];t!==void 0?c.position(e,(t-i[e])/a):o!==void 0&&c.position(as(o,a,i))}}else if(!s)return;return this},relativePosition:function(e,t){var n=this[0],r=this.cy(),a=xe(e)?e:void 0,i=a!==void 0||t!==void 0&&pe(e),o=r.hasCompoundNodes();if(n&&n.isNode()){if(!i){var s=n.position(),l=o?n.parent():null,u=l&&l.length>0,c=u;u&&(l=l[0]);var d=c?l.position():{x:0,y:0};return a={x:s.x-d.x,y:s.y-d.y},e===void 0?a:a[e]}for(var h=0;h<this.length;h++){var p=this[h],f=o?p.parent():null,g=f&&f.length>0,v=g;g&&(f=f[0]);var y=v?f.position():{x:0,y:0};t!==void 0?p.position(e,t+y[e]):a!==void 0&&p.position({x:a.x+y.x,y:a.y+y.y})}}else if(!i)return;return this}},bt.modelPosition=bt.point=bt.position,bt.modelPositions=bt.points=bt.positions,bt.renderedPoint=bt.renderedPosition,bt.relativePoint=bt.relativePosition;var _n,Gt,ef=xu;_n=Gt={},Gt.renderedBoundingBox=function(e){var t=this.boundingBox(e),n=this.cy(),r=n.zoom(),a=n.pan(),i=t.x1*r+a.x,o=t.x2*r+a.x,s=t.y1*r+a.y,l=t.y2*r+a.y;return{x1:i,x2:o,y1:s,y2:l,w:o-i,h:l-s}},Gt.dirtyCompoundBoundsCache=function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.cy();return t.styleEnabled()&&t.hasCompoundNodes()?(this.forEachUp(function(n){if(n.isParent()){var r=n._private;r.compoundBoundsClean=!1,r.bbCache=null,e||n.emitAndNotify("bounds")}}),this):this},Gt.updateCompoundBounds=function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.cy();if(!t.styleEnabled()||!t.hasCompoundNodes())return this;if(!e&&t.batching())return this;function n(o){if(o.isParent()){var s=o._private,l=o.children(),u=o.pstyle("compound-sizing-wrt-labels").value==="include",c={width:{val:o.pstyle("min-width").pfValue,left:o.pstyle("min-width-bias-left"),right:o.pstyle("min-width-bias-right")},height:{val:o.pstyle("min-height").pfValue,top:o.pstyle("min-height-bias-top"),bottom:o.pstyle("min-height-bias-bottom")}},d=l.boundingBox({includeLabels:u,includeOverlays:!1,useCache:!1}),h=s.position;d.w!==0&&d.h!==0||((d={w:o.pstyle("width").pfValue,h:o.pstyle("height").pfValue}).x1=h.x-d.w/2,d.x2=h.x+d.w/2,d.y1=h.y-d.h/2,d.y2=h.y+d.h/2);var p=c.width.left.value;c.width.left.units==="px"&&c.width.val>0&&(p=100*p/c.width.val);var f=c.width.right.value;c.width.right.units==="px"&&c.width.val>0&&(f=100*f/c.width.val);var g=c.height.top.value;c.height.top.units==="px"&&c.height.val>0&&(g=100*g/c.height.val);var v=c.height.bottom.value;c.height.bottom.units==="px"&&c.height.val>0&&(v=100*v/c.height.val);var y=x(c.width.val-d.w,p,f),b=y.biasDiff,m=y.biasComplementDiff,w=x(c.height.val-d.h,g,v),k=w.biasDiff,E=w.biasComplementDiff;s.autoPadding=function(S,P,T,D){if(T.units!=="%")return T.units==="px"?T.pfValue:0;switch(D){case"width":return S>0?T.pfValue*S:0;case"height":return P>0?T.pfValue*P:0;case"average":return S>0&&P>0?T.pfValue*(S+P)/2:0;case"min":return S>0&&P>0?S>P?T.pfValue*P:T.pfValue*S:0;case"max":return S>0&&P>0?S>P?T.pfValue*S:T.pfValue*P:0;default:return 0}}(d.w,d.h,o.pstyle("padding"),o.pstyle("padding-relative-to").value),s.autoWidth=Math.max(d.w,c.width.val),h.x=(-b+d.x1+d.x2+m)/2,s.autoHeight=Math.max(d.h,c.height.val),h.y=(-k+d.y1+d.y2+E)/2}function x(S,P,T){var D=0,A=0,B=P+T;return S>0&&B>0&&(D=P/B*S,A=T/B*S),{biasDiff:D,biasComplementDiff:A}}}for(var r=0;r<this.length;r++){var a=this[r],i=a._private;i.compoundBoundsClean&&!e||(n(a),t.batching()||(i.compoundBoundsClean=!0))}return this};var ft=function(e){return e===1/0||e===-1/0?0:e},xt=function(e,t,n,r,a){r-t!==0&&a-n!==0&&t!=null&&n!=null&&r!=null&&a!=null&&(e.x1=t<e.x1?t:e.x1,e.x2=r>e.x2?r:e.x2,e.y1=n<e.y1?n:e.y1,e.y2=a>e.y2?a:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},Kt=function(e,t){return t==null?e:xt(e,t.x1,t.y1,t.x2,t.y2)},tr=function(e,t,n){return ot(e,t,n)},Kr=function(e,t,n){if(!t.cy().headless()){var r,a,i=t._private,o=i.rstyle,s=o.arrowWidth/2;if(t.pstyle(n+"-arrow-shape").value!=="none"){n==="source"?(r=o.srcX,a=o.srcY):n==="target"?(r=o.tgtX,a=o.tgtY):(r=o.midX,a=o.midY);var l=i.arrowBounds=i.arrowBounds||{},u=l[n]=l[n]||{};u.x1=r-s,u.y1=a-s,u.x2=r+s,u.y2=a+s,u.w=u.x2-u.x1,u.h=u.y2-u.y1,Br(u,1),xt(e,u.x1,u.y1,u.x2,u.y2)}}},_i=function(e,t,n){if(!t.cy().headless()){var r;r=n?n+"-":"";var a=t._private,i=a.rstyle;if(t.pstyle(r+"label").strValue){var o,s,l,u,c=t.pstyle("text-halign"),d=t.pstyle("text-valign"),h=tr(i,"labelWidth",n),p=tr(i,"labelHeight",n),f=tr(i,"labelX",n),g=tr(i,"labelY",n),v=t.pstyle(r+"text-margin-x").pfValue,y=t.pstyle(r+"text-margin-y").pfValue,b=t.isEdge(),m=t.pstyle(r+"text-rotation"),w=t.pstyle("text-outline-width").pfValue,k=t.pstyle("text-border-width").pfValue/2,E=t.pstyle("text-background-padding").pfValue,x=p,S=h,P=S/2,T=x/2;if(b)o=f-P,s=f+P,l=g-T,u=g+T;else{switch(c.value){case"left":o=f-S,s=f;break;case"center":o=f-P,s=f+P;break;case"right":o=f,s=f+S}switch(d.value){case"top":l=g-x,u=g;break;case"center":l=g-T,u=g+T;break;case"bottom":l=g,u=g+x}}var D=v-Math.max(w,k)-E-2,A=v+Math.max(w,k)+E+2,B=y-Math.max(w,k)-E-2,M=y+Math.max(w,k)+E+2;o+=D,s+=A,l+=B,u+=M;var I=n||"main",R=a.labelBounds,_=R[I]=R[I]||{};_.x1=o,_.y1=l,_.x2=s,_.y2=u,_.w=s-o,_.h=u-l,_.leftPad=D,_.rightPad=A,_.topPad=B,_.botPad=M;var z=b&&m.strValue==="autorotate",V=m.pfValue!=null&&m.pfValue!==0;if(z||V){var L=z?tr(a.rstyle,"labelAngle",n):m.pfValue,X=Math.cos(L),W=Math.sin(L),G=(o+s)/2,U=(l+u)/2;if(!b){switch(c.value){case"left":G=s;break;case"right":G=o}switch(d.value){case"top":U=u;break;case"bottom":U=l}}var Q=function(le,fe){return{x:(le-=G)*X-(fe-=U)*W+G,y:le*W+fe*X+U}},F=Q(o,l),O=Q(o,u),Y=Q(s,l),$=Q(s,u);o=Math.min(F.x,O.x,Y.x,$.x),s=Math.max(F.x,O.x,Y.x,$.x),l=Math.min(F.y,O.y,Y.y,$.y),u=Math.max(F.y,O.y,Y.y,$.y)}var J=I+"Rot",ne=R[J]=R[J]||{};ne.x1=o,ne.y1=l,ne.x2=s,ne.y2=u,ne.w=s-o,ne.h=u-l,xt(e,o,l,s,u),xt(a.labelBounds.all,o,l,s,u)}return e}},ku=function(e,t){if(!t.cy().headless()){var n=t.pstyle("outline-opacity").value,r=t.pstyle("outline-width").value+t.pstyle("outline-offset").value;Tu(e,t,n,r,"outside",r/2)}},Tu=function(e,t,n,r,a,i){if(!(n===0||r<=0||a==="inside")){var o=t.cy(),s=t.pstyle("shape").value,l=o.renderer().nodeShapes[s],u=t.position(),c=u.x,d=u.y,h=t.width(),p=t.height();if(l.hasMiterBounds){a==="center"&&(r/=2);var f=l.miterBounds(c,d,h,p,r);Kt(e,f)}else i!=null&&i>0&&_r(e,[i,i,i,i])}},tf=function(e,t){var n,r,a,i,o,s,l,u=e._private.cy,c=u.styleEnabled(),d=u.headless(),h=nt(),p=e._private,f=e.isNode(),g=e.isEdge(),v=p.rstyle,y=f&&c?e.pstyle("bounds-expansion").pfValue:[0],b=function(O){return O.pstyle("display").value!=="none"},m=!c||b(e)&&(!g||b(e.source())&&b(e.target()));if(m){var w=0;c&&t.includeOverlays&&e.pstyle("overlay-opacity").value!==0&&(w=e.pstyle("overlay-padding").value);var k=0;c&&t.includeUnderlays&&e.pstyle("underlay-opacity").value!==0&&(k=e.pstyle("underlay-padding").value);var E=Math.max(w,k),x=0;if(c&&(x=e.pstyle("width").pfValue/2),f&&t.includeNodes){var S=e.position();o=S.x,s=S.y;var P=e.outerWidth()/2,T=e.outerHeight()/2;xt(h,n=o-P,a=s-T,r=o+P,i=s+T),c&&ku(h,e),c&&t.includeOutlines&&!d&&ku(h,e),c&&function(O,Y){if(!Y.cy().headless()){var $=Y.pstyle("border-opacity").value,J=Y.pstyle("border-width").pfValue,ne=Y.pstyle("border-position").value;Tu(O,Y,$,J,ne)}}(h,e)}else if(g&&t.includeEdges)if(c&&!d){var D=e.pstyle("curve-style").strValue;if(n=Math.min(v.srcX,v.midX,v.tgtX),r=Math.max(v.srcX,v.midX,v.tgtX),a=Math.min(v.srcY,v.midY,v.tgtY),i=Math.max(v.srcY,v.midY,v.tgtY),xt(h,n-=x,a-=x,r+=x,i+=x),D==="haystack"){var A=v.haystackPts;if(A&&A.length===2){if(n=A[0].x,a=A[0].y,n>(r=A[1].x)){var B=n;n=r,r=B}if(a>(i=A[1].y)){var M=a;a=i,i=M}xt(h,n-x,a-x,r+x,i+x)}}else if(D==="bezier"||D==="unbundled-bezier"||zt(D,"segments")||zt(D,"taxi")){var I;switch(D){case"bezier":case"unbundled-bezier":I=v.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":I=v.linePts}if(I!=null)for(var R=0;R<I.length;R++){var _=I[R];n=_.x-x,r=_.x+x,a=_.y-x,i=_.y+x,xt(h,n,a,r,i)}}}else{var z=e.source().position(),V=e.target().position();if((n=z.x)>(r=V.x)){var L=n;n=r,r=L}if((a=z.y)>(i=V.y)){var X=a;a=i,i=X}xt(h,n-=x,a-=x,r+=x,i+=x)}if(c&&t.includeEdges&&g&&(Kr(h,e,"mid-source"),Kr(h,e,"mid-target"),Kr(h,e,"source"),Kr(h,e,"target")),c&&e.pstyle("ghost").value==="yes"){var W=e.pstyle("ghost-offset-x").pfValue,G=e.pstyle("ghost-offset-y").pfValue;xt(h,h.x1+W,h.y1+G,h.x2+W,h.y2+G)}var U=p.bodyBounds=p.bodyBounds||{};os(U,h),_r(U,y),Br(U,1),c&&(n=h.x1,r=h.x2,a=h.y1,i=h.y2,xt(h,n-E,a-E,r+E,i+E));var Q=p.overlayBounds=p.overlayBounds||{};os(Q,h),_r(Q,y),Br(Q,1);var F=p.labelBounds=p.labelBounds||{};F.all!=null?((l=F.all).x1=1/0,l.y1=1/0,l.x2=-1/0,l.y2=-1/0,l.w=0,l.h=0):F.all=nt(),c&&t.includeLabels&&(t.includeMainLabels&&_i(h,e,null),g&&(t.includeSourceLabels&&_i(h,e,"source"),t.includeTargetLabels&&_i(h,e,"target")))}return h.x1=ft(h.x1),h.y1=ft(h.y1),h.x2=ft(h.x2),h.y2=ft(h.y2),h.w=ft(h.x2-h.x1),h.h=ft(h.y2-h.y1),h.w>0&&h.h>0&&m&&(_r(h,y),Br(h,1)),h},Cu=function(e){var t=0,n=function(a){return(a?1:0)<<t++},r=0;return r+=n(e.incudeNodes),r+=n(e.includeEdges),r+=n(e.includeLabels),r+=n(e.includeMainLabels),r+=n(e.includeSourceLabels),r+=n(e.includeTargetLabels),r+=n(e.includeOverlays),r+=n(e.includeOutlines)},Pu=function(e){var t=function(i){return Math.round(i)};if(e.isEdge()){var n=e.source().position(),r=e.target().position();return Ho([t(n.x),t(n.y),t(r.x),t(r.y)])}var a=e.position();return Ho([t(a.x),t(a.y)])},Su=function(e,t){var n,r=e._private,a=e.isEdge(),i=(t==null?Bu:Cu(t))===Bu;if(r.bbCache==null?(n=tf(e,nr),r.bbCache=n,r.bbCachePosKey=Pu(e)):n=r.bbCache,!i){var o=e.isNode();n=nt(),(t.includeNodes&&o||t.includeEdges&&!o)&&(t.includeOverlays?Kt(n,r.overlayBounds):Kt(n,r.bodyBounds)),t.includeLabels&&(t.includeMainLabels&&(!a||t.includeSourceLabels&&t.includeTargetLabels)?Kt(n,r.labelBounds.all):(t.includeMainLabels&&Kt(n,r.labelBounds.mainRot),t.includeSourceLabels&&Kt(n,r.labelBounds.sourceRot),t.includeTargetLabels&&Kt(n,r.labelBounds.targetRot))),n.w=n.x2-n.x1,n.h=n.y2-n.y1}return n},nr={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},Bu=Cu(nr),_u=Ke(nr);Gt.boundingBox=function(e){var t,n=e===void 0||e.useCache===void 0||e.useCache===!0,r=gn(function(u){var c=u._private;return c.bbCache==null||c.styleDirty||c.bbCachePosKey!==Pu(u)},function(u){return u.id()});if(n&&this.length===1&&!r(this[0]))e=e===void 0?nr:_u(e),t=Su(this[0],e);else{t=nt();var a=_u(e=e||nr),i=this,o=i.cy().styleEnabled();this.edges().forEach(r),this.nodes().forEach(r),o&&this.recalculateRenderedStyle(n),this.updateCompoundBounds(!n);for(var s=0;s<i.length;s++){var l=i[s];r(l)&&l.dirtyBoundingBoxCache(),Kt(t,Su(l,a))}}return t.x1=ft(t.x1),t.y1=ft(t.y1),t.x2=ft(t.x2),t.y2=ft(t.y2),t.w=ft(t.x2-t.x1),t.h=ft(t.y2-t.y1),t},Gt.dirtyBoundingBoxCache=function(){for(var e=0;e<this.length;e++){var t=this[e]._private;t.bbCache=null,t.bbCachePosKey=null,t.bodyBounds=null,t.overlayBounds=null,t.labelBounds.all=null,t.labelBounds.source=null,t.labelBounds.target=null,t.labelBounds.main=null,t.labelBounds.sourceRot=null,t.labelBounds.targetRot=null,t.labelBounds.mainRot=null,t.arrowBounds.source=null,t.arrowBounds.target=null,t.arrowBounds["mid-source"]=null,t.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this},Gt.boundingBoxAt=function(e){var t=this.nodes(),n=this.cy(),r=n.hasCompoundNodes(),a=n.collection();if(r&&(a=t.filter(function(s){return s.isParent()}),t=t.not(a)),xe(e)){var i=e;e=function(){return i}}n.startBatch(),t.forEach(function(s,l){return s._private.bbAtOldPos=e(s,l)}).silentPositions(e),r&&(a.dirtyCompoundBoundsCache(),a.dirtyBoundingBoxCache(),a.updateCompoundBounds(!0));var o=function(s){return{x1:s.x1,x2:s.x2,w:s.w,y1:s.y1,y2:s.y2,h:s.h}}(this.boundingBox({useCache:!1}));return t.silentPositions(function(s){return s._private.bbAtOldPos}),r&&(a.dirtyCompoundBoundsCache(),a.dirtyBoundingBoxCache(),a.updateCompoundBounds(!0)),n.endBatch(),o},_n.boundingbox=_n.bb=_n.boundingBox,_n.renderedBoundingbox=_n.renderedBoundingBox;var rr,ar,nf=Gt;rr=ar={};var Du=function(e){e.uppercaseName=Oo(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=Oo(e.outerName),rr[e.name]=function(){var t=this[0],n=t._private,r=n.cy._private.styleEnabled;if(t){if(r){if(t.isParent())return t.updateCompoundBounds(),n[e.autoName]||0;var a=t.pstyle(e.name);return a.strValue==="label"?(t.recalculateRenderedStyle(),n.rstyle[e.labelName]||0):a.pfValue}return 1}},rr["outer"+e.uppercaseName]=function(){var t=this[0],n=t._private.cy._private.styleEnabled;if(t){if(n){var r=t[e.name](),a=t.pstyle("border-position").value;return r+(a==="center"?t.pstyle("border-width").pfValue:a==="outside"?2*t.pstyle("border-width").pfValue:0)+2*t.padding()}return 1}},rr["rendered"+e.uppercaseName]=function(){var t=this[0];if(t)return t[e.name]()*this.cy().zoom()},rr["rendered"+e.uppercaseOuterName]=function(){var t=this[0];if(t)return t[e.outerName]()*this.cy().zoom()}};Du({name:"width"}),Du({name:"height"}),ar.padding=function(){var e=this[0],t=e._private;return e.isParent()?(e.updateCompoundBounds(),t.autoPadding!==void 0?t.autoPadding:e.pstyle("padding").pfValue):e.pstyle("padding").pfValue},ar.paddedHeight=function(){var e=this[0];return e.height()+2*e.padding()},ar.paddedWidth=function(){var e=this[0];return e.width()+2*e.padding()};var rf=ar,Au={controlPoints:{get:function(e){return e.renderer().getControlPoints(e)},mult:!0},segmentPoints:{get:function(e){return e.renderer().getSegmentPoints(e)},mult:!0},sourceEndpoint:{get:function(e){return e.renderer().getSourceEndpoint(e)}},targetEndpoint:{get:function(e){return e.renderer().getTargetEndpoint(e)}},midpoint:{get:function(e){return e.renderer().getEdgeMidpoint(e)}}},af=Object.keys(Au).reduce(function(e,t){var n=Au[t],r=function(a){return"rendered"+a[0].toUpperCase()+a.substr(1)}(t);return e[t]=function(){return function(a,i){if(a.isEdge()&&a.takesUpSpace())return i(a)}(this,n.get)},n.mult?e[r]=function(){return function(a,i){if(a.isEdge()&&a.takesUpSpace()){var o=a.cy(),s=o.pan(),l=o.zoom();return i(a).map(function(u){return Pr(u,l,s)})}}(this,n.get)}:e[r]=function(){return function(a,i){if(a.isEdge()&&a.takesUpSpace()){var o=a.cy();return Pr(i(a),o.zoom(),o.pan())}}(this,n.get)},e},{}),of=ge({},ef,nf,rf,af),Mu=function(e,t){this.recycle(e,t)};function ir(){return!1}function Ur(){return!0}Mu.prototype={instanceString:function(){return"event"},recycle:function(e,t){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=ir,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?Ur:ir):e!=null&&e.type?t=e:this.type=e,t!=null&&(this.originalEvent=t.originalEvent,this.type=t.type!=null?t.type:this.type,this.cy=t.cy,this.target=t.target,this.position=t.position,this.renderedPosition=t.renderedPosition,this.namespace=t.namespace,this.layout=t.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var n=this.position,r=this.cy.zoom(),a=this.cy.pan();this.renderedPosition={x:n.x*r+a.x,y:n.y*r+a.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=Ur;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=Ur;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Ur,this.stopPropagation()},isDefaultPrevented:ir,isPropagationStopped:ir,isImmediatePropagationStopped:ir};var Iu=/^([^.]+)(\.(?:[^.]+))?$/,Nu={qualifierCompare:function(e,t){return e===t},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},Ru=Object.keys(Nu),sf={};function Zr(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sf,t=arguments.length>1?arguments[1]:void 0,n=0;n<Ru.length;n++){var r=Ru[n];this[r]=e[r]||Nu[r]}this.context=t||this.context,this.listeners=[],this.emitting=0}var Ut=Zr.prototype,Lu=function(e,t,n,r,a,i,o){Ie(r)&&(a=r,r=null),o&&(i=i==null?o:ge({},i,o));for(var s=Ce(n)?n:n.split(/\s+/),l=0;l<s.length;l++){var u=s[l];if(!Lt(u)){var c=u.match(Iu);if(c&&t(e,u,c[1],c[2]?c[2]:null,r,a,i)===!1)break}}},zu=function(e,t){return e.addEventFields(e.context,t),new Mu(t.type,t)},lf=function(e,t,n){if(Yn(n)!=="event")if(xe(n))t(e,zu(e,n));else for(var r=Ce(n)?n:n.split(/\s+/),a=0;a<r.length;a++){var i=r[a];if(!Lt(i)){var o=i.match(Iu);if(o){var s=o[1],l=o[2]?o[2]:null;t(e,zu(e,{type:s,namespace:l,target:e.context}))}}}else t(e,n)};Ut.on=Ut.addListener=function(e,t,n,r,a){return Lu(this,function(i,o,s,l,u,c,d){Ie(c)&&i.listeners.push({event:o,callback:c,type:s,namespace:l,qualifier:u,conf:d})},e,t,n,r,a),this},Ut.one=function(e,t,n,r){return this.on(e,t,n,r,{one:!0})},Ut.removeListener=Ut.off=function(e,t,n,r){var a=this;this.emitting!==0&&(this.listeners=this.listeners.slice());for(var i=this.listeners,o=function(l){var u=i[l];Lu(a,function(c,d,h,p,f,g){if((u.type===h||e==="*")&&(!p&&u.namespace!==".*"||u.namespace===p)&&(!f||c.qualifierCompare(u.qualifier,f))&&(!g||u.callback===g))return i.splice(l,1),!1},e,t,n,r)},s=i.length-1;s>=0;s--)o(s);return this},Ut.removeAllListeners=function(){return this.removeListener("*")},Ut.emit=Ut.trigger=function(e,t,n){var r=this.listeners,a=r.length;return this.emitting++,Ce(t)||(t=[t]),lf(this,function(i,o){n!=null&&(r=[{event:o.event,type:o.type,namespace:o.namespace,callback:n}],a=r.length);for(var s=function(){var u=r[l];if(u.type===o.type&&(!u.namespace||u.namespace===o.namespace||u.namespace===".*")&&i.eventMatches(i.context,u,o)){var c=[o];t!=null&&function(p,f){for(var g=0;g<f.length;g++){var v=f[g];p.push(v)}}(c,t),i.beforeEmit(i.context,u,o),u.conf&&u.conf.one&&(i.listeners=i.listeners.filter(function(p){return p!==u}));var d=i.callbackContext(i.context,u,o),h=u.callback.apply(d,c);i.afterEmit(i.context,u,o),h===!1&&(o.stopPropagation(),o.preventDefault())}},l=0;l<a;l++)s();i.bubble(i.context)&&!o.isPropagationStopped()&&i.parent(i.context).emit(o,t)},e),this.emitting--,this};var uf={qualifierCompare:function(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function(e,t,n){var r=t.qualifier;return r==null||e!==n.target&&jn(n.target)&&r.matches(n.target)},addEventFields:function(e,t){t.cy=e.cy(),t.target=e},callbackContext:function(e,t,n){return t.qualifier!=null?n.target:e},beforeEmit:function(e,t){t.conf&&t.conf.once&&t.conf.onceCollection.removeListener(t.event,t.qualifier,t.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},$r=function(e){return pe(e)?new qt(e):e},Ou={createEmitter:function(){for(var e=0;e<this.length;e++){var t=this[e],n=t._private;n.emitter||(n.emitter=new Zr(uf,t))}return this},emitter:function(){return this._private.emitter},on:function(e,t,n){for(var r=$r(t),a=0;a<this.length;a++)this[a].emitter().on(e,r,n);return this},removeListener:function(e,t,n){for(var r=$r(t),a=0;a<this.length;a++)this[a].emitter().removeListener(e,r,n);return this},removeAllListeners:function(){for(var e=0;e<this.length;e++)this[e].emitter().removeAllListeners();return this},one:function(e,t,n){for(var r=$r(t),a=0;a<this.length;a++)this[a].emitter().one(e,r,n);return this},once:function(e,t,n){for(var r=$r(t),a=0;a<this.length;a++)this[a].emitter().on(e,r,n,{once:!0,onceCollection:this})},emit:function(e,t){for(var n=0;n<this.length;n++)this[n].emitter().emit(e,t);return this},emitAndNotify:function(e,t){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,t),this}};Te.eventAliasesOn(Ou);var Vu={nodes:function(e){return this.filter(function(t){return t.isNode()}).filter(e)},edges:function(e){return this.filter(function(t){return t.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),t=this.spawn(),n=0;n<this.length;n++){var r=this[n];r.isNode()?e.push(r):t.push(r)}return{nodes:e,edges:t}},filter:function(e,t){if(e===void 0)return this;if(pe(e)||lt(e))return new qt(e).filter(this);if(Ie(e)){for(var n=this.spawn(),r=this,a=0;a<r.length;a++){var i=r[a];(t?e.apply(t,[i,a,r]):e(i,a,r))&&n.push(i)}return n}return this.spawn()},not:function(e){if(e){pe(e)&&(e=this.filter(e));for(var t=this.spawn(),n=0;n<this.length;n++){var r=this[n];e.has(r)||t.push(r)}return t}return this},absoluteComplement:function(){return this.cy().mutableElements().not(this)},intersect:function(e){if(pe(e)){var t=e;return this.filter(t)}for(var n=this.spawn(),r=e,a=this.length<e.length,i=a?this:r,o=a?r:this,s=0;s<i.length;s++){var l=i[s];o.has(l)&&n.push(l)}return n},xor:function(e){var t=this._private.cy;pe(e)&&(e=t.$(e));var n=this.spawn(),r=e,a=function(i,o){for(var s=0;s<i.length;s++){var l=i[s],u=l._private.data.id;o.hasElementWithId(u)||n.push(l)}};return a(this,r),a(r,this),n},diff:function(e){var t=this._private.cy;pe(e)&&(e=t.$(e));var n=this.spawn(),r=this.spawn(),a=this.spawn(),i=e,o=function(s,l,u){for(var c=0;c<s.length;c++){var d=s[c],h=d._private.data.id;l.hasElementWithId(h)?a.merge(d):u.push(d)}};return o(this,i,n),o(i,this,r),{left:n,right:r,both:a}},add:function(e){var t=this._private.cy;if(!e)return this;if(pe(e)){var n=e;e=t.mutableElements().filter(n)}for(var r=this.spawnSelf(),a=0;a<e.length;a++){var i=e[a],o=!this.has(i);o&&r.push(i)}return r},merge:function(e){var t=this._private,n=t.cy;if(!e)return this;if(e&&pe(e)){var r=e;e=n.mutableElements().filter(r)}for(var a=t.map,i=0;i<e.length;i++){var o=e[i],s=o._private.data.id;if(!a.has(s)){var l=this.length++;this[l]=o,a.set(s,{ele:o,index:l})}}return this},unmergeAt:function(e){var t=this[e].id(),n=this._private.map;this[e]=void 0,n.delete(t);var r=e===this.length-1;if(this.length>1&&!r){var a=this.length-1,i=this[a],o=i._private.data.id;this[a]=void 0,this[e]=i,n.set(o,{ele:i,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var t=this._private,n=e._private.data.id,r=t.map.get(n);if(!r)return this;var a=r.index;return this.unmergeAt(a),this},unmerge:function(e){var t=this._private.cy;if(!e)return this;if(e&&pe(e)){var n=e;e=t.mutableElements().filter(n)}for(var r=0;r<e.length;r++)this.unmergeOne(e[r]);return this},unmergeBy:function(e){for(var t=this.length-1;t>=0;t--)e(this[t])&&this.unmergeAt(t);return this},map:function(e,t){for(var n=[],r=this,a=0;a<r.length;a++){var i=r[a],o=t?e.apply(t,[i,a,r]):e(i,a,r);n.push(o)}return n},reduce:function(e,t){for(var n=t,r=this,a=0;a<r.length;a++)n=e(n,r[a],a,r);return n},max:function(e,t){for(var n,r=-1/0,a=this,i=0;i<a.length;i++){var o=a[i],s=t?e.apply(t,[o,i,a]):e(o,i,a);s>r&&(r=s,n=o)}return{value:r,ele:n}},min:function(e,t){for(var n,r=1/0,a=this,i=0;i<a.length;i++){var o=a[i],s=t?e.apply(t,[o,i,a]):e(o,i,a);s<r&&(r=s,n=o)}return{value:r,ele:n}}},Ee=Vu;Ee.u=Ee["|"]=Ee["+"]=Ee.union=Ee.or=Ee.add,Ee["\\"]=Ee["!"]=Ee["-"]=Ee.difference=Ee.relativeComplement=Ee.subtract=Ee.not,Ee.n=Ee["&"]=Ee["."]=Ee.and=Ee.intersection=Ee.intersect,Ee["^"]=Ee["(+)"]=Ee["(-)"]=Ee.symmetricDifference=Ee.symdiff=Ee.xor,Ee.fnFilter=Ee.filterFn=Ee.stdFilter=Ee.filter,Ee.complement=Ee.abscomp=Ee.absoluteComplement;var Fu=function(e,t){var n=e.cy().hasCompoundNodes();function r(l){var u=l.pstyle("z-compound-depth");return u.value==="auto"?n?l.zDepth():0:u.value==="bottom"?-1:u.value==="top"?Ta:0}var a=r(e)-r(t);if(a!==0)return a;function i(l){return l.pstyle("z-index-compare").value==="auto"&&l.isNode()?1:0}var o=i(e)-i(t);if(o!==0)return o;var s=e.pstyle("z-index").value-t.pstyle("z-index").value;return s!==0?s:e.poolIndex()-t.poolIndex()},Qr={forEach:function(e,t){if(Ie(e))for(var n=this.length,r=0;r<n;r++){var a=this[r];if((t?e.apply(t,[a,r,this]):e(a,r,this))===!1)break}return this},toArray:function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t]);return e},slice:function(e,t){var n=[],r=this.length;t==null&&(t=r),e==null&&(e=0),e<0&&(e=r+e),t<0&&(t=r+t);for(var a=e;a>=0&&a<t&&a<r;a++)n.push(this[a]);return this.spawn(n)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!Ie(e))return this;var t=this.toArray().sort(e);return this.spawn(t)},sortByZIndex:function(){return this.sort(Fu)},zDepth:function(){var e=this[0];if(e){var t=e._private;if(t.group==="nodes"){var n=t.data.parent?e.parents().size():0;return e.isParent()?n:Ta-1}var r=t.source,a=t.target,i=r.zDepth(),o=a.zDepth();return Math.max(i,o,0)}}};Qr.each=Qr.forEach;var Di;Di="undefined",(typeof Symbol>"u"?"undefined":Ye(Symbol))!=Di&&Ye(Symbol.iterator)!=Di&&(Qr[Symbol.iterator]=function(){var e=this,t={value:void 0,done:!1},n=0,r=this.length;return ao({next:function(){return n<r?t.value=e[n++]:(t.value=void 0,t.done=!0),t}},Symbol.iterator,function(){return this})});var cf=Ke({nodeDimensionsIncludeLabels:!1}),Jr={layoutDimensions:function(e){var t;if(e=cf(e),this.takesUpSpace())if(e.nodeDimensionsIncludeLabels){var n=this.boundingBox();t={w:n.w,h:n.h}}else t={w:this.outerWidth(),h:this.outerHeight()};else t={w:0,h:0};return t.w!==0&&t.h!==0||(t.w=t.h=1),t},layoutPositions:function(e,t,n){var r=this.nodes().filter(function(y){return!y.isParent()}),a=this.cy(),i=t.eles,o=function(y){return y.id()},s=gn(n,o);e.emit({type:"layoutstart",layout:e}),e.animations=[];var l=t.spacingFactor&&t.spacingFactor!==1,u=function(){if(!l)return null;for(var y=nt(),b=0;b<r.length;b++){var m=r[b],w=s(m,b);is(y,w.x,w.y)}return y}(),c=gn(function(y,b){var m=s(y,b);return l&&(m=function(w,k,E){var x=k.x1+k.w/2,S=k.y1+k.h/2;return{x:x+(E.x-x)*w,y:S+(E.y-S)*w}}(Math.abs(t.spacingFactor),u,m)),t.transform!=null&&(m=t.transform(y,m)),m},o);if(t.animate){for(var d=0;d<r.length;d++){var h=r[d],p=c(h,d);if(t.animateFilter==null||t.animateFilter(h,d)){var f=h.animation({position:p,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(f)}else h.position(p)}if(t.fit){var g=a.animation({fit:{boundingBox:i.boundingBoxAt(c),padding:t.padding},duration:t.animationDuration,easing:t.animationEasing});e.animations.push(g)}else if(t.zoom!==void 0&&t.pan!==void 0){var v=a.animation({zoom:t.zoom,pan:t.pan,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(v)}e.animations.forEach(function(y){return y.play()}),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),Tn.all(e.animations.map(function(y){return y.promise()})).then(function(){e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e})})}else r.positions(c),t.fit&&a.fit(t.eles,t.padding),t.zoom!=null&&a.zoom(t.zoom),t.pan&&a.pan(t.pan),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){return this.cy().makeLayout(ge({},e,{eles:this}))}};function Yu(e,t,n){var r,a=n._private,i=a.styleCache=a.styleCache||[];return(r=i[e])!=null?r:r=i[e]=t(n)}function ea(e,t){return e=en(e),function(n){return Yu(e,t,n)}}function ta(e,t){e=en(e);var n=function(r){return t.call(r)};return function(){var r=this[0];if(r)return Yu(e,n,r)}}Jr.createLayout=Jr.makeLayout=Jr.layout;var Ue={recalculateRenderedStyle:function(e){var t=this.cy(),n=t.renderer(),r=t.styleEnabled();return n&&r&&n.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e,t=this.cy(),n=function(r){return r._private.styleCache=null};return t.hasCompoundNodes()?((e=this.spawnSelf().merge(this.descendants()).merge(this.parents())).merge(e.connectedEdges()),e.forEach(n)):this.forEach(function(r){n(r),r.connectedEdges().forEach(n)}),this},updateStyle:function(e){var t=this._private.cy;if(!t.styleEnabled())return this;if(t.batching())return t._private.batchStyleEles.merge(this),this;var n=this;e=!(!e&&e!==void 0),t.hasCompoundNodes()&&(n=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var r=n;return e?r.emitAndNotify("style"):r.emit("style"),n.forEach(function(a){return a._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(e.styleEnabled())for(var t=0;t<this.length;t++){var n=this[t];n._private.styleDirty&&(n._private.styleDirty=!1,e.style().apply(n))}},parsedStyle:function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],n=this[0],r=n.cy();if(r.styleEnabled()&&n){n._private.styleDirty&&(n._private.styleDirty=!1,r.style().apply(n));var a=n._private.style[e];return a??(t?r.style().getDefaultProperty(e):null)}},numericStyle:function(e){var t=this[0];if(t.cy().styleEnabled()&&t){var n=t.pstyle(e);return n.pfValue!==void 0?n.pfValue:n.value}},numericStyleUnits:function(e){var t=this[0];if(t.cy().styleEnabled())return t?t.pstyle(e).units:void 0},renderedStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var n=this[0];return n?t.style().getRenderedStyle(n,e):void 0},style:function(e,t){var n=this.cy();if(!n.styleEnabled())return this;var r=!1,a=n.style();if(xe(e)){var i=e;a.applyBypass(this,i,r),this.emitAndNotify("style")}else if(pe(e)){if(t===void 0){var o=this[0];return o?a.getStylePropertyValue(o,e):void 0}a.applyBypass(this,e,t,r),this.emitAndNotify("style")}else if(e===void 0){var s=this[0];return s?a.getRawStyle(s):void 0}return this},removeStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var n=!1,r=t.style(),a=this;if(e===void 0)for(var i=0;i<a.length;i++){var o=a[i];r.removeAllBypasses(o,n)}else{e=e.split(/\s+/);for(var s=0;s<a.length;s++){var l=a[s];r.removeBypasses(l,e,n)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var t=e.hasCompoundNodes(),n=this[0];if(n){var r=n._private,a=n.pstyle("opacity").value;if(!t)return a;var i=r.data.parent?n.parents():null;if(i)for(var o=0;o<i.length;o++)a*=i[o].pstyle("opacity").value;return a}},transparent:function(){if(!this.cy().styleEnabled())return!1;var e=this[0],t=e.cy().hasCompoundNodes();return e?t?e.effectiveOpacity()===0:e.pstyle("opacity").value===0:void 0},backgrounding:function(){return!!this.cy().styleEnabled()&&!!this[0]._private.backgrounding}};function Ai(e,t){var n=e._private.data.parent?e.parents():null;if(n){for(var r=0;r<n.length;r++)if(!t(n[r]))return!1}return!0}function Mi(e){var t=e.ok,n=e.edgeOkViaNode||e.ok,r=e.parentOk||e.ok;return function(){var a=this.cy();if(!a.styleEnabled())return!0;var i=this[0],o=a.hasCompoundNodes();if(i){var s=i._private;if(!t(i))return!1;if(i.isNode())return!o||Ai(i,r);var l=s.source,u=s.target;return n(l)&&(!o||Ai(l,n))&&(l===u||n(u)&&(!o||Ai(u,n)))}}}var Dn=ea("eleTakesUpSpace",function(e){return e.pstyle("display").value==="element"&&e.width()!==0&&(!e.isNode()||e.height()!==0)});Ue.takesUpSpace=ta("takesUpSpace",Mi({ok:Dn}));var df=ea("eleInteractive",function(e){return e.pstyle("events").value==="yes"&&e.pstyle("visibility").value==="visible"&&Dn(e)}),hf=ea("parentInteractive",function(e){return e.pstyle("visibility").value==="visible"&&Dn(e)});Ue.interactive=ta("interactive",Mi({ok:df,parentOk:hf,edgeOkViaNode:Dn})),Ue.noninteractive=function(){var e=this[0];if(e)return!e.interactive()};var ff=ea("eleVisible",function(e){return e.pstyle("visibility").value==="visible"&&e.pstyle("opacity").pfValue!==0&&Dn(e)}),pf=Dn;Ue.visible=ta("visible",Mi({ok:ff,edgeOkViaNode:pf})),Ue.hidden=function(){var e=this[0];if(e)return!e.visible()},Ue.isBundledBezier=ta("isBundledBezier",function(){return!!this.cy().styleEnabled()&&!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace()}),Ue.bypass=Ue.css=Ue.style,Ue.renderedCss=Ue.renderedStyle,Ue.removeBypass=Ue.removeCss=Ue.removeStyle,Ue.pstyle=Ue.parsedStyle;var Zt={};function ju(e){return function(){var t=arguments,n=[];if(t.length===2){var r=t[0],a=t[1];this.on(e.event,r,a)}else if(t.length===1&&Ie(t[0])){var i=t[0];this.on(e.event,i)}else if(t.length===0||t.length===1&&Ce(t[0])){for(var o=t.length===1?t[0]:null,s=0;s<this.length;s++){var l=this[s],u=!e.ableField||l._private[e.ableField],c=l._private[e.field]!=e.value;if(e.overrideAble){var d=e.overrideAble(l);if(d!==void 0&&(u=d,!d))return this}u&&(l._private[e.field]=e.value,c&&n.push(l))}var h=this.spawn(n);h.updateStyle(),h.emit(e.event),o&&h.emit(o)}return this}}function An(e){Zt[e.field]=function(){var t=this[0];if(t){if(e.overrideField){var n=e.overrideField(t);if(n!==void 0)return n}return t._private[e.field]}},Zt[e.on]=ju({event:e.on,field:e.field,ableField:e.ableField,overrideAble:e.overrideAble,value:!0}),Zt[e.off]=ju({event:e.off,field:e.field,ableField:e.ableField,overrideAble:e.overrideAble,value:!1})}An({field:"locked",overrideField:function(e){return!!e.cy().autolock()||void 0},on:"lock",off:"unlock"}),An({field:"grabbable",overrideField:function(e){return!e.cy().autoungrabify()&&!e.pannable()&&void 0},on:"grabify",off:"ungrabify"}),An({field:"selected",ableField:"selectable",overrideAble:function(e){return!e.cy().autounselectify()&&void 0},on:"select",off:"unselect"}),An({field:"selectable",overrideField:function(e){return!e.cy().autounselectify()&&void 0},on:"selectify",off:"unselectify"}),Zt.deselect=Zt.unselect,Zt.grabbed=function(){var e=this[0];if(e)return e._private.grabbed},An({field:"active",on:"activate",off:"unactivate"}),An({field:"pannable",on:"panify",off:"unpanify"}),Zt.inactive=function(){var e=this[0];if(e)return!e._private.active};var Qe={},Xu=function(e){return function(t){for(var n=[],r=0;r<this.length;r++){var a=this[r];if(a.isNode()){for(var i=!1,o=a.connectedEdges(),s=0;s<o.length;s++){var l=o[s],u=l.source(),c=l.target();if(e.noIncomingEdges&&c===a&&u!==a||e.noOutgoingEdges&&u===a&&c!==a){i=!0;break}}i||n.push(a)}}return this.spawn(n,!0).filter(t)}},qu=function(e){return function(t){for(var n=[],r=0;r<this.length;r++){var a=this[r];if(a.isNode())for(var i=a.connectedEdges(),o=0;o<i.length;o++){var s=i[o],l=s.source(),u=s.target();e.outgoing&&l===a?(n.push(s),n.push(u)):e.incoming&&u===a&&(n.push(s),n.push(l))}}return this.spawn(n,!0).filter(t)}},Wu=function(e){return function(t){for(var n=this,r=[],a={};;){var i=e.outgoing?n.outgoers():n.incomers();if(i.length===0)break;for(var o=!1,s=0;s<i.length;s++){var l=i[s],u=l.id();a[u]||(a[u]=!0,r.push(l),o=!0)}if(!o)break;n=i}return this.spawn(r,!0).filter(t)}};function Hu(e){return function(t){for(var n=[],r=0;r<this.length;r++){var a=this[r]._private[e.attr];a&&n.push(a)}return this.spawn(n,!0).filter(t)}}function Gu(e){return function(t){var n=[],r=this._private.cy,a=e||{};pe(t)&&(t=r.$(t));for(var i=0;i<t.length;i++)for(var o=t[i]._private.edges,s=0;s<o.length;s++){var l=o[s],u=l._private.data,c=this.hasElementWithId(u.source)&&t.hasElementWithId(u.target),d=t.hasElementWithId(u.source)&&this.hasElementWithId(u.target);if(c||d){if((a.thisIsSrc||a.thisIsTgt)&&(a.thisIsSrc&&!c||a.thisIsTgt&&!d))continue;n.push(l)}}return this.spawn(n,!0)}}function Ku(e){return e=ge({},{codirected:!1},e),function(t){for(var n=[],r=this.edges(),a=e,i=0;i<r.length;i++)for(var o=r[i]._private,s=o.source,l=s._private.data.id,u=o.data.target,c=s._private.edges,d=0;d<c.length;d++){var h=c[d],p=h._private.data,f=p.target,g=p.source,v=f===u&&g===l,y=l===f&&u===g;(a.codirected&&v||!a.codirected&&(v||y))&&n.push(h)}return this.spawn(n,!0).filter(t)}}Qe.clearTraversalCache=function(){for(var e=0;e<this.length;e++)this[e]._private.traversalCache=null},ge(Qe,{roots:Xu({noIncomingEdges:!0}),leaves:Xu({noOutgoingEdges:!0}),outgoers:ht(qu({outgoing:!0}),"outgoers"),successors:Wu({outgoing:!0}),incomers:ht(qu({incoming:!0}),"incomers"),predecessors:Wu({})}),ge(Qe,{neighborhood:ht(function(e){for(var t=[],n=this.nodes(),r=0;r<n.length;r++)for(var a=n[r],i=a.connectedEdges(),o=0;o<i.length;o++){var s=i[o],l=s.source(),u=s.target(),c=a===l?u:l;c.length>0&&t.push(c[0]),t.push(s[0])}return this.spawn(t,!0).filter(e)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}}),Qe.neighbourhood=Qe.neighborhood,Qe.closedNeighbourhood=Qe.closedNeighborhood,Qe.openNeighbourhood=Qe.openNeighborhood,ge(Qe,{source:ht(function(e){var t,n=this[0];return n&&(t=n._private.source||n.cy().collection()),t&&e?t.filter(e):t},"source"),target:ht(function(e){var t,n=this[0];return n&&(t=n._private.target||n.cy().collection()),t&&e?t.filter(e):t},"target"),sources:Hu({attr:"source"}),targets:Hu({attr:"target"})}),ge(Qe,{edgesWith:ht(Gu(),"edgesWith"),edgesTo:ht(Gu({thisIsSrc:!0}),"edgesTo")}),ge(Qe,{connectedEdges:ht(function(e){for(var t=[],n=0;n<this.length;n++){var r=this[n];if(r.isNode())for(var a=r._private.edges,i=0;i<a.length;i++){var o=a[i];t.push(o)}}return this.spawn(t,!0).filter(e)},"connectedEdges"),connectedNodes:ht(function(e){for(var t=[],n=0;n<this.length;n++){var r=this[n];r.isEdge()&&(t.push(r.source()[0]),t.push(r.target()[0]))}return this.spawn(t,!0).filter(e)},"connectedNodes"),parallelEdges:ht(Ku(),"parallelEdges"),codirectedEdges:ht(Ku({codirected:!0}),"codirectedEdges")}),ge(Qe,{components:function(e){var t=this,n=t.cy(),r=n.collection(),a=e==null?t.nodes():e.nodes(),i=[];e!=null&&a.empty()&&(a=e.sources());var o=function(l,u){r.merge(l),a.unmerge(l),u.merge(l)};if(a.empty())return t.spawn();var s=function(){var l=n.collection();i.push(l);var u=a[0];o(u,l),t.bfs({directed:!1,roots:u,visit:function(c){return o(c,l)}}),l.forEach(function(c){c.connectedEdges().forEach(function(d){t.has(d)&&l.has(d.source())&&l.has(d.target())&&l.merge(d)})})};do s();while(a.length>0);return i},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}}),Qe.componentsOf=Qe.components;var Ze=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0&&arguments[2],r=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(e!==void 0){var a=new _t,i=!1;if(t){if(t.length>0&&xe(t[0])&&!jn(t[0])){i=!0;for(var o=[],s=new yn,l=0,u=t.length;l<u;l++){var c=t[l];c.data==null&&(c.data={});var d=c.data;if(d.id==null)d.id=Qo();else if(e.hasElementWithId(d.id)||s.has(d.id))continue;var h=new Cr(e,c,!1);o.push(h),s.add(d.id)}t=o}}else t=[];this.length=0;for(var p=0,f=t.length;p<f;p++){var g=t[p][0];if(g!=null){var v=g._private.data.id;n&&a.has(v)||(n&&a.set(v,{index:this.length,ele:g}),this[this.length]=g,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(y){this.lazyMap=y},rebuildMap:function(){for(var y=this.lazyMap=new _t,b=this.eles,m=0;m<b.length;m++){var w=b[m];y.set(w.id(),{index:m,ele:w})}}},n&&(this._private.map=a),i&&!r&&this.restore()}else Me("A collection must have a reference to the core")},Se=Cr.prototype=Ze.prototype=Object.create(Array.prototype);Se.instanceString=function(){return"collection"},Se.spawn=function(e,t){return new Ze(this.cy(),e,t)},Se.spawnSelf=function(){return this.spawn(this)},Se.cy=function(){return this._private.cy},Se.renderer=function(){return this._private.cy.renderer()},Se.element=function(){return this[0]},Se.collection=function(){return Ro(this)?this:new Ze(this._private.cy,[this])},Se.unique=function(){return new Ze(this._private.cy,this,!0)},Se.hasElementWithId=function(e){return e=""+e,this._private.map.has(e)},Se.getElementById=function(e){e=""+e;var t=this._private.cy,n=this._private.map.get(e);return n?n.ele:new Ze(t)},Se.$id=Se.getElementById,Se.poolIndex=function(){var e=this._private.cy._private.elements,t=this[0]._private.data.id;return e._private.map.get(t).index},Se.indexOf=function(e){var t=e[0]._private.data.id;return this._private.map.get(t).index},Se.indexOfId=function(e){return e=""+e,this._private.map.get(e).index},Se.json=function(e){var t=this.element(),n=this.cy();if(t==null&&e)return this;if(t!=null){var r=t._private;if(xe(e)){if(n.startBatch(),e.data){t.data(e.data);var a=r.data;if(t.isEdge()){var i=!1,o={},s=e.data.source,l=e.data.target;s!=null&&s!=a.source&&(o.source=""+s,i=!0),l!=null&&l!=a.target&&(o.target=""+l,i=!0),i&&(t=t.move(o))}else{var u="parent"in e.data,c=e.data.parent;!u||c==null&&a.parent==null||c==a.parent||(c===void 0&&(c=null),c!=null&&(c=""+c),t=t.move({parent:c}))}}e.position&&t.position(e.position);var d=function(f,g,v){var y=e[f];y!=null&&y!==r[f]&&(y?t[g]():t[v]())};return d("removed","remove","restore"),d("selected","select","unselect"),d("selectable","selectify","unselectify"),d("locked","lock","unlock"),d("grabbable","grabify","ungrabify"),d("pannable","panify","unpanify"),e.classes!=null&&t.classes(e.classes),n.endBatch(),this}if(e===void 0){var h={data:Et(r.data),position:Et(r.position),group:r.group,removed:r.removed,selected:r.selected,selectable:r.selectable,locked:r.locked,grabbable:r.grabbable,pannable:r.pannable,classes:null};h.classes="";var p=0;return r.classes.forEach(function(f){return h.classes+=p++===0?f:" "+f}),h}}},Se.jsons=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t].json();e.push(n)}return e},Se.clone=function(){for(var e=this.cy(),t=[],n=0;n<this.length;n++){var r=this[n].json(),a=new Cr(e,r,!1);t.push(a)}return new Ze(e,t)},Se.copy=Se.clone,Se.restore=function(){for(var e,t,n=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],a=this,i=a.cy(),o=i._private,s=[],l=[],u=0,c=a.length;u<c;u++){var d=a[u];r&&!d.removed()||(d.isNode()?s.push(d):l.push(d))}e=s.concat(l);var h=function(){e.splice(t,1),t--};for(t=0;t<e.length;t++){var p=e[t],f=p._private,g=f.data;if(p.clearTraversalCache(),r||f.removed)if(g.id===void 0)g.id=Qo();else if(oe(g.id))g.id=""+g.id;else{if(Lt(g.id)||!pe(g.id)){Me("Can not create element with invalid string ID `"+g.id+"`"),h();continue}if(i.hasElementWithId(g.id)){Me("Can not create second element with ID `"+g.id+"`"),h();continue}}var v=g.id;if(p.isNode()){var y=f.position;y.x==null&&(y.x=0),y.y==null&&(y.y=0)}if(p.isEdge()){for(var b=p,m=["source","target"],w=m.length,k=!1,E=0;E<w;E++){var x=m[E],S=g[x];oe(S)&&(S=g[x]=""+g[x]),S==null||S===""?(Me("Can not create edge `"+v+"` with unspecified "+x),k=!0):i.hasElementWithId(S)||(Me("Can not create edge `"+v+"` with nonexistant "+x+" `"+S+"`"),k=!0)}if(k){h();continue}var P=i.getElementById(g.source),T=i.getElementById(g.target);P.same(T)?P._private.edges.push(b):(P._private.edges.push(b),T._private.edges.push(b)),b._private.source=P,b._private.target=T}f.map=new _t,f.map.set(v,{ele:p,index:0}),f.removed=!1,r&&i.addToPool(p)}for(var D=0;D<s.length;D++){var A=s[D],B=A._private.data;oe(B.parent)&&(B.parent=""+B.parent);var M=B.parent;if(M!=null||A._private.parent){var I=A._private.parent?i.collection().merge(A._private.parent):i.getElementById(M);if(I.empty())B.parent=void 0;else if(I[0].removed())ke("Node added with missing parent, reference to parent removed"),B.parent=void 0,A._private.parent=null;else{for(var R=!1,_=I;!_.empty();){if(A.same(_)){R=!0,B.parent=void 0;break}_=_.parent()}R||(I[0]._private.children.push(A),A._private.parent=I[0],o.hasCompoundNodes=!0)}}}if(e.length>0){for(var z=e.length===a.length?a:new Ze(i,e),V=0;V<z.length;V++){var L=z[V];L.isNode()||(L.parallelEdges().clearTraversalCache(),L.source().clearTraversalCache(),L.target().clearTraversalCache())}(o.hasCompoundNodes?i.collection().merge(z).merge(z.connectedNodes()).merge(z.parent()):z).dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(n),n?z.emitAndNotify("add"):r&&z.emit("add")}return a},Se.removed=function(){var e=this[0];return e&&e._private.removed},Se.inside=function(){var e=this[0];return e&&!e._private.removed},Se.remove=function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],n=this,r=[],a={},i=n._private.cy;function o(T){var D=a[T.id()];t&&T.removed()||D||(a[T.id()]=!0,T.isNode()?(r.push(T),function(A){for(var B=A._private.edges,M=0;M<B.length;M++)o(B[M])}(T),function(A){for(var B=A._private.children,M=0;M<B.length;M++)o(B[M])}(T)):r.unshift(T))}for(var s=0,l=n.length;s<l;s++)o(n[s]);function u(T,D){var A=T._private.edges;Vt(A,D),T.clearTraversalCache()}function c(T){T.clearTraversalCache()}var d=[];function h(T,D){D=D[0];var A=(T=T[0])._private.children,B=T.id();Vt(A,D),D._private.parent=null,d.ids[B]||(d.ids[B]=!0,d.push(T))}d.ids={},n.dirtyCompoundBoundsCache(),t&&i.removeFromPool(r);for(var p=0;p<r.length;p++){var f=r[p];if(f.isEdge()){var g=f.source()[0],v=f.target()[0];u(g,f),u(v,f);for(var y=f.parallelEdges(),b=0;b<y.length;b++){var m=y[b];c(m),m.isBundledBezier()&&m.dirtyBoundingBoxCache()}}else{var w=f.parent();w.length!==0&&h(w,f)}t&&(f._private.removed=!0)}var k=i._private.elements;i._private.hasCompoundNodes=!1;for(var E=0;E<k.length;E++)if(k[E].isParent()){i._private.hasCompoundNodes=!0;break}var x=new Ze(this.cy(),r);x.size()>0&&(e?x.emitAndNotify("remove"):t&&x.emit("remove"));for(var S=0;S<d.length;S++){var P=d[S];t&&P.removed()||P.updateStyle()}return x},Se.move=function(e){var t=this._private.cy,n=this,r=!1,a=!1,i=function(h){return h==null?h:""+h};if(e.source!==void 0||e.target!==void 0){var o=i(e.source),s=i(e.target),l=o!=null&&t.hasElementWithId(o),u=s!=null&&t.hasElementWithId(s);(l||u)&&(t.batch(function(){n.remove(r,a),n.emitAndNotify("moveout");for(var h=0;h<n.length;h++){var p=n[h],f=p._private.data;p.isEdge()&&(l&&(f.source=o),u&&(f.target=s))}n.restore(r,a)}),n.emitAndNotify("move"))}else if(e.parent!==void 0){var c=i(e.parent);if(c===null||t.hasElementWithId(c)){var d=c===null?void 0:c;t.batch(function(){var h=n.remove(r,a);h.emitAndNotify("moveout");for(var p=0;p<n.length;p++){var f=n[p],g=f._private.data;f.isNode()&&(g.parent=d)}h.restore(r,a)}),n.emitAndNotify("move")}}return this},[Bs,Hh,Yr,Ht,Sn,Jh,Gr,of,Ou,Vu,{isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},Qr,Jr,Ue,Zt,Qe].forEach(function(e){ge(Se,e)});var gf={add:function(e){var t,n=this;if(lt(e)){var r=e;if(r._private.cy===n)t=r.restore();else{for(var a=[],i=0;i<r.length;i++){var o=r[i];a.push(o.json())}t=new Ze(n,a)}}else if(Ce(e))t=new Ze(n,e);else if(xe(e)&&(Ce(e.nodes)||Ce(e.edges))){for(var s=e,l=[],u=["nodes","edges"],c=0,d=u.length;c<d;c++){var h=u[c],p=s[h];if(Ce(p))for(var f=0,g=p.length;f<g;f++){var v=ge({group:h},p[f]);l.push(v)}}t=new Ze(n,l)}else t=new Cr(n,e).collection();return t},remove:function(e){if(!lt(e)){if(pe(e)){var t=e;e=this.$(t)}}return e.remove()}};/*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */function vf(e,t,n,r){var a=.1,i=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var o=0;o<4;++o)if(typeof arguments[o]!="number"||isNaN(arguments[o])||!isFinite(arguments[o]))return!1;e=Math.min(e,1),n=Math.min(n,1),e=Math.max(e,0),n=Math.max(n,0);var s=i?new Float32Array(11):new Array(11);function l(b,m){return 1-3*m+3*b}function u(b,m){return 3*m-6*b}function c(b){return 3*b}function d(b,m,w){return((l(m,w)*b+u(m,w))*b+c(m))*b}function h(b,m,w){return 3*l(m,w)*b*b+2*u(m,w)*b+c(m)}function p(b){for(var m=0,w=1;w!==10&&s[w]<=b;++w)m+=a;--w;var k=m+(b-s[w])/(s[w+1]-s[w])*a,E=h(k,e,n);return E>=.001?function(x,S){for(var P=0;P<4;++P){var T=h(S,e,n);if(T===0)return S;S-=(d(S,e,n)-x)/T}return S}(b,k):E===0?k:function(x,S,P){var T,D,A=0;do(T=d(D=S+(P-S)/2,e,n)-x)>0?P=D:S=D;while(Math.abs(T)>1e-7&&++A<10);return D}(b,m,m+a)}var f=!1;function g(){f=!0,e===t&&n===r||function(){for(var b=0;b<11;++b)s[b]=d(b*a,e,n)}()}var v=function(b){return f||g(),e===t&&n===r?b:b===0?0:b===1?1:d(p(b),t,r)};v.getControlPoints=function(){return[{x:e,y:t},{x:n,y:r}]};var y="generateBezier("+[e,t,n,r]+")";return v.toString=function(){return y},v}/*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */var yf=function(){function e(r){return-r.tension*r.x-r.friction*r.v}function t(r,a,i){var o={x:r.x+i.dx*a,v:r.v+i.dv*a,tension:r.tension,friction:r.friction};return{dx:o.v,dv:e(o)}}function n(r,a){var i={dx:r.v,dv:e(r)},o=t(r,.5*a,i),s=t(r,.5*a,o),l=t(r,a,s),u=1/6*(i.dx+2*(o.dx+s.dx)+l.dx),c=1/6*(i.dv+2*(o.dv+s.dv)+l.dv);return r.x=r.x+u*a,r.v=r.v+c*a,r}return function r(a,i,o){var s,l,u,c={x:-1,v:0,tension:null,friction:null},d=[0],h=0,p=1e-4;for(a=parseFloat(a)||500,i=parseFloat(i)||20,o=o||null,c.tension=a,c.friction=i,l=(s=o!==null)?(h=r(a,i))/o*.016:.016;u=n(u||c,l),d.push(1+u.x),h+=16,Math.abs(u.x)>p&&Math.abs(u.v)>p;);return s?function(f){return d[f*(d.length-1)|0]}:h}}(),Be=function(e,t,n,r){var a=vf(e,t,n,r);return function(i,o,s){return i+(o-i)*a(s)}},na={linear:function(e,t,n){return e+(t-e)*n},ease:Be(.25,.1,.25,1),"ease-in":Be(.42,0,1,1),"ease-out":Be(0,0,.58,1),"ease-in-out":Be(.42,0,.58,1),"ease-in-sine":Be(.47,0,.745,.715),"ease-out-sine":Be(.39,.575,.565,1),"ease-in-out-sine":Be(.445,.05,.55,.95),"ease-in-quad":Be(.55,.085,.68,.53),"ease-out-quad":Be(.25,.46,.45,.94),"ease-in-out-quad":Be(.455,.03,.515,.955),"ease-in-cubic":Be(.55,.055,.675,.19),"ease-out-cubic":Be(.215,.61,.355,1),"ease-in-out-cubic":Be(.645,.045,.355,1),"ease-in-quart":Be(.895,.03,.685,.22),"ease-out-quart":Be(.165,.84,.44,1),"ease-in-out-quart":Be(.77,0,.175,1),"ease-in-quint":Be(.755,.05,.855,.06),"ease-out-quint":Be(.23,1,.32,1),"ease-in-out-quint":Be(.86,0,.07,1),"ease-in-expo":Be(.95,.05,.795,.035),"ease-out-expo":Be(.19,1,.22,1),"ease-in-out-expo":Be(1,0,0,1),"ease-in-circ":Be(.6,.04,.98,.335),"ease-out-circ":Be(.075,.82,.165,1),"ease-in-out-circ":Be(.785,.135,.15,.86),spring:function(e,t,n){if(n===0)return na.linear;var r=yf(e,t,n);return function(a,i,o){return a+(i-a)*r(o)}},"cubic-bezier":Be};function Uu(e,t,n,r,a){if(r===1||t===n)return n;var i=a(t,n,r);return e==null||((e.roundValue||e.color)&&(i=Math.round(i)),e.min!==void 0&&(i=Math.max(i,e.min)),e.max!==void 0&&(i=Math.min(i,e.max))),i}function Zu(e,t){return e.pfValue!=null||e.value!=null?e.pfValue==null||t!=null&&t.type.units==="%"?e.value:e.pfValue:e}function Mn(e,t,n,r,a){var i=a!=null?a.type:null;n<0?n=0:n>1&&(n=1);var o=Zu(e,a),s=Zu(t,a);if(oe(o)&&oe(s))return Uu(i,o,s,n,r);if(Ce(o)&&Ce(s)){for(var l=[],u=0;u<s.length;u++){var c=o[u],d=s[u];if(c!=null&&d!=null){var h=Uu(i,c,d,n,r);l.push(h)}else l.push(d)}return l}}function mf(e,t,n,r){var a=!r,i=e._private,o=t._private,s=o.easing,l=o.startTime,u=(r?e:e.cy()).style();if(!o.easingImpl)if(s==null)o.easingImpl=na.linear;else{var c,d,h;pe(s)?c=u.parse("transition-timing-function",s).value:c=s,pe(c)?(d=c,h=[]):(d=c[1],h=c.slice(2).map(function(R){return+R})),h.length>0?(d==="spring"&&h.push(o.duration),o.easingImpl=na[d].apply(null,h)):o.easingImpl=na[d]}var p,f=o.easingImpl;if(p=o.duration===0?1:(n-l)/o.duration,o.applying&&(p=o.progress),p<0?p=0:p>1&&(p=1),o.delay==null){var g=o.startPosition,v=o.position;if(v&&a&&!e.locked()){var y={};or(g.x,v.x)&&(y.x=Mn(g.x,v.x,p,f)),or(g.y,v.y)&&(y.y=Mn(g.y,v.y,p,f)),e.position(y)}var b=o.startPan,m=o.pan,w=i.pan,k=m!=null&&r;k&&(or(b.x,m.x)&&(w.x=Mn(b.x,m.x,p,f)),or(b.y,m.y)&&(w.y=Mn(b.y,m.y,p,f)),e.emit("pan"));var E=o.startZoom,x=o.zoom,S=x!=null&&r;S&&(or(E,x)&&(i.zoom=$n(i.minZoom,Mn(E,x,p,f),i.maxZoom)),e.emit("zoom")),(k||S)&&e.emit("viewport");var P=o.style;if(P&&P.length>0&&a){for(var T=0;T<P.length;T++){var D=P[T],A=D.name,B=D,M=o.startStyle[A],I=Mn(M,B,p,f,u.properties[M.name]);u.overrideBypass(e,A,I)}e.emit("style")}}return o.progress=p,p}function or(e,t){return e!=null&&t!=null&&(!(!oe(e)||!oe(t))||!(!e||!t))}function bf(e,t,n,r){var a=t._private;a.started=!0,a.startTime=n-a.progress*a.duration}function $u(e,t){var n=t._private.aniEles,r=[];function a(u,c){var d=u._private,h=d.animation.current,p=d.animation.queue,f=!1;if(h.length===0){var g=p.shift();g&&h.push(g)}for(var v=function(w){for(var k=w.length-1;k>=0;k--)(0,w[k])();w.splice(0,w.length)},y=h.length-1;y>=0;y--){var b=h[y],m=b._private;m.stopped?(h.splice(y,1),m.hooked=!1,m.playing=!1,m.started=!1,v(m.frames)):(m.playing||m.applying)&&(m.playing&&m.applying&&(m.applying=!1),m.started||bf(0,b,e),mf(u,b,e,c),m.applying&&(m.applying=!1),v(m.frames),m.step!=null&&m.step(e),b.completed()&&(h.splice(y,1),m.hooked=!1,m.playing=!1,m.started=!1,v(m.completes)),f=!0)}return c||h.length!==0||p.length!==0||r.push(u),f}for(var i=!1,o=0;o<n.length;o++){var s=a(n[o]);i=i||s}var l=a(t,!0);(i||l)&&(n.length>0?t.notify("draw",n):t.notify("draw")),n.unmerge(r),t.emit("step")}var xf={animate:Te.animate(),animation:Te.animation(),animated:Te.animated(),clearQueue:Te.clearQueue(),delay:Te.delay(),delayAnimation:Te.delayAnimation(),stop:Te.stop(),addToAnimationPool:function(e){this.styleEnabled()&&this._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,e.styleEnabled()){var t=e.renderer();t&&t.beforeRender?t.beforeRender(function(n,r){$u(r,e)},t.beforeRenderPriorities.animations):function n(){e._private.animationsRunning&&Er(function(r){$u(r,e),n()})}()}}},wf={qualifierCompare:function(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function(e,t,n){var r=t.qualifier;return r==null||e!==n.target&&jn(n.target)&&r.matches(n.target)},addEventFields:function(e,t){t.cy=e,t.target=e},callbackContext:function(e,t,n){return t.qualifier!=null?n.target:e}},ra=function(e){return pe(e)?new qt(e):e},Qu={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new Zr(wf,this)),this},emitter:function(){return this._private.emitter},on:function(e,t,n){return this.emitter().on(e,ra(t),n),this},removeListener:function(e,t,n){return this.emitter().removeListener(e,ra(t),n),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,t,n){return this.emitter().one(e,ra(t),n),this},once:function(e,t,n){return this.emitter().one(e,ra(t),n),this},emit:function(e,t){return this.emitter().emit(e,t),this},emitAndNotify:function(e,t){return this.emit(e),this.notify(e,t),this}};Te.eventAliasesOn(Qu);var Ii={png:function(e){return e=e||{},this._private.renderer.png(e)},jpg:function(e){var t=this._private.renderer;return(e=e||{}).bg=e.bg||"#fff",t.jpg(e)}};Ii.jpeg=Ii.jpg;var aa={layout:function(e){var t=this;if(e!=null)if(e.name!=null){var n=e.name,r=t.extension("layout",n);if(r!=null){var a;a=pe(e.eles)?t.$(e.eles):e.eles!=null?e.eles:t.$();var i=new r(ge({},e,{cy:t,eles:a}));return i}Me("No such layout `"+n+"` found.  Did you forget to import it and `cytoscape.use()` it?")}else Me("A `name` must be specified to make a layout");else Me("Layout options must be specified to make a layout")}};aa.createLayout=aa.makeLayout=aa.layout;var Ef={notify:function(e,t){var n=this._private;if(this.batching()){n.batchNotifications=n.batchNotifications||{};var r=n.batchNotifications[e]=n.batchNotifications[e]||this.collection();t!=null&&r.merge(t)}else if(n.notificationsEnabled){var a=this.renderer();!this.destroyed()&&a&&a.notify(e,t)}},notifications:function(e){var t=this._private;return e===void 0?t.notificationsEnabled:(t.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var t=this.renderer();Object.keys(e.batchNotifications).forEach(function(n){var r=e.batchNotifications[n];r.empty()?t.notify(n):t.notify(n,r)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var t=this;return this.batch(function(){for(var n=Object.keys(e),r=0;r<n.length;r++){var a=n[r],i=e[a];t.getElementById(a).data(i)}})}},kf=Ke({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),Ni={renderTo:function(e,t,n,r){return this._private.renderer.renderTo(e,t,n,r),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var t=this,n=t.extension("renderer",e.name);if(n!=null){e.wheelSensitivity!==void 0&&ke("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var r=kf(e);r.cy=t,t._private.renderer=new n(r),this.notify("init")}else Me("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"))},destroyRenderer:function(){var e=this;e.notify("destroy");var t=e.container();if(t)for(t._cyreg=null;t.childNodes.length>0;)t.removeChild(t.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(n){var r=n._private;r.rscratch={},r.rstyle={},r.animation.current=[],r.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};Ni.invalidateDimensions=Ni.resize;var ia={collection:function(e,t){return pe(e)?this.$(e):lt(e)?e.collection():Ce(e)?(t||(t={}),new Ze(this,e,t.unique,t.removed)):new Ze(this)},nodes:function(e){var t=this.$(function(n){return n.isNode()});return e?t.filter(e):t},edges:function(e){var t=this.$(function(n){return n.isEdge()});return e?t.filter(e):t},$:function(e){var t=this._private.elements;return e?t.filter(e):t.spawnSelf()},mutableElements:function(){return this._private.elements}};ia.elements=ia.filter=ia.$;var He={},sr="t";He.apply=function(e){for(var t=this,n=t._private.cy.collection(),r=0;r<e.length;r++){var a=e[r],i=t.getContextMeta(a);if(!i.empty){var o=t.getContextStyle(i),s=t.applyContextStyle(i,o,a);a._private.appliedInitStyle?t.updateTransitions(a,s.diffProps):a._private.appliedInitStyle=!0,t.updateStyleHints(a)&&n.push(a)}}return n},He.getPropertiesDiff=function(e,t){var n=this,r=n._private.propDiffs=n._private.propDiffs||{},a=e+"-"+t,i=r[a];if(i)return i;for(var o=[],s={},l=0;l<n.length;l++){var u=n[l],c=e[l]===sr,d=t[l]===sr,h=c!==d,p=u.mappedProperties.length>0;if(h||d&&p){var f=void 0;h&&p||h?f=u.properties:p&&(f=u.mappedProperties);for(var g=0;g<f.length;g++){for(var v=f[g],y=v.name,b=!1,m=l+1;m<n.length;m++){var w=n[m];if(t[m]===sr&&(b=w.properties[v.name]!=null))break}s[y]||b||(s[y]=!0,o.push(y))}}}return r[a]=o,o},He.getContextMeta=function(e){for(var t,n=this,r="",a=e._private.styleCxtKey||"",i=0;i<n.length;i++){var o=n[i];r+=o.selector&&o.selector.matches(e)?sr:"f"}return t=n.getPropertiesDiff(a,r),e._private.styleCxtKey=r,{key:r,diffPropNames:t,empty:t.length===0}},He.getContextStyle=function(e){var t=e.key,n=this._private.contextStyles=this._private.contextStyles||{};if(n[t])return n[t];for(var r={_private:{key:t}},a=0;a<this.length;a++){var i=this[a];if(t[a]===sr)for(var o=0;o<i.properties.length;o++){var s=i.properties[o];r[s.name]=s}}return n[t]=r,r},He.applyContextStyle=function(e,t,n){for(var r=e.diffPropNames,a={},i=this.types,o=0;o<r.length;o++){var s=r[o],l=t[s],u=n.pstyle(s);if(!l){if(!u)continue;l=u.bypass?{name:s,deleteBypassed:!0}:{name:s,delete:!0}}if(u!==l){if(l.mapped===i.fn&&u!=null&&u.mapping!=null&&u.mapping.value===l.value){var c=u.mapping;if((c.fnValue=l.value(n))===c.prevFnValue)continue}var d=a[s]={prev:u};this.applyParsedProperty(n,l),d.next=n.pstyle(s),d.next&&d.next.bypass&&(d.next=d.next.bypassed)}}return{diffProps:a}},He.updateStyleHints=function(e){var t=e._private,n=this,r=n.propertyGroupNames,a=n.propertyGroupKeys,i=function(J,ne,le){return n.getPropertiesHash(J,ne,le)},o=t.styleKey;if(e.removed())return!1;var s=t.group==="nodes",l=e._private.style;r=Object.keys(l);for(var u=0;u<a.length;u++){var c=a[u];t.styleKeys[c]=[Jt,vn]}for(var d=function(J,ne){return t.styleKeys[ne][0]=Gn(J,t.styleKeys[ne][0])},h=function(J,ne){return t.styleKeys[ne][1]=Kn(J,t.styleKeys[ne][1])},p=function(J,ne){d(J,ne),h(J,ne)},f=function(J,ne){for(var le=0;le<J.length;le++){var fe=J.charCodeAt(le);d(fe,ne),h(fe,ne)}},g=function(J){return-128<J&&J<128&&Math.floor(J)!==J?2e9-(1024*J|0):J},v=0;v<r.length;v++){var y=r[v],b=l[y];if(b!=null){var m=this.properties[y],w=m.type,k=m.groupKey,E=void 0;m.hashOverride!=null?E=m.hashOverride(e,b):b.pfValue!=null&&(E=b.pfValue);var x=m.enums==null?b.value:null,S=E!=null,P=S||x!=null,T=b.units;w.number&&P&&!w.multiple?(p(g(S?E:x),k),S||T==null||f(T,k)):f(b.strValue,k)}}for(var D,A,B=[Jt,vn],M=0;M<a.length;M++){var I=a[M],R=t.styleKeys[I];B[0]=Gn(R[0],B[0]),B[1]=Kn(R[1],B[1])}t.styleKey=(D=B[0],A=B[1],2097152*D+A);var _=t.styleKeys;t.labelDimsKey=Ot(_.labelDimensions);var z=i(e,["label"],_.labelDimensions);if(t.labelKey=Ot(z),t.labelStyleKey=Ot(kr(_.commonLabel,z)),!s){var V=i(e,["source-label"],_.labelDimensions);t.sourceLabelKey=Ot(V),t.sourceLabelStyleKey=Ot(kr(_.commonLabel,V));var L=i(e,["target-label"],_.labelDimensions);t.targetLabelKey=Ot(L),t.targetLabelStyleKey=Ot(kr(_.commonLabel,L))}if(s){var X=t.styleKeys,W=X.nodeBody,G=X.nodeBorder,U=X.nodeOutline,Q=X.backgroundImage,F=X.compound,O=X.pie,Y=X.stripe,$=[W,G,U,Q,F,O,Y].filter(function(J){return J!=null}).reduce(kr,[Jt,vn]);t.nodeKey=Ot($),t.hasPie=O!=null&&O[0]!==Jt&&O[1]!==vn,t.hasStripe=Y!=null&&Y[0]!==Jt&&Y[1]!==vn}return o!==t.styleKey},He.clearStyleHints=function(e){var t=e._private;t.styleCxtKey="",t.styleKeys={},t.styleKey=null,t.labelKey=null,t.labelStyleKey=null,t.sourceLabelKey=null,t.sourceLabelStyleKey=null,t.targetLabelKey=null,t.targetLabelStyleKey=null,t.nodeKey=null,t.hasPie=null,t.hasStripe=null},He.applyParsedProperty=function(e,t){var n,r=this,a=t,i=e._private.style,o=r.types,s=r.properties[a.name].type,l=a.bypass,u=i[a.name],c=u&&u.bypass,d=e._private,h="mapping",p=function(L){return L==null?null:L.pfValue!=null?L.pfValue:L.value},f=function(){var L=p(u),X=p(a);r.checkTriggers(e,a.name,L,X)};if(t.name==="curve-style"&&e.isEdge()&&(t.value!=="bezier"&&e.isLoop()||t.value==="haystack"&&(e.source().isParent()||e.target().isParent()))&&(a=t=this.parse(t.name,"bezier",l)),a.delete)return i[a.name]=void 0,f(),!0;if(a.deleteBypassed)return u?!!u.bypass&&(u.bypassed=void 0,f(),!0):(f(),!0);if(a.deleteBypass)return u?!!u.bypass&&(i[a.name]=u.bypassed,f(),!0):(f(),!0);var g=function(){ke("Do not assign mappings to elements without corresponding data (i.e. ele `"+e.id()+"` has no mapping for property `"+a.name+"` with data field `"+a.field+"`); try a `["+a.field+"]` selector to limit scope to elements with `"+a.field+"` defined")};switch(a.mapped){case o.mapData:for(var v,y=a.field.split("."),b=d.data,m=0;m<y.length&&b;m++)b=b[y[m]];if(b==null)return g(),!1;if(!oe(b))return ke("Do not use continuous mappers without specifying numeric data (i.e. `"+a.field+": "+b+"` for `"+e.id()+"` is non-numeric)"),!1;var w=a.fieldMax-a.fieldMin;if((v=w===0?0:(b-a.fieldMin)/w)<0?v=0:v>1&&(v=1),s.color){var k=a.valueMin[0],E=a.valueMax[0],x=a.valueMin[1],S=a.valueMax[1],P=a.valueMin[2],T=a.valueMax[2],D=a.valueMin[3]==null?1:a.valueMin[3],A=a.valueMax[3]==null?1:a.valueMax[3],B=[Math.round(k+(E-k)*v),Math.round(x+(S-x)*v),Math.round(P+(T-P)*v),Math.round(D+(A-D)*v)];n={bypass:a.bypass,name:a.name,value:B,strValue:"rgb("+B[0]+", "+B[1]+", "+B[2]+")"}}else{if(!s.number)return!1;var M=a.valueMin+(a.valueMax-a.valueMin)*v;n=this.parse(a.name,M,a.bypass,h)}if(!n)return g(),!1;n.mapping=a,a=n;break;case o.data:for(var I=a.field.split("."),R=d.data,_=0;_<I.length&&R;_++)R=R[I[_]];if(R!=null&&(n=this.parse(a.name,R,a.bypass,h)),!n)return g(),!1;n.mapping=a,a=n;break;case o.fn:var z=a.value,V=a.fnValue!=null?a.fnValue:z(e);if(a.prevFnValue=V,V==null)return ke("Custom function mappers may not return null (i.e. `"+a.name+"` for ele `"+e.id()+"` is null)"),!1;if(!(n=this.parse(a.name,V,a.bypass,h)))return ke("Custom function mappers may not return invalid values for the property type (i.e. `"+a.name+"` for ele `"+e.id()+"` is invalid)"),!1;n.mapping=Et(a),a=n;break;case void 0:break;default:return!1}return l?(a.bypassed=c?u.bypassed:u,i[a.name]=a):c?u.bypassed=a:i[a.name]=a,f(),!0},He.cleanElements=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(this.clearStyleHints(r),r.dirtyCompoundBoundsCache(),r.dirtyBoundingBoxCache(),t)for(var a=r._private.style,i=Object.keys(a),o=0;o<i.length;o++){var s=i[o],l=a[s];l!=null&&(l.bypass?l.bypassed=null:a[s]=null)}else r._private.style={}}},He.update=function(){this._private.cy.mutableElements().updateStyle()},He.updateTransitions=function(e,t){var n=this,r=e._private,a=e.pstyle("transition-property").value,i=e.pstyle("transition-duration").pfValue,o=e.pstyle("transition-delay").pfValue;if(a.length>0&&i>0){for(var s={},l=!1,u=0;u<a.length;u++){var c=a[u],d=e.pstyle(c),h=t[c];if(h){var p=h.prev,f=h.next!=null?h.next:d,g=!1,v=void 0,y=1e-6;p&&(oe(p.pfValue)&&oe(f.pfValue)?(g=f.pfValue-p.pfValue,v=p.pfValue+y*g):oe(p.value)&&oe(f.value)?(g=f.value-p.value,v=p.value+y*g):Ce(p.value)&&Ce(f.value)&&(g=p.value[0]!==f.value[0]||p.value[1]!==f.value[1]||p.value[2]!==f.value[2],v=p.strValue),g&&(s[c]=f.strValue,this.applyBypass(e,c,v),l=!0))}}if(!l)return;r.transitioning=!0,new Tn(function(b){o>0?e.delayAnimation(o).play().promise().then(b):b()}).then(function(){return e.animation({style:s,duration:i,easing:e.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){n.removeBypasses(e,a),e.emitAndNotify("style"),r.transitioning=!1})}else r.transitioning&&(this.removeBypasses(e,a),e.emitAndNotify("style"),r.transitioning=!1)},He.checkTrigger=function(e,t,n,r,a,i){var o=this.properties[t],s=a(o);e.removed()||s!=null&&s(n,r,e)&&i(o)},He.checkZOrderTrigger=function(e,t,n,r){var a=this;this.checkTrigger(e,t,n,r,function(i){return i.triggersZOrder},function(){a._private.cy.notify("zorder",e)})},He.checkBoundsTrigger=function(e,t,n,r){this.checkTrigger(e,t,n,r,function(a){return a.triggersBounds},function(a){e.dirtyCompoundBoundsCache(),e.dirtyBoundingBoxCache()})},He.checkConnectedEdgesBoundsTrigger=function(e,t,n,r){this.checkTrigger(e,t,n,r,function(a){return a.triggersBoundsOfConnectedEdges},function(a){e.connectedEdges().forEach(function(i){i.dirtyBoundingBoxCache()})})},He.checkParallelEdgesBoundsTrigger=function(e,t,n,r){this.checkTrigger(e,t,n,r,function(a){return a.triggersBoundsOfParallelEdges},function(a){e.parallelEdges().forEach(function(i){i.dirtyBoundingBoxCache()})})},He.checkTriggers=function(e,t,n,r){e.dirtyStyleCache(),this.checkZOrderTrigger(e,t,n,r),this.checkBoundsTrigger(e,t,n,r),this.checkConnectedEdgesBoundsTrigger(e,t,n,r),this.checkParallelEdgesBoundsTrigger(e,t,n,r)};var Tf={applyBypass:function(e,t,n,r){var a=[];if(t==="*"||t==="**"){if(n!==void 0)for(var i=0;i<this.properties.length;i++){var o=this.properties[i].name,s=this.parse(o,n,!0);s&&a.push(s)}}else if(pe(t)){var l=this.parse(t,n,!0);l&&a.push(l)}else{if(!xe(t))return!1;var u=t;r=n;for(var c=Object.keys(u),d=0;d<c.length;d++){var h=c[d],p=u[h];if(p===void 0&&(p=u[br(h)]),p!==void 0){var f=this.parse(h,p,!0);f&&a.push(f)}}}if(a.length===0)return!1;for(var g=!1,v=0;v<e.length;v++){for(var y=e[v],b={},m=void 0,w=0;w<a.length;w++){var k=a[w];if(r){var E=y.pstyle(k.name);m=b[k.name]={prev:E}}g=this.applyParsedProperty(y,Et(k))||g,r&&(m.next=y.pstyle(k.name))}g&&this.updateStyleHints(y),r&&this.updateTransitions(y,b,!0)}return g},overrideBypass:function(e,t,n){t=wa(t);for(var r=0;r<e.length;r++){var a=e[r],i=a._private.style[t],o=this.properties[t].type,s=o.color,l=o.mutiple,u=i?i.pfValue!=null?i.pfValue:i.value:null;i&&i.bypass?(i.value=n,i.pfValue!=null&&(i.pfValue=n),i.strValue=s?"rgb("+n.join(",")+")":l?n.join(" "):""+n,this.updateStyleHints(a)):this.applyBypass(a,t,n),this.checkTriggers(a,t,u,n)}},removeAllBypasses:function(e,t){return this.removeBypasses(e,this.propertyNames,t)},removeBypasses:function(e,t,n){for(var r=0;r<e.length;r++){for(var a=e[r],i={},o=0;o<t.length;o++){var s=t[o],l=this.properties[s],u=a.pstyle(l.name);if(u&&u.bypass){var c=this.parse(s,"",!0),d=i[l.name]={prev:u};this.applyParsedProperty(a,c),d.next=a.pstyle(l.name)}}this.updateStyleHints(a),n&&this.updateTransitions(a,i,!0)}}},Cf={getEmSizeInPixels:function(){var e=this.containerCss("font-size");return e!=null?parseFloat(e):1},containerCss:function(e){var t=this._private.cy,n=t.container(),r=t.window();if(r&&n&&r.getComputedStyle)return r.getComputedStyle(n).getPropertyValue(e)}},Ri={getRenderedStyle:function(e,t){return t?this.getStylePropertyValue(e,t,!0):this.getRawStyle(e,!0)},getRawStyle:function(e,t){var n=this;if(e=e[0]){for(var r={},a=0;a<n.properties.length;a++){var i=n.properties[a],o=n.getStylePropertyValue(e,i.name,t);o!=null&&(r[i.name]=o,r[br(i.name)]=o)}return r}},getIndexedStyle:function(e,t,n,r){var a=e.pstyle(t)[n][r];return a??e.cy().style().getDefaultProperty(t)[n][0]},getStylePropertyValue:function(e,t,n){if(e=e[0]){var r=this.properties[t];r.alias&&(r=r.pointsTo);var a=r.type,i=e.pstyle(r.name);if(i){var o=i.value,s=i.units,l=i.strValue;if(n&&a.number&&o!=null&&oe(o)){var u=e.cy().zoom(),c=function(p){return p*u},d=function(p,f){return c(p)+f},h=Ce(o);return(h?s.every(function(p){return p!=null}):s!=null)?h?o.map(function(p,f){return d(p,s[f])}).join(" "):d(o,s):h?o.map(function(p){return pe(p)?p:""+c(p)}).join(" "):""+c(o)}if(l!=null)return l}return null}},getAnimationStartStyle:function(e,t){for(var n={},r=0;r<t.length;r++){var a=t[r].name,i=e.pstyle(a);i!==void 0&&(i=xe(i)?this.parse(a,i.strValue):this.parse(a,i)),i&&(n[a]=i)}return n},getPropsList:function(e){var t=[],n=e,r=this.properties;if(n)for(var a=Object.keys(n),i=0;i<a.length;i++){var o=a[i],s=n[o],l=r[o]||r[wa(o)],u=this.parse(l.name,s);u&&t.push(u)}return t},getNonDefaultPropertiesHash:function(e,t,n){var r,a,i,o,s,l,u=n.slice();for(s=0;s<t.length;s++)if(r=t[s],(a=e.pstyle(r,!1))!=null)if(a.pfValue!=null)u[0]=Gn(o,u[0]),u[1]=Kn(o,u[1]);else for(i=a.strValue,l=0;l<i.length;l++)o=i.charCodeAt(l),u[0]=Gn(o,u[0]),u[1]=Kn(o,u[1]);return u}};Ri.getPropertiesHash=Ri.getNonDefaultPropertiesHash;var Pf={appendFromJson:function(e){for(var t=this,n=0;n<e.length;n++){var r=e[n],a=r.selector,i=r.style||r.css,o=Object.keys(i);t.selector(a);for(var s=0;s<o.length;s++){var l=o[s],u=i[l];t.css(l,u)}}return t},fromJson:function(e){var t=this;return t.resetToDefault(),t.appendFromJson(e),t},json:function(){for(var e=[],t=this.defaultLength;t<this.length;t++){for(var n=this[t],r=n.selector,a=n.properties,i={},o=0;o<a.length;o++){var s=a[o];i[s.name]=s.strValue}e.push({selector:r?r.toString():"core",style:i})}return e}},Sf={appendFromString:function(e){var t,n,r,a=this,i=""+e;function o(){i=i.length>t.length?i.substr(t.length):""}function s(){n=n.length>r.length?n.substr(r.length):""}for(i=i.replace(/[/][*](\s|.)+?[*][/]/g,"");!i.match(/^\s*$/);){var l=i.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!l){ke("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+i);break}t=l[0];var u=l[1];if(u!=="core"&&new qt(u).invalid){ke("Skipping parsing of block: Invalid selector found in string stylesheet: "+u),o();continue}var c=l[2],d=!1;n=c;for(var h=[];!n.match(/^\s*$/);){var p=n.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!p){ke("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+c),d=!0;break}r=p[0];var f=p[1],g=p[2];this.properties[f]?a.parse(f,g)?(h.push({name:f,val:g}),s()):(ke("Skipping property: Invalid property definition in: "+r),s()):(ke("Skipping property: Invalid property name in: "+r),s())}if(d){o();break}a.selector(u);for(var v=0;v<h.length;v++){var y=h[v];a.css(y.name,y.val)}o()}return a},fromString:function(e){var t=this;return t.resetToDefault(),t.appendFromString(e),t}},ze={};(function(){var e=Xe,t=md,n=xd,r=function(O){return"^"+O+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},a=function(O){var Y=e+"|\\w+|"+t+"|"+n+"|\\#[0-9a-fA-F]{3}|\\#[0-9a-fA-F]{6}";return"^"+O+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+e+")\\s*\\,\\s*("+e+")\\s*,\\s*("+Y+")\\s*\\,\\s*("+Y+")\\)$"},i=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];ze.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},axisDirectionExplicit:{enums:["leftward","rightward","upward","downward"]},axisDirectionPrimary:{enums:["horizontal","vertical"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},boxSelection:{enums:["contain","overlap","none"]},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle","circle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:r("data")},layoutData:{mapping:!0,regex:r("layoutData")},scratch:{mapping:!0,regex:r("scratch")},mapData:{mapping:!0,regex:a("mapData")},mapLayoutData:{mapping:!0,regex:a("mapLayoutData")},mapScratch:{mapping:!0,regex:a("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:i,singleRegexMatchValue:!0},urls:{regexes:i,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(O,Y){switch(O.length){case 2:return Y[0]!=="deg"&&Y[0]!=="rad"&&Y[1]!=="deg"&&Y[1]!=="rad";case 1:return pe(O[0])||Y[0]==="deg"||Y[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+e+")\\s*,\\s*("+e+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+e+")\\s*,\\s*("+e+")\\s*,\\s*("+e+")\\s*,\\s*("+e+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(O){var Y=O.length;return Y===1||Y===2||Y===4}}};var o={zeroNonZero:function(O,Y){return(O==null||Y==null)&&O!==Y||O==0&&Y!=0||O!=0&&Y==0},any:function(O,Y){return O!=Y},emptyNonEmpty:function(O,Y){var $=Lt(O),J=Lt(Y);return $&&!J||!$&&J}},s=ze.types,l=[{name:"label",type:s.text,triggersBounds:o.any,triggersZOrder:o.emptyNonEmpty},{name:"text-rotation",type:s.textRotation,triggersBounds:o.any},{name:"text-margin-x",type:s.bidirectionalSize,triggersBounds:o.any},{name:"text-margin-y",type:s.bidirectionalSize,triggersBounds:o.any}],u=[{name:"source-label",type:s.text,triggersBounds:o.any},{name:"source-text-rotation",type:s.textRotation,triggersBounds:o.any},{name:"source-text-margin-x",type:s.bidirectionalSize,triggersBounds:o.any},{name:"source-text-margin-y",type:s.bidirectionalSize,triggersBounds:o.any},{name:"source-text-offset",type:s.size,triggersBounds:o.any}],c=[{name:"target-label",type:s.text,triggersBounds:o.any},{name:"target-text-rotation",type:s.textRotation,triggersBounds:o.any},{name:"target-text-margin-x",type:s.bidirectionalSize,triggersBounds:o.any},{name:"target-text-margin-y",type:s.bidirectionalSize,triggersBounds:o.any},{name:"target-text-offset",type:s.size,triggersBounds:o.any}],d=[{name:"font-family",type:s.fontFamily,triggersBounds:o.any},{name:"font-style",type:s.fontStyle,triggersBounds:o.any},{name:"font-weight",type:s.fontWeight,triggersBounds:o.any},{name:"font-size",type:s.size,triggersBounds:o.any},{name:"text-transform",type:s.textTransform,triggersBounds:o.any},{name:"text-wrap",type:s.textWrap,triggersBounds:o.any},{name:"text-overflow-wrap",type:s.textOverflowWrap,triggersBounds:o.any},{name:"text-max-width",type:s.size,triggersBounds:o.any},{name:"text-outline-width",type:s.size,triggersBounds:o.any},{name:"line-height",type:s.positiveNumber,triggersBounds:o.any}],h=[{name:"text-valign",type:s.valign,triggersBounds:o.any},{name:"text-halign",type:s.halign,triggersBounds:o.any},{name:"color",type:s.color},{name:"text-outline-color",type:s.color},{name:"text-outline-opacity",type:s.zeroOneNumber},{name:"text-background-color",type:s.color},{name:"text-background-opacity",type:s.zeroOneNumber},{name:"text-background-padding",type:s.size,triggersBounds:o.any},{name:"text-border-opacity",type:s.zeroOneNumber},{name:"text-border-color",type:s.color},{name:"text-border-width",type:s.size,triggersBounds:o.any},{name:"text-border-style",type:s.borderStyle,triggersBounds:o.any},{name:"text-background-shape",type:s.textBackgroundShape,triggersBounds:o.any},{name:"text-justification",type:s.justification},{name:"box-select-labels",type:s.bool,triggersBounds:o.any}],p=[{name:"events",type:s.bool,triggersZOrder:o.any},{name:"text-events",type:s.bool,triggersZOrder:o.any},{name:"box-selection",type:s.boxSelection,triggersZOrder:o.any}],f=[{name:"display",type:s.display,triggersZOrder:o.any,triggersBounds:o.any,triggersBoundsOfConnectedEdges:o.any,triggersBoundsOfParallelEdges:function(O,Y,$){return O!==Y&&$.pstyle("curve-style").value==="bezier"}},{name:"visibility",type:s.visibility,triggersZOrder:o.any},{name:"opacity",type:s.zeroOneNumber,triggersZOrder:o.zeroNonZero},{name:"text-opacity",type:s.zeroOneNumber},{name:"min-zoomed-font-size",type:s.size},{name:"z-compound-depth",type:s.zCompoundDepth,triggersZOrder:o.any},{name:"z-index-compare",type:s.zIndexCompare,triggersZOrder:o.any},{name:"z-index",type:s.number,triggersZOrder:o.any}],g=[{name:"overlay-padding",type:s.size,triggersBounds:o.any},{name:"overlay-color",type:s.color},{name:"overlay-opacity",type:s.zeroOneNumber,triggersBounds:o.zeroNonZero},{name:"overlay-shape",type:s.overlayShape,triggersBounds:o.any},{name:"overlay-corner-radius",type:s.cornerRadius}],v=[{name:"underlay-padding",type:s.size,triggersBounds:o.any},{name:"underlay-color",type:s.color},{name:"underlay-opacity",type:s.zeroOneNumber,triggersBounds:o.zeroNonZero},{name:"underlay-shape",type:s.overlayShape,triggersBounds:o.any},{name:"underlay-corner-radius",type:s.cornerRadius}],y=[{name:"transition-property",type:s.propList},{name:"transition-duration",type:s.time},{name:"transition-delay",type:s.time},{name:"transition-timing-function",type:s.easing}],b=function(O,Y){return Y.value==="label"?-O.poolIndex():Y.pfValue},m=[{name:"height",type:s.nodeSize,triggersBounds:o.any,hashOverride:b},{name:"width",type:s.nodeSize,triggersBounds:o.any,hashOverride:b},{name:"shape",type:s.nodeShape,triggersBounds:o.any},{name:"shape-polygon-points",type:s.polygonPointList,triggersBounds:o.any},{name:"corner-radius",type:s.cornerRadius},{name:"background-color",type:s.color},{name:"background-fill",type:s.fill},{name:"background-opacity",type:s.zeroOneNumber},{name:"background-blacken",type:s.nOneOneNumber},{name:"background-gradient-stop-colors",type:s.colors},{name:"background-gradient-stop-positions",type:s.percentages},{name:"background-gradient-direction",type:s.gradientDirection},{name:"padding",type:s.sizeMaybePercent,triggersBounds:o.any},{name:"padding-relative-to",type:s.paddingRelativeTo,triggersBounds:o.any},{name:"bounds-expansion",type:s.boundsExpansion,triggersBounds:o.any}],w=[{name:"border-color",type:s.color},{name:"border-opacity",type:s.zeroOneNumber},{name:"border-width",type:s.size,triggersBounds:o.any},{name:"border-style",type:s.borderStyle},{name:"border-cap",type:s.lineCap},{name:"border-join",type:s.lineJoin},{name:"border-dash-pattern",type:s.numbers},{name:"border-dash-offset",type:s.number},{name:"border-position",type:s.linePosition}],k=[{name:"outline-color",type:s.color},{name:"outline-opacity",type:s.zeroOneNumber},{name:"outline-width",type:s.size,triggersBounds:o.any},{name:"outline-style",type:s.borderStyle},{name:"outline-offset",type:s.size,triggersBounds:o.any}],E=[{name:"background-image",type:s.urls},{name:"background-image-crossorigin",type:s.bgCrossOrigin},{name:"background-image-opacity",type:s.zeroOneNumbers},{name:"background-image-containment",type:s.bgContainment},{name:"background-image-smoothing",type:s.bools},{name:"background-position-x",type:s.bgPos},{name:"background-position-y",type:s.bgPos},{name:"background-width-relative-to",type:s.bgRelativeTo},{name:"background-height-relative-to",type:s.bgRelativeTo},{name:"background-repeat",type:s.bgRepeat},{name:"background-fit",type:s.bgFit},{name:"background-clip",type:s.bgClip},{name:"background-width",type:s.bgWH},{name:"background-height",type:s.bgWH},{name:"background-offset-x",type:s.bgPos},{name:"background-offset-y",type:s.bgPos}],x=[{name:"position",type:s.position,triggersBounds:o.any},{name:"compound-sizing-wrt-labels",type:s.compoundIncludeLabels,triggersBounds:o.any},{name:"min-width",type:s.size,triggersBounds:o.any},{name:"min-width-bias-left",type:s.sizeMaybePercent,triggersBounds:o.any},{name:"min-width-bias-right",type:s.sizeMaybePercent,triggersBounds:o.any},{name:"min-height",type:s.size,triggersBounds:o.any},{name:"min-height-bias-top",type:s.sizeMaybePercent,triggersBounds:o.any},{name:"min-height-bias-bottom",type:s.sizeMaybePercent,triggersBounds:o.any}],S=[{name:"line-style",type:s.lineStyle},{name:"line-color",type:s.color},{name:"line-fill",type:s.fill},{name:"line-cap",type:s.lineCap},{name:"line-opacity",type:s.zeroOneNumber},{name:"line-dash-pattern",type:s.numbers},{name:"line-dash-offset",type:s.number},{name:"line-outline-width",type:s.size},{name:"line-outline-color",type:s.color},{name:"line-gradient-stop-colors",type:s.colors},{name:"line-gradient-stop-positions",type:s.percentages},{name:"curve-style",type:s.curveStyle,triggersBounds:o.any,triggersBoundsOfParallelEdges:function(O,Y){return O!==Y&&(O==="bezier"||Y==="bezier")}},{name:"haystack-radius",type:s.zeroOneNumber,triggersBounds:o.any},{name:"source-endpoint",type:s.edgeEndpoint,triggersBounds:o.any},{name:"target-endpoint",type:s.edgeEndpoint,triggersBounds:o.any},{name:"control-point-step-size",type:s.size,triggersBounds:o.any},{name:"control-point-distances",type:s.bidirectionalSizes,triggersBounds:o.any},{name:"control-point-weights",type:s.numbers,triggersBounds:o.any},{name:"segment-distances",type:s.bidirectionalSizes,triggersBounds:o.any},{name:"segment-weights",type:s.numbers,triggersBounds:o.any},{name:"segment-radii",type:s.numbers,triggersBounds:o.any},{name:"radius-type",type:s.radiusType,triggersBounds:o.any},{name:"taxi-turn",type:s.bidirectionalSizeMaybePercent,triggersBounds:o.any},{name:"taxi-turn-min-distance",type:s.size,triggersBounds:o.any},{name:"taxi-direction",type:s.axisDirection,triggersBounds:o.any},{name:"taxi-radius",type:s.number,triggersBounds:o.any},{name:"edge-distances",type:s.edgeDistances,triggersBounds:o.any},{name:"arrow-scale",type:s.positiveNumber,triggersBounds:o.any},{name:"loop-direction",type:s.angle,triggersBounds:o.any},{name:"loop-sweep",type:s.angle,triggersBounds:o.any},{name:"source-distance-from-node",type:s.size,triggersBounds:o.any},{name:"target-distance-from-node",type:s.size,triggersBounds:o.any}],P=[{name:"ghost",type:s.bool,triggersBounds:o.any},{name:"ghost-offset-x",type:s.bidirectionalSize,triggersBounds:o.any},{name:"ghost-offset-y",type:s.bidirectionalSize,triggersBounds:o.any},{name:"ghost-opacity",type:s.zeroOneNumber}],T=[{name:"selection-box-color",type:s.color},{name:"selection-box-opacity",type:s.zeroOneNumber},{name:"selection-box-border-color",type:s.color},{name:"selection-box-border-width",type:s.size},{name:"active-bg-color",type:s.color},{name:"active-bg-opacity",type:s.zeroOneNumber},{name:"active-bg-size",type:s.size},{name:"outside-texture-bg-color",type:s.color},{name:"outside-texture-bg-opacity",type:s.zeroOneNumber}],D=[];ze.pieBackgroundN=16,D.push({name:"pie-size",type:s.sizeMaybePercent}),D.push({name:"pie-hole",type:s.sizeMaybePercent}),D.push({name:"pie-start-angle",type:s.angle});for(var A=1;A<=ze.pieBackgroundN;A++)D.push({name:"pie-"+A+"-background-color",type:s.color}),D.push({name:"pie-"+A+"-background-size",type:s.percent}),D.push({name:"pie-"+A+"-background-opacity",type:s.zeroOneNumber});var B=[];ze.stripeBackgroundN=16,B.push({name:"stripe-size",type:s.sizeMaybePercent}),B.push({name:"stripe-direction",type:s.axisDirectionPrimary});for(var M=1;M<=ze.stripeBackgroundN;M++)B.push({name:"stripe-"+M+"-background-color",type:s.color}),B.push({name:"stripe-"+M+"-background-size",type:s.percent}),B.push({name:"stripe-"+M+"-background-opacity",type:s.zeroOneNumber});var I=[],R=ze.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:s.arrowShape,triggersBounds:o.any},{name:"arrow-color",type:s.color},{name:"arrow-fill",type:s.arrowFill},{name:"arrow-width",type:s.arrowWidth}].forEach(function(O){R.forEach(function(Y){var $=Y+"-"+O.name,J=O.type,ne=O.triggersBounds;I.push({name:$,type:J,triggersBounds:ne})})},{});var _=ze.properties=[].concat(p,y,f,g,v,P,h,d,l,u,c,m,w,k,E,D,B,x,S,I,T),z=ze.propertyGroups={behavior:p,transition:y,visibility:f,overlay:g,underlay:v,ghost:P,commonLabel:h,labelDimensions:d,mainLabel:l,sourceLabel:u,targetLabel:c,nodeBody:m,nodeBorder:w,nodeOutline:k,backgroundImage:E,pie:D,stripe:B,compound:x,edgeLine:S,edgeArrow:I,core:T},V=ze.propertyGroupNames={};(ze.propertyGroupKeys=Object.keys(z)).forEach(function(O){V[O]=z[O].map(function(Y){return Y.name}),z[O].forEach(function(Y){return Y.groupKey=O})});var L=ze.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];ze.propertyNames=_.map(function(O){return O.name});for(var X=0;X<_.length;X++){var W=_[X];_[W.name]=W}for(var G=0;G<L.length;G++){var U=L[G],Q=_[U.pointsTo],F={name:U.name,alias:!0,pointsTo:Q};_.push(F),_[U.name]=F}})(),ze.getDefaultProperty=function(e){return this.getDefaultProperties()[e]},ze.getDefaultProperties=function(){var e=this._private;if(e.defaultProperties!=null)return e.defaultProperties;for(var t=ge({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","box-selection":"contain","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","box-select-labels":"no","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%","pie-hole":0,"pie-start-angle":"0deg"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var c=1;c<=ze.pieBackgroundN;c++){var d=u.name.replace("{{i}}",c),h=u.value;l[d]=h}return l},{}),{"stripe-size":"100%","stripe-direction":"horizontal"},[{name:"stripe-{{i}}-background-color",value:"black"},{name:"stripe-{{i}}-background-size",value:"0%"},{name:"stripe-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var c=1;c<=ze.stripeBackgroundN;c++){var d=u.name.replace("{{i}}",c),h=u.value;l[d]=h}return l},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(l,u){return ze.arrowPrefixes.forEach(function(c){var d=c+"-"+u.name,h=u.value;l[d]=h}),l},{})),n={},r=0;r<this.properties.length;r++){var a=this.properties[r];if(!a.pointsTo){var i=a.name,o=t[i],s=this.parse(i,o);n[i]=s}}return e.defaultProperties=n,e.defaultProperties},ze.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var Ju={parse:function(e,t,n,r){var a=this;if(Ie(t))return a.parseImplWarn(e,t,n,r);var i,o=Go(e,""+t,n?"t":"f",r==="mapping"||r===!0||r===!1||r==null?"dontcare":r),s=a.propCache=a.propCache||[];return(i=s[o])||(i=s[o]=a.parseImplWarn(e,t,n,r)),(n||r==="mapping")&&(i=Et(i))&&(i.value=Et(i.value)),i},parseImplWarn:function(e,t,n,r){var a=this.parseImpl(e,t,n,r);return a||t==null||ke("The style property `".concat(e,": ").concat(t,"` is invalid")),!a||a.name!=="width"&&a.name!=="height"||t!=="label"||ke("The style value of `label` is deprecated for `"+a.name+"`"),a}};Ju.parseImpl=function(e,t,n,r){var a=this;e=wa(e);var i=a.properties[e],o=t,s=a.types;if(!i||t===void 0)return null;i.alias&&(i=i.pointsTo,e=i.name);var l=pe(t);l&&(t=t.trim());var u,c,d=i.type;if(!d)return null;if(n&&(t===""||t===null))return{name:e,value:t,bypass:!0,deleteBypass:!0};if(Ie(t))return{name:e,value:t,strValue:"fn",mapped:s.fn,bypass:n};if(!(!l||r||t.length<7||t[1]!=="a")){if(t.length>=7&&t[0]==="d"&&(u=new RegExp(s.data.regex).exec(t))){if(n)return!1;var h=s.data;return{name:e,value:u,strValue:""+t,mapped:h,field:u[1],bypass:n}}if(t.length>=10&&t[0]==="m"&&(c=new RegExp(s.mapData.regex).exec(t))){if(n||d.multiple)return!1;var p=s.mapData;if(!d.color&&!d.number)return!1;var f=this.parse(e,c[4]);if(!f||f.mapped)return!1;var g=this.parse(e,c[5]);if(!g||g.mapped)return!1;if(f.pfValue===g.pfValue||f.strValue===g.strValue)return ke("`"+e+": "+t+"` is not a valid mapper because the output range is zero; converting to `"+e+": "+f.strValue+"`"),this.parse(e,f.strValue);if(d.color){var v=f.value,y=g.value;if(!(v[0]!==y[0]||v[1]!==y[1]||v[2]!==y[2]||v[3]!==y[3]&&(v[3]!=null&&v[3]!==1||y[3]!=null&&y[3]!==1)))return!1}return{name:e,value:c,strValue:""+t,mapped:p,field:c[1],fieldMin:parseFloat(c[2]),fieldMax:parseFloat(c[3]),valueMin:f.value,valueMax:g.value,bypass:n}}}if(d.multiple&&r!=="multiple"){var b;if(b=l?t.split(/\s+/):Ce(t)?t:[t],d.evenMultiple&&b.length%2!=0)return null;for(var m=[],w=[],k=[],E="",x=!1,S=0;S<b.length;S++){var P=a.parse(e,b[S],n,"multiple");x=x||pe(P.value),m.push(P.value),k.push(P.pfValue!=null?P.pfValue:P.value),w.push(P.units),E+=(S>0?" ":"")+P.strValue}return d.validate&&!d.validate(m,w)?null:d.singleEnum&&x?m.length===1&&pe(m[0])?{name:e,value:m[0],strValue:m[0],bypass:n}:null:{name:e,value:m,pfValue:k,strValue:E,bypass:n,units:w}}var T,D,A=function(){for(var Y=0;Y<d.enums.length;Y++)if(d.enums[Y]===t)return{name:e,value:t,strValue:""+t,bypass:n};return null};if(d.number){var B,M="px";if(d.units&&(B=d.units),d.implicitUnits&&(M=d.implicitUnits),!d.unitless)if(l){var I="px|em"+(d.allowPercent?"|\\%":"");B&&(I=B);var R=t.match("^("+Xe+")("+I+")?$");R&&(t=R[1],B=R[2]||M)}else B&&!d.implicitUnits||(B=M);if(t=parseFloat(t),isNaN(t)&&d.enums===void 0)return null;if(isNaN(t)&&d.enums!==void 0)return t=o,A();if(d.integer&&(!oe(D=t)||Math.floor(D)!==D)||d.min!==void 0&&(t<d.min||d.strictMin&&t===d.min)||d.max!==void 0&&(t>d.max||d.strictMax&&t===d.max))return null;var _={name:e,value:t,strValue:""+t+(B||""),units:B,bypass:n};return d.unitless||B!=="px"&&B!=="em"?_.pfValue=t:_.pfValue=B!=="px"&&B?this.getEmSizeInPixels()*t:t,B!=="ms"&&B!=="s"||(_.pfValue=B==="ms"?t:1e3*t),B!=="deg"&&B!=="rad"||(_.pfValue=B==="rad"?t:(T=t,Math.PI*T/180)),B==="%"&&(_.pfValue=t/100),_}if(d.propList){var z=[],V=""+t;if(V!=="none"){for(var L=V.split(/\s*,\s*|\s+/),X=0;X<L.length;X++){var W=L[X].trim();a.properties[W]?z.push(W):ke("`"+W+"` is not a valid property name")}if(z.length===0)return null}return{name:e,value:z,strValue:z.length===0?"none":z.join(" "),bypass:n}}if(d.color){var G=Fo(t);return G?{name:e,value:G,pfValue:G,strValue:"rgb("+G[0]+","+G[1]+","+G[2]+")",bypass:n}:null}if(d.regex||d.regexes){if(d.enums){var U=A();if(U)return U}for(var Q=d.regexes?d.regexes:[d.regex],F=0;F<Q.length;F++){var O=new RegExp(Q[F]).exec(t);if(O)return{name:e,value:d.singleRegexMatchValue?O[1]:O,strValue:""+t,bypass:n}}return null}return d.string?{name:e,value:""+t,strValue:""+t,bypass:n}:d.enums?A():null};var Ge=function(e){if(!(this instanceof Ge))return new Ge(e);xa(e)?(this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()):Me("A style must have a core reference")},Je=Ge.prototype;Je.instanceString=function(){return"style"},Je.clear=function(){for(var e=this._private,t=e.cy.elements(),n=0;n<this.length;n++)this[n]=void 0;return this.length=0,e.contextStyles={},e.propDiffs={},this.cleanElements(t,!0),t.forEach(function(r){var a=r[0]._private;a.styleDirty=!0,a.appliedInitStyle=!1}),this},Je.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this},Je.core=function(e){return this._private.coreStyle[e]||this.getDefaultProperty(e)},Je.selector=function(e){var t=e==="core"?null:new qt(e),n=this.length++;return this[n]={selector:t,properties:[],mappedProperties:[],index:n},this},Je.css=function(){var e=arguments;if(e.length===1)for(var t=e[0],n=0;n<this.properties.length;n++){var r=this.properties[n],a=t[r.name];a===void 0&&(a=t[br(r.name)]),a!==void 0&&this.cssRule(r.name,a)}else e.length===2&&this.cssRule(e[0],e[1]);return this},Je.style=Je.css,Je.cssRule=function(e,t){var n=this.parse(e,t);if(n){var r=this.length-1;this[r].properties.push(n),this[r].properties[n.name]=n,n.name.match(/pie-(\d+)-background-size/)&&n.value&&(this._private.hasPie=!0),n.name.match(/stripe-(\d+)-background-size/)&&n.value&&(this._private.hasStripe=!0),n.mapped&&this[r].mappedProperties.push(n),!this[r].selector&&(this._private.coreStyle[n.name]=n)}return this},Je.append=function(e){return Lo(e)?e.appendToStyle(this):Ce(e)?this.appendFromJson(e):pe(e)&&this.appendFromString(e),this},Ge.fromJson=function(e,t){var n=new Ge(e);return n.fromJson(t),n},Ge.fromString=function(e,t){return new Ge(e).fromString(t)},[He,Tf,Cf,Ri,Pf,Sf,ze,Ju].forEach(function(e){ge(Je,e)}),Ge.types=Je.types,Ge.properties=Je.properties,Ge.propertyGroups=Je.propertyGroups,Ge.propertyGroupNames=Je.propertyGroupNames,Ge.propertyGroupKeys=Je.propertyGroupKeys;var Bf={style:function(e){return e&&this.setStyle(e).update(),this._private.style},setStyle:function(e){var t=this._private;return Lo(e)?t.style=e.generateStyle(this):Ce(e)?t.style=Ge.fromJson(this,e):pe(e)?t.style=Ge.fromString(this,e):t.style=Ge(this),t.style},updateStyle:function(){this.mutableElements().updateStyle()}},on={autolock:function(e){return e===void 0?this._private.autolock:(this._private.autolock=!!e,this)},autoungrabify:function(e){return e===void 0?this._private.autoungrabify:(this._private.autoungrabify=!!e,this)},autounselectify:function(e){return e===void 0?this._private.autounselectify:(this._private.autounselectify=!!e,this)},selectionType:function(e){var t=this._private;return t.selectionType==null&&(t.selectionType="single"),e===void 0?t.selectionType:(e!=="additive"&&e!=="single"||(t.selectionType=e),this)},panningEnabled:function(e){return e===void 0?this._private.panningEnabled:(this._private.panningEnabled=!!e,this)},userPanningEnabled:function(e){return e===void 0?this._private.userPanningEnabled:(this._private.userPanningEnabled=!!e,this)},zoomingEnabled:function(e){return e===void 0?this._private.zoomingEnabled:(this._private.zoomingEnabled=!!e,this)},userZoomingEnabled:function(e){return e===void 0?this._private.userZoomingEnabled:(this._private.userZoomingEnabled=!!e,this)},boxSelectionEnabled:function(e){return e===void 0?this._private.boxSelectionEnabled:(this._private.boxSelectionEnabled=!!e,this)},pan:function(){var e,t,n,r,a,i=arguments,o=this._private.pan;switch(i.length){case 0:return o;case 1:if(pe(i[0]))return o[e=i[0]];if(xe(i[0])){if(!this._private.panningEnabled)return this;r=(n=i[0]).x,a=n.y,oe(r)&&(o.x=r),oe(a)&&(o.y=a),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;t=i[1],(e=i[0])!=="x"&&e!=="y"||!oe(t)||(o[e]=t),this.emit("pan viewport")}return this.notify("viewport"),this},panBy:function(e,t){var n,r,a,i,o,s=arguments,l=this._private.pan;if(!this._private.panningEnabled)return this;switch(s.length){case 1:xe(e)&&(i=(a=s[0]).x,o=a.y,oe(i)&&(l.x+=i),oe(o)&&(l.y+=o),this.emit("pan viewport"));break;case 2:r=t,(n=e)!=="x"&&n!=="y"||!oe(r)||(l[n]+=r),this.emit("pan viewport")}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(e,t){var n=this.getFitViewport(e,t);if(n){var r=this._private;r.zoom=n.zoom,r.pan=n.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,t){if(oe(e)&&t===void 0&&(t=e,e=void 0),this._private.panningEnabled&&this._private.zoomingEnabled){var n,r;if(pe(e)){var a=e;e=this.$(a)}else if(xe(r=e)&&oe(r.x1)&&oe(r.x2)&&oe(r.y1)&&oe(r.y2)){var i=e;(n={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2}).w=n.x2-n.x1,n.h=n.y2-n.y1}else lt(e)||(e=this.mutableElements());if(!lt(e)||!e.empty()){n=n||e.boundingBox();var o,s=this.width(),l=this.height();if(t=oe(t)?t:0,!isNaN(s)&&!isNaN(l)&&s>0&&l>0&&!isNaN(n.w)&&!isNaN(n.h)&&n.w>0&&n.h>0)return{zoom:o=(o=(o=Math.min((s-2*t)/n.w,(l-2*t)/n.h))>this._private.maxZoom?this._private.maxZoom:o)<this._private.minZoom?this._private.minZoom:o,pan:{x:(s-o*(n.x1+n.x2))/2,y:(l-o*(n.y1+n.y2))/2}}}}},zoomRange:function(e,t){var n=this._private;if(t==null){var r=e;e=r.min,t=r.max}return oe(e)&&oe(t)&&e<=t?(n.minZoom=e,n.maxZoom=t):oe(e)&&t===void 0&&e<=n.maxZoom?n.minZoom=e:oe(t)&&e===void 0&&t>=n.minZoom&&(n.maxZoom=t),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var t,n,r=this._private,a=r.pan,i=r.zoom,o=!1;if(r.zoomingEnabled||(o=!0),oe(e)?n=e:xe(e)&&(n=e.level,e.position!=null?t=Pr(e.position,i,a):e.renderedPosition!=null&&(t=e.renderedPosition),t==null||r.panningEnabled||(o=!0)),n=(n=n>r.maxZoom?r.maxZoom:n)<r.minZoom?r.minZoom:n,o||!oe(n)||n===i||t!=null&&(!oe(t.x)||!oe(t.y)))return null;if(t!=null){var s=a,l=i,u=n;return{zoomed:!0,panned:!0,zoom:u,pan:{x:-u/l*(t.x-s.x)+t.x,y:-u/l*(t.y-s.y)+t.y}}}return{zoomed:!0,panned:!1,zoom:n,pan:a}},zoom:function(e){if(e===void 0)return this._private.zoom;var t=this.getZoomedViewport(e),n=this._private;return t!=null&&t.zoomed?(n.zoom=t.zoom,t.panned&&(n.pan.x=t.pan.x,n.pan.y=t.pan.y),this.emit("zoom"+(t.panned?" pan":"")+" viewport"),this.notify("viewport"),this):this},viewport:function(e){var t=this._private,n=!0,r=!0,a=[],i=!1,o=!1;if(!e)return this;if(oe(e.zoom)||(n=!1),xe(e.pan)||(r=!1),!n&&!r)return this;if(n){var s=e.zoom;s<t.minZoom||s>t.maxZoom||!t.zoomingEnabled?i=!0:(t.zoom=s,a.push("zoom"))}if(r&&(!i||!e.cancelOnFailedZoom)&&t.panningEnabled){var l=e.pan;oe(l.x)&&(t.pan.x=l.x,o=!1),oe(l.y)&&(t.pan.y=l.y,o=!1),o||a.push("pan")}return a.length>0&&(a.push("viewport"),this.emit(a.join(" ")),this.notify("viewport")),this},center:function(e){var t=this.getCenterPan(e);return t&&(this._private.pan=t,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,t){if(this._private.panningEnabled){if(pe(e)){var n=e;e=this.mutableElements().filter(n)}else lt(e)||(e=this.mutableElements());if(e.length!==0){var r=e.boundingBox(),a=this.width(),i=this.height();return{x:(a-(t=t===void 0?this._private.zoom:t)*(r.x1+r.x2))/2,y:(i-t*(r.y1+r.y2))/2}}}},reset:function(){return this._private.panningEnabled&&this._private.zoomingEnabled?(this.viewport({pan:{x:0,y:0},zoom:1}),this):this},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e,t,n=this._private,r=n.container,a=this;return n.sizeCache=n.sizeCache||(r?(e=a.window().getComputedStyle(r),t=function(i){return parseFloat(e.getPropertyValue(i))},{width:r.clientWidth-t("padding-left")-t("padding-right"),height:r.clientHeight-t("padding-top")-t("padding-bottom")}):{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,t=this._private.zoom,n=this.renderedExtent(),r={x1:(n.x1-e.x)/t,x2:(n.x2-e.x)/t,y1:(n.y1-e.y)/t,y2:(n.y2-e.y)/t};return r.w=r.x2-r.x1,r.h=r.y2-r.y1,r},renderedExtent:function(){var e=this.width(),t=this.height();return{x1:0,y1:0,x2:e,y2:t,w:e,h:t}},multiClickDebounceTime:function(e){return e?(this._private.multiClickDebounceTime=e,this):this._private.multiClickDebounceTime}};on.centre=on.center,on.autolockNodes=on.autolock,on.autoungrabifyNodes=on.autoungrabify;var lr={data:Te.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:Te.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:Te.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Te.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};lr.attr=lr.data,lr.removeAttr=lr.removeData;var ur=function(e){var t=this,n=(e=ge({},e)).container;n&&!mr(n)&&mr(n[0])&&(n=n[0]);var r=n?n._cyreg:null;(r=r||{})&&r.cy&&(r.cy.destroy(),r={});var a=r.readies=r.readies||[];n&&(n._cyreg=r),r.cy=t;var i=je!==void 0&&n!==void 0&&!e.headless,o=e;o.layout=ge({name:i?"grid":"null"},o.layout),o.renderer=ge({name:i?"canvas":"null"},o.renderer);var s=function(c,d,h){return d!==void 0?d:h!==void 0?h:c},l=this._private={container:n,ready:!1,options:o,elements:new Ze(this),listeners:[],aniEles:new Ze(this),data:o.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:s(!0,o.zoomingEnabled),userZoomingEnabled:s(!0,o.userZoomingEnabled),panningEnabled:s(!0,o.panningEnabled),userPanningEnabled:s(!0,o.userPanningEnabled),boxSelectionEnabled:s(!0,o.boxSelectionEnabled),autolock:s(!1,o.autolock,o.autolockNodes),autoungrabify:s(!1,o.autoungrabify,o.autoungrabifyNodes),autounselectify:s(!1,o.autounselectify),styleEnabled:o.styleEnabled===void 0?i:o.styleEnabled,zoom:oe(o.zoom)?o.zoom:1,pan:{x:xe(o.pan)&&oe(o.pan.x)?o.pan.x:0,y:xe(o.pan)&&oe(o.pan.y)?o.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:s(250,o.multiClickDebounceTime)};this.createEmitter(),this.selectionType(o.selectionType),this.zoomRange({min:o.minZoom,max:o.maxZoom}),l.styleEnabled&&t.setStyle([]);var u=ge({},o,o.renderer);t.initRenderer(u),function(c,d){if(c.some(vd))return Tn.all(c).then(d);d(c)}([o.style,o.elements],function(c){var d=c[0],h=c[1];l.styleEnabled&&t.style().append(d),function(p,f,g){t.notifications(!1);var v=t.mutableElements();v.length>0&&v.remove(),p!=null&&(xe(p)||Ce(p))&&t.add(p),t.one("layoutready",function(b){t.notifications(!0),t.emit(b),t.one("load",f),t.emitAndNotify("load")}).one("layoutstop",function(){t.one("done",g),t.emit("done")});var y=ge({},t._private.options.layout);y.eles=t.elements(),t.layout(y).run()}(h,function(){t.startAnimationLoop(),l.ready=!0,Ie(o.ready)&&t.on("ready",o.ready);for(var p=0;p<a.length;p++){var f=a[p];t.on("ready",f)}r&&(r.readies=[]),t.emit("ready")},o.done)})},oa=ur.prototype;ge(oa,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},window:function(){if(this._private.container==null)return je;var e=this._private.container.ownerDocument;return e===void 0||e==null?je:e.defaultView||je},mount:function(e){if(e!=null){var t=this,n=t._private,r=n.options;return!mr(e)&&mr(e[0])&&(e=e[0]),t.stopAnimationLoop(),t.destroyRenderer(),n.container=e,n.styleEnabled=!0,t.invalidateSize(),t.initRenderer(ge({},r,r.renderer,{name:r.renderer.name==="null"?"canvas":r.renderer.name})),t.startAnimationLoop(),t.style(r.style),t.emit("mount"),t}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return Et(this._private.options)},json:function(e){var t=this,n=t._private,r=t.mutableElements();if(xe(e)){if(t.startBatch(),e.elements){var a={},i=function(v,y){for(var b=[],m=[],w=0;w<v.length;w++){var k=v[w];if(k.data.id){var E=""+k.data.id,x=t.getElementById(E);a[E]=!0,x.length!==0?m.push({ele:x,json:k}):(y&&(k.group=y),b.push(k))}else ke("cy.json() cannot handle elements without an ID attribute")}t.add(b);for(var S=0;S<m.length;S++){var P=m[S],T=P.ele,D=P.json;T.json(D)}};if(Ce(e.elements))i(e.elements);else for(var o=["nodes","edges"],s=0;s<o.length;s++){var l=o[s],u=e.elements[l];Ce(u)&&i(u,l)}var c=t.collection();r.filter(function(v){return!a[v.id()]}).forEach(function(v){v.isParent()?c.merge(v):v.remove()}),c.forEach(function(v){return v.children().move({parent:null})}),c.forEach(function(v){return function(y){return t.getElementById(y.id())}(v).remove()})}e.style&&t.style(e.style),e.zoom!=null&&e.zoom!==n.zoom&&t.zoom(e.zoom),e.pan&&(e.pan.x===n.pan.x&&e.pan.y===n.pan.y||t.pan(e.pan)),e.data&&t.data(e.data);for(var d=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],h=0;h<d.length;h++){var p=d[h];e[p]!=null&&t[p](e[p])}return t.endBatch(),this}var f={};e?f.elements=this.elements().map(function(v){return v.json()}):(f.elements={},r.forEach(function(v){var y=v.group();f.elements[y]||(f.elements[y]=[]),f.elements[y].push(v.json())})),this._private.styleEnabled&&(f.style=t.style().json()),f.data=Et(t.data());var g=n.options;return f.zoomingEnabled=n.zoomingEnabled,f.userZoomingEnabled=n.userZoomingEnabled,f.zoom=n.zoom,f.minZoom=n.minZoom,f.maxZoom=n.maxZoom,f.panningEnabled=n.panningEnabled,f.userPanningEnabled=n.userPanningEnabled,f.pan=Et(n.pan),f.boxSelectionEnabled=n.boxSelectionEnabled,f.renderer=Et(g.renderer),f.hideEdgesOnViewport=g.hideEdgesOnViewport,f.textureOnViewport=g.textureOnViewport,f.wheelSensitivity=g.wheelSensitivity,f.motionBlur=g.motionBlur,f.multiClickDebounceTime=g.multiClickDebounceTime,f}}),oa.$id=oa.getElementById,[gf,xf,Qu,Ii,aa,Ef,Ni,ia,Bf,on,lr].forEach(function(e){ge(oa,e)});var _f={fit:!0,directed:!1,direction:"downward",padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}},Df={maximal:!1,acyclic:!1},In=function(e){return e.scratch("breadthfirst")},ec=function(e,t){return e.scratch("breadthfirst",t)};function tc(e){this.options=ge({},_f,Df,e)}tc.prototype.run=function(){var e,t=this.options,n=t.cy,r=t.eles,a=r.nodes().filter(function(te){return te.isChildless()}),i=r,o=t.directed,s=t.acyclic||t.maximal||t.maximalAdjustments>0,l=!!t.boundingBox,u=nt(l?t.boundingBox:structuredClone(n.extent()));if(lt(t.roots))e=t.roots;else if(Ce(t.roots)){for(var c=[],d=0;d<t.roots.length;d++){var h=t.roots[d],p=n.getElementById(h);c.push(p)}e=n.collection(c)}else if(pe(t.roots))e=n.$(t.roots);else if(o)e=a.roots();else{var f=r.components();e=n.collection();for(var g=function(){var te=f[v],se=te.maxDegree(!1),de=te.filter(function(ue){return ue.degree(!1)===se});e=e.add(de)},v=0;v<f.length;v++)g()}var y=[],b={},m=function(te,se){y[se]==null&&(y[se]=[]);var de=y[se].length;y[se].push(te),ec(te,{index:de,depth:se})};i.bfs({roots:e,directed:t.directed,visit:function(te,se,de,ue,C){var N=te[0],j=N.id();N.isChildless()&&m(N,C),b[j]=!0}});for(var w=[],k=0;k<a.length;k++){var E=a[k];b[E.id()]||w.push(E)}var x=function(te){for(var se=y[te],de=0;de<se.length;de++){var ue=se[de];ue!=null?ec(ue,{depth:te,index:de}):(se.splice(de,1),de--)}},S=function(te,se){for(var de=In(te),ue=te.incomers().filter(function(Z){return Z.isNode()&&r.has(Z)}),C=-1,N=te.id(),j=0;j<ue.length;j++){var H=ue[j],K=In(H);C=Math.max(C,K.depth)}if(de.depth<=C){if(!t.acyclic&&se[N])return null;var q=C+1;return function(Z,ee){var ae=In(Z),re=ae.depth,ye=ae.index;y[re][ye]=null,Z.isChildless()&&m(Z,ee)}(te,q),se[N]=q,!0}return!1};if(o&&s){var P=[],T={},D=function(te){return P.push(te)},A=function(){return P.shift()};for(a.forEach(function(te){return P.push(te)});P.length>0;){var B=A(),M=S(B,T);if(M)B.outgoers().filter(function(te){return te.isNode()&&r.has(te)}).forEach(D);else if(M===null){ke("Detected double maximal shift for node `"+B.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var I=0;if(t.avoidOverlap)for(var R=0;R<a.length;R++){var _=a[R].layoutDimensions(t),z=_.w,V=_.h;I=Math.max(I,z,V)}var L={},X=function(te){if(L[te.id()])return L[te.id()];for(var se=In(te).depth,de=te.neighborhood(),ue=0,C=0,N=0;N<de.length;N++){var j=de[N];if(!j.isEdge()&&!j.isParent()&&a.has(j)){var H=In(j);if(H!=null){var K=H.index,q=H.depth;if(K!=null&&q!=null){var Z=y[q].length;q<se&&(ue+=K/Z,C++)}}}}return ue/=C=Math.max(1,C),C===0&&(ue=0),L[te.id()]=ue,ue},W=function(te,se){var de=X(te)-X(se);return de===0?Vo(te.id(),se.id()):de};t.depthSort!==void 0&&(W=t.depthSort);for(var G=y.length,U=0;U<G;U++)y[U].sort(W),x(U);for(var Q=[],F=0;F<w.length;F++)Q.push(w[F]);Q.length&&(y.unshift(Q),G=y.length,function(){for(var te=0;te<G;te++)x(te)}());for(var O=0,Y=0;Y<G;Y++)O=Math.max(y[Y].length,O);var $=u.x1+u.w/2,J=u.y1+u.h/2,ne=a.reduce(function(te,se){return de=se.boundingBox({includeLabels:t.nodeDimensionsIncludeLabels}),{w:te.w===-1?de.w:(te.w+de.w)/2,h:te.h===-1?de.h:(te.h+de.h)/2};var de},{w:-1,h:-1}),le=Math.max(G===1?0:l?(u.h-2*t.padding-ne.h)/(G-1):(u.h-2*t.padding-ne.h)/(G+1),I),fe=y.reduce(function(te,se){return Math.max(te,se.length)},0),ce={downward:0,leftward:90,upward:180,rightward:-90};return Object.keys(ce).indexOf(t.direction)===-1&&Me("Invalid direction '".concat(t.direction,"' specified for breadthfirst layout. Valid values are: ").concat(Object.keys(ce).join(", "))),r.nodes().layoutPositions(this,t,function(te){return Cd(function(se){var de=In(se),ue=de.depth,C=de.index;if(t.circle){var N=Math.min(u.w/2/G,u.h/2/G),j=(N=Math.max(N,I))*ue+N-(G>0&&y[0].length<=3?N/2:0),H=2*Math.PI/y[ue].length*C;return ue===0&&y[0].length===1&&(j=1),{x:$+j*Math.cos(H),y:J+j*Math.sin(H)}}var K=y[ue].length,q=Math.max(K===1?0:l?(u.w-2*t.padding-ne.w)/((t.grid?fe:K)-1):(u.w-2*t.padding-ne.w)/((t.grid?fe:K)+1),I);return{x:$+(C+1-(K+1)/2)*q,y:J+(ue+1-(G+1)/2)*le}}(te),u,ce[t.direction])}),this};var Af={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:1.5*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function nc(e){this.options=ge({},Af,e)}nc.prototype.run=function(){var e=this.options,t=e,n=e.cy,r=t.eles,a=t.counterclockwise!==void 0?!t.counterclockwise:t.clockwise,i=r.nodes().not(":parent");t.sort&&(i=i.sort(t.sort));for(var o,s=nt(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),l=s.x1+s.w/2,u=s.y1+s.h/2,c=(t.sweep===void 0?2*Math.PI-2*Math.PI/i.length:t.sweep)/Math.max(1,i.length-1),d=0,h=0;h<i.length;h++){var p=i[h].layoutDimensions(t),f=p.w,g=p.h;d=Math.max(d,f,g)}if(o=oe(t.radius)?t.radius:i.length<=1?0:Math.min(s.h,s.w)/2-d,i.length>1&&t.avoidOverlap){d*=1.75;var v=Math.cos(c)-Math.cos(0),y=Math.sin(c)-Math.sin(0),b=Math.sqrt(d*d/(v*v+y*y));o=Math.max(b,o)}return r.nodes().layoutPositions(this,t,function(m,w){var k=t.startAngle+w*c*(a?1:-1),E=o*Math.cos(k),x=o*Math.sin(k);return{x:l+E,y:u+x}}),this};var rc,Mf={fit:!0,padding:30,startAngle:1.5*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function ac(e){this.options=ge({},Mf,e)}ac.prototype.run=function(){for(var e=this.options,t=e,n=t.counterclockwise!==void 0?!t.counterclockwise:t.clockwise,r=e.cy,a=t.eles,i=a.nodes().not(":parent"),o=nt(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()}),s=o.x1+o.w/2,l=o.y1+o.h/2,u=[],c=0,d=0;d<i.length;d++){var h,p=i[d];h=t.concentric(p),u.push({value:h,node:p}),p._private.scratch.concentric=h}i.updateStyle();for(var f=0;f<i.length;f++){var g=i[f].layoutDimensions(t);c=Math.max(c,g.w,g.h)}u.sort(function(ne,le){return le.value-ne.value});for(var v=t.levelWidth(i),y=[[]],b=y[0],m=0;m<u.length;m++){var w=u[m];b.length>0&&Math.abs(b[0].value-w.value)>=v&&(b=[],y.push(b)),b.push(w)}var k=c+t.minNodeSpacing;if(!t.avoidOverlap){var E=y.length>0&&y[0].length>1,x=(Math.min(o.w,o.h)/2-k)/(y.length+E?1:0);k=Math.min(k,x)}for(var S=0,P=0;P<y.length;P++){var T=y[P],D=t.sweep===void 0?2*Math.PI-2*Math.PI/T.length:t.sweep,A=T.dTheta=D/Math.max(1,T.length-1);if(T.length>1&&t.avoidOverlap){var B=Math.cos(A)-Math.cos(0),M=Math.sin(A)-Math.sin(0),I=Math.sqrt(k*k/(B*B+M*M));S=Math.max(I,S)}T.r=S,S+=k}if(t.equidistant){for(var R=0,_=0,z=0;z<y.length;z++){var V=y[z].r-_;R=Math.max(R,V)}_=0;for(var L=0;L<y.length;L++){var X=y[L];L===0&&(_=X.r),X.r=_,_+=R}}for(var W={},G=0;G<y.length;G++)for(var U=y[G],Q=U.dTheta,F=U.r,O=0;O<U.length;O++){var Y=U[O],$=t.startAngle+(n?1:-1)*Q*O,J={x:s+F*Math.cos($),y:l+F*Math.sin($)};W[Y.node.id()]=J}return a.nodes().layoutPositions(this,t,function(ne){var le=ne.id();return W[le]}),this};var If={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,t){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function sa(e){this.options=ge({},If,e),this.options.layout=this;var t=this.options.eles.nodes(),n=this.options.eles.edges().filter(function(r){var a=r.source().data("id"),i=r.target().data("id"),o=t.some(function(l){return l.data("id")===a}),s=t.some(function(l){return l.data("id")===i});return!o||!s});this.options.eles=this.options.eles.not(n)}sa.prototype.run=function(){var e=this.options,t=e.cy,n=this;n.stopped=!1,e.animate!==!0&&e.animate!==!1||n.emit({type:"layoutstart",layout:n}),rc=e.debug===!0;var r=Nf(t,n,e);rc&&(void 0)(r),e.randomize&&Lf(r);var a=St(),i=function(){zf(r,t,e),e.fit===!0&&t.fit(e.padding)},o=function(d){return!(n.stopped||d>=e.numIter)&&(Of(r,e),r.temperature=r.temperature*e.coolingFactor,!(r.temperature<e.minTemp))},s=function(){if(e.animate===!0||e.animate===!1)i(),n.one("layoutstop",e.stop),n.emit({type:"layoutstop",layout:n});else{var d=e.eles.nodes(),h=oc(r,e,d);d.layoutPositions(n,e,h)}},l=0,u=!0;if(e.animate===!0){var c=function(){for(var d=0;u&&d<e.refresh;)u=o(l),l++,d++;u?(St()-a>=e.animationThreshold&&i(),Er(c)):(uc(r,e),s())};c()}else{for(;u;)u=o(l),l++;uc(r,e),s()}return this},sa.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this},sa.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var Nf=function(e,t,n){for(var r=n.eles.edges(),a=n.eles.nodes(),i=nt(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),o={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:a.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:r.size(),temperature:n.initialTemp,clientWidth:i.w,clientHeight:i.h,boundingBox:i},s=n.eles.components(),l={},u=0;u<s.length;u++)for(var c=s[u],d=0;d<c.length;d++)l[c[d].id()]=u;for(u=0;u<o.nodeSize;u++){var h=(y=a[u]).layoutDimensions(n);(_={}).isLocked=y.locked(),_.id=y.data("id"),_.parentId=y.data("parent"),_.cmptId=l[y.id()],_.children=[],_.positionX=y.position("x"),_.positionY=y.position("y"),_.offsetX=0,_.offsetY=0,_.height=h.w,_.width=h.h,_.maxX=_.positionX+_.width/2,_.minX=_.positionX-_.width/2,_.maxY=_.positionY+_.height/2,_.minY=_.positionY-_.height/2,_.padLeft=parseFloat(y.style("padding")),_.padRight=parseFloat(y.style("padding")),_.padTop=parseFloat(y.style("padding")),_.padBottom=parseFloat(y.style("padding")),_.nodeRepulsion=Ie(n.nodeRepulsion)?n.nodeRepulsion(y):n.nodeRepulsion,o.layoutNodes.push(_),o.idToIndex[_.id]=u}var p=[],f=0,g=-1,v=[];for(u=0;u<o.nodeSize;u++){var y,b=(y=o.layoutNodes[u]).parentId;b!=null?o.layoutNodes[o.idToIndex[b]].children.push(y.id):(p[++g]=y.id,v.push(y.id))}for(o.graphSet.push(v);f<=g;){var m=p[f++],w=o.idToIndex[m],k=o.layoutNodes[w].children;if(k.length>0)for(o.graphSet.push(k),u=0;u<k.length;u++)p[++g]=k[u]}for(u=0;u<o.graphSet.length;u++){var E=o.graphSet[u];for(d=0;d<E.length;d++){var x=o.idToIndex[E[d]];o.indexToGraph[x]=u}}for(u=0;u<o.edgeSize;u++){var S=r[u],P={};P.id=S.data("id"),P.sourceId=S.data("source"),P.targetId=S.data("target");var T=Ie(n.idealEdgeLength)?n.idealEdgeLength(S):n.idealEdgeLength,D=Ie(n.edgeElasticity)?n.edgeElasticity(S):n.edgeElasticity,A=o.idToIndex[P.sourceId],B=o.idToIndex[P.targetId];if(o.indexToGraph[A]!=o.indexToGraph[B]){for(var M=Rf(P.sourceId,P.targetId,o),I=o.graphSet[M],R=0,_=o.layoutNodes[A];I.indexOf(_.id)===-1;)_=o.layoutNodes[o.idToIndex[_.parentId]],R++;for(_=o.layoutNodes[B];I.indexOf(_.id)===-1;)_=o.layoutNodes[o.idToIndex[_.parentId]],R++;T*=R*n.nestingFactor}P.idealLength=T,P.elasticity=D,o.layoutEdges.push(P)}return o},Rf=function(e,t,n){var r=ic(e,t,0,n);return 2>r.count?0:r.graph},ic=function(e,t,n,r){var a=r.graphSet[n];if(-1<a.indexOf(e)&&-1<a.indexOf(t))return{count:2,graph:n};for(var i=0,o=0;o<a.length;o++){var s=a[o],l=r.idToIndex[s],u=r.layoutNodes[l].children;if(u.length!==0){var c=r.indexToGraph[r.idToIndex[u[0]]],d=ic(e,t,c,r);if(d.count!==0){if(d.count!==1)return d;if(++i===2)break}}}return{count:i,graph:n}},Lf=function(e,t){for(var n=e.clientWidth,r=e.clientHeight,a=0;a<e.nodeSize;a++){var i=e.layoutNodes[a];i.children.length!==0||i.isLocked||(i.positionX=Math.random()*n,i.positionY=Math.random()*r)}},oc=function(e,t,n){var r=e.boundingBox,a={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return t.boundingBox&&(n.forEach(function(i){var o=e.layoutNodes[e.idToIndex[i.data("id")]];a.x1=Math.min(a.x1,o.positionX),a.x2=Math.max(a.x2,o.positionX),a.y1=Math.min(a.y1,o.positionY),a.y2=Math.max(a.y2,o.positionY)}),a.w=a.x2-a.x1,a.h=a.y2-a.y1),function(i,o){var s=e.layoutNodes[e.idToIndex[i.data("id")]];if(t.boundingBox){var l=a.w===0?.5:(s.positionX-a.x1)/a.w,u=a.h===0?.5:(s.positionY-a.y1)/a.h;return{x:r.x1+l*r.w,y:r.y1+u*r.h}}return{x:s.positionX,y:s.positionY}}},zf=function(e,t,n){var r=n.layout,a=n.eles.nodes(),i=oc(e,n,a);a.positions(i),e.ready!==!0&&(e.ready=!0,r.one("layoutready",n.ready),r.emit({type:"layoutready",layout:this}))},Of=function(e,t,n){Vf(e,t),jf(e),Xf(e,t),qf(e),Wf(e)},Vf=function(e,t){for(var n=0;n<e.graphSet.length;n++)for(var r=e.graphSet[n],a=r.length,i=0;i<a;i++)for(var o=e.layoutNodes[e.idToIndex[r[i]]],s=i+1;s<a;s++){var l=e.layoutNodes[e.idToIndex[r[s]]];Ff(o,l,e,t)}},sc=function(e){return 2*e*Math.random()-1},Ff=function(e,t,n,r){if(e.cmptId===t.cmptId||n.isCompound){var a=t.positionX-e.positionX,i=t.positionY-e.positionY;a===0&&i===0&&(a=sc(1),i=sc(1));var o=Yf(e,t,a,i);if(o>0)var s=(u=r.nodeOverlap*o)*a/(g=Math.sqrt(a*a+i*i)),l=u*i/g;else{var u,c=la(e,a,i),d=la(t,-1*a,-1*i),h=d.x-c.x,p=d.y-c.y,f=h*h+p*p,g=Math.sqrt(f);s=(u=(e.nodeRepulsion+t.nodeRepulsion)/f)*h/g,l=u*p/g}e.isLocked||(e.offsetX-=s,e.offsetY-=l),t.isLocked||(t.offsetX+=s,t.offsetY+=l)}},Yf=function(e,t,n,r){if(n>0)var a=e.maxX-t.minX;else a=t.maxX-e.minX;if(r>0)var i=e.maxY-t.minY;else i=t.maxY-e.minY;return a>=0&&i>=0?Math.sqrt(a*a+i*i):0},la=function(e,t,n){var r=e.positionX,a=e.positionY,i=e.height||1,o=e.width||1,s=n/t,l=i/o,u={};return t===0&&0<n||t===0&&0>n?(u.x=r,u.y=a+i/2,u):0<t&&-1*l<=s&&s<=l?(u.x=r+o/2,u.y=a+o*n/2/t,u):0>t&&-1*l<=s&&s<=l?(u.x=r-o/2,u.y=a-o*n/2/t,u):0<n&&(s<=-1*l||s>=l)?(u.x=r+i*t/2/n,u.y=a+i/2,u):(0>n&&(s<=-1*l||s>=l)&&(u.x=r-i*t/2/n,u.y=a-i/2),u)},jf=function(e,t){for(var n=0;n<e.edgeSize;n++){var r=e.layoutEdges[n],a=e.idToIndex[r.sourceId],i=e.layoutNodes[a],o=e.idToIndex[r.targetId],s=e.layoutNodes[o],l=s.positionX-i.positionX,u=s.positionY-i.positionY;if(l!==0||u!==0){var c=la(i,l,u),d=la(s,-1*l,-1*u),h=d.x-c.x,p=d.y-c.y,f=Math.sqrt(h*h+p*p),g=Math.pow(r.idealLength-f,2)/r.elasticity;if(f!==0)var v=g*h/f,y=g*p/f;else v=0,y=0;i.isLocked||(i.offsetX+=v,i.offsetY+=y),s.isLocked||(s.offsetX-=v,s.offsetY-=y)}}},Xf=function(e,t){if(t.gravity!==0)for(var n=0;n<e.graphSet.length;n++){var r=e.graphSet[n],a=r.length;if(n===0)var i=e.clientHeight/2,o=e.clientWidth/2;else{var s=e.layoutNodes[e.idToIndex[r[0]]],l=e.layoutNodes[e.idToIndex[s.parentId]];i=l.positionX,o=l.positionY}for(var u=0;u<a;u++){var c=e.layoutNodes[e.idToIndex[r[u]]];if(!c.isLocked){var d=i-c.positionX,h=o-c.positionY,p=Math.sqrt(d*d+h*h);if(p>1){var f=t.gravity*d/p,g=t.gravity*h/p;c.offsetX+=f,c.offsetY+=g}}}}},qf=function(e,t){var n=[],r=0,a=-1;for(n.push.apply(n,e.graphSet[0]),a+=e.graphSet[0].length;r<=a;){var i=n[r++],o=e.idToIndex[i],s=e.layoutNodes[o],l=s.children;if(0<l.length&&!s.isLocked){for(var u=s.offsetX,c=s.offsetY,d=0;d<l.length;d++){var h=e.layoutNodes[e.idToIndex[l[d]]];h.offsetX+=u,h.offsetY+=c,n[++a]=l[d]}s.offsetX=0,s.offsetY=0}}},Wf=function(e,t){for(var n=0;n<e.nodeSize;n++)0<(a=e.layoutNodes[n]).children.length&&(a.maxX=void 0,a.minX=void 0,a.maxY=void 0,a.minY=void 0);for(n=0;n<e.nodeSize;n++)if(!(0<(a=e.layoutNodes[n]).children.length||a.isLocked)){var r=Hf(a.offsetX,a.offsetY,e.temperature);a.positionX+=r.x,a.positionY+=r.y,a.offsetX=0,a.offsetY=0,a.minX=a.positionX-a.width,a.maxX=a.positionX+a.width,a.minY=a.positionY-a.height,a.maxY=a.positionY+a.height,lc(a,e)}for(n=0;n<e.nodeSize;n++){var a;0<(a=e.layoutNodes[n]).children.length&&!a.isLocked&&(a.positionX=(a.maxX+a.minX)/2,a.positionY=(a.maxY+a.minY)/2,a.width=a.maxX-a.minX,a.height=a.maxY-a.minY)}},Hf=function(e,t,n){var r=Math.sqrt(e*e+t*t);if(r>n)var a={x:n*e/r,y:n*t/r};else a={x:e,y:t};return a},lc=function(e,t){var n=e.parentId;if(n!=null){var r=t.layoutNodes[t.idToIndex[n]],a=!1;return(r.maxX==null||e.maxX+r.padRight>r.maxX)&&(r.maxX=e.maxX+r.padRight,a=!0),(r.minX==null||e.minX-r.padLeft<r.minX)&&(r.minX=e.minX-r.padLeft,a=!0),(r.maxY==null||e.maxY+r.padBottom>r.maxY)&&(r.maxY=e.maxY+r.padBottom,a=!0),(r.minY==null||e.minY-r.padTop<r.minY)&&(r.minY=e.minY-r.padTop,a=!0),a?lc(r,t):void 0}},uc=function(e,t){for(var n=e.layoutNodes,r=[],a=0;a<n.length;a++){var i=n[a],o=i.cmptId;(r[o]=r[o]||[]).push(i)}var s=0;for(a=0;a<r.length;a++)if(g=r[a]){g.x1=1/0,g.x2=-1/0,g.y1=1/0,g.y2=-1/0;for(var l=0;l<g.length;l++){var u=g[l];g.x1=Math.min(g.x1,u.positionX-u.width/2),g.x2=Math.max(g.x2,u.positionX+u.width/2),g.y1=Math.min(g.y1,u.positionY-u.height/2),g.y2=Math.max(g.y2,u.positionY+u.height/2)}g.w=g.x2-g.x1,g.h=g.y2-g.y1,s+=g.w*g.h}r.sort(function(v,y){return y.w*y.h-v.w*v.h});var c=0,d=0,h=0,p=0,f=Math.sqrt(s)*e.clientWidth/e.clientHeight;for(a=0;a<r.length;a++){var g;if(g=r[a]){for(l=0;l<g.length;l++)(u=g[l]).isLocked||(u.positionX+=c-g.x1,u.positionY+=d-g.y1);c+=g.w+t.componentSpacing,h+=g.w+t.componentSpacing,p=Math.max(p,g.h),h>f&&(d+=p+t.componentSpacing,c=0,h=0,p=0)}}},Gf={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function cc(e){this.options=ge({},Gf,e)}cc.prototype.run=function(){var e=this.options,t=e,n=e.cy,r=t.eles,a=r.nodes().not(":parent");t.sort&&(a=a.sort(t.sort));var i=nt(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()});if(i.h===0||i.w===0)r.nodes().layoutPositions(this,t,function(W){return{x:i.x1,y:i.y1}});else{var o=a.size(),s=Math.sqrt(o*i.h/i.w),l=Math.round(s),u=Math.round(i.w/i.h*s),c=function(W){if(W==null)return Math.min(l,u);Math.min(l,u)==l?l=W:u=W},d=function(W){if(W==null)return Math.max(l,u);Math.max(l,u)==l?l=W:u=W},h=t.rows,p=t.cols!=null?t.cols:t.columns;if(h!=null&&p!=null)l=h,u=p;else if(h!=null&&p==null)l=h,u=Math.ceil(o/l);else if(h==null&&p!=null)u=p,l=Math.ceil(o/u);else if(u*l>o){var f=c(),g=d();(f-1)*g>=o?c(f-1):(g-1)*f>=o&&d(g-1)}else for(;u*l<o;){var v=c(),y=d();(y+1)*v>=o?d(y+1):c(v+1)}var b=i.w/u,m=i.h/l;if(t.condense&&(b=0,m=0),t.avoidOverlap)for(var w=0;w<a.length;w++){var k=a[w],E=k._private.position;E.x!=null&&E.y!=null||(E.x=0,E.y=0);var x=k.layoutDimensions(t),S=t.avoidOverlapPadding,P=x.w+S,T=x.h+S;b=Math.max(b,P),m=Math.max(m,T)}for(var D={},A=function(W,G){return!!D["c-"+W+"-"+G]},B=function(W,G){D["c-"+W+"-"+G]=!0},M=0,I=0,R=function(){++I>=u&&(I=0,M++)},_={},z=0;z<a.length;z++){var V=a[z],L=t.position(V);if(L&&(L.row!==void 0||L.col!==void 0)){var X={row:L.row,col:L.col};if(X.col===void 0)for(X.col=0;A(X.row,X.col);)X.col++;else if(X.row===void 0)for(X.row=0;A(X.row,X.col);)X.row++;_[V.id()]=X,B(X.row,X.col)}}a.layoutPositions(this,t,function(W,G){var U,Q;if(W.locked()||W.isParent())return!1;var F=_[W.id()];if(F)U=F.col*b+b/2+i.x1,Q=F.row*m+m/2+i.y1;else{for(;A(M,I);)R();U=I*b+b/2+i.x1,Q=M*m+m/2+i.y1,B(M,I),R()}return{x:U,y:Q}})}return this};var Kf={ready:function(){},stop:function(){}};function Li(e){this.options=ge({},Kf,e)}Li.prototype.run=function(){var e=this.options,t=e.eles,n=this;return e.cy,n.emit("layoutstart"),t.nodes().positions(function(){return{x:0,y:0}}),n.one("layoutready",e.ready),n.emit("layoutready"),n.one("layoutstop",e.stop),n.emit("layoutstop"),this},Li.prototype.stop=function(){return this};var Uf={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function dc(e){this.options=ge({},Uf,e)}dc.prototype.run=function(){var e=this.options,t=e.eles.nodes(),n=Ie(e.positions);return t.layoutPositions(this,e,function(r,a){var i=function(o){if(e.positions==null)return function(l){return{x:l.x,y:l.y}}(o.position());if(n)return e.positions(o);var s=e.positions[o._private.data.id];return s??null}(r);return!r.locked()&&i!=null&&i}),this};var Zf={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function hc(e){this.options=ge({},Zf,e)}hc.prototype.run=function(){var e=this.options,t=e.cy,n=e.eles,r=nt(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()});return n.nodes().layoutPositions(this,e,function(a,i){return{x:r.x1+Math.round(Math.random()*r.w),y:r.y1+Math.round(Math.random()*r.h)}}),this};var $f=[{name:"breadthfirst",impl:tc},{name:"circle",impl:nc},{name:"concentric",impl:ac},{name:"cose",impl:sa},{name:"grid",impl:cc},{name:"null",impl:Li},{name:"preset",impl:dc},{name:"random",impl:hc}];function fc(e){this.options=e,this.notifications=0}var pc=function(){},gc=function(){throw new Error("A headless instance can not render images")};fc.prototype={recalculateRenderedStyle:pc,notify:function(){this.notifications++},init:pc,isHeadless:function(){return!0},png:gc,jpg:gc};var Qf={arrowShapeWidth:.3,registerArrowShapes:function(){var e=this.arrowShapes={},t=this,n=function(l,u,c,d,h,p,f){var g=h.x-c/2-f,v=h.x+c/2+f,y=h.y-c/2-f,b=h.y+c/2+f;return g<=l&&l<=v&&y<=u&&u<=b},r=function(l,u,c,d,h){var p=l*Math.cos(d)-u*Math.sin(d),f=(l*Math.sin(d)+u*Math.cos(d))*c;return{x:p*c+h.x,y:f+h.y}},a=function(l,u,c,d){for(var h=[],p=0;p<l.length;p+=2){var f=l[p],g=l[p+1];h.push(r(f,g,u,c,d))}return h},i=function(l){for(var u=[],c=0;c<l.length;c++){var d=l[c];u.push(d.x,d.y)}return u},o=function(l){return l.pstyle("width").pfValue*l.pstyle("arrow-scale").pfValue*2},s=function(l,u){pe(u)&&(u=e[u]),e[l]=ge({name:l,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(c,d,h,p,f,g){var v=i(a(this.points,h+2*g,p,f));return st(c,d,v)},roughCollide:n,draw:function(c,d,h,p){var f=a(this.points,d,h,p);t.arrowShapeImpl("polygon")(c,f)},spacing:function(c){return 0},gap:o},u)};s("none",{collide:Tr,roughCollide:Tr,draw:Ca,spacing:Zo,gap:Zo}),s("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),s("arrow","triangle"),s("triangle-backcurve",{points:e.triangle.points,controlPoint:[0,-.15],roughCollide:n,draw:function(l,u,c,d,h){var p=a(this.points,u,c,d),f=this.controlPoint,g=r(f[0],f[1],u,c,d);t.arrowShapeImpl(this.name)(l,p,g)},gap:function(l){return .8*o(l)}}),s("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(l,u,c,d,h,p,f){var g=i(a(this.points,c+2*f,d,h)),v=i(a(this.pointsTee,c+2*f,d,h));return st(l,u,g)||st(l,u,v)},draw:function(l,u,c,d,h){var p=a(this.points,u,c,d),f=a(this.pointsTee,u,c,d);t.arrowShapeImpl(this.name)(l,p,f)}}),s("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(l,u,c,d,h,p,f){var g=h,v=Math.pow(g.x-l,2)+Math.pow(g.y-u,2)<=Math.pow((c+2*f)*this.radius,2),y=i(a(this.points,c+2*f,d,h));return st(l,u,y)||v},draw:function(l,u,c,d,h){var p=a(this.pointsTr,u,c,d);t.arrowShapeImpl(this.name)(l,p,d.x,d.y,this.radius*u)},spacing:function(l){return t.getArrowWidth(l.pstyle("width").pfValue,l.pstyle("arrow-scale").value)*this.radius}}),s("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(l,u){var c=this.baseCrossLinePts.slice(),d=u/l;return c[3]=c[3]-d,c[5]=c[5]-d,c},collide:function(l,u,c,d,h,p,f){var g=i(a(this.points,c+2*f,d,h)),v=i(a(this.crossLinePts(c,p),c+2*f,d,h));return st(l,u,g)||st(l,u,v)},draw:function(l,u,c,d,h){var p=a(this.points,u,c,d),f=a(this.crossLinePts(u,h),u,c,d);t.arrowShapeImpl(this.name)(l,p,f)}}),s("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(l){return .525*o(l)}}),s("circle",{radius:.15,collide:function(l,u,c,d,h,p,f){var g=h;return Math.pow(g.x-l,2)+Math.pow(g.y-u,2)<=Math.pow((c+2*f)*this.radius,2)},draw:function(l,u,c,d,h){t.arrowShapeImpl(this.name)(l,d.x,d.y,this.radius*u)},spacing:function(l){return t.getArrowWidth(l.pstyle("width").pfValue,l.pstyle("arrow-scale").value)*this.radius}}),s("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(l){return 1},gap:function(l){return 1}}),s("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),s("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(l){return l.pstyle("width").pfValue*l.pstyle("arrow-scale").value}}),s("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(l){return .95*l.pstyle("width").pfValue*l.pstyle("arrow-scale").value}})}},Jf={projectIntoViewport:function(e,t){var n=this.cy,r=this.findContainerClientCoords(),a=r[0],i=r[1],o=r[4],s=n.pan(),l=n.zoom();return[((e-a)/o-s.x)/l,((t-i)/o-s.y)/l]},findContainerClientCoords:function(){if(this.containerBB)return this.containerBB;var e=this.container,t=e.getBoundingClientRect(),n=this.cy.window().getComputedStyle(e),r=function(k){return parseFloat(n.getPropertyValue(k))},a=r("padding-left"),i=r("padding-right"),o=r("padding-top"),s=r("padding-bottom"),l=r("border-left-width"),u=r("border-right-width"),c=r("border-top-width"),d=(r("border-bottom-width"),e.clientWidth),h=e.clientHeight,p=a+i,f=o+s,g=l+u,v=t.width/(d+g),y=d-p,b=h-f,m=t.left+a+l,w=t.top+o+c;return this.containerBB=[m,w,y,b,v]},invalidateContainerClientCoordsCache:function(){this.containerBB=null},findNearestElement:function(e,t,n,r){return this.findNearestElements(e,t,n,r)[0]},findNearestElements:function(e,t,n,r){var a,i,o=this,s=this,l=s.getCachedZSortedEles(),u=[],c=s.cy.zoom(),d=s.cy.hasCompoundNodes(),h=(r?24:8)/c,p=(r?8:2)/c,f=(r?8:2)/c,g=1/0;function v(x,S){if(x.isNode()){if(i)return;i=x,u.push(x)}if(x.isEdge()&&(S==null||S<g))if(a){if(a.pstyle("z-compound-depth").value===x.pstyle("z-compound-depth").value&&a.pstyle("z-compound-depth").value===x.pstyle("z-compound-depth").value){for(var P=0;P<u.length;P++)if(u[P].isEdge()){u[P]=x,a=x,g=S??g;break}}}else u.push(x),a=x,g=S??g}function y(x){var S=x.outerWidth()+2*p,P=x.outerHeight()+2*p,T=S/2,D=P/2,A=x.position(),B=x.pstyle("corner-radius").value==="auto"?"auto":x.pstyle("corner-radius").pfValue,M=x._private.rscratch;if(A.x-T<=e&&e<=A.x+T&&A.y-D<=t&&t<=A.y+D&&s.nodeShapes[o.getNodeShape(x)].checkPoint(e,t,0,S,P,A.x,A.y,B,M))return v(x,0),!0}function b(x){var S,P=x._private,T=P.rscratch,D=x.pstyle("width").pfValue,A=x.pstyle("arrow-scale").value,B=D/2+h,M=B*B,I=2*B,R=P.source,_=P.target;if(T.edgeType==="segments"||T.edgeType==="straight"||T.edgeType==="haystack"){for(var z=T.allpts,V=0;V+3<z.length;V+=2)if(Kd(e,t,z[V],z[V+1],z[V+2],z[V+3],I)&&M>(S=$d(e,t,z[V],z[V+1],z[V+2],z[V+3])))return v(x,S),!0}else if(T.edgeType==="bezier"||T.edgeType==="multibezier"||T.edgeType==="self"||T.edgeType==="compound"){for(z=T.allpts,V=0;V+5<T.allpts.length;V+=4)if(Ud(e,t,z[V],z[V+1],z[V+2],z[V+3],z[V+4],z[V+5],I)&&M>(S=Zd(e,t,z[V],z[V+1],z[V+2],z[V+3],z[V+4],z[V+5])))return v(x,S),!0}R=R||P.source,_=_||P.target;var L=o.getArrowWidth(D,A),X=[{name:"source",x:T.arrowStartX,y:T.arrowStartY,angle:T.srcArrowAngle},{name:"target",x:T.arrowEndX,y:T.arrowEndY,angle:T.tgtArrowAngle},{name:"mid-source",x:T.midX,y:T.midY,angle:T.midsrcArrowAngle},{name:"mid-target",x:T.midX,y:T.midY,angle:T.midtgtArrowAngle}];for(V=0;V<X.length;V++){var W=X[V],G=s.arrowShapes[x.pstyle(W.name+"-arrow-shape").value],U=x.pstyle("width").pfValue;if(G.roughCollide(e,t,L,W.angle,{x:W.x,y:W.y},U,h)&&G.collide(e,t,L,W.angle,{x:W.x,y:W.y},U,h))return v(x),!0}d&&u.length>0&&(y(R),y(_))}function m(x,S,P){return ot(x,S,P)}function w(x,S){var P,T=x._private,D=f;P=S?S+"-":"",x.boundingBox();var A=T.labelBounds[S||"main"],B=x.pstyle(P+"label").value;if(x.pstyle("text-events").strValue==="yes"&&B){var M=m(T.rscratch,"labelX",S),I=m(T.rscratch,"labelY",S),R=m(T.rscratch,"labelAngle",S),_=x.pstyle(P+"text-margin-x").pfValue,z=x.pstyle(P+"text-margin-y").pfValue,V=A.x1-D-_,L=A.x2+D-_,X=A.y1-D-z,W=A.y2+D-z;if(R){var G=Math.cos(R),U=Math.sin(R),Q=function(ne,le){return{x:(ne-=M)*G-(le-=I)*U+M,y:ne*U+le*G+I}},F=Q(V,X),O=Q(V,W),Y=Q(L,X),$=Q(L,W),J=[F.x+_,F.y+z,Y.x+_,Y.y+z,$.x+_,$.y+z,O.x+_,O.y+z];if(st(e,t,J))return v(x),!0}else if(Ft(A,e,t))return v(x),!0}}n&&(l=l.interactive);for(var k=l.length-1;k>=0;k--){var E=l[k];E.isNode()?y(E)||w(E):b(E)||w(E)||w(E,"source")||w(E,"target")}return u},getAllInBox:function(e,t,n,r){var a=this.getCachedZSortedEles().interactive,i=2/this.cy.zoom(),o=[],s=Math.min(e,n),l=Math.max(e,n),u=Math.min(t,r),c=Math.max(t,r),d=nt({x1:e=s,y1:t=u,x2:n=l,y2:r=c}),h=[{x:d.x1,y:d.y1},{x:d.x2,y:d.y1},{x:d.x2,y:d.y2},{x:d.x1,y:d.y2}],p=[[h[0],h[1]],[h[1],h[2]],[h[2],h[3]],[h[3],h[0]]];function f($,J,ne){return ot($,J,ne)}function g($,J){var ne=$._private,le=i;$.boundingBox();var fe=ne.labelBounds.main;if(!fe)return null;var ce=f(ne.rscratch,"labelX",J),te=f(ne.rscratch,"labelY",J),se=f(ne.rscratch,"labelAngle",J),de=$.pstyle("text-margin-x").pfValue,ue=$.pstyle("text-margin-y").pfValue,C=fe.x1-le-de,N=fe.x2+le-de,j=fe.y1-le-ue,H=fe.y2+le-ue;if(se){var K=Math.cos(se),q=Math.sin(se),Z=function(ee,ae){return{x:(ee-=ce)*K-(ae-=te)*q+ce,y:ee*q+ae*K+te}};return[Z(C,j),Z(N,j),Z(N,H),Z(C,H)]}return[{x:C,y:j},{x:N,y:j},{x:N,y:H},{x:C,y:H}]}function v($,J,ne,le){function fe(ce,te,se){return(se.y-ce.y)*(te.x-ce.x)>(te.y-ce.y)*(se.x-ce.x)}return fe($,ne,le)!==fe(J,ne,le)&&fe($,J,ne)!==fe($,J,le)}for(var y=0;y<a.length;y++){var b=a[y];if(b.isNode()){var m=b,w=m.pstyle("text-events").strValue==="yes",k=m.pstyle("box-selection").strValue,E=m.pstyle("box-select-labels").strValue==="yes";if(k==="none")continue;var x=(k==="overlap"||E)&&w,S=m.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:x});if(k==="contain"){var P=!1;if(E&&w){var T=g(m);T&&La(T,h)&&(o.push(m),P=!0)}!P&&ls(d,S)&&o.push(m)}else if(k==="overlap"&&Ma(d,S)){var D=m.boundingBox({includeNodes:!0,includeEdges:!0,includeLabels:!1,includeMainLabels:!1,includeSourceLabels:!1,includeTargetLabels:!1});if(La([{x:D.x1,y:D.y1},{x:D.x2,y:D.y1},{x:D.x2,y:D.y2},{x:D.x1,y:D.y2}],h))o.push(m);else{var A=g(m);A&&La(A,h)&&o.push(m)}}}else{var B=b,M=B._private,I=M.rscratch,R=B.pstyle("box-selection").strValue;if(R==="none")continue;if(R==="contain"){if(I.startX!=null&&I.startY!=null&&!Ft(d,I.startX,I.startY)||I.endX!=null&&I.endY!=null&&!Ft(d,I.endX,I.endY))continue;if(I.edgeType==="bezier"||I.edgeType==="multibezier"||I.edgeType==="self"||I.edgeType==="compound"||I.edgeType==="segments"||I.edgeType==="haystack"){for(var _=M.rstyle.bezierPts||M.rstyle.linePts||M.rstyle.haystackPts,z=!0,V=0;V<_.length;V++)if(!ss(d,_[V])){z=!1;break}z&&o.push(B)}else I.edgeType==="straight"&&o.push(B)}else if(R==="overlap"){var L=!1;if(I.startX!=null&&I.startY!=null&&I.endX!=null&&I.endY!=null&&(Ft(d,I.startX,I.startY)||Ft(d,I.endX,I.endY)))o.push(B),L=!0;else if(!L&&I.edgeType==="haystack"){for(var X=M.rstyle.haystackPts,W=0;W<X.length;W++)if(ss(d,X[W])){o.push(B),L=!0;break}}if(!L){var G=M.rstyle.bezierPts||M.rstyle.linePts||M.rstyle.haystackPts;if((!G||G.length<2)&&I.edgeType==="straight"&&I.startX!=null&&I.startY!=null&&I.endX!=null&&I.endY!=null&&(G=[{x:I.startX,y:I.startY},{x:I.endX,y:I.endY}]),!G||G.length<2)continue;for(var U=0;U<G.length-1;U++){for(var Q=G[U],F=G[U+1],O=0;O<p.length;O++){var Y=Le(p[O],2);if(v(Q,F,Y[0],Y[1])){o.push(B),L=!0;break}}if(L)break}}}}}return o}},zi={calculateArrowAngles:function(e){var t,n,r,a,i,o,s=e._private.rscratch,l=s.edgeType==="haystack",u=s.edgeType==="bezier",c=s.edgeType==="multibezier",d=s.edgeType==="segments",h=s.edgeType==="compound",p=s.edgeType==="self";if(l?(r=s.haystackPts[0],a=s.haystackPts[1],i=s.haystackPts[2],o=s.haystackPts[3]):(r=s.arrowStartX,a=s.arrowStartY,i=s.arrowEndX,o=s.arrowEndY),g=s.midX,v=s.midY,d)t=r-s.segpts[0],n=a-s.segpts[1];else if(c||h||p||u){var f=s.allpts;t=r-We(f[0],f[2],f[4],.1),n=a-We(f[1],f[3],f[5],.1)}else t=r-g,n=a-v;s.srcArrowAngle=Sr(t,n);var g=s.midX,v=s.midY;if(l&&(g=(r+i)/2,v=(a+o)/2),t=i-r,n=o-a,d)if((f=s.allpts).length/2%2==0){var y=(P=f.length/2)-2;t=f[P]-f[y],n=f[P+1]-f[y+1]}else s.isRound?(t=s.midVector[1],n=-s.midVector[0]):(y=(P=f.length/2-1)-2,t=f[P]-f[y],n=f[P+1]-f[y+1]);else if(c||h||p){var b,m,w,k,f=s.allpts;if(s.ctrlpts.length/2%2==0){var E=(x=(S=f.length/2-1)+2)+2;b=We(f[S],f[x],f[E],0),m=We(f[S+1],f[x+1],f[E+1],0),w=We(f[S],f[x],f[E],1e-4),k=We(f[S+1],f[x+1],f[E+1],1e-4)}else{var x,S;E=(x=f.length/2-1)+2,b=We(f[S=x-2],f[x],f[E],.4999),m=We(f[S+1],f[x+1],f[E+1],.4999),w=We(f[S],f[x],f[E],.5),k=We(f[S+1],f[x+1],f[E+1],.5)}t=w-b,n=k-m}if(s.midtgtArrowAngle=Sr(t,n),s.midDispX=t,s.midDispY=n,t*=-1,n*=-1,d&&(f=s.allpts).length/2%2!=0){if(!s.isRound){var P,T=(P=f.length/2-1)+2;t=-(f[T]-f[P]),n=-(f[T+1]-f[P+1])}}if(s.midsrcArrowAngle=Sr(t,n),d)t=i-s.segpts[s.segpts.length-2],n=o-s.segpts[s.segpts.length-1];else if(c||h||p||u){var D=(f=s.allpts).length;t=i-We(f[D-6],f[D-4],f[D-2],.9),n=o-We(f[D-5],f[D-3],f[D-1],.9)}else t=i-g,n=o-v;s.tgtArrowAngle=Sr(t,n)}};zi.getArrowWidth=zi.getArrowHeight=function(e,t){var n=this.arrowWidthCache=this.arrowWidthCache||{},r=n[e+", "+t];return r||(r=Math.max(Math.pow(13.37*e,.9),29)*t,n[e+", "+t]=r,r)};var Oi,Vi,vc,yc,sn,ua,At,ln,un,Mt,cr,ca,mc,bc,Fi,Yi,xc,kt={},pt={},wc=function(e,t,n){n.x=t.x-e.x,n.y=t.y-e.y,n.len=Math.sqrt(n.x*n.x+n.y*n.y),n.nx=n.x/n.len,n.ny=n.y/n.len,n.ang=Math.atan2(n.ny,n.nx)},ep=function(e,t,n,r,a){var i,o;if(e!==xc?wc(t,e,kt):((o=kt).x=-1*(i=pt).x,o.y=-1*i.y,o.nx=-1*i.nx,o.ny=-1*i.ny,o.ang=i.ang>0?-(Math.PI-i.ang):Math.PI+i.ang),wc(t,n,pt),vc=kt.nx*pt.ny-kt.ny*pt.nx,yc=kt.nx*pt.nx-kt.ny*-pt.ny,At=Math.asin(Math.max(-1,Math.min(1,vc))),Math.abs(At)<1e-6)return Oi=t.x,Vi=t.y,void(un=cr=0);sn=1,ua=!1,yc<0?At<0?At=Math.PI+At:(At=Math.PI-At,sn=-1,ua=!0):At>0&&(sn=-1,ua=!0),cr=t.radius!==void 0?t.radius:r,ln=At/2,ca=Math.min(kt.len/2,pt.len/2),a?(Mt=Math.abs(Math.cos(ln)*cr/Math.sin(ln)))>ca?(Mt=ca,un=Math.abs(Mt*Math.sin(ln)/Math.cos(ln))):un=cr:(Mt=Math.min(ca,cr),un=Math.abs(Mt*Math.sin(ln)/Math.cos(ln))),Fi=t.x+pt.nx*Mt,Yi=t.y+pt.ny*Mt,Oi=Fi-pt.ny*un*sn,Vi=Yi+pt.nx*un*sn,mc=t.x+kt.nx*Mt,bc=t.y+kt.ny*Mt,xc=t};function Ec(e,t){t.radius===0?e.lineTo(t.cx,t.cy):e.arc(t.cx,t.cy,t.radius,t.startAngle,t.endAngle,t.counterClockwise)}function ji(e,t,n,r){var a=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];return r===0||t.radius===0?{cx:t.x,cy:t.y,radius:0,startX:t.x,startY:t.y,stopX:t.x,stopY:t.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(ep(e,t,n,r,a),{cx:Oi,cy:Vi,radius:un,startX:mc,startY:bc,stopX:Fi,stopY:Yi,startAngle:kt.ang+Math.PI/2*sn,endAngle:pt.ang-Math.PI/2*sn,counterClockwise:ua})}var da=.01,tp=Math.sqrt(.02),et={};function kc(e){var t=[];if(e!=null){for(var n=0;n<e.length;n+=2){var r=e[n],a=e[n+1];t.push({x:r,y:a})}return t}}et.findMidptPtsEtc=function(e,t){var n,r=t.posPts,a=t.intersectionPts,i=t.vectorNormInverse,o=e.pstyle("source-endpoint"),s=e.pstyle("target-endpoint"),l=o.units!=null&&s.units!=null;switch(e.pstyle("edge-distances").value){case"node-position":n=r;break;case"intersection":n=a;break;case"endpoints":if(l){var u=Le(this.manualEndptToPx(e.source()[0],o),2),c=u[0],d=u[1],h=Le(this.manualEndptToPx(e.target()[0],s),2),p=h[0],f=h[1],g={x1:c,y1:d,x2:p,y2:f};i=function(v,y,b,m){var w=m-y,k=b-v,E=Math.sqrt(k*k+w*w);return{x:-w/E,y:k/E}}(c,d,p,f),n=g}else ke("Edge ".concat(e.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),n=a}return{midptPts:n,vectorNormInverse:i}},et.findHaystackPoints=function(e){for(var t=0;t<e.length;t++){var n=e[t],r=n._private,a=r.rscratch;if(!a.haystack){var i=2*Math.random()*Math.PI;a.source={x:Math.cos(i),y:Math.sin(i)},i=2*Math.random()*Math.PI,a.target={x:Math.cos(i),y:Math.sin(i)}}var o=r.source,s=r.target,l=o.position(),u=s.position(),c=o.width(),d=s.width(),h=o.height(),p=s.height(),f=n.pstyle("haystack-radius").value/2;a.haystackPts=a.allpts=[a.source.x*c*f+l.x,a.source.y*h*f+l.y,a.target.x*d*f+u.x,a.target.y*p*f+u.y],a.midX=(a.allpts[0]+a.allpts[2])/2,a.midY=(a.allpts[1]+a.allpts[3])/2,a.edgeType="haystack",a.haystack=!0,this.storeEdgeProjections(n),this.calculateArrowAngles(n),this.recalculateEdgeLabelProjections(n),this.calculateLabelAngles(n)}},et.findSegmentsPoints=function(e,t){var n=e._private.rscratch,r=e.pstyle("segment-weights"),a=e.pstyle("segment-distances"),i=e.pstyle("segment-radii"),o=e.pstyle("radius-type"),s=Math.min(r.pfValue.length,a.pfValue.length),l=i.pfValue[i.pfValue.length-1],u=o.pfValue[o.pfValue.length-1];n.edgeType="segments",n.segpts=[],n.radii=[],n.isArcRadius=[];for(var c=0;c<s;c++){var d=r.pfValue[c],h=a.pfValue[c],p=1-d,f=d,g=this.findMidptPtsEtc(e,t),v=g.midptPts,y=g.vectorNormInverse,b={x:v.x1*p+v.x2*f,y:v.y1*p+v.y2*f};n.segpts.push(b.x+y.x*h,b.y+y.y*h),n.radii.push(i.pfValue[c]!==void 0?i.pfValue[c]:l),n.isArcRadius.push((o.pfValue[c]!==void 0?o.pfValue[c]:u)==="arc-radius")}},et.findLoopPoints=function(e,t,n,r){var a=e._private.rscratch,i=t.dirCounts,o=t.srcPos,s=e.pstyle("control-point-distances"),l=s?s.pfValue[0]:void 0,u=e.pstyle("loop-direction").pfValue,c=e.pstyle("loop-sweep").pfValue,d=e.pstyle("control-point-step-size").pfValue;a.edgeType="self";var h=n,p=d;r&&(h=0,p=l);var f=u-Math.PI/2,g=f-c/2,v=f+c/2,y=u+"_"+c;h=i[y]===void 0?i[y]=0:++i[y],a.ctrlpts=[o.x+1.4*Math.cos(g)*p*(h/3+1),o.y+1.4*Math.sin(g)*p*(h/3+1),o.x+1.4*Math.cos(v)*p*(h/3+1),o.y+1.4*Math.sin(v)*p*(h/3+1)]},et.findCompoundLoopPoints=function(e,t,n,r){var a=e._private.rscratch;a.edgeType="compound";var i=t.srcPos,o=t.tgtPos,s=t.srcW,l=t.srcH,u=t.tgtW,c=t.tgtH,d=e.pstyle("control-point-step-size").pfValue,h=e.pstyle("control-point-distances"),p=h?h.pfValue[0]:void 0,f=n,g=d;r&&(f=0,g=p);var v={x:i.x-s/2,y:i.y-l/2},y={x:o.x-u/2,y:o.y-c/2},b={x:Math.min(v.x,y.x),y:Math.min(v.y,y.y)},m=Math.max(.5,Math.log(s*da)),w=Math.max(.5,Math.log(u*da));a.ctrlpts=[b.x,b.y-(1+Math.pow(50,1.12)/100)*g*(f/3+1)*m,b.x-(1+Math.pow(50,1.12)/100)*g*(f/3+1)*w,b.y]},et.findStraightEdgePoints=function(e){e._private.rscratch.edgeType="straight"},et.findBezierPoints=function(e,t,n,r,a){var i=e._private.rscratch,o=e.pstyle("control-point-step-size").pfValue,s=e.pstyle("control-point-distances"),l=e.pstyle("control-point-weights"),u=s&&l?Math.min(s.value.length,l.value.length):1,c=s?s.pfValue[0]:void 0,d=l.value[0],h=r;i.edgeType=h?"multibezier":"bezier",i.ctrlpts=[];for(var p=0;p<u;p++){var f=(.5-t.eles.length/2+n)*o*(a?-1:1),g=void 0,v=Aa(f);h&&(c=s?s.pfValue[p]:o,d=l.value[p]);var y=(g=r?c:c!==void 0?v*c:void 0)!==void 0?g:f,b=1-d,m=d,w=this.findMidptPtsEtc(e,t),k=w.midptPts,E=w.vectorNormInverse,x={x:k.x1*b+k.x2*m,y:k.y1*b+k.y2*m};i.ctrlpts.push(x.x+E.x*y,x.y+E.y*y)}},et.findTaxiPoints=function(e,t){var n=e._private.rscratch;n.edgeType="segments";var r="vertical",a="horizontal",i="leftward",o="rightward",s="downward",l="upward",u=t.posPts,c=t.srcW,d=t.srcH,h=t.tgtW,p=t.tgtH,f=e.pstyle("edge-distances").value!=="node-position",g=e.pstyle("taxi-direction").value,v=g,y=e.pstyle("taxi-turn"),b=y.units==="%",m=y.pfValue,w=m<0,k=e.pstyle("taxi-turn-min-distance").pfValue,E=f?(c+h)/2:0,x=f?(d+p)/2:0,S=u.x2-u.x1,P=u.y2-u.y1,T=function(ae,re){return ae>0?Math.max(ae-re,0):Math.min(ae+re,0)},D=T(S,E),A=T(P,x),B=!1;v==="auto"?g=Math.abs(D)>Math.abs(A)?a:r:v===l||v===s?(g=r,B=!0):v!==i&&v!==o||(g=a,B=!0);var M,I=g===r,R=I?A:D,_=I?P:S,z=Aa(_),V=!1;B&&(b||w)||!(v===s&&_<0||v===l&&_>0||v===i&&_>0||v===o&&_<0)||(R=(z*=-1)*Math.abs(R),V=!0),b?M=(m<0?1+m:m)*R:M=(m<0?R:0)+m*z;var L=function(ae){return Math.abs(ae)<k||Math.abs(ae)>=Math.abs(R)},X=L(M),W=L(Math.abs(R)-Math.abs(M));if((X||W)&&!V)if(I){var G=Math.abs(_)<=d/2,U=Math.abs(S)<=h/2;if(G){var Q=(u.x1+u.x2)/2,F=u.y1,O=u.y2;n.segpts=[Q,F,Q,O]}else if(U){var Y=(u.y1+u.y2)/2,$=u.x1,J=u.x2;n.segpts=[$,Y,J,Y]}else n.segpts=[u.x1,u.y2]}else{var ne=Math.abs(_)<=c/2,le=Math.abs(P)<=p/2;if(ne){var fe=(u.y1+u.y2)/2,ce=u.x1,te=u.x2;n.segpts=[ce,fe,te,fe]}else if(le){var se=(u.x1+u.x2)/2,de=u.y1,ue=u.y2;n.segpts=[se,de,se,ue]}else n.segpts=[u.x2,u.y1]}else if(I){var C=u.y1+M+(f?d/2*z:0),N=u.x1,j=u.x2;n.segpts=[N,C,j,C]}else{var H=u.x1+M+(f?c/2*z:0),K=u.y1,q=u.y2;n.segpts=[H,K,H,q]}if(n.isRound){var Z=e.pstyle("taxi-radius").value,ee=e.pstyle("radius-type").value[0]==="arc-radius";n.radii=new Array(n.segpts.length/2).fill(Z),n.isArcRadius=new Array(n.segpts.length/2).fill(ee)}},et.tryToCorrectInvalidPoints=function(e,t){var n=e._private.rscratch;if(n.edgeType==="bezier"){var r=t.srcPos,a=t.tgtPos,i=t.srcW,o=t.srcH,s=t.tgtW,l=t.tgtH,u=t.srcShape,c=t.tgtShape,d=t.srcCornerRadius,h=t.tgtCornerRadius,p=t.srcRs,f=t.tgtRs,g=!oe(n.startX)||!oe(n.startY),v=!oe(n.arrowStartX)||!oe(n.arrowStartY),y=!oe(n.endX)||!oe(n.endY),b=!oe(n.arrowEndX)||!oe(n.arrowEndY),m=3*(this.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.arrowShapeWidth),w=tn({x:n.ctrlpts[0],y:n.ctrlpts[1]},{x:n.startX,y:n.startY}),k=w<m,E=tn({x:n.ctrlpts[0],y:n.ctrlpts[1]},{x:n.endX,y:n.endY}),x=E<m,S=!1;if(g||v||k){S=!0;var P={x:n.ctrlpts[0]-r.x,y:n.ctrlpts[1]-r.y},T=Math.sqrt(P.x*P.x+P.y*P.y),D={x:P.x/T,y:P.y/T},A=Math.max(i,o),B={x:n.ctrlpts[0]+2*D.x*A,y:n.ctrlpts[1]+2*D.y*A},M=u.intersectLine(r.x,r.y,i,o,B.x,B.y,0,d,p);k?(n.ctrlpts[0]=n.ctrlpts[0]+D.x*(m-w),n.ctrlpts[1]=n.ctrlpts[1]+D.y*(m-w)):(n.ctrlpts[0]=M[0]+D.x*m,n.ctrlpts[1]=M[1]+D.y*m)}if(y||b||x){S=!0;var I={x:n.ctrlpts[0]-a.x,y:n.ctrlpts[1]-a.y},R=Math.sqrt(I.x*I.x+I.y*I.y),_={x:I.x/R,y:I.y/R},z=Math.max(i,o),V={x:n.ctrlpts[0]+2*_.x*z,y:n.ctrlpts[1]+2*_.y*z},L=c.intersectLine(a.x,a.y,s,l,V.x,V.y,0,h,f);x?(n.ctrlpts[0]=n.ctrlpts[0]+_.x*(m-E),n.ctrlpts[1]=n.ctrlpts[1]+_.y*(m-E)):(n.ctrlpts[0]=L[0]+_.x*m,n.ctrlpts[1]=L[1]+_.y*m)}S&&this.findEndpoints(e)}},et.storeAllpts=function(e){var t=e._private.rscratch;if(t.edgeType==="multibezier"||t.edgeType==="bezier"||t.edgeType==="self"||t.edgeType==="compound"){t.allpts=[],t.allpts.push(t.startX,t.startY);for(var n=0;n+1<t.ctrlpts.length;n+=2)t.allpts.push(t.ctrlpts[n],t.ctrlpts[n+1]),n+3<t.ctrlpts.length&&t.allpts.push((t.ctrlpts[n]+t.ctrlpts[n+2])/2,(t.ctrlpts[n+1]+t.ctrlpts[n+3])/2);var r;t.allpts.push(t.endX,t.endY),t.ctrlpts.length/2%2==0?(r=t.allpts.length/2-1,t.midX=t.allpts[r],t.midY=t.allpts[r+1]):(r=t.allpts.length/2-3,t.midX=We(t.allpts[r],t.allpts[r+2],t.allpts[r+4],.5),t.midY=We(t.allpts[r+1],t.allpts[r+3],t.allpts[r+5],.5))}else if(t.edgeType==="straight")t.allpts=[t.startX,t.startY,t.endX,t.endY],t.midX=(t.startX+t.endX+t.arrowStartX+t.arrowEndX)/4,t.midY=(t.startY+t.endY+t.arrowStartY+t.arrowEndY)/4;else if(t.edgeType==="segments"){if(t.allpts=[],t.allpts.push(t.startX,t.startY),t.allpts.push.apply(t.allpts,t.segpts),t.allpts.push(t.endX,t.endY),t.isRound){t.roundCorners=[];for(var a=2;a+3<t.allpts.length;a+=2){var i=t.radii[a/2-1],o=t.isArcRadius[a/2-1];t.roundCorners.push(ji({x:t.allpts[a-2],y:t.allpts[a-1]},{x:t.allpts[a],y:t.allpts[a+1],radius:i},{x:t.allpts[a+2],y:t.allpts[a+3]},i,o))}}if(t.segpts.length%4==0){var s=t.segpts.length/2,l=s-2;t.midX=(t.segpts[l]+t.segpts[s])/2,t.midY=(t.segpts[l+1]+t.segpts[s+1])/2}else{var u=t.segpts.length/2-1;if(t.isRound){var c={x:t.segpts[u],y:t.segpts[u+1]},d=t.roundCorners[u/2];if(d.radius===0){var h={x:t.segpts[u+2],y:t.segpts[u+3]};t.midX=c.x,t.midY=c.y,t.midVector=[c.y-h.y,h.x-c.x]}else{var p=[c.x-d.cx,c.y-d.cy],f=d.radius/Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2));p=p.map(function(g){return g*f}),t.midX=d.cx+p[0],t.midY=d.cy+p[1],t.midVector=p}}else t.midX=t.segpts[u],t.midY=t.segpts[u+1]}}},et.checkForInvalidEdgeWarning=function(e){var t=e[0]._private.rscratch;t.nodesOverlap||oe(t.startX)&&oe(t.startY)&&oe(t.endX)&&oe(t.endY)?t.loggedErr=!1:t.loggedErr||(t.loggedErr=!0,ke("Edge `"+e.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))},et.findEdgeControlPoints=function(e){var t=this;if(e&&e.length!==0){for(var n=this,r=n.cy.hasCompoundNodes(),a=new _t,i=function(k,E){return[].concat(yr(k),[E?1:0]).join("-")},o=[],s=[],l=0;l<e.length;l++){var u=e[l],c=u._private,d=u.pstyle("curve-style").value;if(!u.removed()&&u.takesUpSpace())if(d!=="haystack"){var h=d==="unbundled-bezier"||zt(d,"segments")||d==="straight"||d==="straight-triangle"||zt(d,"taxi"),p=d==="unbundled-bezier"||d==="bezier",f=c.source,g=c.target,v=[f.poolIndex(),g.poolIndex()].sort(),y=i(v,h),b=a.get(y);b==null&&(b={eles:[]},o.push({pairId:v,edgeIsUnbundled:h}),a.set(y,b)),b.eles.push(u),h&&(b.hasUnbundled=!0),p&&(b.hasBezier=!0)}else s.push(u)}for(var m=function(){var k,E=o[w],x=E.pairId,S=E.edgeIsUnbundled,P=i(x,S),T=a.get(P);if(!T.hasUnbundled){var D=T.eles[0].parallelEdges().filter(function(ae){return ae.isBundledBezier()});Pa(T.eles),D.forEach(function(ae){return T.eles.push(ae)}),T.eles.sort(function(ae,re){return ae.poolIndex()-re.poolIndex()})}var A=T.eles[0],B=A.source(),M=A.target();if(B.poolIndex()>M.poolIndex()){var I=B;B=M,M=I}var R=T.srcPos=B.position(),_=T.tgtPos=M.position(),z=T.srcW=B.outerWidth(),V=T.srcH=B.outerHeight(),L=T.tgtW=M.outerWidth(),X=T.tgtH=M.outerHeight(),W=T.srcShape=n.nodeShapes[t.getNodeShape(B)],G=T.tgtShape=n.nodeShapes[t.getNodeShape(M)],U=T.srcCornerRadius=B.pstyle("corner-radius").value==="auto"?"auto":B.pstyle("corner-radius").pfValue,Q=T.tgtCornerRadius=M.pstyle("corner-radius").value==="auto"?"auto":M.pstyle("corner-radius").pfValue,F=T.tgtRs=M._private.rscratch,O=T.srcRs=B._private.rscratch;T.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var Y=0;Y<T.eles.length;Y++){var $=T.eles[Y],J=$[0]._private.rscratch,ne=$.pstyle("curve-style").value,le=ne==="unbundled-bezier"||zt(ne,"segments")||zt(ne,"taxi"),fe=!B.same($.source());if(!T.calculatedIntersection&&B!==M&&(T.hasBezier||T.hasUnbundled)){T.calculatedIntersection=!0;var ce=W.intersectLine(R.x,R.y,z,V,_.x,_.y,0,U,O),te=T.srcIntn=ce,se=G.intersectLine(_.x,_.y,L,X,R.x,R.y,0,Q,F),de=T.tgtIntn=se,ue=T.intersectionPts={x1:ce[0],x2:se[0],y1:ce[1],y2:se[1]},C=T.posPts={x1:R.x,x2:_.x,y1:R.y,y2:_.y},N=se[1]-ce[1],j=se[0]-ce[0],H=Math.sqrt(j*j+N*N);oe(H)&&H>=tp||(H=Math.sqrt(Math.max(j*j,da)+Math.max(N*N,da)));var K=T.vector={x:j,y:N},q=T.vectorNorm={x:K.x/H,y:K.y/H},Z={x:-q.y,y:q.x};T.nodesOverlap=!oe(H)||G.checkPoint(ce[0],ce[1],0,L,X,_.x,_.y,Q,F)||W.checkPoint(se[0],se[1],0,z,V,R.x,R.y,U,O),T.vectorNormInverse=Z,k={nodesOverlap:T.nodesOverlap,dirCounts:T.dirCounts,calculatedIntersection:!0,hasBezier:T.hasBezier,hasUnbundled:T.hasUnbundled,eles:T.eles,srcPos:_,srcRs:F,tgtPos:R,tgtRs:O,srcW:L,srcH:X,tgtW:z,tgtH:V,srcIntn:de,tgtIntn:te,srcShape:G,tgtShape:W,posPts:{x1:C.x2,y1:C.y2,x2:C.x1,y2:C.y1},intersectionPts:{x1:ue.x2,y1:ue.y2,x2:ue.x1,y2:ue.y1},vector:{x:-K.x,y:-K.y},vectorNorm:{x:-q.x,y:-q.y},vectorNormInverse:{x:-Z.x,y:-Z.y}}}var ee=fe?k:T;J.nodesOverlap=ee.nodesOverlap,J.srcIntn=ee.srcIntn,J.tgtIntn=ee.tgtIntn,J.isRound=ne.startsWith("round"),r&&(B.isParent()||B.isChild()||M.isParent()||M.isChild())&&(B.parents().anySame(M)||M.parents().anySame(B)||B.same(M)&&B.isParent())?t.findCompoundLoopPoints($,ee,Y,le):B===M?t.findLoopPoints($,ee,Y,le):ne.endsWith("segments")?t.findSegmentsPoints($,ee):ne.endsWith("taxi")?t.findTaxiPoints($,ee):ne==="straight"||!le&&T.eles.length%2==1&&Y===Math.floor(T.eles.length/2)?t.findStraightEdgePoints($):t.findBezierPoints($,ee,Y,le,fe),t.findEndpoints($),t.tryToCorrectInvalidPoints($,ee),t.checkForInvalidEdgeWarning($),t.storeAllpts($),t.storeEdgeProjections($),t.calculateArrowAngles($),t.recalculateEdgeLabelProjections($),t.calculateLabelAngles($)}},w=0;w<o.length;w++)m();this.findHaystackPoints(s)}},et.getSegmentPoints=function(e){var t=e[0]._private.rscratch;if(this.recalculateRenderedStyle(e),t.edgeType==="segments")return kc(t.segpts)},et.getControlPoints=function(e){var t=e[0]._private.rscratch;this.recalculateRenderedStyle(e);var n=t.edgeType;if(n==="bezier"||n==="multibezier"||n==="self"||n==="compound")return kc(t.ctrlpts)},et.getEdgeMidpoint=function(e){var t=e[0]._private.rscratch;return this.recalculateRenderedStyle(e),{x:t.midX,y:t.midY}};var np={manualEndptToPx:function(e,t){var n=e.position(),r=e.outerWidth(),a=e.outerHeight(),i=e._private.rscratch;if(t.value.length===2){var o=[t.pfValue[0],t.pfValue[1]];return t.units[0]==="%"&&(o[0]=o[0]*r),t.units[1]==="%"&&(o[1]=o[1]*a),o[0]+=n.x,o[1]+=n.y,o}var s=t.pfValue[0];s=-Math.PI/2+s;var l=2*Math.max(r,a),u=[n.x+Math.cos(s)*l,n.y+Math.sin(s)*l];return this.nodeShapes[this.getNodeShape(e)].intersectLine(n.x,n.y,r,a,u[0],u[1],0,e.pstyle("corner-radius").value==="auto"?"auto":e.pstyle("corner-radius").pfValue,i)},findEndpoints:function(e){var t,n,r,a,i,o,s,l,u,c=this,d=e.source()[0],h=e.target()[0],p=d.position(),f=h.position(),g=e.pstyle("target-arrow-shape").value,v=e.pstyle("source-arrow-shape").value,y=e.pstyle("target-distance-from-node").pfValue,b=e.pstyle("source-distance-from-node").pfValue,m=d._private.rscratch,w=h._private.rscratch,k=e.pstyle("curve-style").value,E=e._private.rscratch,x=E.edgeType,S=zt(k,"taxi"),P=x==="self"||x==="compound",T=x==="bezier"||x==="multibezier"||P,D=x!=="bezier",A=x==="straight"||x==="segments",B=x==="segments",M=T||D||A,I=P||S,R=e.pstyle("source-endpoint"),_=I?"outside-to-node":R.value,z=d.pstyle("corner-radius").value==="auto"?"auto":d.pstyle("corner-radius").pfValue,V=e.pstyle("target-endpoint"),L=I?"outside-to-node":V.value,X=h.pstyle("corner-radius").value==="auto"?"auto":h.pstyle("corner-radius").pfValue;E.srcManEndpt=R,E.tgtManEndpt=V;var W=(t=(V==null||(n=V.pfValue)===null||n===void 0?void 0:n.length)===2?V.pfValue:null)!==null&&t!==void 0?t:[0,0],G=(r=(R==null||(a=R.pfValue)===null||a===void 0?void 0:a.length)===2?R.pfValue:null)!==null&&r!==void 0?r:[0,0];if(T){var U=[E.ctrlpts[0],E.ctrlpts[1]];o=D?[E.ctrlpts[E.ctrlpts.length-2],E.ctrlpts[E.ctrlpts.length-1]]:U,s=U}else if(A){var Q=B?E.segpts.slice(0,2):[f.x+W[0],f.y+W[1]];o=B?E.segpts.slice(E.segpts.length-2):[p.x+G[0],p.y+G[1]],s=Q}if(L==="inside-to-node")i=[f.x,f.y];else if(V.units)i=this.manualEndptToPx(h,V);else if(L==="outside-to-line")i=E.tgtIntn;else if(L==="outside-to-node"||L==="outside-to-node-or-label"?l=o:L!=="outside-to-line"&&L!=="outside-to-line-or-label"||(l=[p.x,p.y]),i=c.nodeShapes[this.getNodeShape(h)].intersectLine(f.x,f.y,h.outerWidth(),h.outerHeight(),l[0],l[1],0,X,w),L==="outside-to-node-or-label"||L==="outside-to-line-or-label"){var F=h._private.rscratch,O=F.labelWidth,Y=F.labelHeight,$=F.labelX,J=F.labelY,ne=O/2,le=Y/2,fe=h.pstyle("text-valign").value;fe==="top"?J-=le:fe==="bottom"&&(J+=le);var ce=h.pstyle("text-halign").value;ce==="left"?$-=ne:ce==="right"&&($+=ne);var te=Jn(l[0],l[1],[$-ne,J-le,$+ne,J-le,$+ne,J+le,$-ne,J+le],f.x,f.y);if(te.length>0){var se=p,de=nn(se,mn(i)),ue=nn(se,mn(te)),C=de;ue<de&&(i=te,C=ue),te.length>2&&nn(se,{x:te[2],y:te[3]})<C&&(i=[te[2],te[3]])}}var N=Mr(i,o,c.arrowShapes[g].spacing(e)+y),j=Mr(i,o,c.arrowShapes[g].gap(e)+y);if(E.endX=j[0],E.endY=j[1],E.arrowEndX=N[0],E.arrowEndY=N[1],_==="inside-to-node")i=[p.x,p.y];else if(R.units)i=this.manualEndptToPx(d,R);else if(_==="outside-to-line")i=E.srcIntn;else if(_==="outside-to-node"||_==="outside-to-node-or-label"?u=s:_!=="outside-to-line"&&_!=="outside-to-line-or-label"||(u=[f.x,f.y]),i=c.nodeShapes[this.getNodeShape(d)].intersectLine(p.x,p.y,d.outerWidth(),d.outerHeight(),u[0],u[1],0,z,m),_==="outside-to-node-or-label"||_==="outside-to-line-or-label"){var H=d._private.rscratch,K=H.labelWidth,q=H.labelHeight,Z=H.labelX,ee=H.labelY,ae=K/2,re=q/2,ye=d.pstyle("text-valign").value;ye==="top"?ee-=re:ye==="bottom"&&(ee+=re);var he=d.pstyle("text-halign").value;he==="left"?Z-=ae:he==="right"&&(Z+=ae);var ie=Jn(u[0],u[1],[Z-ae,ee-re,Z+ae,ee-re,Z+ae,ee+re,Z-ae,ee+re],p.x,p.y);if(ie.length>0){var ve=f,be=nn(ve,mn(i)),Pe=nn(ve,mn(ie)),Ae=be;Pe<be&&(i=[ie[0],ie[1]],Ae=Pe),ie.length>2&&nn(ve,{x:ie[2],y:ie[3]})<Ae&&(i=[ie[2],ie[3]])}}var Oe=Mr(i,s,c.arrowShapes[v].spacing(e)+b),Re=Mr(i,s,c.arrowShapes[v].gap(e)+b);E.startX=Re[0],E.startY=Re[1],E.arrowStartX=Oe[0],E.arrowStartY=Oe[1],M&&(oe(E.startX)&&oe(E.startY)&&oe(E.endX)&&oe(E.endY)?E.badLine=!1:E.badLine=!0)},getSourceEndpoint:function(e){var t=e[0]._private.rscratch;return this.recalculateRenderedStyle(e),t.edgeType==="haystack"?{x:t.haystackPts[0],y:t.haystackPts[1]}:{x:t.arrowStartX,y:t.arrowStartY}},getTargetEndpoint:function(e){var t=e[0]._private.rscratch;return this.recalculateRenderedStyle(e),t.edgeType==="haystack"?{x:t.haystackPts[2],y:t.haystackPts[3]}:{x:t.arrowEndX,y:t.arrowEndY}}},Xi={};function rp(e,t,n){for(var r=function(s,l,u,c){return We(s,l,u,c)},a=t._private.rstyle.bezierPts,i=0;i<e.bezierProjPcts.length;i++){var o=e.bezierProjPcts[i];a.push({x:r(n[0],n[2],n[4],o),y:r(n[1],n[3],n[5],o)})}}Xi.storeEdgeProjections=function(e){var t=e._private,n=t.rscratch,r=n.edgeType;if(t.rstyle.bezierPts=null,t.rstyle.linePts=null,t.rstyle.haystackPts=null,r==="multibezier"||r==="bezier"||r==="self"||r==="compound"){t.rstyle.bezierPts=[];for(var a=0;a+5<n.allpts.length;a+=4)rp(this,e,n.allpts.slice(a,a+6))}else if(r==="segments"){var i=t.rstyle.linePts=[];for(a=0;a+1<n.allpts.length;a+=2)i.push({x:n.allpts[a],y:n.allpts[a+1]})}else if(r==="haystack"){var o=n.haystackPts;t.rstyle.haystackPts=[{x:o[0],y:o[1]},{x:o[2],y:o[3]}]}t.rstyle.arrowWidth=this.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.arrowShapeWidth},Xi.recalculateEdgeProjections=function(e){this.findEdgeControlPoints(e)};var It={recalculateNodeLabelProjection:function(e){var t=e.pstyle("label").strValue;if(!Lt(t)){var n,r,a=e._private,i=e.width(),o=e.height(),s=e.padding(),l=e.position(),u=e.pstyle("text-halign").strValue,c=e.pstyle("text-valign").strValue,d=a.rscratch,h=a.rstyle;switch(u){case"left":n=l.x-i/2-s;break;case"right":n=l.x+i/2+s;break;default:n=l.x}switch(c){case"top":r=l.y-o/2-s;break;case"bottom":r=l.y+o/2+s;break;default:r=l.y}d.labelX=n,d.labelY=r,h.labelX=n,h.labelY=r,this.calculateLabelAngles(e),this.applyLabelDimensions(e)}}},Tc=function(e,t){var n=Math.atan(t/e);return e===0&&n<0&&(n*=-1),n},Cc=function(e,t){var n=t.x-e.x,r=t.y-e.y;return Tc(n,r)};It.recalculateEdgeLabelProjections=function(e){var t,n=e._private,r=n.rscratch,a=this,i={mid:e.pstyle("label").strValue,source:e.pstyle("source-label").strValue,target:e.pstyle("target-label").strValue};if(i.mid||i.source||i.target){t={x:r.midX,y:r.midY};var o=function(c,d,h){Bt(n.rscratch,c,d,h),Bt(n.rstyle,c,d,h)};o("labelX",null,t.x),o("labelY",null,t.y);var s=Tc(r.midDispX,r.midDispY);o("labelAutoAngle",null,s);var l=function(){if(l.cache)return l.cache;for(var c=[],d=0;d+5<r.allpts.length;d+=4){var h={x:r.allpts[d],y:r.allpts[d+1]},p={x:r.allpts[d+2],y:r.allpts[d+3]},f={x:r.allpts[d+4],y:r.allpts[d+5]};c.push({p0:h,p1:p,p2:f,startDist:0,length:0,segments:[]})}var g=n.rstyle.bezierPts,v=a.bezierProjPcts.length;function y(E,x,S,P,T){var D=tn(x,S),A=E.segments[E.segments.length-1],B={p0:x,p1:S,t0:P,t1:T,startDist:A?A.startDist+A.length:0,length:D};E.segments.push(B),E.length+=D}for(var b=0;b<c.length;b++){var m=c[b],w=c[b-1];w&&(m.startDist=w.startDist+w.length),y(m,m.p0,g[b*v],0,a.bezierProjPcts[0]);for(var k=0;k<v-1;k++)y(m,g[b*v+k],g[b*v+k+1],a.bezierProjPcts[k],a.bezierProjPcts[k+1]);y(m,g[b*v+v-1],m.p2,a.bezierProjPcts[v-1],1)}return l.cache=c},u=function(c){var d,h=c==="source";if(i[c]){var p=e.pstyle(c+"-text-offset").pfValue;switch(r.edgeType){case"self":case"compound":case"bezier":case"multibezier":for(var f,g=l(),v=0,y=0,b=0;b<g.length;b++){for(var m=g[h?b:g.length-1-b],w=0;w<m.segments.length;w++){var k=m.segments[h?w:m.segments.length-1-w],E=b===g.length-1&&w===m.segments.length-1;if(v=y,(y+=k.length)>=p||E){f={cp:m,segment:k};break}}if(f)break}var x=f.cp,S=f.segment,P=(p-v)/S.length,T=S.t1-S.t0,D=h?S.t0+T*P:S.t1-T*P;D=$n(0,D,1),t=bn(x.p0,x.p1,x.p2,D),d=function(L,X,W,G){var U=$n(0,G-.001,1),Q=$n(0,G+.001,1),F=bn(L,X,W,U),O=bn(L,X,W,Q);return Cc(F,O)}(x.p0,x.p1,x.p2,D);break;case"straight":case"segments":case"haystack":for(var A,B,M,I,R=0,_=r.allpts.length,z=0;z+3<_&&(h?(M={x:r.allpts[z],y:r.allpts[z+1]},I={x:r.allpts[z+2],y:r.allpts[z+3]}):(M={x:r.allpts[_-2-z],y:r.allpts[_-1-z]},I={x:r.allpts[_-4-z],y:r.allpts[_-3-z]}),B=R,!((R+=A=tn(M,I))>=p));z+=2);var V=(p-B)/A;V=$n(0,V,1),t=function(L,X,W,G){var U=X.x-L.x,Q=X.y-L.y,F=tn(L,X),O=U/F,Y=Q/F;return W=W??0,G=G??W*F,{x:L.x+O*G,y:L.y+Y*G}}(M,I,V),d=Cc(M,I)}o("labelX",c,t.x),o("labelY",c,t.y),o("labelAutoAngle",c,d)}};u("source"),u("target"),this.applyLabelDimensions(e)}},It.applyLabelDimensions=function(e){this.applyPrefixedLabelDimensions(e),e.isEdge()&&(this.applyPrefixedLabelDimensions(e,"source"),this.applyPrefixedLabelDimensions(e,"target"))},It.applyPrefixedLabelDimensions=function(e,t){var n=e._private,r=this.getLabelText(e,t),a=en(r,e._private.labelDimsKey);if(ot(n.rscratch,"prefixedLabelDimsKey",t)!==a){Bt(n.rscratch,"prefixedLabelDimsKey",t,a);var i=this.calculateLabelDimensions(e,r),o=e.pstyle("line-height").pfValue,s=e.pstyle("text-wrap").strValue,l=ot(n.rscratch,"labelWrapCachedLines",t)||[],u=s!=="wrap"?1:Math.max(l.length,1),c=i.height/u,d=c*o,h=i.width,p=i.height+(u-1)*(o-1)*c;Bt(n.rstyle,"labelWidth",t,h),Bt(n.rscratch,"labelWidth",t,h),Bt(n.rstyle,"labelHeight",t,p),Bt(n.rscratch,"labelHeight",t,p),Bt(n.rscratch,"labelLineHeight",t,d)}},It.getLabelText=function(e,t){var n=e._private,r=t?t+"-":"",a=e.pstyle(r+"label").strValue,i=e.pstyle("text-transform").value,o=function(M,I){return I?(Bt(n.rscratch,M,t,I),I):ot(n.rscratch,M,t)};if(!a)return"";i=="none"||(i=="uppercase"?a=a.toUpperCase():i=="lowercase"&&(a=a.toLowerCase()));var s=e.pstyle("text-wrap").value;if(s==="wrap"){var l=o("labelKey");if(l!=null&&o("labelWrapKey")===l)return o("labelWrapCachedText");for(var u=a.split(`
`),c=e.pstyle("text-max-width").pfValue,d=e.pstyle("text-overflow-wrap").value==="anywhere",h=[],p=/[\s\u200b]+|$/g,f=0;f<u.length;f++){var g=u[f],v=this.calculateLabelDimensions(e,g).width;if(d){var y=g.split("").join("\u200B");g=y}if(v>c){var b,m="",w=0,k=it(g.matchAll(p));try{for(k.s();!(b=k.n()).done;){var E=b.value,x=E[0],S=g.substring(w,E.index);w=E.index+x.length;var P=m.length===0?S:m+S+x;this.calculateLabelDimensions(e,P).width<=c?m+=S+x:(m&&h.push(m),m=S+x)}}catch(M){k.e(M)}finally{k.f()}m.match(/^[\s\u200b]+$/)||h.push(m)}else h.push(g)}o("labelWrapCachedLines",h),a=o("labelWrapCachedText",h.join(`
`)),o("labelWrapKey",l)}else if(s==="ellipsis"){var T=e.pstyle("text-max-width").pfValue,D="",A=!1;if(this.calculateLabelDimensions(e,a).width<T)return a;for(var B=0;B<a.length&&!(this.calculateLabelDimensions(e,D+a[B]+"\u2026").width>T);B++)D+=a[B],B===a.length-1&&(A=!0);return A||(D+="\u2026"),D}return a},It.getLabelJustification=function(e){var t=e.pstyle("text-justification").strValue,n=e.pstyle("text-halign").strValue;if(t!=="auto")return t;if(!e.isNode())return"center";switch(n){case"left":return"right";case"right":return"left";default:return"center"}},It.calculateLabelDimensions=function(e,t){var n=this.cy.window().document,r=e.pstyle("font-style").strValue,a=e.pstyle("font-size").pfValue,i=e.pstyle("font-family").strValue,o=e.pstyle("font-weight").strValue,s=this.labelCalcCanvas,l=this.labelCalcCanvasContext;if(!s){s=this.labelCalcCanvas=n.createElement("canvas"),l=this.labelCalcCanvasContext=s.getContext("2d");var u=s.style;u.position="absolute",u.left="-9999px",u.top="-9999px",u.zIndex="-1",u.visibility="hidden",u.pointerEvents="none"}l.font="".concat(r," ").concat(o," ").concat(a,"px ").concat(i);for(var c=0,d=0,h=t.split(`
`),p=0;p<h.length;p++){var f=h[p],g=l.measureText(f),v=Math.ceil(g.width),y=a;c=Math.max(v,c),d+=y}return{width:c+=0,height:d+=0}},It.calculateLabelAngle=function(e,t){var n=e._private.rscratch,r=e.isEdge(),a=t?t+"-":"",i=e.pstyle(a+"text-rotation"),o=i.strValue;return o==="none"?0:r&&o==="autorotate"?n.labelAutoAngle:o==="autorotate"?0:i.pfValue},It.calculateLabelAngles=function(e){var t=this,n=e.isEdge(),r=e._private.rscratch;r.labelAngle=t.calculateLabelAngle(e),n&&(r.sourceLabelAngle=t.calculateLabelAngle(e,"source"),r.targetLabelAngle=t.calculateLabelAngle(e,"target"))};var Pc={},Sc=!1;Pc.getNodeShape=function(e){var t=e.pstyle("shape").value;if(t==="cutrectangle"&&(e.width()<28||e.height()<28))return Sc||(ke("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),Sc=!0),"rectangle";if(e.isParent())return t==="rectangle"||t==="roundrectangle"||t==="round-rectangle"||t==="cutrectangle"||t==="cut-rectangle"||t==="barrel"?t:"rectangle";if(t==="polygon"){var n=e.pstyle("shape-polygon-points").value;return this.nodeShapes.makePolygon(n).name}return t};var ap={registerCalculationListeners:function(){var e=this.cy,t=e.collection(),n=this,r=function(i){var o=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(t.merge(i),o)for(var s=0;s<i.length;s++){var l=i[s]._private.rstyle;l.clean=!1,l.cleanConnected=!1}};n.binder(e).on("bounds.* dirty.*",function(i){var o=i.target;r(o)}).on("style.* background.*",function(i){var o=i.target;r(o,!1)});var a=function(i){if(i){var o=n.onUpdateEleCalcsFns;t.cleanStyle();for(var s=0;s<t.length;s++){var l=t[s],u=l._private.rstyle;l.isNode()&&!u.cleanConnected&&(r(l.connectedEdges()),u.cleanConnected=!0)}if(o)for(var c=0;c<o.length;c++)(0,o[c])(i,t);n.recalculateRenderedStyle(t),t=e.collection()}};n.flushRenderedStyleQueue=function(){a(!0)},n.beforeRender(a,n.beforeRenderPriorities.eleCalcs)},onUpdateEleCalcs:function(e){(this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[]).push(e)},recalculateRenderedStyle:function(e,t){var n=function(y){return y._private.rstyle.cleanConnected};if(e.length!==0){var r=[],a=[];if(!this.destroyed){t===void 0&&(t=!0);for(var i=0;i<e.length;i++){var o=e[i],s=o._private,l=s.rstyle;!o.isEdge()||n(o.source())&&n(o.target())||(l.clean=!1),o.isEdge()&&o.isBundledBezier()&&o.parallelEdges().some(function(y){return!y._private.rstyle.clean&&y.isBundledBezier()})&&(l.clean=!1),t&&l.clean||o.removed()||o.pstyle("display").value!=="none"&&(s.group==="nodes"?a.push(o):r.push(o),l.clean=!0)}for(var u=0;u<a.length;u++){var c=a[u],d=c._private.rstyle,h=c.position();this.recalculateNodeLabelProjection(c),d.nodeX=h.x,d.nodeY=h.y,d.nodeW=c.pstyle("width").pfValue,d.nodeH=c.pstyle("height").pfValue}this.recalculateEdgeProjections(r);for(var p=0;p<r.length;p++){var f=r[p]._private,g=f.rstyle,v=f.rscratch;g.srcX=v.arrowStartX,g.srcY=v.arrowStartY,g.tgtX=v.arrowEndX,g.tgtY=v.arrowEndY,g.midX=v.midX,g.midY=v.midY,g.labelAngle=v.labelAngle,g.sourceLabelAngle=v.sourceLabelAngle,g.targetLabelAngle=v.targetLabelAngle}}}}},ip={updateCachedGrabbedEles:function(){var e=this.cachedZSortedEles;if(e){e.drag=[],e.nondrag=[];for(var t=[],n=0;n<e.length;n++){var r=(a=e[n])._private.rscratch;a.grabbed()&&!a.isParent()?t.push(a):r.inDragLayer?e.drag.push(a):e.nondrag.push(a)}for(n=0;n<t.length;n++){var a=t[n];e.drag.push(a)}}},invalidateCachedZSortedEles:function(){this.cachedZSortedEles=null},getCachedZSortedEles:function(e){if(e||!this.cachedZSortedEles){var t=this.cy.mutableElements().toArray();t.sort(Fu),t.interactive=t.filter(function(n){return n.interactive()}),this.cachedZSortedEles=t,this.updateCachedGrabbedEles()}else t=this.cachedZSortedEles;return t}},Bc={};[Jf,zi,et,np,Xi,It,Pc,ap,ip].forEach(function(e){ge(Bc,e)});var op={getCachedImage:function(e,t,n){var r=this.imageCache=this.imageCache||{},a=r[e];if(a)return a.image.complete||a.image.addEventListener("load",n),a.image;var i=(a=r[e]=r[e]||{}).image=new Image;i.addEventListener("load",n),i.addEventListener("error",function(){i.error=!0});var o="data:";return e.substring(0,5).toLowerCase()===o||(t=t==="null"?null:t,i.crossOrigin=t),i.src=e,i}},dr={registerBinding:function(e,t,n,r){var a=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(e)){for(var i=[],o=0;o<e.length;o++){var s=e[o];if(s!==void 0){var l=this.binder(s);i.push(l.on.apply(l,a))}}return i}return(l=this.binder(e)).on.apply(l,a)}};dr.binder=function(e){var t,n=this,r=n.cy.window(),a=e===r||e===r.document||e===r.document.body||(t=e,typeof HTMLElement<"u"&&t instanceof HTMLElement);if(n.supportsPassiveEvents==null){var i=!1;try{var o=Object.defineProperty({},"passive",{get:function(){return i=!0,!0}});r.addEventListener("test",null,o)}catch{}n.supportsPassiveEvents=i}var s=function(l,u,c){var d=Array.prototype.slice.call(arguments);return a&&n.supportsPassiveEvents&&(d[2]={capture:c!=null&&c,passive:!1,once:!1}),n.bindings.push({target:e,args:d}),(e.addEventListener||e.on).apply(e,d),this};return{on:s,addEventListener:s,addListener:s,bind:s}},dr.nodeIsDraggable=function(e){return e&&e.isNode()&&!e.locked()&&e.grabbable()},dr.nodeIsGrabbable=function(e){return this.nodeIsDraggable(e)&&e.interactive()},dr.load=function(){var e=this,t=e.cy.window(),n=function(C){return C.selected()},r=function(C,N,j,H){C==null&&(C=e.cy);for(var K=0;K<N.length;K++){var q=N[K];C.emit({originalEvent:j,type:q,position:H})}},a=function(C){return C.shiftKey||C.metaKey||C.ctrlKey},i=function(C,N){var j=!0;if(e.cy.hasCompoundNodes()&&C&&C.pannable()){for(var H=0;N&&H<N.length;H++)if((C=N[H]).isNode()&&C.isParent()&&!C.pannable()){j=!1;break}}else j=!0;return j},o=function(C){C[0]._private.rscratch.inDragLayer=!0},s=function(C){C[0]._private.rscratch.isGrabTarget=!0},l=function(C,N){var j=N.addToList;j.has(C)||!C.grabbable()||C.locked()||(j.merge(C),function(H){H[0]._private.grabbed=!0}(C))},u=function(C,N){N=N||{};var j=C.cy().hasCompoundNodes();N.inDragLayer&&(C.forEach(o),C.neighborhood().stdFilter(function(H){return!j||H.isEdge()}).forEach(o)),N.addToList&&C.forEach(function(H){l(H,N)}),function(H,K){if(H.cy().hasCompoundNodes()&&(K.inDragLayer!=null||K.addToList!=null)){var q=H.descendants();K.inDragLayer&&(q.forEach(o),q.connectedEdges().forEach(o)),K.addToList&&l(q,K)}}(C,N),h(C,{inDragLayer:N.inDragLayer}),e.updateCachedGrabbedEles()},c=u,d=function(C){C&&(e.getCachedZSortedEles().forEach(function(N){(function(j){j[0]._private.grabbed=!1})(N),function(j){j[0]._private.rscratch.inDragLayer=!1}(N),function(j){j[0]._private.rscratch.isGrabTarget=!1}(N)}),e.updateCachedGrabbedEles())},h=function(C,N){if((N.inDragLayer!=null||N.addToList!=null)&&C.cy().hasCompoundNodes()){var j=C.ancestors().orphans();if(!j.same(C)){var H=j.descendants().spawnSelf().merge(j).unmerge(C).unmerge(C.descendants()),K=H.connectedEdges();N.inDragLayer&&(K.forEach(o),H.forEach(o)),N.addToList&&H.forEach(function(q){l(q,N)})}}},p=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},f=typeof MutationObserver<"u",g=typeof ResizeObserver<"u";f?(e.removeObserver=new MutationObserver(function(C){for(var N=0;N<C.length;N++){var j=C[N].removedNodes;if(j){for(var H=0;H<j.length;H++)if(j[H]===e.container){e.destroy();break}}}}),e.container.parentNode&&e.removeObserver.observe(e.container.parentNode,{childList:!0})):e.registerBinding(e.container,"DOMNodeRemoved",function(C){e.destroy()});var v=Hn(function(){e.cy.resize()},100);f&&(e.styleObserver=new MutationObserver(v),e.styleObserver.observe(e.container,{attributes:!0})),e.registerBinding(t,"resize",v),g&&(e.resizeObserver=new ResizeObserver(v),e.resizeObserver.observe(e.container));var y=function(){e.invalidateContainerClientCoordsCache()};(function(C,N){for(;C!=null;)N(C),C=C.parentNode})(e.container,function(C){e.registerBinding(C,"transitionend",y),e.registerBinding(C,"animationend",y),e.registerBinding(C,"scroll",y)}),e.registerBinding(e.container,"contextmenu",function(C){C.preventDefault()});var b=function(C){for(var N=e.findContainerClientCoords(),j=N[0],H=N[1],K=N[2],q=N[3],Z=C.touches?C.touches:[C],ee=!1,ae=0;ae<Z.length;ae++){var re=Z[ae];if(j<=re.clientX&&re.clientX<=j+K&&H<=re.clientY&&re.clientY<=H+q){ee=!0;break}}if(!ee)return!1;for(var ye=e.container,he=C.target.parentNode,ie=!1;he;){if(he===ye){ie=!0;break}he=he.parentNode}return!!ie};e.registerBinding(e.container,"mousedown",function(C){if(b(C)&&(e.hoverData.which!==1||C.which===1)){C.preventDefault(),p(),e.hoverData.capture=!0,e.hoverData.which=C.which;var N=e.cy,j=[C.clientX,C.clientY],H=e.projectIntoViewport(j[0],j[1]),K=e.selection,q=e.findNearestElements(H[0],H[1],!0,!1),Z=q[0],ee=e.dragData.possibleDragElements;e.hoverData.mdownPos=H,e.hoverData.mdownGPos=j;var ae=function(he){return{originalEvent:C,type:he,position:{x:H[0],y:H[1]}}};if(C.which==3){e.hoverData.cxtStarted=!0;var re={originalEvent:C,type:"cxttapstart",position:{x:H[0],y:H[1]}};Z?(Z.activate(),Z.emit(re),e.hoverData.down=Z):N.emit(re),e.hoverData.downTime=new Date().getTime(),e.hoverData.cxtDragged=!1}else if(C.which==1){if(Z&&Z.activate(),Z!=null&&e.nodeIsGrabbable(Z)){if(s(Z),Z.selected()){ee=e.dragData.possibleDragElements=N.collection();var ye=N.$(function(he){return he.isNode()&&he.selected()&&e.nodeIsGrabbable(he)});u(ye,{addToList:ee}),Z.emit(ae("grabon")),ye.forEach(function(he){he.emit(ae("grab"))})}else ee=e.dragData.possibleDragElements=N.collection(),c(Z,{addToList:ee}),Z.emit(ae("grabon")).emit(ae("grab"));e.redrawHint("eles",!0),e.redrawHint("drag",!0)}e.hoverData.down=Z,e.hoverData.downs=q,e.hoverData.downTime=new Date().getTime(),r(Z,["mousedown","tapstart","vmousedown"],C,{x:H[0],y:H[1]}),Z==null?(K[4]=1,e.data.bgActivePosistion={x:H[0],y:H[1]},e.redrawHint("select",!0),e.redraw()):Z.pannable()&&(K[4]=1),e.hoverData.tapholdCancelled=!1,clearTimeout(e.hoverData.tapholdTimeout),e.hoverData.tapholdTimeout=setTimeout(function(){if(!e.hoverData.tapholdCancelled){var he=e.hoverData.down;he?he.emit(ae("taphold")):N.emit(ae("taphold"))}},e.tapholdDuration)}K[0]=K[2]=H[0],K[1]=K[3]=H[1]}},!1);var m,w,k,E=function(C){var N=C.getRootNode();if(N&&N.nodeType===11&&N.host!==void 0)return N}(e.container);e.registerBinding([t,E],"mousemove",function(C){if(e.hoverData.capture||b(C)){var N=!1,j=e.cy,H=j.zoom(),K=[C.clientX,C.clientY],q=e.projectIntoViewport(K[0],K[1]),Z=e.hoverData.mdownPos,ee=e.hoverData.mdownGPos,ae=e.selection,re=null;e.hoverData.draggingEles||e.hoverData.dragging||e.hoverData.selecting||(re=e.findNearestElement(q[0],q[1],!0,!1));var ye,he=e.hoverData.last,ie=e.hoverData.down,ve=[q[0]-ae[2],q[1]-ae[3]],be=e.dragData.possibleDragElements;if(ee){var Pe=K[0]-ee[0],Ae=Pe*Pe,Oe=K[1]-ee[1],Re=Ae+Oe*Oe;e.hoverData.isOverThresholdDrag=ye=Re>=e.desktopTapThreshold2}var tt=a(C);ye&&(e.hoverData.tapholdCancelled=!0),N=!0,r(re,["mousemove","vmousemove","tapdrag"],C,{x:q[0],y:q[1]});var _e=function(vt){return{originalEvent:C,type:vt,position:{x:q[0],y:q[1]}}},gt=function(){e.data.bgActivePosistion=void 0,e.hoverData.selecting||j.emit(_e("boxstart")),ae[4]=1,e.hoverData.selecting=!0,e.redrawHint("select",!0),e.redraw()};if(e.hoverData.which===3){if(ye){var Ve=_e("cxtdrag");ie?ie.emit(Ve):j.emit(Ve),e.hoverData.cxtDragged=!0,e.hoverData.cxtOver&&re===e.hoverData.cxtOver||(e.hoverData.cxtOver&&e.hoverData.cxtOver.emit(_e("cxtdragout")),e.hoverData.cxtOver=re,re&&re.emit(_e("cxtdragover")))}}else if(e.hoverData.dragging){if(N=!0,j.panningEnabled()&&j.userPanningEnabled()){var Fe;if(e.hoverData.justStartedPan){var Ct=e.hoverData.mdownPos;Fe={x:(q[0]-Ct[0])*H,y:(q[1]-Ct[1])*H},e.hoverData.justStartedPan=!1}else Fe={x:ve[0]*H,y:ve[1]*H};j.panBy(Fe),j.emit(_e("dragpan")),e.hoverData.dragged=!0}q=e.projectIntoViewport(C.clientX,C.clientY)}else if(ae[4]!=1||ie!=null&&!ie.pannable()){if(ie&&ie.pannable()&&ie.active()&&ie.unactivate(),ie&&ie.grabbed()||re==he||(he&&r(he,["mouseout","tapdragout"],C,{x:q[0],y:q[1]}),re&&r(re,["mouseover","tapdragover"],C,{x:q[0],y:q[1]}),e.hoverData.last=re),ie)if(ye){if(j.boxSelectionEnabled()&&tt)ie&&ie.grabbed()&&(d(be),ie.emit(_e("freeon")),be.emit(_e("free")),e.dragData.didDrag&&(ie.emit(_e("dragfreeon")),be.emit(_e("dragfree")))),gt();else if(ie&&ie.grabbed()&&e.nodeIsDraggable(ie)){var ut=!e.dragData.didDrag;ut&&e.redrawHint("eles",!0),e.dragData.didDrag=!0,e.hoverData.draggingEles||u(be,{inDragLayer:!0});var ct={x:0,y:0};if(oe(ve[0])&&oe(ve[1])&&(ct.x+=ve[0],ct.y+=ve[1],ut)){var dt=e.hoverData.dragDelta;dt&&oe(dt[0])&&oe(dt[1])&&(ct.x+=dt[0],ct.y+=dt[1])}e.hoverData.draggingEles=!0,be.silentShift(ct).emit(_e("position")).emit(_e("drag")),e.redrawHint("drag",!0),e.redraw()}}else(function(){var vt=e.hoverData.dragDelta=e.hoverData.dragDelta||[];vt.length===0?(vt.push(ve[0]),vt.push(ve[1])):(vt[0]+=ve[0],vt[1]+=ve[1])})();N=!0}else ye&&(e.hoverData.dragging||!j.boxSelectionEnabled()||!tt&&j.panningEnabled()&&j.userPanningEnabled()?!e.hoverData.selecting&&j.panningEnabled()&&j.userPanningEnabled()&&i(ie,e.hoverData.downs)&&(e.hoverData.dragging=!0,e.hoverData.justStartedPan=!0,ae[4]=0,e.data.bgActivePosistion=mn(Z),e.redrawHint("select",!0),e.redraw()):gt(),ie&&ie.pannable()&&ie.active()&&ie.unactivate());return ae[2]=q[0],ae[3]=q[1],N?(C.stopPropagation&&C.stopPropagation(),C.preventDefault&&C.preventDefault(),!1):void 0}},!1),e.registerBinding(t,"mouseup",function(C){if((e.hoverData.which!==1||C.which===1||!e.hoverData.capture)&&e.hoverData.capture){e.hoverData.capture=!1;var N=e.cy,j=e.projectIntoViewport(C.clientX,C.clientY),H=e.selection,K=e.findNearestElement(j[0],j[1],!0,!1),q=e.dragData.possibleDragElements,Z=e.hoverData.down,ee=a(C);e.data.bgActivePosistion&&(e.redrawHint("select",!0),e.redraw()),e.hoverData.tapholdCancelled=!0,e.data.bgActivePosistion=void 0,Z&&Z.unactivate();var ae=function(be){return{originalEvent:C,type:be,position:{x:j[0],y:j[1]}}};if(e.hoverData.which===3){var re=ae("cxttapend");if(Z?Z.emit(re):N.emit(re),!e.hoverData.cxtDragged){var ye=ae("cxttap");Z?Z.emit(ye):N.emit(ye)}e.hoverData.cxtDragged=!1,e.hoverData.which=null}else if(e.hoverData.which===1){if(r(K,["mouseup","tapend","vmouseup"],C,{x:j[0],y:j[1]}),e.dragData.didDrag||e.hoverData.dragged||e.hoverData.selecting||e.hoverData.isOverThresholdDrag||(r(Z,["click","tap","vclick"],C,{x:j[0],y:j[1]}),w=!1,C.timeStamp-k<=N.multiClickDebounceTime()?(m&&clearTimeout(m),w=!0,k=null,r(Z,["dblclick","dbltap","vdblclick"],C,{x:j[0],y:j[1]})):(m=setTimeout(function(){w||r(Z,["oneclick","onetap","voneclick"],C,{x:j[0],y:j[1]})},N.multiClickDebounceTime()),k=C.timeStamp)),Z!=null||e.dragData.didDrag||e.hoverData.selecting||e.hoverData.dragged||a(C)||(N.$(n).unselect(["tapunselect"]),q.length>0&&e.redrawHint("eles",!0),e.dragData.possibleDragElements=q=N.collection()),K!=Z||e.dragData.didDrag||e.hoverData.selecting||K!=null&&K._private.selectable&&(e.hoverData.dragging||(N.selectionType()==="additive"||ee?K.selected()?K.unselect(["tapunselect"]):K.select(["tapselect"]):ee||(N.$(n).unmerge(K).unselect(["tapunselect"]),K.select(["tapselect"]))),e.redrawHint("eles",!0)),e.hoverData.selecting){var he=N.collection(e.getAllInBox(H[0],H[1],H[2],H[3]));e.redrawHint("select",!0),he.length>0&&e.redrawHint("eles",!0),N.emit(ae("boxend"));var ie=function(be){return be.selectable()&&!be.selected()};N.selectionType()==="additive"||ee||N.$(n).unmerge(he).unselect(),he.emit(ae("box")).stdFilter(ie).select().emit(ae("boxselect")),e.redraw()}if(e.hoverData.dragging&&(e.hoverData.dragging=!1,e.redrawHint("select",!0),e.redrawHint("eles",!0),e.redraw()),!H[4]){e.redrawHint("drag",!0),e.redrawHint("eles",!0);var ve=Z&&Z.grabbed();d(q),ve&&(Z.emit(ae("freeon")),q.emit(ae("free")),e.dragData.didDrag&&(Z.emit(ae("dragfreeon")),q.emit(ae("dragfree"))))}}H[4]=0,e.hoverData.down=null,e.hoverData.cxtStarted=!1,e.hoverData.draggingEles=!1,e.hoverData.selecting=!1,e.hoverData.isOverThresholdDrag=!1,e.dragData.didDrag=!1,e.hoverData.dragged=!1,e.hoverData.dragDelta=[],e.hoverData.mdownPos=null,e.hoverData.mdownGPos=null,e.hoverData.which=null}},!1);var x,S,P,T,D,A,B,M,I,R,_,z,V,L,X=[],W=1e5,G=function(C){var N=!1,j=C.deltaY;if(j==null&&(C.wheelDeltaY!=null?j=C.wheelDeltaY/4:C.wheelDelta!=null&&(j=C.wheelDelta/4)),j!==0){if(x==null)if(X.length>=4){var H=X;if(x=function(ve,be){for(var Pe=0;Pe<ve.length;Pe++)if(ve[Pe]%be!==0)return!1;return!0}(H,5),!x){var K=Math.abs(H[0]);x=function(ve){for(var be=Math.abs(ve[0]),Pe=1;Pe<ve.length;Pe++)if(Math.abs(ve[Pe])!==be)return!1;return!0}(H)&&K>5}if(x)for(var q=0;q<H.length;q++)W=Math.min(Math.abs(H[q]),W)}else X.push(j),N=!0;else x&&(W=Math.min(Math.abs(j),W));if(!e.scrollingPage){var Z=e.cy,ee=Z.zoom(),ae=Z.pan(),re=e.projectIntoViewport(C.clientX,C.clientY),ye=[re[0]*ee+ae.x,re[1]*ee+ae.y];if(e.hoverData.draggingEles||e.hoverData.dragging||e.hoverData.cxtStarted||e.selection[4]!==0)C.preventDefault();else if(Z.panningEnabled()&&Z.userPanningEnabled()&&Z.zoomingEnabled()&&Z.userZoomingEnabled()){var he;C.preventDefault(),e.data.wheelZooming=!0,clearTimeout(e.data.wheelTimeout),e.data.wheelTimeout=setTimeout(function(){e.data.wheelZooming=!1,e.redrawHint("eles",!0),e.redraw()},150),N&&Math.abs(j)>5&&(j=5*Aa(j)),he=j/-250,x&&(he/=W,he*=3),he*=e.wheelSensitivity,C.deltaMode===1&&(he*=33);var ie=Z.zoom()*Math.pow(10,he);C.type==="gesturechange"&&(ie=e.gestureStartZoom*C.scale),Z.zoom({level:ie,renderedPosition:{x:ye[0],y:ye[1]}}),Z.emit({type:C.type==="gesturechange"?"pinchzoom":"scrollzoom",originalEvent:C,position:{x:re[0],y:re[1]}})}}}};e.registerBinding(e.container,"wheel",G,!0),e.registerBinding(t,"scroll",function(C){e.scrollingPage=!0,clearTimeout(e.scrollingPageTimeout),e.scrollingPageTimeout=setTimeout(function(){e.scrollingPage=!1},250)},!0),e.registerBinding(e.container,"gesturestart",function(C){e.gestureStartZoom=e.cy.zoom(),e.hasTouchStarted||C.preventDefault()},!0),e.registerBinding(e.container,"gesturechange",function(C){e.hasTouchStarted||G(C)},!0),e.registerBinding(e.container,"mouseout",function(C){var N=e.projectIntoViewport(C.clientX,C.clientY);e.cy.emit({originalEvent:C,type:"mouseout",position:{x:N[0],y:N[1]}})},!1),e.registerBinding(e.container,"mouseover",function(C){var N=e.projectIntoViewport(C.clientX,C.clientY);e.cy.emit({originalEvent:C,type:"mouseover",position:{x:N[0],y:N[1]}})},!1);var U,Q,F,O,Y,$,J,ne=function(C,N,j,H){return Math.sqrt((j-C)*(j-C)+(H-N)*(H-N))},le=function(C,N,j,H){return(j-C)*(j-C)+(H-N)*(H-N)};if(e.registerBinding(e.container,"touchstart",U=function(C){if(e.hasTouchStarted=!0,b(C)){p(),e.touchData.capture=!0,e.data.bgActivePosistion=void 0;var N=e.cy,j=e.touchData.now,H=e.touchData.earlier;if(C.touches[0]){var K=e.projectIntoViewport(C.touches[0].clientX,C.touches[0].clientY);j[0]=K[0],j[1]=K[1]}C.touches[1]&&(K=e.projectIntoViewport(C.touches[1].clientX,C.touches[1].clientY),j[2]=K[0],j[3]=K[1]),C.touches[2]&&(K=e.projectIntoViewport(C.touches[2].clientX,C.touches[2].clientY),j[4]=K[0],j[5]=K[1]);var q=function(Re){return{originalEvent:C,type:Re,position:{x:j[0],y:j[1]}}};if(C.touches[1]){e.touchData.singleTouchMoved=!0,d(e.dragData.touchDragEles);var Z=e.findContainerClientCoords();R=Z[0],_=Z[1],z=Z[2],V=Z[3],S=C.touches[0].clientX-R,P=C.touches[0].clientY-_,T=C.touches[1].clientX-R,D=C.touches[1].clientY-_,L=0<=S&&S<=z&&0<=T&&T<=z&&0<=P&&P<=V&&0<=D&&D<=V;var ee=N.pan(),ae=N.zoom();if(A=ne(S,P,T,D),B=le(S,P,T,D),I=[((M=[(S+T)/2,(P+D)/2])[0]-ee.x)/ae,(M[1]-ee.y)/ae],B<4e4&&!C.touches[2]){var re=e.findNearestElement(j[0],j[1],!0,!0),ye=e.findNearestElement(j[2],j[3],!0,!0);return re&&re.isNode()?(re.activate().emit(q("cxttapstart")),e.touchData.start=re):ye&&ye.isNode()?(ye.activate().emit(q("cxttapstart")),e.touchData.start=ye):N.emit(q("cxttapstart")),e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxt=!0,e.touchData.cxtDragged=!1,e.data.bgActivePosistion=void 0,void e.redraw()}}if(C.touches[2])N.boxSelectionEnabled()&&C.preventDefault();else if(!C.touches[1]){if(C.touches[0]){var he=e.findNearestElements(j[0],j[1],!0,!0),ie=he[0];if(ie!=null&&(ie.activate(),e.touchData.start=ie,e.touchData.starts=he,e.nodeIsGrabbable(ie))){var ve=e.dragData.touchDragEles=N.collection(),be=null;e.redrawHint("eles",!0),e.redrawHint("drag",!0),ie.selected()?(be=N.$(function(Re){return Re.selected()&&e.nodeIsGrabbable(Re)}),u(be,{addToList:ve})):c(ie,{addToList:ve}),s(ie),ie.emit(q("grabon")),be?be.forEach(function(Re){Re.emit(q("grab"))}):ie.emit(q("grab"))}r(ie,["touchstart","tapstart","vmousedown"],C,{x:j[0],y:j[1]}),ie==null&&(e.data.bgActivePosistion={x:K[0],y:K[1]},e.redrawHint("select",!0),e.redraw()),e.touchData.singleTouchMoved=!1,e.touchData.singleTouchStartTime=+new Date,clearTimeout(e.touchData.tapholdTimeout),e.touchData.tapholdTimeout=setTimeout(function(){e.touchData.singleTouchMoved!==!1||e.pinching||e.touchData.selecting||r(e.touchData.start,["taphold"],C,{x:j[0],y:j[1]})},e.tapholdDuration)}}if(C.touches.length>=1){for(var Pe=e.touchData.startPosition=[null,null,null,null,null,null],Ae=0;Ae<j.length;Ae++)Pe[Ae]=H[Ae]=j[Ae];var Oe=C.touches[0];e.touchData.startGPosition=[Oe.clientX,Oe.clientY]}}},!1),e.registerBinding(t,"touchmove",Q=function(C){var N=e.touchData.capture;if(N||b(C)){var j=e.selection,H=e.cy,K=e.touchData.now,q=e.touchData.earlier,Z=H.zoom();if(C.touches[0]){var ee=e.projectIntoViewport(C.touches[0].clientX,C.touches[0].clientY);K[0]=ee[0],K[1]=ee[1]}C.touches[1]&&(ee=e.projectIntoViewport(C.touches[1].clientX,C.touches[1].clientY),K[2]=ee[0],K[3]=ee[1]),C.touches[2]&&(ee=e.projectIntoViewport(C.touches[2].clientX,C.touches[2].clientY),K[4]=ee[0],K[5]=ee[1]);var ae,re=function(hd){return{originalEvent:C,type:hd,position:{x:K[0],y:K[1]}}},ye=e.touchData.startGPosition;if(N&&C.touches[0]&&ye){for(var he=[],ie=0;ie<K.length;ie++)he[ie]=K[ie]-q[ie];var ve=C.touches[0].clientX-ye[0],be=ve*ve,Pe=C.touches[0].clientY-ye[1];ae=be+Pe*Pe>=e.touchTapThreshold2}if(N&&e.touchData.cxt){C.preventDefault();var Ae=C.touches[0].clientX-R,Oe=C.touches[0].clientY-_,Re=C.touches[1].clientX-R,tt=C.touches[1].clientY-_,_e=le(Ae,Oe,Re,tt);if(_e/B>=2.25||_e>=22500){e.touchData.cxt=!1,e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);var gt=re("cxttapend");e.touchData.start?(e.touchData.start.unactivate().emit(gt),e.touchData.start=null):H.emit(gt)}}if(N&&e.touchData.cxt){gt=re("cxtdrag"),e.data.bgActivePosistion=void 0,e.redrawHint("select",!0),e.touchData.start?e.touchData.start.emit(gt):H.emit(gt),e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxtDragged=!0;var Ve=e.findNearestElement(K[0],K[1],!0,!0);e.touchData.cxtOver&&Ve===e.touchData.cxtOver||(e.touchData.cxtOver&&e.touchData.cxtOver.emit(re("cxtdragout")),e.touchData.cxtOver=Ve,Ve&&Ve.emit(re("cxtdragover")))}else if(N&&C.touches[2]&&H.boxSelectionEnabled())C.preventDefault(),e.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,e.touchData.selecting||H.emit(re("boxstart")),e.touchData.selecting=!0,e.touchData.didSelect=!0,j[4]=1,j&&j.length!==0&&j[0]!==void 0?(j[2]=(K[0]+K[2]+K[4])/3,j[3]=(K[1]+K[3]+K[5])/3):(j[0]=(K[0]+K[2]+K[4])/3,j[1]=(K[1]+K[3]+K[5])/3,j[2]=(K[0]+K[2]+K[4])/3+1,j[3]=(K[1]+K[3]+K[5])/3+1),e.redrawHint("select",!0),e.redraw();else if(N&&C.touches[1]&&!e.touchData.didSelect&&H.zoomingEnabled()&&H.panningEnabled()&&H.userZoomingEnabled()&&H.userPanningEnabled()){if(C.preventDefault(),e.data.bgActivePosistion=void 0,e.redrawHint("select",!0),Pt=e.dragData.touchDragEles){e.redrawHint("drag",!0);for(var Fe=0;Fe<Pt.length;Fe++){var Ct=Pt[Fe]._private;Ct.grabbed=!1,Ct.rscratch.inDragLayer=!1}}var ut=e.touchData.start,ct=(Ae=C.touches[0].clientX-R,Oe=C.touches[0].clientY-_,Re=C.touches[1].clientX-R,tt=C.touches[1].clientY-_,ne(Ae,Oe,Re,tt)),dt=ct/A;if(L){var vt=(Ae-S+(Re-T))/2,cd=(Oe-P+(tt-D))/2,Vn=H.zoom(),pa=Vn*dt,vr=H.pan(),to=I[0]*Vn+vr.x,no=I[1]*Vn+vr.y,dd={x:-pa/Vn*(to-vr.x-vt)+to,y:-pa/Vn*(no-vr.y-cd)+no};if(ut&&ut.active()){var Pt=e.dragData.touchDragEles;d(Pt),e.redrawHint("drag",!0),e.redrawHint("eles",!0),ut.unactivate().emit(re("freeon")),Pt.emit(re("free")),e.dragData.didDrag&&(ut.emit(re("dragfreeon")),Pt.emit(re("dragfree")))}H.viewport({zoom:pa,pan:dd,cancelOnFailedZoom:!0}),H.emit(re("pinchzoom")),A=ct,S=Ae,P=Oe,T=Re,D=tt,e.pinching=!0}C.touches[0]&&(ee=e.projectIntoViewport(C.touches[0].clientX,C.touches[0].clientY),K[0]=ee[0],K[1]=ee[1]),C.touches[1]&&(ee=e.projectIntoViewport(C.touches[1].clientX,C.touches[1].clientY),K[2]=ee[0],K[3]=ee[1]),C.touches[2]&&(ee=e.projectIntoViewport(C.touches[2].clientX,C.touches[2].clientY),K[4]=ee[0],K[5]=ee[1])}else if(C.touches[0]&&!e.touchData.didSelect){var yt=e.touchData.start,ga=e.touchData.last;if(e.hoverData.draggingEles||e.swipePanning||(Ve=e.findNearestElement(K[0],K[1],!0,!0)),N&&yt!=null&&C.preventDefault(),N&&yt!=null&&e.nodeIsDraggable(yt))if(ae){Pt=e.dragData.touchDragEles;var ro=!e.dragData.didDrag;ro&&u(Pt,{inDragLayer:!0}),e.dragData.didDrag=!0;var Fn={x:0,y:0};oe(he[0])&&oe(he[1])&&(Fn.x+=he[0],Fn.y+=he[1],ro&&(e.redrawHint("eles",!0),(wt=e.touchData.dragDelta)&&oe(wt[0])&&oe(wt[1])&&(Fn.x+=wt[0],Fn.y+=wt[1]))),e.hoverData.draggingEles=!0,Pt.silentShift(Fn).emit(re("position")).emit(re("drag")),e.redrawHint("drag",!0),e.touchData.startPosition[0]==q[0]&&e.touchData.startPosition[1]==q[1]&&e.redrawHint("eles",!0),e.redraw()}else{var wt;(wt=e.touchData.dragDelta=e.touchData.dragDelta||[]).length===0?(wt.push(he[0]),wt.push(he[1])):(wt[0]+=he[0],wt[1]+=he[1])}if(r(yt||Ve,["touchmove","tapdrag","vmousemove"],C,{x:K[0],y:K[1]}),yt&&yt.grabbed()||Ve==ga||(ga&&ga.emit(re("tapdragout")),Ve&&Ve.emit(re("tapdragover"))),e.touchData.last=Ve,N)for(Fe=0;Fe<K.length;Fe++)K[Fe]&&e.touchData.startPosition[Fe]&&ae&&(e.touchData.singleTouchMoved=!0);N&&(yt==null||yt.pannable())&&H.panningEnabled()&&H.userPanningEnabled()&&(i(yt,e.touchData.starts)&&(C.preventDefault(),e.data.bgActivePosistion||(e.data.bgActivePosistion=mn(e.touchData.startPosition)),e.swipePanning?(H.panBy({x:he[0]*Z,y:he[1]*Z}),H.emit(re("dragpan"))):ae&&(e.swipePanning=!0,H.panBy({x:ve*Z,y:Pe*Z}),H.emit(re("dragpan")),yt&&(yt.unactivate(),e.redrawHint("select",!0),e.touchData.start=null))),ee=e.projectIntoViewport(C.touches[0].clientX,C.touches[0].clientY),K[0]=ee[0],K[1]=ee[1])}for(ie=0;ie<K.length;ie++)q[ie]=K[ie];N&&C.touches.length>0&&!e.hoverData.draggingEles&&!e.swipePanning&&e.data.bgActivePosistion!=null&&(e.data.bgActivePosistion=void 0,e.redrawHint("select",!0),e.redraw())}},!1),e.registerBinding(t,"touchcancel",F=function(C){var N=e.touchData.start;e.touchData.capture=!1,N&&N.unactivate()}),e.registerBinding(t,"touchend",O=function(C){var N=e.touchData.start;if(e.touchData.capture){C.touches.length===0&&(e.touchData.capture=!1),C.preventDefault();var j=e.selection;e.swipePanning=!1,e.hoverData.draggingEles=!1;var H=e.cy,K=H.zoom(),q=e.touchData.now,Z=e.touchData.earlier;if(C.touches[0]){var ee=e.projectIntoViewport(C.touches[0].clientX,C.touches[0].clientY);q[0]=ee[0],q[1]=ee[1]}C.touches[1]&&(ee=e.projectIntoViewport(C.touches[1].clientX,C.touches[1].clientY),q[2]=ee[0],q[3]=ee[1]),C.touches[2]&&(ee=e.projectIntoViewport(C.touches[2].clientX,C.touches[2].clientY),q[4]=ee[0],q[5]=ee[1]);var ae,re=function(_e){return{originalEvent:C,type:_e,position:{x:q[0],y:q[1]}}};if(N&&N.unactivate(),e.touchData.cxt){if(ae=re("cxttapend"),N?N.emit(ae):H.emit(ae),!e.touchData.cxtDragged){var ye=re("cxttap");N?N.emit(ye):H.emit(ye)}return e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxt=!1,e.touchData.start=null,void e.redraw()}if(!C.touches[2]&&H.boxSelectionEnabled()&&e.touchData.selecting){e.touchData.selecting=!1;var he=H.collection(e.getAllInBox(j[0],j[1],j[2],j[3]));j[0]=void 0,j[1]=void 0,j[2]=void 0,j[3]=void 0,j[4]=0,e.redrawHint("select",!0),H.emit(re("boxend")),he.emit(re("box")).stdFilter(function(_e){return _e.selectable()&&!_e.selected()}).select().emit(re("boxselect")),he.nonempty()&&e.redrawHint("eles",!0),e.redraw()}if(N!=null&&N.unactivate(),C.touches[2])e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);else if(!C.touches[1]){if(!C.touches[0]){if(!C.touches[0]){e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);var ie=e.dragData.touchDragEles;if(N!=null){var ve=N._private.grabbed;d(ie),e.redrawHint("drag",!0),e.redrawHint("eles",!0),ve&&(N.emit(re("freeon")),ie.emit(re("free")),e.dragData.didDrag&&(N.emit(re("dragfreeon")),ie.emit(re("dragfree")))),r(N,["touchend","tapend","vmouseup","tapdragout"],C,{x:q[0],y:q[1]}),N.unactivate(),e.touchData.start=null}else{var be=e.findNearestElement(q[0],q[1],!0,!0);r(be,["touchend","tapend","vmouseup","tapdragout"],C,{x:q[0],y:q[1]})}var Pe=e.touchData.startPosition[0]-q[0],Ae=Pe*Pe,Oe=e.touchData.startPosition[1]-q[1],Re=(Ae+Oe*Oe)*K*K;e.touchData.singleTouchMoved||(N||H.$(":selected").unselect(["tapunselect"]),r(N,["tap","vclick"],C,{x:q[0],y:q[1]}),Y=!1,C.timeStamp-J<=H.multiClickDebounceTime()?($&&clearTimeout($),Y=!0,J=null,r(N,["dbltap","vdblclick"],C,{x:q[0],y:q[1]})):($=setTimeout(function(){Y||r(N,["onetap","voneclick"],C,{x:q[0],y:q[1]})},H.multiClickDebounceTime()),J=C.timeStamp)),N!=null&&!e.dragData.didDrag&&N._private.selectable&&Re<e.touchTapThreshold2&&!e.pinching&&(H.selectionType()==="single"?(H.$(n).unmerge(N).unselect(["tapunselect"]),N.select(["tapselect"])):N.selected()?N.unselect(["tapunselect"]):N.select(["tapselect"]),e.redrawHint("eles",!0)),e.touchData.singleTouchMoved=!0}}}for(var tt=0;tt<q.length;tt++)Z[tt]=q[tt];e.dragData.didDrag=!1,C.touches.length===0&&(e.touchData.dragDelta=[],e.touchData.startPosition=[null,null,null,null,null,null],e.touchData.startGPosition=null,e.touchData.didSelect=!1),C.touches.length<2&&(C.touches.length===1&&(e.touchData.startGPosition=[C.touches[0].clientX,C.touches[0].clientY]),e.pinching=!1,e.redrawHint("eles",!0),e.redraw())}},!1),typeof TouchEvent>"u"){var fe=[],ce=function(C){return{clientX:C.clientX,clientY:C.clientY,force:1,identifier:C.pointerId,pageX:C.pageX,pageY:C.pageY,radiusX:C.width/2,radiusY:C.height/2,screenX:C.screenX,screenY:C.screenY,target:C.target}},te=function(C){fe.push(function(N){return{event:N,touch:ce(N)}}(C))},se=function(C){for(var N=0;N<fe.length;N++)if(fe[N].event.pointerId===C.pointerId)return void fe.splice(N,1)},de=function(C){C.touches=fe.map(function(N){return N.touch})},ue=function(C){return C.pointerType==="mouse"||C.pointerType===4};e.registerBinding(e.container,"pointerdown",function(C){ue(C)||(C.preventDefault(),te(C),de(C),U(C))}),e.registerBinding(e.container,"pointerup",function(C){ue(C)||(se(C),de(C),O(C))}),e.registerBinding(e.container,"pointercancel",function(C){ue(C)||(se(C),de(C),F())}),e.registerBinding(e.container,"pointermove",function(C){ue(C)||(C.preventDefault(),function(N){var j=fe.filter(function(H){return H.event.pointerId===N.pointerId})[0];j.event=N,j.touch=ce(N)}(C),de(C),Q(C))})}};var $t={generatePolygon:function(e,t){return this.nodeShapes[e]={renderer:this,name:e,points:t,draw:function(n,r,a,i,o,s){this.renderer.nodeShapeImpl("polygon",n,r,a,i,o,this.points)},intersectLine:function(n,r,a,i,o,s,l,u){return Jn(o,s,this.points,n,r,a/2,i/2,l)},checkPoint:function(n,r,a,i,o,s,l,u){return Dt(n,r,this.points,s,l,i,o,[0,-1],a)},hasMiterBounds:e!=="rectangle",miterBounds:function(n,r,a,i,o,s){return Gd(this.points,n,r,a,i,o)}}}};$t.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,t,n,r,a,i){this.renderer.nodeShapeImpl(this.name,e,t,n,r,a)},intersectLine:function(e,t,n,r,a,i,o,s){return function(l,u,c,d,h,p){var f=c-l,g=d-u;f/=h,g/=p;var v=Math.sqrt(f*f+g*g),y=v-1;if(y<0)return[];var b=y/v;return[(c-l)*b+l,(d-u)*b+u]}(a,i,e,t,n/2+o,r/2+o)},checkPoint:function(e,t,n,r,a,i,o,s){return rn(e,t,r,a,i,o,n)}}},$t.generateRoundPolygon=function(e,t){return this.nodeShapes[e]={renderer:this,name:e,points:t,getOrCreateCorners:function(n,r,a,i,o,s,l){if(s[l]!==void 0&&s[l+"-cx"]===n&&s[l+"-cy"]===r)return s[l];s[l]=new Array(t.length/2),s[l+"-cx"]=n,s[l+"-cy"]=r;var u=a/2,c=i/2;o=o==="auto"?ds(a,i):o;for(var d=new Array(t.length/2),h=0;h<t.length/2;h++)d[h]={x:n+u*t[2*h],y:r+c*t[2*h+1]};var p,f,g,v,y=d.length;for(f=d[y-1],p=0;p<y;p++)g=d[p%y],v=d[(p+1)%y],s[l][p]=ji(f,g,v,o),f=g,g=v;return s[l]},draw:function(n,r,a,i,o,s,l){this.renderer.nodeShapeImpl("round-polygon",n,r,a,i,o,this.points,this.getOrCreateCorners(r,a,i,o,s,l,"drawCorners"))},intersectLine:function(n,r,a,i,o,s,l,u,c){return function(d,h,p,f,g,v,y,b,m){var w,k=[],E=new Array(2*p.length);m.forEach(function(A,B){B===0?(E[E.length-2]=A.startX,E[E.length-1]=A.startY):(E[4*B-2]=A.startX,E[4*B-1]=A.startY),E[4*B]=A.stopX,E[4*B+1]=A.stopY,(w=Qn(d,h,f,g,A.cx,A.cy,A.radius)).length!==0&&k.push(w[0],w[1])});for(var x=0;x<E.length/4;x++)(w=Yt(d,h,f,g,E[4*x],E[4*x+1],E[4*x+2],E[4*x+3],!1)).length!==0&&k.push(w[0],w[1]);if(k.length>2){for(var S=[k[0],k[1]],P=Math.pow(S[0]-d,2)+Math.pow(S[1]-h,2),T=1;T<k.length/2;T++){var D=Math.pow(k[2*T]-d,2)+Math.pow(k[2*T+1]-h,2);D<=P&&(S[0]=k[2*T],S[1]=k[2*T+1],P=D)}return S}return k}(o,s,this.points,n,r,0,0,0,this.getOrCreateCorners(n,r,a,i,u,c,"corners"))},checkPoint:function(n,r,a,i,o,s,l,u,c){return function(d,h,p,f,g,v,y,b){for(var m=new Array(2*p.length),w=0;w<b.length;w++){var k=b[w];if(m[4*w+0]=k.startX,m[4*w+1]=k.startY,m[4*w+2]=k.stopX,m[4*w+3]=k.stopY,Math.pow(k.cx-d,2)+Math.pow(k.cy-h,2)<=Math.pow(k.radius,2))return!0}return st(d,h,m)}(n,r,this.points,0,0,0,0,this.getOrCreateCorners(s,l,i,o,u,c,"corners"))}}},$t.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:rt(4,0),draw:function(e,t,n,r,a,i){this.renderer.nodeShapeImpl(this.name,e,t,n,r,a,this.points,i)},intersectLine:function(e,t,n,r,a,i,o,s){return us(a,i,e,t,n,r,o,s)},checkPoint:function(e,t,n,r,a,i,o,s){var l=r/2,u=a/2;s=s==="auto"?jt(r,a):s;var c=2*(s=Math.min(l,u,s));return!!Dt(e,t,this.points,i,o,r,a-c,[0,-1],n)||!!Dt(e,t,this.points,i,o,r-c,a,[0,-1],n)||!!rn(e,t,c,c,i-l+s,o-u+s,n)||!!rn(e,t,c,c,i+l-s,o-u+s,n)||!!rn(e,t,c,c,i+l-s,o+u-s,n)||!!rn(e,t,c,c,i-l+s,o+u-s,n)}}},$t.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:8,points:rt(4,0),draw:function(e,t,n,r,a,i){this.renderer.nodeShapeImpl(this.name,e,t,n,r,a,null,i)},generateCutTrianglePts:function(e,t,n,r,a){var i=a==="auto"?this.cornerLength:a,o=t/2,s=e/2,l=n-s,u=n+s,c=r-o,d=r+o;return{topLeft:[l,c+i,l+i,c,l+i,c+i],topRight:[u-i,c,u,c+i,u-i,c+i],bottomRight:[u,d-i,u-i,d,u-i,d-i],bottomLeft:[l+i,d,l,d-i,l+i,d-i]}},intersectLine:function(e,t,n,r,a,i,o,s){var l=this.generateCutTrianglePts(n+2*o,r+2*o,e,t,s),u=[].concat.apply([],[l.topLeft.splice(0,4),l.topRight.splice(0,4),l.bottomRight.splice(0,4),l.bottomLeft.splice(0,4)]);return Jn(a,i,u,e,t)},checkPoint:function(e,t,n,r,a,i,o,s){var l=s==="auto"?this.cornerLength:s;if(Dt(e,t,this.points,i,o,r,a-2*l,[0,-1],n)||Dt(e,t,this.points,i,o,r-2*l,a,[0,-1],n))return!0;var u=this.generateCutTrianglePts(r,a,i,o);return st(e,t,u.topLeft)||st(e,t,u.topRight)||st(e,t,u.bottomRight)||st(e,t,u.bottomLeft)}}},$t.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:rt(4,0),draw:function(e,t,n,r,a,i){this.renderer.nodeShapeImpl(this.name,e,t,n,r,a)},intersectLine:function(e,t,n,r,a,i,o,s){var l=this.generateBarrelBezierPts(n+2*o,r+2*o,e,t),u=function(d){var h=bn({x:d[0],y:d[1]},{x:d[2],y:d[3]},{x:d[4],y:d[5]},.15),p=bn({x:d[0],y:d[1]},{x:d[2],y:d[3]},{x:d[4],y:d[5]},.5),f=bn({x:d[0],y:d[1]},{x:d[2],y:d[3]},{x:d[4],y:d[5]},.85);return[d[0],d[1],h.x,h.y,p.x,p.y,f.x,f.y,d[4],d[5]]},c=[].concat(u(l.topLeft),u(l.topRight),u(l.bottomRight),u(l.bottomLeft));return Jn(a,i,c,e,t)},generateBarrelBezierPts:function(e,t,n,r){var a=t/2,i=e/2,o=n-i,s=n+i,l=r-a,u=r+a,c=Ra(e,t),d=c.heightOffset,h=c.widthOffset,p=c.ctrlPtOffsetPct*e,f={topLeft:[o,l+d,o+p,l,o+h,l],topRight:[s-h,l,s-p,l,s,l+d],bottomRight:[s,u-d,s-p,u,s-h,u],bottomLeft:[o+h,u,o+p,u,o,u-d]};return f.topLeft.isTop=!0,f.topRight.isTop=!0,f.bottomLeft.isBottom=!0,f.bottomRight.isBottom=!0,f},checkPoint:function(e,t,n,r,a,i,o,s){var l=Ra(r,a),u=l.heightOffset,c=l.widthOffset;if(Dt(e,t,this.points,i,o,r,a-2*u,[0,-1],n)||Dt(e,t,this.points,i,o,r-2*c,a,[0,-1],n))return!0;for(var d=this.generateBarrelBezierPts(r,a,i,o),h=function(k,E,x){var S,P,T=x[4],D=x[2],A=x[0],B=x[5],M=x[1],I=Math.min(T,A),R=Math.max(T,A),_=Math.min(B,M),z=Math.max(B,M);if(I<=k&&k<=R&&_<=E&&E<=z){var V=[(S=T)-2*(P=D)+A,2*(P-S),S],L=function(X,W,G,U){var Q=W*W-4*X*(G-=U);if(Q<0)return[];var F=Math.sqrt(Q),O=2*X;return[(-W+F)/O,(-W-F)/O]}(V[0],V[1],V[2],k).filter(function(X){return 0<=X&&X<=1});if(L.length>0)return L[0]}return null},p=Object.keys(d),f=0;f<p.length;f++){var g=d[p[f]],v=h(e,t,g);if(v!=null){var y=g[5],b=g[3],m=g[1],w=We(y,b,m,v);if(g.isTop&&w<=t||g.isBottom&&t<=w)return!0}}return!1}}},$t.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:rt(4,0),draw:function(e,t,n,r,a,i){this.renderer.nodeShapeImpl(this.name,e,t,n,r,a,this.points,i)},intersectLine:function(e,t,n,r,a,i,o,s){var l=t-(r/2+o),u=Yt(a,i,e,t,e-(n/2+o),l,e+(n/2+o),l,!1);return u.length>0?u:us(a,i,e,t,n,r,o,s)},checkPoint:function(e,t,n,r,a,i,o,s){var l=2*(s=s==="auto"?jt(r,a):s);if(Dt(e,t,this.points,i,o,r,a-l,[0,-1],n)||Dt(e,t,this.points,i,o,r-l,a,[0,-1],n))return!0;var u=r/2+2*n,c=a/2+2*n;return!!st(e,t,[i-u,o-c,i-u,o,i+u,o,i+u,o-c])||!!rn(e,t,l,l,i+r/2-s,o+a/2-s,n)||!!rn(e,t,l,l,i-r/2+s,o+a/2-s,n)}}},$t.registerNodeShapes=function(){var e=this.nodeShapes={},t=this;this.generateEllipse(),this.generatePolygon("triangle",rt(3,0)),this.generateRoundPolygon("round-triangle",rt(3,0)),this.generatePolygon("rectangle",rt(4,0)),e.square=e.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();var n=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",n),this.generateRoundPolygon("round-diamond",n),this.generatePolygon("pentagon",rt(5,0)),this.generateRoundPolygon("round-pentagon",rt(5,0)),this.generatePolygon("hexagon",rt(6,0)),this.generateRoundPolygon("round-hexagon",rt(6,0)),this.generatePolygon("heptagon",rt(7,0)),this.generateRoundPolygon("round-heptagon",rt(7,0)),this.generatePolygon("octagon",rt(8,0)),this.generateRoundPolygon("round-octagon",rt(8,0));var r=new Array(20),a=Na(5,0),i=Na(5,Math.PI/5),o=.5*(3-Math.sqrt(5));o*=1.57;for(var s=0;s<i.length/2;s++)i[2*s]*=o,i[2*s+1]*=o;for(s=0;s<5;s++)r[4*s]=a[2*s],r[4*s+1]=a[2*s+1],r[4*s+2]=i[2*s],r[4*s+3]=i[2*s+1];r=cs(r),this.generatePolygon("star",r),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);var l=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",l),this.generateRoundPolygon("round-tag",l),e.makePolygon=function(u){var c,d="polygon-"+u.join("$");return(c=this[d])?c:t.generatePolygon(d,u)}};var _c={timeToRender:function(){return this.redrawTotalTime/this.redrawCount},redraw:function(e){e=e||Jo();var t=this;t.averageRedrawTime===void 0&&(t.averageRedrawTime=0),t.lastRedrawTime===void 0&&(t.lastRedrawTime=0),t.lastDrawTime===void 0&&(t.lastDrawTime=0),t.requestedFrame=!0,t.renderOptions=e},beforeRender:function(e,t){if(!this.destroyed){t==null&&Me("Priority is not optional for beforeRender");var n=this.beforeRenderCallbacks;n.push({fn:e,priority:t}),n.sort(function(r,a){return a.priority-r.priority})}}},Dc=function(e,t,n){for(var r=e.beforeRenderCallbacks,a=0;a<r.length;a++)r[a].fn(t,n)};_c.startRenderLoop=function(){var e=this,t=e.cy;if(!e.renderLoopStarted){e.renderLoopStarted=!0;var n=function(r){if(!e.destroyed){if(!t.batching())if(e.requestedFrame&&!e.skipFrame){Dc(e,!0,r);var a=St();e.render(e.renderOptions);var i=e.lastDrawTime=St();e.averageRedrawTime===void 0&&(e.averageRedrawTime=i-a),e.redrawCount===void 0&&(e.redrawCount=0),e.redrawCount++,e.redrawTotalTime===void 0&&(e.redrawTotalTime=0);var o=i-a;e.redrawTotalTime+=o,e.lastRedrawTime=o,e.averageRedrawTime=e.averageRedrawTime/2+o/2,e.requestedFrame=!1}else Dc(e,!1,r);e.skipFrame=!1,Er(n)}};Er(n)}};var Ac=function(e){this.init(e)},Nn=Ac.prototype;Nn.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"],Nn.init=function(e){var t=this;t.options=e,t.cy=e.cy;var n=t.container=e.cy.container(),r=t.cy.window();if(r){var a=r.document,i=a.head,o="__________cytoscape_stylesheet",s="__________cytoscape_container",l=a.getElementById(o)!=null;if(n.className.indexOf(s)<0&&(n.className=(n.className||"")+" "+s),!l){var u=a.createElement("style");u.id=o,u.textContent="."+s+" { position: relative; }",i.insertBefore(u,i.children[0])}r.getComputedStyle(n).getPropertyValue("position")==="static"&&ke("A Cytoscape container has style position:static and so can not use UI extensions properly")}t.selection=[void 0,void 0,void 0,void 0,0],t.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],t.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},t.dragData={possibleDragElements:[]},t.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},t.redraws=0,t.showFps=e.showFps,t.debug=e.debug,t.webgl=e.webgl,t.hideEdgesOnViewport=e.hideEdgesOnViewport,t.textureOnViewport=e.textureOnViewport,t.wheelSensitivity=e.wheelSensitivity,t.motionBlurEnabled=e.motionBlur,t.forcedPixelRatio=oe(e.pixelRatio)?e.pixelRatio:null,t.motionBlur=e.motionBlur,t.motionBlurOpacity=e.motionBlurOpacity,t.motionBlurTransparency=1-t.motionBlurOpacity,t.motionBlurPxRatio=1,t.mbPxRBlurry=1,t.minMbLowQualFrames=4,t.fullQualityMb=!1,t.clearedForMotionBlur=[],t.desktopTapThreshold=e.desktopTapThreshold,t.desktopTapThreshold2=e.desktopTapThreshold*e.desktopTapThreshold,t.touchTapThreshold=e.touchTapThreshold,t.touchTapThreshold2=e.touchTapThreshold*e.touchTapThreshold,t.tapholdDuration=500,t.bindings=[],t.beforeRenderCallbacks=[],t.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},t.registerNodeShapes(),t.registerArrowShapes(),t.registerCalculationListeners()},Nn.notify=function(e,t){var n=this,r=n.cy;this.destroyed||(e!=="init"?e!=="destroy"?((e==="add"||e==="remove"||e==="move"&&r.hasCompoundNodes()||e==="load"||e==="zorder"||e==="mount")&&n.invalidateCachedZSortedEles(),e==="viewport"&&n.redrawHint("select",!0),e==="gc"&&n.redrawHint("gc",!0),e!=="load"&&e!=="resize"&&e!=="mount"||(n.invalidateContainerClientCoordsCache(),n.matchCanvasSize(n.container)),n.redrawHint("eles",!0),n.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()):n.destroy():n.load())},Nn.destroy=function(){var e=this;e.destroyed=!0,e.cy.stopAnimationLoop();for(var t=0;t<e.bindings.length;t++){var n=e.bindings[t],r=n.target;(r.off||r.removeEventListener).apply(r,n.args)}if(e.bindings=[],e.beforeRenderCallbacks=[],e.onUpdateEleCalcsFns=[],e.removeObserver&&e.removeObserver.disconnect(),e.styleObserver&&e.styleObserver.disconnect(),e.resizeObserver&&e.resizeObserver.disconnect(),e.labelCalcDiv)try{document.body.removeChild(e.labelCalcDiv)}catch{}},Nn.isHeadless=function(){return!1},[Qf,Bc,op,dr,$t,_c].forEach(function(e){ge(Nn,e)});var qi=1e3/60,Mc=function(e){return function(){var t=this,n=this.renderer;if(!t.dequeueingSetup){t.dequeueingSetup=!0;var r=Hn(function(){n.redrawHint("eles",!0),n.redrawHint("drag",!0),n.redraw()},e.deqRedrawThreshold),a=e.priority||Ca;n.beforeRender(function(i,o){var s=St(),l=n.averageRedrawTime,u=n.lastRedrawTime,c=[],d=n.cy.extent(),h=n.getPixelRatio();for(i||n.flushRenderedStyleQueue();;){var p=St(),f=p-s,g=p-o;if(u<qi){var v=qi-(i?l:0);if(g>=e.deqFastCost*v)break}else if(i){if(f>=e.deqCost*u||f>=e.deqAvgCost*l)break}else if(g>=e.deqNoDrawCost*qi)break;var y=e.deq(t,h,d);if(!(y.length>0))break;for(var b=0;b<y.length;b++)c.push(y[b])}c.length>0&&(e.onDeqd(t,c),!i&&e.shouldRedraw(t,c,h,d)&&r())},a(t))}}},sp=function(){return Rt(function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Tr;Nt(this,e),this.idsByKey=new _t,this.keyForId=new _t,this.cachesByLvl=new _t,this.lvls=[],this.getKey=t,this.doesEleInvalidateKey=n},[{key:"getIdsFor",value:function(e){e==null&&Me("Can not get id list for null key");var t=this.idsByKey,n=this.idsByKey.get(e);return n||(n=new yn,t.set(e,n)),n}},{key:"addIdForKey",value:function(e,t){e!=null&&this.getIdsFor(e).add(t)}},{key:"deleteIdForKey",value:function(e,t){e!=null&&this.getIdsFor(e).delete(t)}},{key:"getNumberOfIdsForKey",value:function(e){return e==null?0:this.getIdsFor(e).size}},{key:"updateKeyMappingFor",value:function(e){var t=e.id(),n=this.keyForId.get(t),r=this.getKey(e);this.deleteIdForKey(n,t),this.addIdForKey(r,t),this.keyForId.set(t,r)}},{key:"deleteKeyMappingFor",value:function(e){var t=e.id(),n=this.keyForId.get(t);this.deleteIdForKey(n,t),this.keyForId.delete(t)}},{key:"keyHasChangedFor",value:function(e){var t=e.id();return this.keyForId.get(t)!==this.getKey(e)}},{key:"isInvalid",value:function(e){return this.keyHasChangedFor(e)||this.doesEleInvalidateKey(e)}},{key:"getCachesAt",value:function(e){var t=this.cachesByLvl,n=this.lvls,r=t.get(e);return r||(r=new _t,t.set(e,r),n.push(e)),r}},{key:"getCache",value:function(e,t){return this.getCachesAt(t).get(e)}},{key:"get",value:function(e,t){var n=this.getKey(e),r=this.getCache(n,t);return r!=null&&this.updateKeyMappingFor(e),r}},{key:"getForCachedKey",value:function(e,t){var n=this.keyForId.get(e.id());return this.getCache(n,t)}},{key:"hasCache",value:function(e,t){return this.getCachesAt(t).has(e)}},{key:"has",value:function(e,t){var n=this.getKey(e);return this.hasCache(n,t)}},{key:"setCache",value:function(e,t,n){n.key=e,this.getCachesAt(t).set(e,n)}},{key:"set",value:function(e,t,n){var r=this.getKey(e);this.setCache(r,t,n),this.updateKeyMappingFor(e)}},{key:"deleteCache",value:function(e,t){this.getCachesAt(t).delete(e)}},{key:"delete",value:function(e,t){var n=this.getKey(e);this.deleteCache(n,t)}},{key:"invalidateKey",value:function(e){var t=this;this.lvls.forEach(function(n){return t.deleteCache(e,n)})}},{key:"invalidate",value:function(e){var t=e.id(),n=this.keyForId.get(t);this.deleteKeyMappingFor(e);var r=this.doesEleInvalidateKey(e);return r&&this.invalidateKey(n),r||this.getNumberOfIdsForKey(n)===0}}])}(),lp=7.99,Rn={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},up=Ke({getKey:null,doesEleInvalidateKey:Tr,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:Uo,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),hr=function(e,t){var n=this;n.renderer=e,n.onDequeues=[];var r=up(t);ge(n,r),n.lookup=new sp(r.getKey,r.doesEleInvalidateKey),n.setupDequeueing()},qe=hr.prototype;qe.reasons=Rn,qe.getTextureQueue=function(e){var t=this;return t.eleImgCaches=t.eleImgCaches||{},t.eleImgCaches[e]=t.eleImgCaches[e]||[]},qe.getRetiredTextureQueue=function(e){var t=this.eleImgCaches.retired=this.eleImgCaches.retired||{};return t[e]=t[e]||[]},qe.getElementQueue=function(){return this.eleCacheQueue=this.eleCacheQueue||new Zn(function(e,t){return t.reqs-e.reqs})},qe.getElementKeyToQueue=function(){return this.eleKeyToCacheQueue=this.eleKeyToCacheQueue||{}},qe.getElement=function(e,t,n,r,a){var i=this,o=this.renderer,s=o.cy.zoom(),l=this.lookup;if(!t||t.w===0||t.h===0||isNaN(t.w)||isNaN(t.h)||!e.visible()||e.removed()||!i.allowEdgeTxrCaching&&e.isEdge()||!i.allowParentTxrCaching&&e.isParent())return null;if(r==null&&(r=Math.ceil(Da(s*n))),r<-4)r=-4;else if(s>=7.99||r>3)return null;var u=Math.pow(2,r),c=t.h*u,d=t.w*u,h=o.eleTextBiggerThanMin(e,u);if(!this.isVisible(e,h))return null;var p,f=l.get(e,r);if(f&&f.invalidated&&(f.invalidated=!1,f.texture.invalidatedWidth-=f.width),f)return f;if(p=c<=25?25:c<=50?50:50*Math.ceil(c/50),c>1024||d>1024)return null;var g=i.getTextureQueue(p),v=g[g.length-2],y=function(){return i.recycleTexture(p,d)||i.addTexture(p,d)};v||(v=g[g.length-1]),v||(v=y()),v.width-v.usedWidth<d&&(v=y());for(var b,m=function(I){return I&&I.scaledLabelShown===h},w=a&&a===Rn.dequeue,k=a&&a===Rn.highQuality,E=a&&a===Rn.downscale,x=r+1;x<=3;x++){var S=l.get(e,x);if(S){b=S;break}}var P=b&&b.level===r+1?b:null,T=function(){v.context.drawImage(P.texture.canvas,P.x,0,P.width,P.height,v.usedWidth,0,d,c)};if(v.context.setTransform(1,0,0,1,0,0),v.context.clearRect(v.usedWidth,0,d,p),m(P))T();else if(m(b)){if(!k)return i.queueElement(e,b.level-1),b;for(var D=b.level;D>r;D--)P=i.getElement(e,t,n,D,Rn.downscale);T()}else{var A;if(!w&&!k&&!E)for(var B=r-1;B>=-4;B--){var M=l.get(e,B);if(M){A=M;break}}if(m(A))return i.queueElement(e,r),A;v.context.translate(v.usedWidth,0),v.context.scale(u,u),this.drawElement(v.context,e,t,h,!1),v.context.scale(1/u,1/u),v.context.translate(-v.usedWidth,0)}return f={x:v.usedWidth,texture:v,level:r,scale:u,width:d,height:c,scaledLabelShown:h},v.usedWidth+=Math.ceil(d+8),v.eleCaches.push(f),l.set(e,r,f),i.checkTextureFullness(v),f},qe.invalidateElements=function(e){for(var t=0;t<e.length;t++)this.invalidateElement(e[t])},qe.invalidateElement=function(e){var t=this,n=t.lookup,r=[];if(n.isInvalid(e)){for(var a=-4;a<=3;a++){var i=n.getForCachedKey(e,a);i&&r.push(i)}if(n.invalidate(e))for(var o=0;o<r.length;o++){var s=r[o],l=s.texture;l.invalidatedWidth+=s.width,s.invalidated=!0,t.checkTextureUtility(l)}t.removeFromQueue(e)}},qe.checkTextureUtility=function(e){e.invalidatedWidth>=.2*e.width&&this.retireTexture(e)},qe.checkTextureFullness=function(e){var t=this.getTextureQueue(e.height);e.usedWidth/e.width>.8&&e.fullnessChecks>=10?Vt(t,e):e.fullnessChecks++},qe.retireTexture=function(e){var t=e.height,n=this.getTextureQueue(t),r=this.lookup;Vt(n,e),e.retired=!0;for(var a=e.eleCaches,i=0;i<a.length;i++){var o=a[i];r.deleteCache(o.key,o.level)}Pa(a),this.getRetiredTextureQueue(t).push(e)},qe.addTexture=function(e,t){var n={};return this.getTextureQueue(e).push(n),n.eleCaches=[],n.height=e,n.width=Math.max(1024,t),n.usedWidth=0,n.invalidatedWidth=0,n.fullnessChecks=0,n.canvas=this.renderer.makeOffscreenCanvas(n.width,n.height),n.context=n.canvas.getContext("2d"),n},qe.recycleTexture=function(e,t){for(var n=this.getTextureQueue(e),r=this.getRetiredTextureQueue(e),a=0;a<r.length;a++){var i=r[a];if(i.width>=t)return i.retired=!1,i.usedWidth=0,i.invalidatedWidth=0,i.fullnessChecks=0,Pa(i.eleCaches),i.context.setTransform(1,0,0,1,0,0),i.context.clearRect(0,0,i.width,i.height),Vt(r,i),n.push(i),i}},qe.queueElement=function(e,t){var n=this.getElementQueue(),r=this.getElementKeyToQueue(),a=this.getKey(e),i=r[a];if(i)i.level=Math.max(i.level,t),i.eles.merge(e),i.reqs++,n.updateItem(i);else{var o={eles:e.spawn().merge(e),level:t,reqs:1,key:a};n.push(o),r[a]=o}},qe.dequeue=function(e){for(var t=this,n=t.getElementQueue(),r=t.getElementKeyToQueue(),a=[],i=t.lookup,o=0;o<1&&n.size()>0;o++){var s=n.pop(),l=s.key,u=s.eles[0],c=i.hasCache(u,s.level);if(r[l]=null,!c){a.push(s);var d=t.getBoundingBox(u);t.getElement(u,d,e,s.level,Rn.dequeue)}}return a},qe.removeFromQueue=function(e){var t=this.getElementQueue(),n=this.getElementKeyToQueue(),r=this.getKey(e),a=n[r];a!=null&&(a.eles.length===1?(a.reqs=Ta,t.updateItem(a),t.pop(),n[r]=null):a.eles.unmerge(e))},qe.onDequeue=function(e){this.onDequeues.push(e)},qe.offDequeue=function(e){Vt(this.onDequeues,e)},qe.setupDequeueing=Mc({deqRedrawThreshold:100,deqCost:.15,deqAvgCost:.1,deqNoDrawCost:.9,deqFastCost:.9,deq:function(e,t,n){return e.dequeue(t,n)},onDeqd:function(e,t){for(var n=0;n<e.onDequeues.length;n++)(0,e.onDequeues[n])(t)},shouldRedraw:function(e,t,n,r){for(var a=0;a<t.length;a++)for(var i=t[a].eles,o=0;o<i.length;o++){var s=i[o].boundingBox();if(Ma(s,r))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var Ic=function(e){var t=this,n=t.renderer=e,r=n.cy;t.layersByLevel={},t.firstGet=!0,t.lastInvalidationTime=St()-500,t.skipping=!1,t.eleTxrDeqs=r.collection(),t.scheduleElementRefinement=Hn(function(){t.refineElementTextures(t.eleTxrDeqs),t.eleTxrDeqs.unmerge(t.eleTxrDeqs)},50),n.beforeRender(function(a,i){i-t.lastInvalidationTime<=250?t.skipping=!0:t.skipping=!1},n.beforeRenderPriorities.lyrTxrSkip),t.layersQueue=new Zn(function(a,i){return i.reqs-a.reqs}),t.setupDequeueing()},$e=Ic.prototype,Nc=0,cp=Math.pow(2,53)-1;$e.makeLayer=function(e,t){var n=Math.pow(2,t),r=Math.ceil(e.w*n),a=Math.ceil(e.h*n),i=this.renderer.makeOffscreenCanvas(r,a),o={id:Nc=++Nc%cp,bb:e,level:t,width:r,height:a,canvas:i,context:i.getContext("2d"),eles:[],elesQueue:[],reqs:0},s=o.context,l=-o.bb.x1,u=-o.bb.y1;return s.scale(n,n),s.translate(l,u),o},$e.getLayers=function(e,t,n){var r=this,a=r.renderer.cy.zoom(),i=r.firstGet;if(r.firstGet=!1,n==null){if((n=Math.ceil(Da(a*t)))<-4)n=-4;else if(a>=3.99||n>2)return null}r.validateLayersElesOrdering(n,e);var o,s,l=r.layersByLevel,u=Math.pow(2,n),c=l[n]=l[n]||[];if(r.levelIsComplete(n,e))return c;(function(){var w=function(S){if(r.validateLayersElesOrdering(S,e),r.levelIsComplete(S,e))return s=l[S],!0},k=function(S){if(!s)for(var P=n+S;-4<=P&&P<=2&&!w(P);P+=S);};k(1),k(-1);for(var E=c.length-1;E>=0;E--){var x=c[E];x.invalid&&Vt(c,x)}})();var d=function(w){var k=(w=w||{}).after;(function(){if(!o){o=nt();for(var T=0;T<e.length;T++)Wd(o,e[T].boundingBox())}})();var E=Math.ceil(o.w*u),x=Math.ceil(o.h*u);if(E>32767||x>32767||E*x>16e6)return null;var S=r.makeLayer(o,n);if(k!=null){var P=c.indexOf(k)+1;c.splice(P,0,S)}else(w.insert===void 0||w.insert)&&c.unshift(S);return S};if(r.skipping&&!i)return null;for(var h=null,p=e.length/1,f=!i,g=0;g<e.length;g++){var v=e[g],y=v._private.rscratch,b=y.imgLayerCaches=y.imgLayerCaches||{},m=b[n];if(m)h=m;else{if((!h||h.eles.length>=p||!ls(h.bb,v.boundingBox()))&&!(h=d({insert:!0,after:h})))return null;s||f?r.queueLayer(h,v):r.drawEleInLayer(h,v,n,t),h.eles.push(v),b[n]=h}}return s||(f?null:c)},$e.getEleLevelForLayerLevel=function(e,t){return e},$e.drawEleInLayer=function(e,t,n,r){var a=this.renderer,i=e.context,o=t.boundingBox();o.w!==0&&o.h!==0&&t.visible()&&(n=this.getEleLevelForLayerLevel(n,r),a.setImgSmoothing(i,!1),a.drawCachedElement(i,t,null,null,n,!0),a.setImgSmoothing(i,!0))},$e.levelIsComplete=function(e,t){var n=this.layersByLevel[e];if(!n||n.length===0)return!1;for(var r=0,a=0;a<n.length;a++){var i=n[a];if(i.reqs>0||i.invalid)return!1;r+=i.eles.length}return r===t.length},$e.validateLayersElesOrdering=function(e,t){var n=this.layersByLevel[e];if(n)for(var r=0;r<n.length;r++){for(var a=n[r],i=-1,o=0;o<t.length;o++)if(a.eles[0]===t[o]){i=o;break}if(i<0)this.invalidateLayer(a);else{var s=i;for(o=0;o<a.eles.length;o++)if(a.eles[o]!==t[s+o]){this.invalidateLayer(a);break}}}},$e.updateElementsInLayers=function(e,t){for(var n=jn(e[0]),r=0;r<e.length;r++)for(var a=n?null:e[r],i=n?e[r]:e[r].ele,o=i._private.rscratch,s=o.imgLayerCaches=o.imgLayerCaches||{},l=-4;l<=2;l++){var u=s[l];u&&(a&&this.getEleLevelForLayerLevel(u.level)!==a.level||t(u,i,a))}},$e.haveLayers=function(){for(var e=!1,t=-4;t<=2;t++){var n=this.layersByLevel[t];if(n&&n.length>0){e=!0;break}}return e},$e.invalidateElements=function(e){var t=this;e.length!==0&&(t.lastInvalidationTime=St(),e.length!==0&&t.haveLayers()&&t.updateElementsInLayers(e,function(n,r,a){t.invalidateLayer(n)}))},$e.invalidateLayer=function(e){if(this.lastInvalidationTime=St(),!e.invalid){var t=e.level,n=e.eles,r=this.layersByLevel[t];Vt(r,e),e.elesQueue=[],e.invalid=!0,e.replacement&&(e.replacement.invalid=!0);for(var a=0;a<n.length;a++){var i=n[a]._private.rscratch.imgLayerCaches;i&&(i[t]=null)}}},$e.refineElementTextures=function(e){var t=this;t.updateElementsInLayers(e,function(n,r,a){var i=n.replacement;if(i||((i=n.replacement=t.makeLayer(n.bb,n.level)).replaces=n,i.eles=n.eles),!i.reqs)for(var o=0;o<i.eles.length;o++)t.queueLayer(i,i.eles[o])})},$e.enqueueElementRefinement=function(e){this.eleTxrDeqs.merge(e),this.scheduleElementRefinement()},$e.queueLayer=function(e,t){var n=this.layersQueue,r=e.elesQueue,a=r.hasId=r.hasId||{};if(!e.replacement){if(t){if(a[t.id()])return;r.push(t),a[t.id()]=!0}e.reqs?(e.reqs++,n.updateItem(e)):(e.reqs=1,n.push(e))}},$e.dequeue=function(e){for(var t=this,n=t.layersQueue,r=[],a=0;a<1&&n.size()!==0;){var i=n.peek();if(i.replacement)n.pop();else if(i.replaces&&i!==i.replaces.replacement)n.pop();else if(i.invalid)n.pop();else{var o=i.elesQueue.shift();o&&(t.drawEleInLayer(i,o,i.level,e),a++),r.length===0&&r.push(!0),i.elesQueue.length===0&&(n.pop(),i.reqs=0,i.replaces&&t.applyLayerReplacement(i),t.requestRedraw())}}return r},$e.applyLayerReplacement=function(e){var t=this.layersByLevel[e.level],n=e.replaces,r=t.indexOf(n);if(!(r<0||n.invalid)){t[r]=e;for(var a=0;a<e.eles.length;a++){var i=e.eles[a]._private,o=i.imgLayerCaches=i.imgLayerCaches||{};o&&(o[e.level]=e)}this.requestRedraw()}},$e.requestRedraw=Hn(function(){var e=this.renderer;e.redrawHint("eles",!0),e.redrawHint("drag",!0),e.redraw()},100),$e.setupDequeueing=Mc({deqRedrawThreshold:50,deqCost:.15,deqAvgCost:.1,deqNoDrawCost:.9,deqFastCost:.9,deq:function(e,t){return e.dequeue(t)},onDeqd:Ca,shouldRedraw:Uo,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var Rc,Lc={};function dp(e,t){for(var n=0;n<t.length;n++){var r=t[n];e.lineTo(r.x,r.y)}}function hp(e,t,n){for(var r,a=0;a<t.length;a++){var i=t[a];a===0&&(r=i),e.lineTo(i.x,i.y)}e.quadraticCurveTo(n.x,n.y,r.x,r.y)}function zc(e,t,n){e.beginPath&&e.beginPath();for(var r=t,a=0;a<r.length;a++){var i=r[a];e.lineTo(i.x,i.y)}var o=n,s=n[0];for(e.moveTo(s.x,s.y),a=1;a<o.length;a++)i=o[a],e.lineTo(i.x,i.y);e.closePath&&e.closePath()}function fp(e,t,n,r,a){e.beginPath&&e.beginPath(),e.arc(n,r,a,0,2*Math.PI,!1);var i=t,o=i[0];e.moveTo(o.x,o.y);for(var s=0;s<i.length;s++){var l=i[s];e.lineTo(l.x,l.y)}e.closePath&&e.closePath()}function pp(e,t,n,r){e.arc(t,n,r,0,2*Math.PI,!1)}Lc.arrowShapeImpl=function(e){return(Rc||(Rc={polygon:dp,"triangle-backcurve":hp,"triangle-tee":zc,"circle-triangle":fp,"triangle-cross":zc,circle:pp}))[e]};var Ln={drawElement:function(e,t,n,r,a,i){t.isNode()?this.drawNode(e,t,n,r,a,i):this.drawEdge(e,t,n,r,a,i)},drawElementOverlay:function(e,t){t.isNode()?this.drawNodeOverlay(e,t):this.drawEdgeOverlay(e,t)},drawElementUnderlay:function(e,t){t.isNode()?this.drawNodeUnderlay(e,t):this.drawEdgeUnderlay(e,t)},drawCachedElementPortion:function(e,t,n,r,a,i,o,s){var l=this,u=n.getBoundingBox(t);if(u.w!==0&&u.h!==0){var c=n.getElement(t,u,r,a,i);if(c!=null){var d=s(l,t);if(d===0)return;var h,p,f,g,v,y,b=o(l,t),m=u.x1,w=u.y1,k=u.w,E=u.h;if(b!==0){var x=n.getRotationPoint(t);f=x.x,g=x.y,e.translate(f,g),e.rotate(b),(v=l.getImgSmoothing(e))||l.setImgSmoothing(e,!0);var S=n.getRotationOffset(t);h=S.x,p=S.y}else h=m,p=w;d!==1&&(y=e.globalAlpha,e.globalAlpha=y*d),e.drawImage(c.texture.canvas,c.x,0,c.width,c.height,h,p,k,E),d!==1&&(e.globalAlpha=y),b!==0&&(e.rotate(-b),e.translate(-f,-g),v||l.setImgSmoothing(e,!1))}else n.drawElement(e,t)}}},gp=function(){return 0},vp=function(e,t){return e.getTextAngle(t,null)},yp=function(e,t){return e.getTextAngle(t,"source")},mp=function(e,t){return e.getTextAngle(t,"target")},bp=function(e,t){return t.effectiveOpacity()},Wi=function(e,t){return t.pstyle("text-opacity").pfValue*t.effectiveOpacity()};Ln.drawCachedElement=function(e,t,n,r,a,i){var o=this,s=o.data,l=s.eleTxrCache,u=s.lblTxrCache,c=s.slbTxrCache,d=s.tlbTxrCache,h=t.boundingBox(),p=i===!0?l.reasons.highQuality:null;if(h.w!==0&&h.h!==0&&t.visible()&&(!r||Ma(h,r))){var f=t.isEdge(),g=t.element()._private.rscratch.badLine;o.drawElementUnderlay(e,t),o.drawCachedElementPortion(e,t,l,n,a,p,gp,bp),f&&g||o.drawCachedElementPortion(e,t,u,n,a,p,vp,Wi),f&&!g&&(o.drawCachedElementPortion(e,t,c,n,a,p,yp,Wi),o.drawCachedElementPortion(e,t,d,n,a,p,mp,Wi)),o.drawElementOverlay(e,t)}},Ln.drawElements=function(e,t){for(var n=0;n<t.length;n++){var r=t[n];this.drawElement(e,r)}},Ln.drawCachedElements=function(e,t,n,r){for(var a=0;a<t.length;a++){var i=t[a];this.drawCachedElement(e,i,n,r)}},Ln.drawCachedNodes=function(e,t,n,r){for(var a=0;a<t.length;a++){var i=t[a];i.isNode()&&this.drawCachedElement(e,i,n,r)}},Ln.drawLayeredElements=function(e,t,n,r){var a=this.data.lyrTxrCache.getLayers(t,n);if(a)for(var i=0;i<a.length;i++){var o=a[i],s=o.bb;s.w!==0&&s.h!==0&&e.drawImage(o.canvas,s.x1,s.y1,s.w,s.h)}else this.drawCachedElements(e,t,n,r)};var Qt={drawEdge:function(e,t,n){var r=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],a=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],i=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],o=this,s=t._private.rscratch;if((!i||t.visible())&&!s.badLine&&s.allpts!=null&&!isNaN(s.allpts[0])){var l;n&&(l=n,e.translate(-l.x1,-l.y1));var u=i?t.pstyle("opacity").value:1,c=i?t.pstyle("line-opacity").value:1,d=t.pstyle("curve-style").value,h=t.pstyle("line-style").value,p=t.pstyle("width").pfValue,f=t.pstyle("line-cap").value,g=t.pstyle("line-outline-width").value,v=t.pstyle("line-outline-color").value,y=u*c,b=u*c,m=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y;d==="straight-triangle"?(o.eleStrokeStyle(e,t,P),o.drawEdgeTrianglePath(t,e,s.allpts)):(e.lineWidth=p,e.lineCap=f,o.eleStrokeStyle(e,t,P),o.drawEdgePath(t,e,s.allpts,h),e.lineCap="butt")},w=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b;o.drawArrowheads(e,t,P)};if(e.lineJoin="round",t.pstyle("ghost").value==="yes"){var k=t.pstyle("ghost-offset-x").pfValue,E=t.pstyle("ghost-offset-y").pfValue,x=t.pstyle("ghost-opacity").value,S=y*x;e.translate(k,E),m(S),w(S),e.translate(-k,-E)}else(function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y;e.lineWidth=p+g,e.lineCap=f,g>0?(o.colorStrokeStyle(e,v[0],v[1],v[2],P),d==="straight-triangle"?o.drawEdgeTrianglePath(t,e,s.allpts):(o.drawEdgePath(t,e,s.allpts,h),e.lineCap="butt")):e.lineCap="butt"})();a&&o.drawEdgeUnderlay(e,t),m(),w(),a&&o.drawEdgeOverlay(e,t),o.drawElementText(e,t,null,r),n&&e.translate(l.x1,l.y1)}}},Oc=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,n){if(n.visible()){var r=n.pstyle("".concat(e,"-opacity")).value;if(r!==0){var a=this,i=a.usePaths(),o=n._private.rscratch,s=2*n.pstyle("".concat(e,"-padding")).pfValue,l=n.pstyle("".concat(e,"-color")).value;t.lineWidth=s,o.edgeType!=="self"||i?t.lineCap="round":t.lineCap="butt",a.colorStrokeStyle(t,l[0],l[1],l[2],r),a.drawEdgePath(n,t,o.allpts,"solid")}}}};Qt.drawEdgeOverlay=Oc("overlay"),Qt.drawEdgeUnderlay=Oc("underlay"),Qt.drawEdgePath=function(e,t,n,r){var a,i=e._private.rscratch,o=t,s=!1,l=this.usePaths(),u=e.pstyle("line-dash-pattern").pfValue,c=e.pstyle("line-dash-offset").pfValue;if(l){var d=n.join("$");i.pathCacheKey&&i.pathCacheKey===d?(a=t=i.pathCache,s=!0):(a=t=new Path2D,i.pathCacheKey=d,i.pathCache=a)}if(o.setLineDash)switch(r){case"dotted":o.setLineDash([1,1]);break;case"dashed":o.setLineDash(u),o.lineDashOffset=c;break;case"solid":o.setLineDash([])}if(!s&&!i.badLine)switch(t.beginPath&&t.beginPath(),t.moveTo(n[0],n[1]),i.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var h=2;h+3<n.length;h+=4)t.quadraticCurveTo(n[h],n[h+1],n[h+2],n[h+3]);break;case"straight":case"haystack":for(var p=2;p+1<n.length;p+=2)t.lineTo(n[p],n[p+1]);break;case"segments":if(i.isRound){var f,g=it(i.roundCorners);try{for(g.s();!(f=g.n()).done;)Ec(t,f.value)}catch(y){g.e(y)}finally{g.f()}t.lineTo(n[n.length-2],n[n.length-1])}else for(var v=2;v+1<n.length;v+=2)t.lineTo(n[v],n[v+1])}t=o,l?t.stroke(a):t.stroke(),t.setLineDash&&t.setLineDash([])},Qt.drawEdgeTrianglePath=function(e,t,n){t.fillStyle=t.strokeStyle;for(var r=e.pstyle("width").pfValue,a=0;a+1<n.length;a+=2){var i=[n[a+2]-n[a],n[a+3]-n[a+1]],o=Math.sqrt(i[0]*i[0]+i[1]*i[1]),s=[i[1]/o,-i[0]/o],l=[s[0]*r/2,s[1]*r/2];t.beginPath(),t.moveTo(n[a]-l[0],n[a+1]-l[1]),t.lineTo(n[a]+l[0],n[a+1]+l[1]),t.lineTo(n[a+2],n[a+3]),t.closePath(),t.fill()}},Qt.drawArrowheads=function(e,t,n){var r=t._private.rscratch,a=r.edgeType==="haystack";a||this.drawArrowhead(e,t,"source",r.arrowStartX,r.arrowStartY,r.srcArrowAngle,n),this.drawArrowhead(e,t,"mid-target",r.midX,r.midY,r.midtgtArrowAngle,n),this.drawArrowhead(e,t,"mid-source",r.midX,r.midY,r.midsrcArrowAngle,n),a||this.drawArrowhead(e,t,"target",r.arrowEndX,r.arrowEndY,r.tgtArrowAngle,n)},Qt.drawArrowhead=function(e,t,n,r,a,i,o){if(!(isNaN(r)||r==null||isNaN(a)||a==null||isNaN(i)||i==null)){var s=this,l=t.pstyle(n+"-arrow-shape").value;if(l!=="none"){var u=t.pstyle(n+"-arrow-fill").value==="hollow"?"both":"filled",c=t.pstyle(n+"-arrow-fill").value,d=t.pstyle("width").pfValue,h=t.pstyle(n+"-arrow-width"),p=h.value==="match-line"?d:h.pfValue;h.units==="%"&&(p*=d);var f=t.pstyle("opacity").value;o===void 0&&(o=f);var g=e.globalCompositeOperation;o===1&&c!=="hollow"||(e.globalCompositeOperation="destination-out",s.colorFillStyle(e,255,255,255,1),s.colorStrokeStyle(e,255,255,255,1),s.drawArrowShape(t,e,u,d,l,p,r,a,i),e.globalCompositeOperation=g);var v=t.pstyle(n+"-arrow-color").value;s.colorFillStyle(e,v[0],v[1],v[2],o),s.colorStrokeStyle(e,v[0],v[1],v[2],o),s.drawArrowShape(t,e,c,d,l,p,r,a,i)}}},Qt.drawArrowShape=function(e,t,n,r,a,i,o,s,l){var u,c=this,d=this.usePaths()&&a!=="triangle-cross",h=!1,p=t,f={x:o,y:s},g=e.pstyle("arrow-scale").value,v=this.getArrowWidth(r,g),y=c.arrowShapes[a];if(d){var b=c.arrowPathCache=c.arrowPathCache||[],m=en(a),w=b[m];w!=null?(u=t=w,h=!0):(u=t=new Path2D,b[m]=u)}h||(t.beginPath&&t.beginPath(),d?y.draw(t,1,0,{x:0,y:0},1):y.draw(t,v,l,f,r),t.closePath&&t.closePath()),t=p,d&&(t.translate(o,s),t.rotate(l),t.scale(v,v)),n!=="filled"&&n!=="both"||(d?t.fill(u):t.fill()),n!=="hollow"&&n!=="both"||(t.lineWidth=i/(d?v:1),t.lineJoin="miter",d?t.stroke(u):t.stroke()),d&&(t.scale(1/v,1/v),t.rotate(-l),t.translate(-o,-s))};var xp={safeDrawImage:function(e,t,n,r,a,i,o,s,l,u){if(!(a<=0||i<=0||l<=0||u<=0))try{e.drawImage(t,n,r,a,i,o,s,l,u)}catch(c){ke(c)}},drawInscribedImage:function(e,t,n,r,a){var i=this,o=n.position(),s=o.x,l=o.y,u=n.cy().style(),c=u.getIndexedStyle.bind(u),d=c(n,"background-fit","value",r),h=c(n,"background-repeat","value",r),p=n.width(),f=n.height(),g=2*n.padding(),v=p+(c(n,"background-width-relative-to","value",r)==="inner"?0:g),y=f+(c(n,"background-height-relative-to","value",r)==="inner"?0:g),b=n._private.rscratch,m=c(n,"background-clip","value",r)==="node",w=c(n,"background-image-opacity","value",r)*a,k=c(n,"background-image-smoothing","value",r),E=n.pstyle("corner-radius").value;E!=="auto"&&(E=n.pstyle("corner-radius").pfValue);var x=t.width||t.cachedW,S=t.height||t.cachedH;x!=null&&S!=null||(document.body.appendChild(t),x=t.cachedW=t.width||t.offsetWidth,S=t.cachedH=t.height||t.offsetHeight,document.body.removeChild(t));var P=x,T=S;if(c(n,"background-width","value",r)!=="auto"&&(P=c(n,"background-width","units",r)==="%"?c(n,"background-width","pfValue",r)*v:c(n,"background-width","pfValue",r)),c(n,"background-height","value",r)!=="auto"&&(T=c(n,"background-height","units",r)==="%"?c(n,"background-height","pfValue",r)*y:c(n,"background-height","pfValue",r)),P!==0&&T!==0){if(d==="contain")P*=D=Math.min(v/P,y/T),T*=D;else if(d==="cover"){var D;P*=D=Math.max(v/P,y/T),T*=D}var A=s-v/2,B=c(n,"background-position-x","units",r),M=c(n,"background-position-x","pfValue",r);A+=B==="%"?(v-P)*M:M;var I=c(n,"background-offset-x","units",r),R=c(n,"background-offset-x","pfValue",r);A+=I==="%"?(v-P)*R:R;var _=l-y/2,z=c(n,"background-position-y","units",r),V=c(n,"background-position-y","pfValue",r);_+=z==="%"?(y-T)*V:V;var L=c(n,"background-offset-y","units",r),X=c(n,"background-offset-y","pfValue",r);_+=L==="%"?(y-T)*X:X,b.pathCache&&(A-=s,_-=l,s=0,l=0);var W=e.globalAlpha;e.globalAlpha=w;var G=i.getImgSmoothing(e),U=!1;if(k==="no"&&G?(i.setImgSmoothing(e,!1),U=!0):k!=="yes"||G||(i.setImgSmoothing(e,!0),U=!0),h==="no-repeat")m&&(e.save(),b.pathCache?e.clip(b.pathCache):(i.nodeShapes[i.getNodeShape(n)].draw(e,s,l,v,y,E,b),e.clip())),i.safeDrawImage(e,t,0,0,x,S,A,_,P,T),m&&e.restore();else{var Q=e.createPattern(t,h);e.fillStyle=Q,i.nodeShapes[i.getNodeShape(n)].draw(e,s,l,v,y,E,b),e.translate(A,_),e.fill(),e.translate(-A,-_)}e.globalAlpha=W,U&&i.setImgSmoothing(e,G)}}},cn={};function Vc(e,t,n,r,a){var i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,o=Math.min(i,r/2,a/2);e.beginPath(),e.moveTo(t+o,n),e.lineTo(t+r-o,n),e.quadraticCurveTo(t+r,n,t+r,n+o),e.lineTo(t+r,n+a-o),e.quadraticCurveTo(t+r,n+a,t+r-o,n+a),e.lineTo(t+o,n+a),e.quadraticCurveTo(t,n+a,t,n+a-o),e.lineTo(t,n+o),e.quadraticCurveTo(t,n,t+o,n),e.closePath()}cn.eleTextBiggerThanMin=function(e,t){if(!t){var n=e.cy().zoom(),r=this.getPixelRatio(),a=Math.ceil(Da(n*r));t=Math.pow(2,a)}return!(e.pstyle("font-size").pfValue*t<e.pstyle("min-zoomed-font-size").pfValue)},cn.drawElementText=function(e,t,n,r,a){var i=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],o=this;if(r==null){if(i&&!o.eleTextBiggerThanMin(t))return}else if(r===!1)return;if(t.isNode()){var s=t.pstyle("label");if(!s||!s.value)return;var l=o.getLabelJustification(t);e.textAlign=l,e.textBaseline="bottom"}else{var u=t.element()._private.rscratch.badLine,c=t.pstyle("label"),d=t.pstyle("source-label"),h=t.pstyle("target-label");if(u||(!c||!c.value)&&(!d||!d.value)&&(!h||!h.value))return;e.textAlign="center",e.textBaseline="bottom"}var p,f=!n;n&&(p=n,e.translate(-p.x1,-p.y1)),a==null?(o.drawText(e,t,null,f,i),t.isEdge()&&(o.drawText(e,t,"source",f,i),o.drawText(e,t,"target",f,i))):o.drawText(e,t,a,f,i),n&&e.translate(p.x1,p.y1)},cn.getFontCache=function(e){var t;this.fontCaches=this.fontCaches||[];for(var n=0;n<this.fontCaches.length;n++)if((t=this.fontCaches[n]).context===e)return t;return t={context:e},this.fontCaches.push(t),t},cn.setupTextStyle=function(e,t){var n=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],r=t.pstyle("font-style").strValue,a=t.pstyle("font-size").pfValue+"px",i=t.pstyle("font-family").strValue,o=t.pstyle("font-weight").strValue,s=n?t.effectiveOpacity()*t.pstyle("text-opacity").value:1,l=t.pstyle("text-outline-opacity").value*s,u=t.pstyle("color").value,c=t.pstyle("text-outline-color").value;e.font=r+" "+o+" "+a+" "+i,e.lineJoin="round",this.colorFillStyle(e,u[0],u[1],u[2],s),this.colorStrokeStyle(e,c[0],c[1],c[2],l)},cn.getTextAngle=function(e,t){var n,r=e._private.rscratch,a=t?t+"-":"",i=e.pstyle(a+"text-rotation");if(i.strValue==="autorotate"){var o=ot(r,"labelAngle",t);n=e.isEdge()?o:0}else n=i.strValue==="none"?0:i.pfValue;return n},cn.drawText=function(e,t,n){var r=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],a=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],i=t._private.rscratch,o=a?t.effectiveOpacity():1;if(!a||o!==0&&t.pstyle("text-opacity").value!==0){n==="main"&&(n=null);var s,l,u=ot(i,"labelX",n),c=ot(i,"labelY",n),d=this.getLabelText(t,n);if(d!=null&&d!==""&&!isNaN(u)&&!isNaN(c)){this.setupTextStyle(e,t,a);var h,p=n?n+"-":"",f=ot(i,"labelWidth",n),g=ot(i,"labelHeight",n),v=t.pstyle(p+"text-margin-x").pfValue,y=t.pstyle(p+"text-margin-y").pfValue,b=t.isEdge(),m=t.pstyle("text-halign").value,w=t.pstyle("text-valign").value;switch(b&&(m="center",w="center"),u+=v,c+=y,(h=r?this.getTextAngle(t,n):0)!==0&&(s=u,l=c,e.translate(s,l),e.rotate(h),u=0,c=0),w){case"top":break;case"center":c+=g/2;break;case"bottom":c+=g}var k=t.pstyle("text-background-opacity").value,E=t.pstyle("text-border-opacity").value,x=t.pstyle("text-border-width").pfValue,S=t.pstyle("text-background-padding").pfValue,P=t.pstyle("text-background-shape").strValue,T=P==="round-rectangle"||P==="roundrectangle",D=P==="circle";if(k>0||x>0&&E>0){var A=e.fillStyle,B=e.strokeStyle,M=e.lineWidth,I=t.pstyle("text-background-color").value,R=t.pstyle("text-border-color").value,_=t.pstyle("text-border-style").value,z=k>0,V=x>0&&E>0,L=u-S;switch(m){case"left":L-=f;break;case"center":L-=f/2}var X=c-g-S,W=f+2*S,G=g+2*S;if(z&&(e.fillStyle="rgba(".concat(I[0],",").concat(I[1],",").concat(I[2],",").concat(k*o,")")),V&&(e.strokeStyle="rgba(".concat(R[0],",").concat(R[1],",").concat(R[2],",").concat(E*o,")"),e.lineWidth=x,e.setLineDash))switch(_){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash([4,2]);break;case"double":e.lineWidth=x/4,e.setLineDash([]);break;default:e.setLineDash([])}if(T?(e.beginPath(),Vc(e,L,X,W,G,2)):D?(e.beginPath(),function(ne,le,fe,ce,te){var se=Math.min(ce,te)/2,de=le+ce/2,ue=fe+te/2;ne.beginPath(),ne.arc(de,ue,se,0,2*Math.PI),ne.closePath()}(e,L,X,W,G)):(e.beginPath(),e.rect(L,X,W,G)),z&&e.fill(),V&&e.stroke(),V&&_==="double"){var U=x/2;e.beginPath(),T?Vc(e,L+U,X+U,W-2*U,G-2*U,2):e.rect(L+U,X+U,W-2*U,G-2*U),e.stroke()}e.fillStyle=A,e.strokeStyle=B,e.lineWidth=M,e.setLineDash&&e.setLineDash([])}var Q=2*t.pstyle("text-outline-width").pfValue;if(Q>0&&(e.lineWidth=Q),t.pstyle("text-wrap").value==="wrap"){var F=ot(i,"labelWrapCachedLines",n),O=ot(i,"labelLineHeight",n),Y=f/2,$=this.getLabelJustification(t);switch($==="auto"||(m==="left"?$==="left"?u+=-f:$==="center"&&(u+=-Y):m==="center"?$==="left"?u+=-Y:$==="right"&&(u+=Y):m==="right"&&($==="center"?u+=Y:$==="right"&&(u+=f))),w){case"top":case"center":case"bottom":c-=(F.length-1)*O}for(var J=0;J<F.length;J++)Q>0&&e.strokeText(F[J],u,c),e.fillText(F[J],u,c),c+=O}else Q>0&&e.strokeText(d,u,c),e.fillText(d,u,c);h!==0&&(e.rotate(-h),e.translate(-s,-l))}}};var dn={drawNode:function(e,t,n){var r,a,i=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],o=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],s=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],l=this,u=t._private,c=u.rscratch,d=t.position();if(oe(d.x)&&oe(d.y)&&(!s||t.visible())){var h,p,f=s?t.effectiveOpacity():1,g=l.usePaths(),v=!1,y=t.padding();r=t.width()+2*y,a=t.height()+2*y,n&&(p=n,e.translate(-p.x1,-p.y1));for(var b=t.pstyle("background-image").value,m=new Array(b.length),w=new Array(b.length),k=0,E=0;E<b.length;E++){var x=b[E];if(m[E]=x!=null&&x!=="none"){var S=t.cy().style().getIndexedStyle(t,"background-image-crossorigin","value",E);k++,w[E]=l.getCachedImage(x,S,function(){u.backgroundTimestamp=Date.now(),t.emitAndNotify("background")})}}var P=t.pstyle("background-blacken").value,T=t.pstyle("border-width").pfValue,D=t.pstyle("background-opacity").value*f,A=t.pstyle("border-color").value,B=t.pstyle("border-style").value,M=t.pstyle("border-join").value,I=t.pstyle("border-cap").value,R=t.pstyle("border-position").value,_=t.pstyle("border-dash-pattern").pfValue,z=t.pstyle("border-dash-offset").pfValue,V=t.pstyle("border-opacity").value*f,L=t.pstyle("outline-width").pfValue,X=t.pstyle("outline-color").value,W=t.pstyle("outline-style").value,G=t.pstyle("outline-opacity").value*f,U=t.pstyle("outline-offset").value,Q=t.pstyle("corner-radius").value;Q!=="auto"&&(Q=t.pstyle("corner-radius").pfValue);var F=function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:D;l.eleFillStyle(e,t,q)},O=function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:V;l.colorStrokeStyle(e,A[0],A[1],A[2],q)},Y=function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:G;l.colorStrokeStyle(e,X[0],X[1],X[2],q)},$=function(q,Z,ee,ae){var re,ye=l.nodePathCache=l.nodePathCache||[],he=Go(ee==="polygon"?ee+","+ae.join(","):ee,""+Z,""+q,""+Q),ie=ye[he],ve=!1;return ie!=null?(re=ie,ve=!0,c.pathCache=re):(re=new Path2D,ye[he]=c.pathCache=re),{path:re,cacheHit:ve}},J=t.pstyle("shape").strValue,ne=t.pstyle("shape-polygon-points").pfValue;if(g){e.translate(d.x,d.y);var le=$(r,a,J,ne);h=le.path,v=le.cacheHit}var fe=function(){if(!v){var q=d;g&&(q={x:0,y:0}),l.nodeShapes[l.getNodeShape(t)].draw(h||e,q.x,q.y,r,a,Q,c)}g?e.fill(h):e.fill()},ce=function(){for(var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:f,Z=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],ee=u.backgrounding,ae=0,re=0;re<w.length;re++){var ye=t.cy().style().getIndexedStyle(t,"background-image-containment","value",re);Z&&ye==="over"||!Z&&ye==="inside"?ae++:m[re]&&w[re].complete&&!w[re].error&&(ae++,l.drawInscribedImage(e,w[re],t,re,q))}u.backgrounding=ae!==k,ee!==u.backgrounding&&t.updateStyle(!1)},te=function(){var q=arguments.length>0&&arguments[0]!==void 0&&arguments[0],Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f;l.hasPie(t)&&(l.drawPie(e,t,Z),q&&(g||l.nodeShapes[l.getNodeShape(t)].draw(e,d.x,d.y,r,a,Q,c)))},se=function(){var q=arguments.length>0&&arguments[0]!==void 0&&arguments[0],Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f;l.hasStripe(t)&&(e.save(),g?e.clip(c.pathCache):(l.nodeShapes[l.getNodeShape(t)].draw(e,d.x,d.y,r,a,Q,c),e.clip()),l.drawStripe(e,t,Z),e.restore(),q&&(g||l.nodeShapes[l.getNodeShape(t)].draw(e,d.x,d.y,r,a,Q,c)))},de=function(){var q=(P>0?P:-P)*(arguments.length>0&&arguments[0]!==void 0?arguments[0]:f),Z=P>0?0:255;P!==0&&(l.colorFillStyle(e,Z,Z,Z,q),g?e.fill(h):e.fill())},ue=function(){if(T>0){if(e.lineWidth=T,e.lineCap=I,e.lineJoin=M,e.setLineDash)switch(B){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash(_),e.lineDashOffset=z;break;case"solid":case"double":e.setLineDash([])}if(R!=="center"){if(e.save(),e.lineWidth*=2,R==="inside")g?e.clip(h):e.clip();else{var q=new Path2D;q.rect(-r/2-T,-a/2-T,r+2*T,a+2*T),q.addPath(h),e.clip(q,"evenodd")}g?e.stroke(h):e.stroke(),e.restore()}else g?e.stroke(h):e.stroke();if(B==="double"){e.lineWidth=T/3;var Z=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",g?e.stroke(h):e.stroke(),e.globalCompositeOperation=Z}e.setLineDash&&e.setLineDash([])}},C=function(){if(L>0){if(e.lineWidth=L,e.lineCap="butt",e.setLineDash)switch(W){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash([4,2]);break;case"solid":case"double":e.setLineDash([])}var q=d;g&&(q={x:0,y:0});var Z=l.getNodeShape(t),ee=T;R==="inside"&&(ee=0),R==="outside"&&(ee*=2);var ae,re=(r+ee+(L+U))/r,ye=(a+ee+(L+U))/a,he=r*re,ie=a*ye,ve=l.nodeShapes[Z].points;if(g&&(ae=$(he,ie,Z,ve).path),Z==="ellipse")l.drawEllipsePath(ae||e,q.x,q.y,he,ie);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(Z)){var be=0,Pe=0,Ae=0;Z==="round-diamond"?be=1.4*(ee+U+L):Z==="round-heptagon"?(be=1.075*(ee+U+L),Ae=-(ee/2+U+L)/35):Z==="round-hexagon"?be=1.12*(ee+U+L):Z==="round-pentagon"?(be=1.13*(ee+U+L),Ae=-(ee/2+U+L)/15):Z==="round-tag"?(be=1.12*(ee+U+L),Pe=.07*(ee/2+L+U)):Z==="round-triangle"&&(be=(ee+U+L)*(Math.PI/2),Ae=-(ee+U/2+L)/Math.PI),be!==0&&(he=r*(re=(r+be)/r),["round-hexagon","round-tag"].includes(Z)||(ie=a*(ye=(a+be)/a)));for(var Oe=he/2,Re=ie/2,tt=(Q=Q==="auto"?ds(he,ie):Q)+(ee+L+U)/2,_e=new Array(ve.length/2),gt=new Array(ve.length/2),Ve=0;Ve<ve.length/2;Ve++)_e[Ve]={x:q.x+Pe+Oe*ve[2*Ve],y:q.y+Ae+Re*ve[2*Ve+1]};var Fe,Ct,ut,ct,dt=_e.length;for(Ct=_e[dt-1],Fe=0;Fe<dt;Fe++)ut=_e[Fe%dt],ct=_e[(Fe+1)%dt],gt[Fe]=ji(Ct,ut,ct,tt),Ct=ut,ut=ct;l.drawRoundPolygonPath(ae||e,q.x+Pe,q.y+Ae,r*re,a*ye,ve,gt)}else["roundrectangle","round-rectangle"].includes(Z)?(Q=Q==="auto"?jt(he,ie):Q,l.drawRoundRectanglePath(ae||e,q.x,q.y,he,ie,Q+(ee+L+U)/2)):["cutrectangle","cut-rectangle"].includes(Z)?(Q=Q==="auto"?8:Q,l.drawCutRectanglePath(ae||e,q.x,q.y,he,ie,null,Q+(ee+L+U)/4)):["bottomroundrectangle","bottom-round-rectangle"].includes(Z)?(Q=Q==="auto"?jt(he,ie):Q,l.drawBottomRoundRectanglePath(ae||e,q.x,q.y,he,ie,Q+(ee+L+U)/2)):Z==="barrel"?l.drawBarrelPath(ae||e,q.x,q.y,he,ie):Z.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(Z)?(ve=Dr(Ar(ve,(ee+L+U)/r)),l.drawPolygonPath(ae||e,q.x,q.y,r,a,ve)):(ve=Dr(Ar(ve,-((ee+L+U)/r))),l.drawPolygonPath(ae||e,q.x,q.y,r,a,ve));if(g?e.stroke(ae):e.stroke(),W==="double"){e.lineWidth=ee/3;var vt=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",g?e.stroke(ae):e.stroke(),e.globalCompositeOperation=vt}e.setLineDash&&e.setLineDash([])}};if(t.pstyle("ghost").value==="yes"){var N=t.pstyle("ghost-offset-x").pfValue,j=t.pstyle("ghost-offset-y").pfValue,H=t.pstyle("ghost-opacity").value,K=H*f;e.translate(N,j),Y(),C(),F(H*D),fe(),ce(K,!0),O(H*V),ue(),te(P!==0||T!==0),se(P!==0||T!==0),ce(K,!1),de(K),e.translate(-N,-j)}g&&e.translate(-d.x,-d.y),o&&l.drawNodeUnderlay(e,t,d,r,a),g&&e.translate(d.x,d.y),Y(),C(),F(),fe(),ce(f,!0),O(),ue(),te(P!==0||T!==0),se(P!==0||T!==0),ce(f,!1),de(),g&&e.translate(-d.x,-d.y),l.drawElementText(e,t,null,i),o&&l.drawNodeOverlay(e,t,d,r,a),n&&e.translate(p.x1,p.y1)}}},Fc=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,n,r,a,i){if(n.visible()){var o=n.pstyle("".concat(e,"-padding")).pfValue,s=n.pstyle("".concat(e,"-opacity")).value,l=n.pstyle("".concat(e,"-color")).value,u=n.pstyle("".concat(e,"-shape")).value,c=n.pstyle("".concat(e,"-corner-radius")).value;if(s>0){if(r=r||n.position(),a==null||i==null){var d=n.padding();a=n.width()+2*d,i=n.height()+2*d}this.colorFillStyle(t,l[0],l[1],l[2],s),this.nodeShapes[u].draw(t,r.x,r.y,a+2*o,i+2*o,c),t.fill()}}}};dn.drawNodeOverlay=Fc("overlay"),dn.drawNodeUnderlay=Fc("underlay"),dn.hasPie=function(e){return(e=e[0])._private.hasPie},dn.hasStripe=function(e){return(e=e[0])._private.hasStripe},dn.drawPie=function(e,t,n,r){t=t[0],r=r||t.position();var a,i=t.cy().style(),o=t.pstyle("pie-size"),s=t.pstyle("pie-hole"),l=t.pstyle("pie-start-angle").pfValue,u=r.x,c=r.y,d=t.width(),h=t.height(),p=Math.min(d,h)/2,f=0;if(this.usePaths()&&(u=0,c=0),o.units==="%"?p*=o.pfValue:o.pfValue!==void 0&&(p=o.pfValue/2),s.units==="%"?a=p*s.pfValue:s.pfValue!==void 0&&(a=s.pfValue/2),!(a>=p))for(var g=1;g<=i.pieBackgroundN;g++){var v=t.pstyle("pie-"+g+"-background-size").value,y=t.pstyle("pie-"+g+"-background-color").value,b=t.pstyle("pie-"+g+"-background-opacity").value*n,m=v/100;m+f>1&&(m=1-f);var w=1.5*Math.PI+2*Math.PI*f,k=(w+=l)+2*Math.PI*m;v===0||f>=1||f+m>1||(a===0?(e.beginPath(),e.moveTo(u,c),e.arc(u,c,p,w,k),e.closePath()):(e.beginPath(),e.arc(u,c,p,w,k),e.arc(u,c,a,k,w,!0),e.closePath()),this.colorFillStyle(e,y[0],y[1],y[2],b),e.fill(),f+=m)}},dn.drawStripe=function(e,t,n,r){t=t[0],r=r||t.position();var a=t.cy().style(),i=r.x,o=r.y,s=t.width(),l=t.height(),u=0,c=this.usePaths();e.save();var d=t.pstyle("stripe-direction").value,h=t.pstyle("stripe-size");switch(d){case"vertical":break;case"righward":e.rotate(-Math.PI/2)}var p=s,f=l;h.units==="%"?(p*=h.pfValue,f*=h.pfValue):h.pfValue!==void 0&&(p=h.pfValue,f=h.pfValue),c&&(i=0,o=0),o-=p/2,i-=f/2;for(var g=1;g<=a.stripeBackgroundN;g++){var v=t.pstyle("stripe-"+g+"-background-size").value,y=t.pstyle("stripe-"+g+"-background-color").value,b=t.pstyle("stripe-"+g+"-background-opacity").value*n,m=v/100;m+u>1&&(m=1-u),v===0||u>=1||u+m>1||(e.beginPath(),e.rect(i,o+f*u,p,f*m),e.closePath(),this.colorFillStyle(e,y[0],y[1],y[2],b),e.fill(),u+=m)}e.restore()};var fr,at={};function Yc(e,t,n){var r=e.createShader(t);if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(r));return r}function wp(e,t,n){n===void 0&&(n=t);var r=e.makeOffscreenCanvas(t,n),a=r.context=r.getContext("2d");return r.clear=function(){return a.clearRect(0,0,r.width,r.height)},r.clear(),r}function Hi(e){var t=e.pixelRatio,n=e.cy.zoom(),r=e.cy.pan();return{zoom:n*t,pan:{x:r.x*t,y:r.y*t}}}function Ep(e){return e.pstyle("background-fill").value==="solid"&&e.pstyle("background-image").strValue==="none"&&(e.pstyle("border-width").value===0||e.pstyle("border-opacity").value===0||e.pstyle("border-style").value==="solid")}function kp(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function hn(e,t,n){var r=e[0]/255,a=e[1]/255,i=e[2]/255,o=t,s=n||new Array(4);return s[0]=r*o,s[1]=a*o,s[2]=i*o,s[3]=o,s}function zn(e,t){var n=t||new Array(4);return n[0]=(255&e)/255,n[1]=(e>>8&255)/255,n[2]=(e>>16&255)/255,n[3]=(e>>24&255)/255,n}function Tp(e){return e[0]+(e[1]<<8)+(e[2]<<16)+(e[3]<<24)}function jc(e,t){switch(t){case"float":return[1,e.FLOAT,4];case"vec2":return[2,e.FLOAT,4];case"vec3":return[3,e.FLOAT,4];case"vec4":return[4,e.FLOAT,4];case"int":return[1,e.INT,4];case"ivec2":return[2,e.INT,4]}}function Xc(e,t,n){switch(t){case e.FLOAT:return new Float32Array(n);case e.INT:return new Int32Array(n)}}function Cp(e,t,n,r,a,i){switch(t){case e.FLOAT:return new Float32Array(n.buffer,i*r,a);case e.INT:return new Int32Array(n.buffer,i*r,a)}}function Tt(e,t,n,r){var a=Le(jc(e,n),3),i=a[0],o=a[1],s=a[2],l=Xc(e,o,t*i),u=i*s,c=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,t*u,e.DYNAMIC_DRAW),e.enableVertexAttribArray(r),o===e.FLOAT?e.vertexAttribPointer(r,i,o,!1,u,0):o===e.INT&&e.vertexAttribIPointer(r,i,o,u,0),e.vertexAttribDivisor(r,1),e.bindBuffer(e.ARRAY_BUFFER,null);for(var d=new Array(t),h=0;h<t;h++)d[h]=Cp(e,o,l,u,i,h);return c.dataArray=l,c.stride=u,c.size=i,c.getView=function(p){return d[p]},c.setPoint=function(p,f,g){var v=d[p];v[0]=f,v[1]=g},c.bufferSubData=function(p){e.bindBuffer(e.ARRAY_BUFFER,c),p?e.bufferSubData(e.ARRAY_BUFFER,0,l,0,p*i):e.bufferSubData(e.ARRAY_BUFFER,0,l)},c}at.getPixelRatio=function(){var e=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var t=this.cy.window(),n=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(t.devicePixelRatio||1)/n},at.paintCache=function(e){for(var t,n=this.paintCaches=this.paintCaches||[],r=!0,a=0;a<n.length;a++)if((t=n[a]).context===e){r=!1;break}return r&&(t={context:e},n.push(t)),t},at.createGradientStyleFor=function(e,t,n,r,a){var i,o=this.usePaths(),s=n.pstyle(t+"-gradient-stop-colors").value,l=n.pstyle(t+"-gradient-stop-positions").pfValue;if(r==="radial-gradient")if(n.isEdge()){var u=n.sourceEndpoint(),c=n.targetEndpoint(),d=n.midpoint(),h=tn(u,d),p=tn(c,d);i=e.createRadialGradient(d.x,d.y,0,d.x,d.y,Math.max(h,p))}else{var f=o?{x:0,y:0}:n.position(),g=n.paddedWidth(),v=n.paddedHeight();i=e.createRadialGradient(f.x,f.y,0,f.x,f.y,Math.max(g,v))}else if(n.isEdge()){var y=n.sourceEndpoint(),b=n.targetEndpoint();i=e.createLinearGradient(y.x,y.y,b.x,b.y)}else{var m=o?{x:0,y:0}:n.position(),w=n.paddedWidth()/2,k=n.paddedHeight()/2;switch(n.pstyle("background-gradient-direction").value){case"to-bottom":i=e.createLinearGradient(m.x,m.y-k,m.x,m.y+k);break;case"to-top":i=e.createLinearGradient(m.x,m.y+k,m.x,m.y-k);break;case"to-left":i=e.createLinearGradient(m.x+w,m.y,m.x-w,m.y);break;case"to-right":i=e.createLinearGradient(m.x-w,m.y,m.x+w,m.y);break;case"to-bottom-right":case"to-right-bottom":i=e.createLinearGradient(m.x-w,m.y-k,m.x+w,m.y+k);break;case"to-top-right":case"to-right-top":i=e.createLinearGradient(m.x-w,m.y+k,m.x+w,m.y-k);break;case"to-bottom-left":case"to-left-bottom":i=e.createLinearGradient(m.x+w,m.y-k,m.x-w,m.y+k);break;case"to-top-left":case"to-left-top":i=e.createLinearGradient(m.x+w,m.y+k,m.x-w,m.y-k)}}if(!i)return null;for(var E=l.length===s.length,x=s.length,S=0;S<x;S++)i.addColorStop(E?l[S]:S/(x-1),"rgba("+s[S][0]+","+s[S][1]+","+s[S][2]+","+a+")");return i},at.gradientFillStyle=function(e,t,n,r){var a=this.createGradientStyleFor(e,"background",t,n,r);if(!a)return null;e.fillStyle=a},at.colorFillStyle=function(e,t,n,r,a){e.fillStyle="rgba("+t+","+n+","+r+","+a+")"},at.eleFillStyle=function(e,t,n){var r=t.pstyle("background-fill").value;if(r==="linear-gradient"||r==="radial-gradient")this.gradientFillStyle(e,t,r,n);else{var a=t.pstyle("background-color").value;this.colorFillStyle(e,a[0],a[1],a[2],n)}},at.gradientStrokeStyle=function(e,t,n,r){var a=this.createGradientStyleFor(e,"line",t,n,r);if(!a)return null;e.strokeStyle=a},at.colorStrokeStyle=function(e,t,n,r,a){e.strokeStyle="rgba("+t+","+n+","+r+","+a+")"},at.eleStrokeStyle=function(e,t,n){var r=t.pstyle("line-fill").value;if(r==="linear-gradient"||r==="radial-gradient")this.gradientStrokeStyle(e,t,r,n);else{var a=t.pstyle("line-color").value;this.colorStrokeStyle(e,a[0],a[1],a[2],n)}},at.matchCanvasSize=function(e){var t=this,n=t.data,r=t.findContainerClientCoords(),a=r[2],i=r[3],o=t.getPixelRatio(),s=t.motionBlurPxRatio;e!==t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_NODE]&&e!==t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_DRAG]||(o=s);var l,u=a*o,c=i*o;if(u!==t.canvasWidth||c!==t.canvasHeight){t.fontCaches=null;var d=n.canvasContainer;d.style.width=a+"px",d.style.height=i+"px";for(var h=0;h<t.CANVAS_LAYERS;h++)(l=n.canvases[h]).width=u,l.height=c,l.style.width=a+"px",l.style.height=i+"px";for(h=0;h<t.BUFFER_COUNT;h++)(l=n.bufferCanvases[h]).width=u,l.height=c,l.style.width=a+"px",l.style.height=i+"px";t.textureMult=1,o<=1&&(l=n.bufferCanvases[t.TEXTURE_BUFFER],t.textureMult=2,l.width=u*t.textureMult,l.height=c*t.textureMult),t.canvasWidth=u,t.canvasHeight=c,t.pixelRatio=o}},at.renderTo=function(e,t,n,r){this.render({forcedContext:e,forcedZoom:t,forcedPan:n,drawAllLayers:!0,forcedPxRatio:r})},at.clearCanvas=function(){var e=this,t=e.data;function n(r){r.clearRect(0,0,e.canvasWidth,e.canvasHeight)}n(t.contexts[e.NODE]),n(t.contexts[e.DRAG])},at.render=function(e){var t=this;e=e||Jo();var n=t.cy,r=e.forcedContext,a=e.drawAllLayers,i=e.drawOnlyNodeLayer,o=e.forcedZoom,s=e.forcedPan,l=e.forcedPxRatio===void 0?this.getPixelRatio():e.forcedPxRatio,u=t.data,c=u.canvasNeedsRedraw,d=t.textureOnViewport&&!r&&(t.pinching||t.hoverData.dragging||t.swipePanning||t.data.wheelZooming),h=e.motionBlur!==void 0?e.motionBlur:t.motionBlur,p=t.motionBlurPxRatio,f=n.hasCompoundNodes(),g=t.hoverData.draggingEles,v=!(!t.hoverData.selecting&&!t.touchData.selecting),y=h=h&&!r&&t.motionBlurEnabled&&!v;r||(t.prevPxRatio!==l&&(t.invalidateContainerClientCoordsCache(),t.matchCanvasSize(t.container),t.redrawHint("eles",!0),t.redrawHint("drag",!0)),t.prevPxRatio=l),!r&&t.motionBlurTimeout&&clearTimeout(t.motionBlurTimeout),h&&(t.mbFrames==null&&(t.mbFrames=0),t.mbFrames++,t.mbFrames<3&&(y=!1),t.mbFrames>t.minMbLowQualFrames&&(t.motionBlurPxRatio=t.mbPxRBlurry)),t.clearingMotionBlur&&(t.motionBlurPxRatio=1),t.textureDrawLastFrame&&!d&&(c[t.NODE]=!0,c[t.SELECT_BOX]=!0);var b=n.style(),m=n.zoom(),w=o!==void 0?o:m,k=n.pan(),E={x:k.x,y:k.y},x={zoom:m,pan:{x:k.x,y:k.y}},S=t.prevViewport;S===void 0||x.zoom!==S.zoom||x.pan.x!==S.pan.x||x.pan.y!==S.pan.y||g&&!f||(t.motionBlurPxRatio=1),s&&(E=s),w*=l,E.x*=l,E.y*=l;var P=t.getCachedZSortedEles();function T(O,Y,$,J,ne){var le=O.globalCompositeOperation;O.globalCompositeOperation="destination-out",t.colorFillStyle(O,255,255,255,t.motionBlurTransparency),O.fillRect(Y,$,J,ne),O.globalCompositeOperation=le}function D(O,Y){var $,J,ne,le;t.clearingMotionBlur||O!==u.bufferContexts[t.MOTIONBLUR_BUFFER_NODE]&&O!==u.bufferContexts[t.MOTIONBLUR_BUFFER_DRAG]?($=E,J=w,ne=t.canvasWidth,le=t.canvasHeight):($={x:k.x*p,y:k.y*p},J=m*p,ne=t.canvasWidth*p,le=t.canvasHeight*p),O.setTransform(1,0,0,1,0,0),Y==="motionBlur"?T(O,0,0,ne,le):r||Y!==void 0&&!Y||O.clearRect(0,0,ne,le),a||(O.translate($.x,$.y),O.scale(J,J)),s&&O.translate(s.x,s.y),o&&O.scale(o,o)}if(d||(t.textureDrawLastFrame=!1),d){if(t.textureDrawLastFrame=!0,!t.textureCache){t.textureCache={},t.textureCache.bb=n.mutableElements().boundingBox(),t.textureCache.texture=t.data.bufferCanvases[t.TEXTURE_BUFFER];var A=t.data.bufferContexts[t.TEXTURE_BUFFER];A.setTransform(1,0,0,1,0,0),A.clearRect(0,0,t.canvasWidth*t.textureMult,t.canvasHeight*t.textureMult),t.render({forcedContext:A,drawOnlyNodeLayer:!0,forcedPxRatio:l*t.textureMult}),(x=t.textureCache.viewport={zoom:n.zoom(),pan:n.pan(),width:t.canvasWidth,height:t.canvasHeight}).mpan={x:(0-x.pan.x)/x.zoom,y:(0-x.pan.y)/x.zoom}}c[t.DRAG]=!1,c[t.NODE]=!1;var B=u.contexts[t.NODE],M=t.textureCache.texture;x=t.textureCache.viewport,B.setTransform(1,0,0,1,0,0),h?T(B,0,0,x.width,x.height):B.clearRect(0,0,x.width,x.height);var I=b.core("outside-texture-bg-color").value,R=b.core("outside-texture-bg-opacity").value;t.colorFillStyle(B,I[0],I[1],I[2],R),B.fillRect(0,0,x.width,x.height),m=n.zoom(),D(B,!1),B.clearRect(x.mpan.x,x.mpan.y,x.width/x.zoom/l,x.height/x.zoom/l),B.drawImage(M,x.mpan.x,x.mpan.y,x.width/x.zoom/l,x.height/x.zoom/l)}else t.textureOnViewport&&!r&&(t.textureCache=null);var _=n.extent(),z=t.pinching||t.hoverData.dragging||t.swipePanning||t.data.wheelZooming||t.hoverData.draggingEles||t.cy.animated(),V=t.hideEdgesOnViewport&&z,L=[];if(L[t.NODE]=!c[t.NODE]&&h&&!t.clearedForMotionBlur[t.NODE]||t.clearingMotionBlur,L[t.NODE]&&(t.clearedForMotionBlur[t.NODE]=!0),L[t.DRAG]=!c[t.DRAG]&&h&&!t.clearedForMotionBlur[t.DRAG]||t.clearingMotionBlur,L[t.DRAG]&&(t.clearedForMotionBlur[t.DRAG]=!0),c[t.NODE]||a||i||L[t.NODE]){var X=h&&!L[t.NODE]&&p!==1;D(B=r||(X?t.data.bufferContexts[t.MOTIONBLUR_BUFFER_NODE]:u.contexts[t.NODE]),h&&!X?"motionBlur":void 0),V?t.drawCachedNodes(B,P.nondrag,l,_):t.drawLayeredElements(B,P.nondrag,l,_),t.debug&&t.drawDebugPoints(B,P.nondrag),a||h||(c[t.NODE]=!1)}if(!i&&(c[t.DRAG]||a||L[t.DRAG])&&(X=h&&!L[t.DRAG]&&p!==1,D(B=r||(X?t.data.bufferContexts[t.MOTIONBLUR_BUFFER_DRAG]:u.contexts[t.DRAG]),h&&!X?"motionBlur":void 0),V?t.drawCachedNodes(B,P.drag,l,_):t.drawCachedElements(B,P.drag,l,_),t.debug&&t.drawDebugPoints(B,P.drag),a||h||(c[t.DRAG]=!1)),this.drawSelectionRectangle(e,D),h&&p!==1){var W=u.contexts[t.NODE],G=t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_NODE],U=u.contexts[t.DRAG],Q=t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_DRAG],F=function(O,Y,$){O.setTransform(1,0,0,1,0,0),$||!y?O.clearRect(0,0,t.canvasWidth,t.canvasHeight):T(O,0,0,t.canvasWidth,t.canvasHeight);var J=p;O.drawImage(Y,0,0,t.canvasWidth*J,t.canvasHeight*J,0,0,t.canvasWidth,t.canvasHeight)};(c[t.NODE]||L[t.NODE])&&(F(W,G,L[t.NODE]),c[t.NODE]=!1),(c[t.DRAG]||L[t.DRAG])&&(F(U,Q,L[t.DRAG]),c[t.DRAG]=!1)}t.prevViewport=x,t.clearingMotionBlur&&(t.clearingMotionBlur=!1,t.motionBlurCleared=!0,t.motionBlur=!0),h&&(t.motionBlurTimeout=setTimeout(function(){t.motionBlurTimeout=null,t.clearedForMotionBlur[t.NODE]=!1,t.clearedForMotionBlur[t.DRAG]=!1,t.motionBlur=!1,t.clearingMotionBlur=!d,t.mbFrames=0,c[t.NODE]=!0,c[t.DRAG]=!0,t.redraw()},100)),r||n.emit("render")},at.drawSelectionRectangle=function(e,t){var n=this,r=n.cy,a=n.data,i=r.style(),o=e.drawOnlyNodeLayer,s=e.drawAllLayers,l=a.canvasNeedsRedraw,u=e.forcedContext;if(n.showFps||!o&&l[n.SELECT_BOX]&&!s){var c=u||a.contexts[n.SELECT_BOX];if(t(c),n.selection[4]==1&&(n.hoverData.selecting||n.touchData.selecting)){var d=n.cy.zoom(),h=i.core("selection-box-border-width").value/d;c.lineWidth=h,c.fillStyle="rgba("+i.core("selection-box-color").value[0]+","+i.core("selection-box-color").value[1]+","+i.core("selection-box-color").value[2]+","+i.core("selection-box-opacity").value+")",c.fillRect(n.selection[0],n.selection[1],n.selection[2]-n.selection[0],n.selection[3]-n.selection[1]),h>0&&(c.strokeStyle="rgba("+i.core("selection-box-border-color").value[0]+","+i.core("selection-box-border-color").value[1]+","+i.core("selection-box-border-color").value[2]+","+i.core("selection-box-opacity").value+")",c.strokeRect(n.selection[0],n.selection[1],n.selection[2]-n.selection[0],n.selection[3]-n.selection[1]))}if(a.bgActivePosistion&&!n.hoverData.selecting){d=n.cy.zoom();var p=a.bgActivePosistion;c.fillStyle="rgba("+i.core("active-bg-color").value[0]+","+i.core("active-bg-color").value[1]+","+i.core("active-bg-color").value[2]+","+i.core("active-bg-opacity").value+")",c.beginPath(),c.arc(p.x,p.y,i.core("active-bg-size").pfValue/d,0,2*Math.PI),c.fill()}var f=n.lastRedrawTime;if(n.showFps&&f){f=Math.round(f);var g=Math.round(1e3/f),v="1 frame = "+f+" ms = "+g+" fps";if(c.setTransform(1,0,0,1,0,0),c.fillStyle="rgba(255, 0, 0, 0.75)",c.strokeStyle="rgba(255, 0, 0, 0.75)",c.font="30px Arial",!fr){var y=c.measureText(v);fr=y.actualBoundingBoxAscent}c.fillText(v,0,fr),c.strokeRect(0,fr+10,250,20),c.fillRect(0,fr+10,250*Math.min(g/60,1),20)}s||(l[n.SELECT_BOX]=!1)}};var qc=typeof Float32Array<"u"?Float32Array:Array;function Gi(){var e=new qc(9);return qc!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Wc(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function ha(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],h=n[0],p=n[1];return e[0]=r,e[1]=a,e[2]=i,e[3]=o,e[4]=s,e[5]=l,e[6]=h*r+p*o+u,e[7]=h*a+p*s+c,e[8]=h*i+p*l+d,e}function Hc(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],h=Math.sin(n),p=Math.cos(n);return e[0]=p*r+h*o,e[1]=p*a+h*s,e[2]=p*i+h*l,e[3]=p*o-h*r,e[4]=p*s-h*a,e[5]=p*l-h*i,e[6]=u,e[7]=c,e[8]=d,e}function Ki(e,t,n){var r=n[0],a=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=a*t[3],e[4]=a*t[4],e[5]=a*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var Pp=function(){return Rt(function e(t,n,r,a){Nt(this,e),this.debugID=Math.floor(1e4*Math.random()),this.r=t,this.texSize=n,this.texRows=r,this.texHeight=Math.floor(n/r),this.enableWrapping=!0,this.locked=!1,this.texture=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=a(t,n,n),this.scratch=a(t,n,this.texHeight,"scratch")},[{key:"lock",value:function(){this.locked=!0}},{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(e){var t=e.w,n=e.h,r=this.texHeight,a=this.texSize,i=r/n,o=t*i,s=n*i;return o>a&&(o=t*(i=a/t),s=n*i),{scale:i,texW:o,texH:s}}},{key:"draw",value:function(e,t,n){var r=this;if(this.locked)throw new Error("can't draw, atlas is locked");var a=this.texSize,i=this.texRows,o=this.texHeight,s=this.getScale(t),l=s.scale,u=s.texW,c=s.texH,d=function(g,v){if(n&&v){var y=v.context,b=g.x,m=g.row,w=b,k=o*m;y.save(),y.translate(w,k),y.scale(l,l),n(y,t),y.restore()}},h=[null,null],p=function(){d(r.freePointer,r.canvas),h[0]={x:r.freePointer.x,y:r.freePointer.row*o,w:u,h:c},h[1]={x:r.freePointer.x+u,y:r.freePointer.row*o,w:0,h:c},r.freePointer.x+=u,r.freePointer.x==a&&(r.freePointer.x=0,r.freePointer.row++)},f=function(){r.freePointer.x=0,r.freePointer.row++};if(this.freePointer.x+u<=a)p();else{if(this.freePointer.row>=i-1)return!1;this.freePointer.x===a?(f(),p()):this.enableWrapping?function(){var g=r.scratch,v=r.canvas;g.clear(),d({x:0,row:0},g);var y=a-r.freePointer.x,b=u-y,m=o,w=r.freePointer.x,k=r.freePointer.row*o,E=y;v.context.drawImage(g,0,0,E,m,w,k,E,m),h[0]={x:w,y:k,w:E,h:c};var x=y,S=(r.freePointer.row+1)*o,P=b;v&&v.context.drawImage(g,x,0,P,m,0,S,P,m),h[1]={x:0,y:S,w:P,h:c},r.freePointer.x=b,r.freePointer.row++}():(f(),p())}return this.keyToLocation.set(e,h),this.needsBuffer=!0,h}},{key:"getOffsets",value:function(e){return this.keyToLocation.get(e)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(e){if(this.locked)return!1;var t=this.texSize,n=this.texRows,r=this.getScale(e).texW;return!(this.freePointer.x+r>t)||this.freePointer.row<n-1}},{key:"bufferIfNeeded",value:function(e){this.texture||(this.texture=function(t){var n=t.createTexture();return n.buffer=function(r){t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null)},n.deleteTexture=function(){t.deleteTexture(n)},n}(e,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1,this.locked&&(this.canvas=null,this.scratch=null))}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null),this.canvas=null,this.scratch=null,this.locked=!0}}])}(),Sp=function(){return Rt(function e(t,n,r,a){Nt(this,e),this.r=t,this.texSize=n,this.texRows=r,this.createTextureCanvas=a,this.atlases=[],this.styleKeyToAtlas=new Map,this.markedKeys=new Set},[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function(){var e=this.r,t=this.texSize,n=this.texRows,r=this.createTextureCanvas;return new Pp(e,t,n,r)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var e=this.r,t=this.texSize,n=this.texRows,r=this.createTextureCanvas,a=Math.floor(t/n);this.scratch=r(e,t,a,"scratch")}return this.scratch}},{key:"draw",value:function(e,t,n){var r=this.styleKeyToAtlas.get(e);return r||((r=this.atlases[this.atlases.length-1])&&r.canFit(t)||(r&&r.lock(),r=this._createAtlas(),this.atlases.push(r)),r.draw(e,t,n),this.styleKeyToAtlas.set(e,r)),r}},{key:"getAtlas",value:function(e){return this.styleKeyToAtlas.get(e)}},{key:"hasAtlas",value:function(e){return this.styleKeyToAtlas.has(e)}},{key:"markKeyForGC",value:function(e){this.markedKeys.add(e)}},{key:"gc",value:function(){var e=this,t=this.markedKeys;if(t.size!==0){var n,r=[],a=new Map,i=null,o=it(this.atlases);try{var s=function(){var l,u,c=n.value,d=c.getKeys(),h=(u=d,(l=t).intersection?l.intersection(u):new Set(yr(l).filter(function(m){return u.has(m)})));if(h.size===0)return r.push(c),d.forEach(function(m){return a.set(m,c)}),1;i||(i=e._createAtlas(),r.push(i));var p,f=it(d);try{for(f.s();!(p=f.n()).done;){var g=p.value;if(!h.has(g)){var v=Le(c.getOffsets(g),2),y=v[0],b=v[1];i.canFit({w:y.w+b.w,h:y.h})||(i.lock(),i=e._createAtlas(),r.push(i)),c.canvas&&(e._copyTextureToNewAtlas(g,c,i),a.set(g,i))}}}catch(m){f.e(m)}finally{f.f()}c.dispose()};for(o.s();!(n=o.n()).done;)s()}catch(l){o.e(l)}finally{o.f()}this.atlases=r,this.styleKeyToAtlas=a,this.markedKeys=new Set}else console.log("nothing to garbage collect")}},{key:"_copyTextureToNewAtlas",value:function(e,t,n){var r=Le(t.getOffsets(e),2),a=r[0],i=r[1];if(i.w===0)n.draw(e,a,function(u){u.drawImage(t.canvas,a.x,a.y,a.w,a.h,0,0,a.w,a.h)});else{var o=this._getScratchCanvas();o.clear(),o.context.drawImage(t.canvas,a.x,a.y,a.w,a.h,0,0,a.w,a.h),o.context.drawImage(t.canvas,i.x,i.y,i.w,i.h,a.w,0,i.w,i.h);var s=a.w+i.w,l=a.h;n.draw(e,{w:s,h:l},function(u){u.drawImage(o,0,0,s,l,0,0,s,l)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}])}(),Bp=function(){return Rt(function e(t,n){Nt(this,e),this.r=t,this.globalOptions=n,this.atlasSize=n.webglTexSize,this.maxAtlasesPerBatch=n.webglTexPerBatch,this.renderTypes=new Map,this.collections=new Map,this.typeAndIdToKey=new Map},[{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"addAtlasCollection",value:function(e,t){var n=this.globalOptions,r=n.webglTexSize,a=n.createTextureCanvas,i=t.texRows,o=this._cacheScratchCanvas(a),s=new Sp(this.r,r,i,o);this.collections.set(e,s)}},{key:"addRenderType",value:function(e,t){var n=t.collection;if(!this.collections.has(n))throw new Error("invalid atlas collection name '".concat(n,"'"));var r=this.collections.get(n),a=ge({type:e,atlasCollection:r},t);this.renderTypes.set(e,a)}},{key:"getRenderTypeOpts",value:function(e){return this.renderTypes.get(e)}},{key:"getAtlasCollection",value:function(e){return this.collections.get(e)}},{key:"_cacheScratchCanvas",value:function(e){var t=-1,n=-1,r=null;return function(a,i,o,s){return s?(r&&i==t&&o==n||(t=i,n=o,r=e(a,i,o)),r):e(a,i,o)}}},{key:"_key",value:function(e,t){return"".concat(e,"-").concat(t)}},{key:"invalidate",value:function(e){var t,n=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.forceRedraw,i=a!==void 0&&a,o=r.filterEle,s=o===void 0?function(){return!0}:o,l=r.filterType,u=l===void 0?function(){return!0}:l,c=!1,d=!1,h=it(e);try{for(h.s();!(t=h.n()).done;){var p=t.value;if(s(p)){var f,g=it(this.renderTypes.values());try{var v=function(){var y=f.value,b=y.type;if(u(b)){var m=n.collections.get(y.collection),w=y.getKey(p),k=Array.isArray(w)?w:[w];if(i)k.forEach(function(P){return m.markKeyForGC(P)}),d=!0;else{var E=y.getID?y.getID(p):p.id(),x=n._key(b,E),S=n.typeAndIdToKey.get(x);S===void 0||kp(k,S)||(c=!0,n.typeAndIdToKey.delete(x),S.forEach(function(P){return m.markKeyForGC(P)}))}}};for(g.s();!(f=g.n()).done;)v()}catch(y){g.e(y)}finally{g.f()}}}}catch(y){h.e(y)}finally{h.f()}return d&&(this.gc(),c=!1),c}},{key:"gc",value:function(){var e,t=it(this.collections.values());try{for(t.s();!(e=t.n()).done;)e.value.gc()}catch(n){t.e(n)}finally{t.f()}}},{key:"getOrCreateAtlas",value:function(e,t,n,r){var a=this.renderTypes.get(t),i=this.collections.get(a.collection),o=!1,s=i.draw(r,n,function(c){a.drawClipped?(c.save(),c.beginPath(),c.rect(0,0,n.w,n.h),c.clip(),a.drawElement(c,e,n,!0,!0),c.restore()):a.drawElement(c,e,n,!0,!0),o=!0});if(o){var l=a.getID?a.getID(e):e.id(),u=this._key(t,l);this.typeAndIdToKey.has(u)?this.typeAndIdToKey.get(u).push(r):this.typeAndIdToKey.set(u,[r])}return s}},{key:"getAtlasInfo",value:function(e,t){var n=this,r=this.renderTypes.get(t),a=r.getKey(e);return(Array.isArray(a)?a:[a]).map(function(i){var o=r.getBoundingBox(e,i),s=n.getOrCreateAtlas(e,t,o,i),l=Le(s.getOffsets(i),2),u=l[0];return{atlas:s,tex:u,tex1:u,tex2:l[1],bb:o}})}},{key:"getDebugInfo",value:function(){var e,t=[],n=it(this.collections);try{for(n.s();!(e=n.n()).done;){var r=Le(e.value,2),a=r[0],i=r[1].getCounts(),o=i.keyCount,s=i.atlasCount;t.push({type:a,keyCount:o,atlasCount:s})}}catch(l){n.e(l)}finally{n.f()}return t}}])}(),_p=function(){return Rt(function e(t){Nt(this,e),this.globalOptions=t,this.atlasSize=t.webglTexSize,this.maxAtlasesPerBatch=t.webglTexPerBatch,this.batchAtlases=[]},[{key:"getMaxAtlasesPerBatch",value:function(){return this.maxAtlasesPerBatch}},{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlasesPerBatch},function(e,t){return t})}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function(e){return this.batchAtlases.length!==this.maxAtlasesPerBatch||this.batchAtlases.includes(e)}},{key:"getAtlasIndexForBatch",value:function(e){var t=this.batchAtlases.indexOf(e);if(t<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)throw new Error("cannot add more atlases to batch");this.batchAtlases.push(e),t=this.batchAtlases.length-1}return t}}])}(),pr={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},Gc=1,Kc=2,Dp=function(){return Rt(function e(t,n,r){Nt(this,e),this.r=t,this.gl=n,this.maxInstances=r.webglBatchSize,this.atlasSize=r.webglTexSize,this.bgColor=r.bgColor,this.debug=r.webglDebug,this.batchDebugInfo=[],r.enableWrapping=!0,r.createTextureCanvas=wp,this.atlasManager=new Bp(t,r),this.batchManager=new _p(r),this.simpleShapeOptions=new Map,this.program=this._createShaderProgram(pr.SCREEN),this.pickingProgram=this._createShaderProgram(pr.PICKING),this.vao=this._createVAO()},[{key:"addAtlasCollection",value:function(e,t){this.atlasManager.addAtlasCollection(e,t)}},{key:"addTextureAtlasRenderType",value:function(e,t){this.atlasManager.addRenderType(e,t)}},{key:"addSimpleShapeRenderType",value:function(e,t){this.simpleShapeOptions.set(e,t)}},{key:"invalidate",value:function(e){var t=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).type,n=this.atlasManager;return t?n.invalidate(e,{filterType:function(r){return r===t},forceRedraw:!0}):n.invalidate(e)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"_createShaderProgram",value:function(e){var t=this.gl,n=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; // a vertex from the unit square
      
      in mat3 aTransform; // used to transform verticies, eg into a bounding box
      in int aVertType; // the type of thing we are rendering

      // the z-index that is output when using picking mode
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex; // x/y/w/h of texture in atlas

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in vec2 aLineWidth; // also used for node border width

      // simple shapes
      in vec4 aCornerRadius; // for round-rectangle [top-right, bottom-right, top-left, bottom-left]
      in vec4 aColor; // also used for edges
      in vec4 aBorderColor; // aLineWidth is used for border width

      // output values passed to the fragment shader
      out vec2 vTexCoord;
      out vec4 vColor;
      out vec2 vPosition;
      // flat values are not interpolated
      flat out int vAtlasId; 
      flat out int vVertType;
      flat out vec2 vTopRight;
      flat out vec2 vBotLeft;
      flat out vec4 vCornerRadius;
      flat out vec4 vBorderColor;
      flat out vec2 vBorderWidth;
      flat out vec4 vIndex;
      
      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition; // TODO make this a vec3, simplifies some code below

        if(aVertType == `.concat(0,`) {
          float texX = aTex.x; // texture coordinates
          float texY = aTex.y;
          float texW = aTex.z;
          float texH = aTex.w;

          if(vid == 1 || vid == 2 || vid == 4) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(4," || aVertType == ").concat(7,` 
             || aVertType == `).concat(5," || aVertType == ").concat(6,`) { // simple shapes

          // the bounding box is needed by the fragment shader
          vBotLeft  = (aTransform * vec3(0, 0, 1)).xy; // flat
          vTopRight = (aTransform * vec3(1, 1, 1)).xy; // flat
          vPosition = (aTransform * vec3(position, 1)).xy; // will be interpolated

          // calculations are done in the fragment shader, just pass these along
          vColor = aColor;
          vCornerRadius = aCornerRadius;
          vBorderColor = aBorderColor;
          vBorderWidth = aLineWidth;

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(1,`) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          // stretch the unit square into a long skinny rectangle
          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth[0] * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vColor = aColor;
        } 
        else if(aVertType == `).concat(2,`) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0, p1, p2, pos;
          if(position.x == 0.0) { // The left side of the unit square
            p0 = pointA;
            p1 = pointB;
            p2 = pointC;
            pos = position;
          } else { // The right side of the unit square, use same approach but flip the geometry upside down
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth[0];

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vColor = aColor;
        } 
        else if(aVertType == `).concat(3,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2(  0.0,  0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
          vColor = aColor;
        }
        else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vVertType = aVertType;
        vIndex = aIndex;
      }
    `),r=this.batchManager.getIndexArray(),a=`#version 300 es
      precision highp float;

      // declare texture unit for each texture atlas in the batch
      `.concat(r.map(function(s){return"uniform sampler2D uTexture".concat(s,";")}).join(`
	`),`

      uniform vec4 uBGColor;
      uniform float uZoom;

      in vec2 vTexCoord;
      in vec4 vColor;
      in vec2 vPosition; // model coordinates

      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;
      flat in vec2 vTopRight;
      flat in vec2 vBotLeft;
      flat in vec4 vCornerRadius;
      flat in vec4 vBorderColor;
      flat in vec2 vBorderWidth;

      out vec4 outColor;

      `).concat(`
  float circleSD(vec2 p, float r) {
    return distance(vec2(0), p) - r; // signed distance
  }
`,`
      `).concat(`
  float rectangleSD(vec2 p, vec2 b) {
    vec2 d = abs(p)-b;
    return distance(vec2(0),max(d,0.0)) + min(max(d.x,d.y),0.0);
  }
`,`
      `).concat(`
  float roundRectangleSD(vec2 p, vec2 b, vec4 cr) {
    cr.xy = (p.x > 0.0) ? cr.xy : cr.zw;
    cr.x  = (p.y > 0.0) ? cr.x  : cr.y;
    vec2 q = abs(p) - b + cr.x;
    return min(max(q.x, q.y), 0.0) + distance(vec2(0), max(q, 0.0)) - cr.x;
  }
`,`
      `).concat(`
  float ellipseSD(vec2 p, vec2 ab) {
    p = abs( p ); // symmetry

    // find root with Newton solver
    vec2 q = ab*(p-ab);
    float w = (q.x<q.y)? 1.570796327 : 0.0;
    for( int i=0; i<5; i++ ) {
      vec2 cs = vec2(cos(w),sin(w));
      vec2 u = ab*vec2( cs.x,cs.y);
      vec2 v = ab*vec2(-cs.y,cs.x);
      w = w + dot(p-u,v)/(dot(p-u,u)+dot(v,v));
    }
    
    // compute final point and distance
    float d = length(p-ab*vec2(cos(w),sin(w)));
    
    // return signed distance
    return (dot(p/ab,p/ab)>1.0) ? d : -d;
  }
`,`

      vec4 blend(vec4 top, vec4 bot) { // blend colors with premultiplied alpha
        return vec4( 
          top.rgb + (bot.rgb * (1.0 - top.a)),
          top.a   + (bot.a   * (1.0 - top.a)) 
        );
      }

      vec4 distInterp(vec4 cA, vec4 cB, float d) { // interpolate color using Signed Distance
        // scale to the zoom level so that borders don't look blurry when zoomed in
        // note 1.5 is an aribitrary value chosen because it looks good
        return mix(cA, cB, 1.0 - smoothstep(0.0, 1.5 / uZoom, abs(d))); 
      }

      void main(void) {
        if(vVertType == `).concat(0,`) {
          // look up the texel from the texture unit
          `).concat(r.map(function(s){return"if(vAtlasId == ".concat(s,") outColor = texture(uTexture").concat(s,", vTexCoord);")}).join(`
	else `),`
        } 
        else if(vVertType == `).concat(3,`) {
          // mimics how canvas renderer uses context.globalCompositeOperation = 'destination-out';
          outColor = blend(vColor, uBGColor);
          outColor.a = 1.0; // make opaque, masks out line under arrow
        }
        else if(vVertType == `).concat(4,` && vBorderWidth == vec2(0.0)) { // simple rectangle with no border
          outColor = vColor; // unit square is already transformed to the rectangle, nothing else needs to be done
        }
        else if(vVertType == `).concat(4," || vVertType == ").concat(7,` 
          || vVertType == `).concat(5," || vVertType == ").concat(6,`) { // use SDF

          float outerBorder = vBorderWidth[0];
          float innerBorder = vBorderWidth[1];
          float borderPadding = outerBorder * 2.0;
          float w = vTopRight.x - vBotLeft.x - borderPadding;
          float h = vTopRight.y - vBotLeft.y - borderPadding;
          vec2 b = vec2(w/2.0, h/2.0); // half width, half height
          vec2 p = vPosition - vec2(vTopRight.x - b[0] - outerBorder, vTopRight.y - b[1] - outerBorder); // translate to center

          float d; // signed distance
          if(vVertType == `).concat(4,`) {
            d = rectangleSD(p, b);
          } else if(vVertType == `).concat(7,` && w == h) {
            d = circleSD(p, b.x); // faster than ellipse
          } else if(vVertType == `).concat(7,`) {
            d = ellipseSD(p, b);
          } else {
            d = roundRectangleSD(p, b, vCornerRadius.wzyx);
          }

          // use the distance to interpolate a color to smooth the edges of the shape, doesn't need multisampling
          // we must smooth colors inwards, because we can't change pixels outside the shape's bounding box
          if(d > 0.0) {
            if(d > outerBorder) {
              discard;
            } else {
              outColor = distInterp(vBorderColor, vec4(0), d - outerBorder);
            }
          } else {
            if(d > innerBorder) {
              vec4 outerColor = outerBorder == 0.0 ? vec4(0) : vBorderColor;
              vec4 innerBorderColor = blend(vBorderColor, vColor);
              outColor = distInterp(innerBorderColor, outerColor, d);
            } 
            else {
              vec4 outerColor;
              if(innerBorder == 0.0 && outerBorder == 0.0) {
                outerColor = vec4(0);
              } else if(innerBorder == 0.0) {
                outerColor = vBorderColor;
              } else {
                outerColor = blend(vBorderColor, vColor);
              }
              outColor = distInterp(vColor, outerColor, d - innerBorder);
            }
          }
        }
        else {
          outColor = vColor;
        }

        `).concat(e.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),i=function(s,l,u){var c=Yc(s,s.VERTEX_SHADER,l),d=Yc(s,s.FRAGMENT_SHADER,u),h=s.createProgram();if(s.attachShader(h,c),s.attachShader(h,d),s.linkProgram(h),!s.getProgramParameter(h,s.LINK_STATUS))throw new Error("Could not initialize shaders");return h}(t,n,a);i.aPosition=t.getAttribLocation(i,"aPosition"),i.aIndex=t.getAttribLocation(i,"aIndex"),i.aVertType=t.getAttribLocation(i,"aVertType"),i.aTransform=t.getAttribLocation(i,"aTransform"),i.aAtlasId=t.getAttribLocation(i,"aAtlasId"),i.aTex=t.getAttribLocation(i,"aTex"),i.aPointAPointB=t.getAttribLocation(i,"aPointAPointB"),i.aPointCPointD=t.getAttribLocation(i,"aPointCPointD"),i.aLineWidth=t.getAttribLocation(i,"aLineWidth"),i.aColor=t.getAttribLocation(i,"aColor"),i.aCornerRadius=t.getAttribLocation(i,"aCornerRadius"),i.aBorderColor=t.getAttribLocation(i,"aBorderColor"),i.uPanZoomMatrix=t.getUniformLocation(i,"uPanZoomMatrix"),i.uAtlasSize=t.getUniformLocation(i,"uAtlasSize"),i.uBGColor=t.getUniformLocation(i,"uBGColor"),i.uZoom=t.getUniformLocation(i,"uZoom"),i.uTextures=[];for(var o=0;o<this.batchManager.getMaxAtlasesPerBatch();o++)i.uTextures.push(t.getUniformLocation(i,"uTexture".concat(o)));return i}},{key:"_createVAO",value:function(){var e=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=e.length/2;var t=this.maxInstances,n=this.gl,r=this.program,a=n.createVertexArray();return n.bindVertexArray(a),function(i,o,s,l){var u=Le(jc(i,o),2),c=u[0],d=u[1],h=Xc(i,d,l),p=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,p),i.bufferData(i.ARRAY_BUFFER,h,i.STATIC_DRAW),d===i.FLOAT?i.vertexAttribPointer(s,c,d,!1,0,0):d===i.INT&&i.vertexAttribIPointer(s,c,d,0,0),i.enableVertexAttribArray(s),i.bindBuffer(i.ARRAY_BUFFER,null)}(n,"vec2",r.aPosition,e),this.transformBuffer=function(i,o,s){for(var l=new Float32Array(9*o),u=new Array(o),c=0;c<o;c++){var d=9*c*4;u[c]=new Float32Array(l.buffer,d,9)}var h=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,h),i.bufferData(i.ARRAY_BUFFER,l.byteLength,i.DYNAMIC_DRAW);for(var p=0;p<3;p++){var f=s+p;i.enableVertexAttribArray(f),i.vertexAttribPointer(f,3,i.FLOAT,!1,36,12*p),i.vertexAttribDivisor(f,1)}return i.bindBuffer(i.ARRAY_BUFFER,null),h.getMatrixView=function(g){return u[g]},h.setData=function(g,v){u[v].set(g,0)},h.bufferSubData=function(){i.bindBuffer(i.ARRAY_BUFFER,h),i.bufferSubData(i.ARRAY_BUFFER,0,l)},h}(n,t,r.aTransform),this.indexBuffer=Tt(n,t,"vec4",r.aIndex),this.vertTypeBuffer=Tt(n,t,"int",r.aVertType),this.atlasIdBuffer=Tt(n,t,"int",r.aAtlasId),this.texBuffer=Tt(n,t,"vec4",r.aTex),this.pointAPointBBuffer=Tt(n,t,"vec4",r.aPointAPointB),this.pointCPointDBuffer=Tt(n,t,"vec4",r.aPointCPointD),this.lineWidthBuffer=Tt(n,t,"vec2",r.aLineWidth),this.colorBuffer=Tt(n,t,"vec4",r.aColor),this.cornerRadiusBuffer=Tt(n,t,"vec4",r.aCornerRadius),this.borderColorBuffer=Tt(n,t,"vec4",r.aBorderColor),n.bindVertexArray(null),a}},{key:"buffers",get:function(){var e=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(t){return zt(t,"Buffer")}).map(function(t){return e[t]})),this._buffers}},{key:"startFrame",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pr.SCREEN;this.panZoomMatrix=e,this.renderTarget=t,this.batchDebugInfo=[],this.wrappedCount=0,this.simpleCount=0,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.batchManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"_isVisible",value:function(e,t){return!!e.visible()&&(!t||!t.isVisible||t.isVisible(e))}},{key:"drawTexture",value:function(e,t,n){var r=this.atlasManager,a=this.batchManager,i=r.getRenderTypeOpts(n);if(this._isVisible(e,i)&&(!e.isEdge()||this._isValidEdge(e))){if(this.renderTarget.picking&&i.getTexPickingMode){var o=i.getTexPickingMode(e);if(o===Gc)return;if(o==Kc)return void this.drawPickingRectangle(e,t,n)}var s,l=it(r.getAtlasInfo(e,n));try{for(l.s();!(s=l.n()).done;){var u=s.value,c=u.atlas,d=u.tex1,h=u.tex2;a.canAddToCurrentBatch(c)||this.endBatch();for(var p=a.getAtlasIndexForBatch(c),f=0,g=[[d,!0],[h,!1]];f<g.length;f++){var v=Le(g[f],2),y=v[0],b=v[1];if(y.w!=0){var m=this.instanceCount;this.vertTypeBuffer.getView(m)[0]=0,zn(t,this.indexBuffer.getView(m)),this.atlasIdBuffer.getView(m)[0]=p;var w=this.texBuffer.getView(m);w[0]=y.x,w[1]=y.y,w[2]=y.w,w[3]=y.h;var k=this.transformBuffer.getMatrixView(m);this.setTransformMatrix(e,k,i,u,b),this.instanceCount++,b||this.wrappedCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}catch(E){l.e(E)}finally{l.f()}}}},{key:"setTransformMatrix",value:function(e,t,n,r){var a=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],i=0;if(n.shapeProps&&n.shapeProps.padding&&(i=e.pstyle(n.shapeProps.padding).pfValue),r){var o=r.bb,s=r.tex1,l=r.tex2,u=s.w/(s.w+l.w);a||(u=1-u);var c=this._getAdjustedBB(o,i,a,u);this._applyTransformMatrix(t,c,n,e)}else{var d=n.getBoundingBox(e),h=this._getAdjustedBB(d,i,!0,1);this._applyTransformMatrix(t,h,n,e)}}},{key:"_applyTransformMatrix",value:function(e,t,n,r){var a,i;Wc(e);var o=n.getRotation?n.getRotation(r):0;if(o!==0){var s=n.getRotationPoint(r);ha(e,e,[s.x,s.y]),Hc(e,e,o);var l=n.getRotationOffset(r);a=l.x+(t.xOffset||0),i=l.y+(t.yOffset||0)}else a=t.x1,i=t.y1;ha(e,e,[a,i]),Ki(e,e,[t.w,t.h])}},{key:"_getAdjustedBB",value:function(e,t,n,r){var a=e.x1,i=e.y1,o=e.w,s=e.h;t&&(a-=t,i-=t,o+=2*t,s+=2*t);var l=0,u=o*r;return n&&r<1?o=u:!n&&r<1&&(a+=l=o-u,o=u),{x1:a,y1:i,w:o,h:s,xOffset:l,yOffset:e.yOffset}}},{key:"drawPickingRectangle",value:function(e,t,n){var r=this.atlasManager.getRenderTypeOpts(n),a=this.instanceCount;this.vertTypeBuffer.getView(a)[0]=4,zn(t,this.indexBuffer.getView(a)),hn([0,0,0],1,this.colorBuffer.getView(a));var i=this.transformBuffer.getMatrixView(a);this.setTransformMatrix(e,i,r),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawNode",value:function(e,t,n){var r=this.simpleShapeOptions.get(n);if(this._isVisible(e,r)){var a=r.shapeProps,i=this._getVertTypeForShape(e,a.shape);if(i===void 0||r.isSimple&&!r.isSimple(e))this.drawTexture(e,t,n);else{var o=this.instanceCount;if(this.vertTypeBuffer.getView(o)[0]=i,i===5||i===6){var s=r.getBoundingBox(e),l=this._getCornerRadius(e,a.radius,s),u=this.cornerRadiusBuffer.getView(o);u[0]=l,u[1]=l,u[2]=l,u[3]=l,i===6&&(u[0]=0,u[2]=0)}zn(t,this.indexBuffer.getView(o)),hn(e.pstyle(a.color).value,e.pstyle(a.opacity).value,this.colorBuffer.getView(o));var c=this.lineWidthBuffer.getView(o);if(c[0]=0,c[1]=0,a.border){var d=e.pstyle("border-width").value;if(d>0){hn(e.pstyle("border-color").value,e.pstyle("border-opacity").value,this.borderColorBuffer.getView(o));var h=e.pstyle("border-position").value;if(h==="inside")c[0]=0,c[1]=-d;else if(h==="outside")c[0]=d,c[1]=0;else{var p=d/2;c[0]=p,c[1]=-p}}}var f=this.transformBuffer.getMatrixView(o);this.setTransformMatrix(e,f,r),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}},{key:"_getVertTypeForShape",value:function(e,t){switch(e.pstyle(t).value){case"rectangle":return 4;case"ellipse":return 7;case"roundrectangle":case"round-rectangle":return 5;case"bottom-round-rectangle":return 6;default:return}}},{key:"_getCornerRadius",value:function(e,t,n){var r=n.w,a=n.h;if(e.pstyle(t).value==="auto")return jt(r,a);var i=e.pstyle(t).pfValue,o=r/2,s=a/2;return Math.min(i,s,o)}},{key:"drawEdgeArrow",value:function(e,t,n){if(e.visible()){var r,a,i,o=e._private.rscratch;if(n==="source"?(r=o.arrowStartX,a=o.arrowStartY,i=o.srcArrowAngle):(r=o.arrowEndX,a=o.arrowEndY,i=o.tgtArrowAngle),!(isNaN(r)||r==null||isNaN(a)||a==null||isNaN(i)||i==null)&&e.pstyle(n+"-arrow-shape").value!=="none"){var s=e.pstyle(n+"-arrow-color").value,l=e.pstyle("opacity").value*e.pstyle("line-opacity").value,u=e.pstyle("width").pfValue,c=e.pstyle("arrow-scale").value,d=this.r.getArrowWidth(u,c),h=this.instanceCount,p=this.transformBuffer.getMatrixView(h);Wc(p),ha(p,p,[r,a]),Ki(p,p,[d,d]),Hc(p,p,i),this.vertTypeBuffer.getView(h)[0]=3,zn(t,this.indexBuffer.getView(h)),hn(s,l,this.colorBuffer.getView(h)),this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}},{key:"drawEdgeLine",value:function(e,t){if(e.visible()){var n=this._getEdgePoints(e);if(n){var r=e.pstyle("opacity").value,a=e.pstyle("line-opacity").value,i=e.pstyle("width").pfValue,o=e.pstyle("line-color").value,s=r*a;if(n.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),n.length==4){var l=this.instanceCount;this.vertTypeBuffer.getView(l)[0]=1,zn(t,this.indexBuffer.getView(l)),hn(o,s,this.colorBuffer.getView(l)),this.lineWidthBuffer.getView(l)[0]=i;var u=this.pointAPointBBuffer.getView(l);u[0]=n[0],u[1]=n[1],u[2]=n[2],u[3]=n[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var c=0;c<n.length-2;c+=2){var d=this.instanceCount;this.vertTypeBuffer.getView(d)[0]=2,zn(t,this.indexBuffer.getView(d)),hn(o,s,this.colorBuffer.getView(d)),this.lineWidthBuffer.getView(d)[0]=i;var h=n[c-2],p=n[c-1],f=n[c],g=n[c+1],v=n[c+2],y=n[c+3],b=n[c+4],m=n[c+5];c==0&&(h=2*f-v+.001,p=2*g-y+.001),c==n.length-4&&(b=2*v-f+.001,m=2*y-g+.001);var w=this.pointAPointBBuffer.getView(d);w[0]=h,w[1]=p,w[2]=f,w[3]=g;var k=this.pointCPointDBuffer.getView(d);k[0]=v,k[1]=y,k[2]=b,k[3]=m,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"_isValidEdge",value:function(e){var t=e._private.rscratch;return!t.badLine&&t.allpts!=null&&!isNaN(t.allpts[0])}},{key:"_getEdgePoints",value:function(e){var t=e._private.rscratch;if(this._isValidEdge(e)){var n=t.allpts;if(n.length==4)return n;var r=this._getNumSegments(e);return this._getCurveSegmentPoints(n,r)}}},{key:"_getNumSegments",value:function(e){return Math.min(Math.max(15,5),this.maxInstances)}},{key:"_getCurveSegmentPoints",value:function(e,t){if(e.length==4)return e;for(var n=Array(2*(t+1)),r=0;r<=t;r++)if(r==0)n[0]=e[0],n[1]=e[1];else if(r==t)n[2*r]=e[e.length-2],n[2*r+1]=e[e.length-1];else{var a=r/t;this._setCurvePoint(e,a,n,2*r)}return n}},{key:"_setCurvePoint",value:function(e,t,n,r){if(!(e.length<=2)){for(var a=Array(e.length-2),i=0;i<a.length;i+=2){var o=(1-t)*e[i]+t*e[i+2],s=(1-t)*e[i+1]+t*e[i+3];a[i]=o,a[i+1]=s}return this._setCurvePoint(a,t,n,r)}n[r]=e[0],n[r+1]=e[1]}},{key:"endBatch",value:function(){var e=this.gl,t=this.vao,n=this.vertexCount,r=this.instanceCount;if(r!==0){var a=this.renderTarget.picking?this.pickingProgram:this.program;e.useProgram(a),e.bindVertexArray(t);var i,o=it(this.buffers);try{for(o.s();!(i=o.n()).done;)i.value.bufferSubData(r)}catch(p){o.e(p)}finally{o.f()}for(var s,l,u=this.batchManager.getAtlases(),c=0;c<u.length;c++)u[c].bufferIfNeeded(e);for(var d=0;d<u.length;d++)e.activeTexture(e.TEXTURE0+d),e.bindTexture(e.TEXTURE_2D,u[d].texture),e.uniform1i(a.uTextures[d],d);e.uniform1f(a.uZoom,(s=this.r,l=s.pixelRatio,s.cy.zoom()*l)),e.uniformMatrix3fv(a.uPanZoomMatrix,!1,this.panZoomMatrix),e.uniform1i(a.uAtlasSize,this.batchManager.getAtlasSize());var h=hn(this.bgColor,1);e.uniform4fv(a.uBGColor,h),e.drawArraysInstanced(e.TRIANGLES,0,n,r),e.bindVertexArray(null),e.bindTexture(e.TEXTURE_2D,null),this.debug&&this.batchDebugInfo.push({count:r,atlasCount:u.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){var e=this.atlasManager.getDebugInfo(),t=e.reduce(function(a,i){return a+i.atlasCount},0),n=this.batchDebugInfo,r=n.reduce(function(a,i){return a+i.count},0);return{atlasInfo:e,totalAtlases:t,wrappedCount:this.wrappedCount,simpleCount:this.simpleCount,batchCount:n.length,batchInfo:n,totalInstances:r}}}])}(),Uc={};function Zc(e,t){var n=e._private.rscratch;return ot(n,"labelWrapCachedLines",t)||[]}Uc.initWebgl=function(e,t){var n=this,r=n.data.contexts[n.WEBGL];e.bgColor=function(c){var d=c.cy.container(),h=d&&d.style&&d.style.backgroundColor||"white";return Fo(h)}(n),e.webglTexSize=Math.min(e.webglTexSize,r.getParameter(r.MAX_TEXTURE_SIZE)),e.webglTexRows=Math.min(e.webglTexRows,54),e.webglTexRowsNodes=Math.min(e.webglTexRowsNodes,54),e.webglBatchSize=Math.min(e.webglBatchSize,16384),e.webglTexPerBatch=Math.min(e.webglTexPerBatch,r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS)),n.webglDebug=e.webglDebug,n.webglDebugShowAtlases=e.webglDebugShowAtlases,n.pickingFrameBuffer=function(c){var d=c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,d);var h=c.createTexture();return c.bindTexture(c.TEXTURE_2D,h),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,h,0),c.bindFramebuffer(c.FRAMEBUFFER,null),d.setFramebufferAttachmentSizes=function(p,f){c.bindTexture(c.TEXTURE_2D,h),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,p,f,0,c.RGBA,c.UNSIGNED_BYTE,null)},d}(r),n.pickingFrameBuffer.needsDraw=!0,n.drawing=new Dp(n,r,e);var a=function(c){return function(d){return n.getTextAngle(d,c)}},i=function(c){return function(d){var h=d.pstyle(c);return h&&h.value}},o=function(c){return function(d){return d.pstyle("".concat(c,"-opacity")).value>0}},s=function(c){return c.pstyle("text-events").strValue==="yes"?Kc:Gc},l=function(c){var d=c.position(),h=d.x,p=d.y,f=c.outerWidth(),g=c.outerHeight();return{w:f,h:g,x1:h-f/2,y1:p-g/2}};n.drawing.addAtlasCollection("node",{texRows:e.webglTexRowsNodes}),n.drawing.addAtlasCollection("label",{texRows:e.webglTexRows}),n.drawing.addTextureAtlasRenderType("node-body",{collection:"node",getKey:t.getStyleKey,getBoundingBox:t.getElementBox,drawElement:t.drawElement}),n.drawing.addSimpleShapeRenderType("node-body",{getBoundingBox:l,isSimple:Ep,shapeProps:{shape:"shape",color:"background-color",opacity:"background-opacity",radius:"corner-radius",border:!0}}),n.drawing.addSimpleShapeRenderType("node-overlay",{getBoundingBox:l,isVisible:o("overlay"),shapeProps:{shape:"overlay-shape",color:"overlay-color",opacity:"overlay-opacity",padding:"overlay-padding",radius:"overlay-corner-radius"}}),n.drawing.addSimpleShapeRenderType("node-underlay",{getBoundingBox:l,isVisible:o("underlay"),shapeProps:{shape:"underlay-shape",color:"underlay-color",opacity:"underlay-opacity",padding:"underlay-padding",radius:"underlay-corner-radius"}}),n.drawing.addTextureAtlasRenderType("label",{collection:"label",getTexPickingMode:s,getKey:Ui(t.getLabelKey,null),getBoundingBox:Zi(t.getLabelBox,null),drawClipped:!0,drawElement:t.drawLabel,getRotation:a(null),getRotationPoint:t.getLabelRotationPoint,getRotationOffset:t.getLabelRotationOffset,isVisible:i("label")}),n.drawing.addTextureAtlasRenderType("edge-source-label",{collection:"label",getTexPickingMode:s,getKey:Ui(t.getSourceLabelKey,"source"),getBoundingBox:Zi(t.getSourceLabelBox,"source"),drawClipped:!0,drawElement:t.drawSourceLabel,getRotation:a("source"),getRotationPoint:t.getSourceLabelRotationPoint,getRotationOffset:t.getSourceLabelRotationOffset,isVisible:i("source-label")}),n.drawing.addTextureAtlasRenderType("edge-target-label",{collection:"label",getTexPickingMode:s,getKey:Ui(t.getTargetLabelKey,"target"),getBoundingBox:Zi(t.getTargetLabelBox,"target"),drawClipped:!0,drawElement:t.drawTargetLabel,getRotation:a("target"),getRotationPoint:t.getTargetLabelRotationPoint,getRotationOffset:t.getTargetLabelRotationOffset,isVisible:i("target-label")});var u=Hn(function(){console.log("garbage collect flag set"),n.data.gc=!0},1e4);n.onUpdateEleCalcs(function(c,d){var h=!1;d&&d.length>0&&(h|=n.drawing.invalidate(d)),h&&u()}),function(c){var d=c.render;c.render=function(g){g=g||{};var v=c.cy;c.webgl&&(v.zoom()>lp?(function(y){var b=y.data.contexts[y.WEBGL];b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)}(c),d.call(c,g)):(function(y){var b=function(m){m.save(),m.setTransform(1,0,0,1,0,0),m.clearRect(0,0,y.canvasWidth,y.canvasHeight),m.restore()};b(y.data.contexts[y.NODE]),b(y.data.contexts[y.DRAG])}(c),Qc(c,g,pr.SCREEN)))};var h=c.matchCanvasSize;c.matchCanvasSize=function(g){h.call(c,g),c.pickingFrameBuffer.setFramebufferAttachmentSizes(c.canvasWidth,c.canvasHeight),c.pickingFrameBuffer.needsDraw=!0},c.findNearestElements=function(g,v,y,b){return function(m,w,k){var E,x,S,P=function(B,M,I){var R,_,z,V,L=Hi(B),X=L.pan,W=L.zoom,G=function(ce,te,se,de,ue){var C=de*se+te.x,N=ue*se+te.y;return[C,N=Math.round(ce.canvasHeight-N)]}(B,X,W,M,I),U=Le(G,2),Q=U[0],F=U[1],O=6;if(R=Q-O/2,_=F-O/2,V=O,(z=O)===0||V===0)return[];var Y=B.data.contexts[B.WEBGL];Y.bindFramebuffer(Y.FRAMEBUFFER,B.pickingFrameBuffer),B.pickingFrameBuffer.needsDraw&&(Y.viewport(0,0,Y.canvas.width,Y.canvas.height),Qc(B,null,pr.PICKING),B.pickingFrameBuffer.needsDraw=!1);var $=z*V,J=new Uint8Array(4*$);Y.readPixels(R,_,z,V,Y.RGBA,Y.UNSIGNED_BYTE,J),Y.bindFramebuffer(Y.FRAMEBUFFER,null);for(var ne=new Set,le=0;le<$;le++){var fe=Tp(J.slice(4*le,4*le+4))-1;fe>=0&&ne.add(fe)}return ne}(m,w,k),T=m.getCachedZSortedEles(),D=it(P);try{for(D.s();!(S=D.n()).done;){var A=T[S.value];if(!E&&A.isNode()&&(E=A),!x&&A.isEdge()&&(x=A),E&&x)break}}catch(B){D.e(B)}finally{D.f()}return[E,x].filter(Boolean)}(c,g,v)};var p=c.invalidateCachedZSortedEles;c.invalidateCachedZSortedEles=function(){p.call(c),c.pickingFrameBuffer.needsDraw=!0};var f=c.notify;c.notify=function(g,v){f.call(c,g,v),g==="viewport"||g==="bounds"?c.pickingFrameBuffer.needsDraw=!0:g==="background"&&c.drawing.invalidate(v,{type:"node-body"})}}(n)};var Ui=function(e,t){return function(n){var r=e(n),a=Zc(n,t);return a.length>1?a.map(function(i,o){return"".concat(r,"_").concat(o)}):r}},Zi=function(e,t){return function(n,r){var a=e(n);if(typeof r=="string"){var i=r.indexOf("_");if(i>0){var o=Number(r.substring(i+1)),s=Zc(n,t),l=a.h/s.length,u=l*o,c=a.y1+u;return{x1:a.x1,w:a.w,y1:c,h:l,yOffset:u}}}return a}};function $c(e,t){var n=e.canvasWidth,r=e.canvasHeight,a=Hi(e),i=a.pan,o=a.zoom;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,n,r),t.translate(i.x,i.y),t.scale(o,o)}function $i(e,t,n){var r=e.drawing;t+=1,n.isNode()?(r.drawNode(n,t,"node-underlay"),r.drawNode(n,t,"node-body"),r.drawTexture(n,t,"label"),r.drawNode(n,t,"node-overlay")):(r.drawEdgeLine(n,t),r.drawEdgeArrow(n,t,"source"),r.drawEdgeArrow(n,t,"target"),r.drawTexture(n,t,"label"),r.drawTexture(n,t,"edge-source-label"),r.drawTexture(n,t,"edge-target-label"))}function Qc(e,t,n){var r;e.webglDebug&&(r=performance.now());var a=e.drawing,i=0;if(n.screen&&e.data.canvasNeedsRedraw[e.SELECT_BOX]&&function(m,w){m.drawSelectionRectangle(w,function(k){return $c(m,k)})}(e,t),e.data.canvasNeedsRedraw[e.NODE]||n.picking){var o=e.data.contexts[e.WEBGL];n.screen?(o.clearColor(0,0,0,0),o.enable(o.BLEND),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA)):o.disable(o.BLEND),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),o.viewport(0,0,o.canvas.width,o.canvas.height);var s=function(m){var w=m.canvasWidth,k=m.canvasHeight,E=Hi(m),x=E.pan,S=E.zoom,P=Gi();ha(P,P,[x.x,x.y]),Ki(P,P,[S,S]);var T=Gi();(function(fe,ce,te){fe[0]=2/ce,fe[1]=0,fe[2]=0,fe[3]=0,fe[4]=-2/te,fe[5]=0,fe[6]=-1,fe[7]=1,fe[8]=1})(T,w,k);var D,A,B,M,I,R,_,z,V,L,X,W,G,U,Q,F,O,Y,$,J,ne,le=Gi();return D=le,B=P,M=(A=T)[0],I=A[1],R=A[2],_=A[3],z=A[4],V=A[5],L=A[6],X=A[7],W=A[8],G=B[0],U=B[1],Q=B[2],F=B[3],O=B[4],Y=B[5],$=B[6],J=B[7],ne=B[8],D[0]=G*M+U*_+Q*L,D[1]=G*I+U*z+Q*X,D[2]=G*R+U*V+Q*W,D[3]=F*M+O*_+Y*L,D[4]=F*I+O*z+Y*X,D[5]=F*R+O*V+Y*W,D[6]=$*M+J*_+ne*L,D[7]=$*I+J*z+ne*X,D[8]=$*R+J*V+ne*W,le}(e),l=e.getCachedZSortedEles();if(i=l.length,a.startFrame(s,n),n.screen){for(var u=0;u<l.nondrag.length;u++)$i(e,u,l.nondrag[u]);for(var c=0;c<l.drag.length;c++)$i(e,c,l.drag[c])}else if(n.picking)for(var d=0;d<l.length;d++)$i(e,d,l[d]);a.endFrame(),n.screen&&e.webglDebugShowAtlases&&(function(m){var w=m.data.contexts[m.NODE];w.save(),$c(m,w),w.strokeStyle="rgba(0, 0, 0, 0.3)",w.beginPath(),w.moveTo(-1e3,0),w.lineTo(1e3,0),w.stroke(),w.beginPath(),w.moveTo(0,-1e3),w.lineTo(0,1e3),w.stroke(),w.restore()}(e),function(m){var w=function(E,x,S){for(var P=E.atlasManager.getAtlasCollection(x),T=m.data.contexts[m.NODE],D=P.atlases,A=0;A<D.length;A++){var B=D[A].canvas;if(B){var M=B.width,I=B.height,R=M*A,_=B.height*S;T.save(),T.scale(.4,.4),T.drawImage(B,R,_),T.strokeStyle="black",T.rect(R,_,M,I),T.stroke(),T.restore()}}},k=0;w(m.drawing,"node",k++),w(m.drawing,"label",k++)}(e)),e.data.canvasNeedsRedraw[e.NODE]=!1,e.data.canvasNeedsRedraw[e.DRAG]=!1}if(e.webglDebug){var h=performance.now(),p=Math.ceil(h-r),f=a.getDebugInfo(),g=["".concat(i," elements"),"".concat(f.totalInstances," instances"),"".concat(f.batchCount," batches"),"".concat(f.totalAtlases," atlases"),"".concat(f.wrappedCount," wrapped textures"),"".concat(f.simpleCount," simple shapes")].join(", ");console.log("WebGL (".concat(n.name,") - frame time ").concat(p,"ms")),console.log("Totals:"),console.log("  ".concat(g)),console.log("Texture Atlases Used:");var v,y=it(f.atlasInfo);try{for(y.s();!(v=y.n()).done;){var b=v.value;console.log("  ".concat(b.type,": ").concat(b.keyCount," keys, ").concat(b.atlasCount," atlases"))}}catch(m){y.e(m)}finally{y.f()}console.log("")}e.data.gc&&(console.log("Garbage Collect!"),e.data.gc=!1,a.gc())}for(var Jc={drawPolygonPath:function(e,t,n,r,a,i){var o=r/2,s=a/2;e.beginPath&&e.beginPath(),e.moveTo(t+o*i[0],n+s*i[1]);for(var l=1;l<i.length/2;l++)e.lineTo(t+o*i[2*l],n+s*i[2*l+1]);e.closePath()},drawRoundPolygonPath:function(e,t,n,r,a,i,o){o.forEach(function(s){return Ec(e,s)}),e.closePath()},drawRoundRectanglePath:function(e,t,n,r,a,i){var o=r/2,s=a/2,l=i==="auto"?jt(r,a):Math.min(i,s,o);e.beginPath&&e.beginPath(),e.moveTo(t,n-s),e.arcTo(t+o,n-s,t+o,n,l),e.arcTo(t+o,n+s,t,n+s,l),e.arcTo(t-o,n+s,t-o,n,l),e.arcTo(t-o,n-s,t,n-s,l),e.lineTo(t,n-s),e.closePath()},drawBottomRoundRectanglePath:function(e,t,n,r,a,i){var o=r/2,s=a/2,l=i==="auto"?jt(r,a):i;e.beginPath&&e.beginPath(),e.moveTo(t,n-s),e.lineTo(t+o,n-s),e.lineTo(t+o,n),e.arcTo(t+o,n+s,t,n+s,l),e.arcTo(t-o,n+s,t-o,n,l),e.lineTo(t-o,n-s),e.lineTo(t,n-s),e.closePath()},drawCutRectanglePath:function(e,t,n,r,a,i,o){var s=r/2,l=a/2,u=o==="auto"?8:o;e.beginPath&&e.beginPath(),e.moveTo(t-s+u,n-l),e.lineTo(t+s-u,n-l),e.lineTo(t+s,n-l+u),e.lineTo(t+s,n+l-u),e.lineTo(t+s-u,n+l),e.lineTo(t-s+u,n+l),e.lineTo(t-s,n+l-u),e.lineTo(t-s,n-l+u),e.closePath()},drawBarrelPath:function(e,t,n,r,a){var i=r/2,o=a/2,s=t-i,l=t+i,u=n-o,c=n+o,d=Ra(r,a),h=d.widthOffset,p=d.heightOffset,f=d.ctrlPtOffsetPct*h;e.beginPath&&e.beginPath(),e.moveTo(s,u+p),e.lineTo(s,c-p),e.quadraticCurveTo(s+f,c,s+h,c),e.lineTo(l-h,c),e.quadraticCurveTo(l-f,c,l,c-p),e.lineTo(l,u+p),e.quadraticCurveTo(l-f,u,l-h,u),e.lineTo(s+h,u),e.quadraticCurveTo(s+f,u,s,u+p),e.closePath()}},ed=Math.sin(0),td=Math.cos(0),Qi={},Ji={},nd=Math.PI/40,On=0*Math.PI;On<2*Math.PI;On+=nd)Qi[On]=Math.sin(On),Ji[On]=Math.cos(On);Jc.drawEllipsePath=function(e,t,n,r,a){if(e.beginPath&&e.beginPath(),e.ellipse)e.ellipse(t,n,r/2,a/2,0,0,2*Math.PI);else for(var i,o,s=r/2,l=a/2,u=0*Math.PI;u<2*Math.PI;u+=nd)i=t-s*Qi[u]*ed+s*Ji[u]*td,o=n+l*Ji[u]*ed+l*Qi[u]*td,u===0?e.moveTo(i,o):e.lineTo(i,o);e.closePath()};var gr={};function rd(e){var t=e.indexOf(",");return e.substr(t+1)}function ad(e,t,n){var r=function(){return t.toDataURL(n,e.quality)};switch(e.output){case"blob-promise":return new Tn(function(a,i){try{t.toBlob(function(o){o!=null?a(o):i(new Error("`canvas.toBlob()` sent a null value in its callback"))},n,e.quality)}catch(o){i(o)}});case"blob":return function(a,i){for(var o=atob(a),s=new ArrayBuffer(o.length),l=new Uint8Array(s),u=0;u<o.length;u++)l[u]=o.charCodeAt(u);return new Blob([s],{type:i})}(rd(r()),n);case"base64":return rd(r());default:return r()}}gr.createBuffer=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,[n,n.getContext("2d")]},gr.bufferCanvasImage=function(e){var t=this.cy,n=t.mutableElements().boundingBox(),r=this.findContainerClientCoords(),a=e.full?Math.ceil(n.w):r[2],i=e.full?Math.ceil(n.h):r[3],o=oe(e.maxWidth)||oe(e.maxHeight),s=this.getPixelRatio(),l=1;if(e.scale!==void 0)a*=e.scale,i*=e.scale,l=e.scale;else if(o){var u=1/0,c=1/0;oe(e.maxWidth)&&(u=l*e.maxWidth/a),oe(e.maxHeight)&&(c=l*e.maxHeight/i),a*=l=Math.min(u,c),i*=l}o||(a*=s,i*=s,l*=s);var d=document.createElement("canvas");d.width=a,d.height=i,d.style.width=a+"px",d.style.height=i+"px";var h=d.getContext("2d");if(a>0&&i>0){h.clearRect(0,0,a,i),h.globalCompositeOperation="source-over";var p=this.getCachedZSortedEles();if(e.full)h.translate(-n.x1*l,-n.y1*l),h.scale(l,l),this.drawElements(h,p),h.scale(1/l,1/l),h.translate(n.x1*l,n.y1*l);else{var f=t.pan(),g={x:f.x*l,y:f.y*l};l*=t.zoom(),h.translate(g.x,g.y),h.scale(l,l),this.drawElements(h,p),h.scale(1/l,1/l),h.translate(-g.x,-g.y)}e.bg&&(h.globalCompositeOperation="destination-over",h.fillStyle=e.bg,h.rect(0,0,a,i),h.fill())}return d},gr.png=function(e){return ad(e,this.bufferCanvasImage(e),"image/png")},gr.jpg=function(e){return ad(e,this.bufferCanvasImage(e),"image/jpeg")};var Ap={nodeShapeImpl:function(e,t,n,r,a,i,o,s){switch(e){case"ellipse":return this.drawEllipsePath(t,n,r,a,i);case"polygon":return this.drawPolygonPath(t,n,r,a,i,o);case"round-polygon":return this.drawRoundPolygonPath(t,n,r,a,i,o,s);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(t,n,r,a,i,s);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(t,n,r,a,i,o,s);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(t,n,r,a,i,s);case"barrel":return this.drawBarrelPath(t,n,r,a,i)}}},Mp=id,me=id.prototype;function id(e){var t=this,n=t.cy.window().document;e.webgl&&(me.CANVAS_LAYERS=t.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),t.data={canvases:new Array(me.CANVAS_LAYERS),contexts:new Array(me.CANVAS_LAYERS),canvasNeedsRedraw:new Array(me.CANVAS_LAYERS),bufferCanvases:new Array(me.BUFFER_COUNT),bufferContexts:new Array(me.CANVAS_LAYERS)};var r="-webkit-tap-highlight-color",a="rgba(0,0,0,0)";t.data.canvasContainer=n.createElement("div");var i=t.data.canvasContainer.style;t.data.canvasContainer.style[r]=a,i.position="relative",i.zIndex="0",i.overflow="hidden";var o=e.cy.container();o.appendChild(t.data.canvasContainer),o.style[r]=a;var s={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};oo&&oo.userAgent.match(/msie|trident|edge/i)&&(s["-ms-touch-action"]="none",s["touch-action"]="none");for(var l=0;l<me.CANVAS_LAYERS;l++){var u=t.data.canvases[l]=n.createElement("canvas"),c=me.CANVAS_TYPES[l];t.data.contexts[l]=u.getContext(c),t.data.contexts[l]||Me("Could not create canvas of type "+c),Object.keys(s).forEach(function(F){u.style[F]=s[F]}),u.style.position="absolute",u.setAttribute("data-id","layer"+l),u.style.zIndex=String(me.CANVAS_LAYERS-l),t.data.canvasContainer.appendChild(u),t.data.canvasNeedsRedraw[l]=!1}for(t.data.topCanvas=t.data.canvases[0],t.data.canvases[me.NODE].setAttribute("data-id","layer"+me.NODE+"-node"),t.data.canvases[me.SELECT_BOX].setAttribute("data-id","layer"+me.SELECT_BOX+"-selectbox"),t.data.canvases[me.DRAG].setAttribute("data-id","layer"+me.DRAG+"-drag"),t.data.canvases[me.WEBGL]&&t.data.canvases[me.WEBGL].setAttribute("data-id","layer"+me.WEBGL+"-webgl"),l=0;l<me.BUFFER_COUNT;l++)t.data.bufferCanvases[l]=n.createElement("canvas"),t.data.bufferContexts[l]=t.data.bufferCanvases[l].getContext("2d"),t.data.bufferCanvases[l].style.position="absolute",t.data.bufferCanvases[l].setAttribute("data-id","buffer"+l),t.data.bufferCanvases[l].style.zIndex=String(-l-1),t.data.bufferCanvases[l].style.visibility="hidden";t.pathsEnabled=!0;var d=nt(),h=function(F){return{x:-F.w/2,y:-F.h/2}},p=function(F){return F[0]._private.nodeKey},f=function(F){return F[0]._private.labelStyleKey},g=function(F){return F[0]._private.sourceLabelStyleKey},v=function(F){return F[0]._private.targetLabelStyleKey},y=function(F,O,Y,$,J){return t.drawElement(F,O,Y,!1,!1,J)},b=function(F,O,Y,$,J){return t.drawElementText(F,O,Y,$,"main",J)},m=function(F,O,Y,$,J){return t.drawElementText(F,O,Y,$,"source",J)},w=function(F,O,Y,$,J){return t.drawElementText(F,O,Y,$,"target",J)},k=function(F){return F.boundingBox(),F[0]._private.bodyBounds},E=function(F){return F.boundingBox(),F[0]._private.labelBounds.main||d},x=function(F){return F.boundingBox(),F[0]._private.labelBounds.source||d},S=function(F){return F.boundingBox(),F[0]._private.labelBounds.target||d},P=function(F,O){return O},T=function(F){return{x:((O=k(F)).x1+O.x2)/2,y:(O.y1+O.y2)/2};var O},D=function(F,O,Y){var $=F?F+"-":"";return{x:O.x+Y.pstyle($+"text-margin-x").pfValue,y:O.y+Y.pstyle($+"text-margin-y").pfValue}},A=function(F,O,Y){var $=F[0]._private.rscratch;return{x:$[O],y:$[Y]}},B=function(F){return D("",A(F,"labelX","labelY"),F)},M=function(F){return D("source",A(F,"sourceLabelX","sourceLabelY"),F)},I=function(F){return D("target",A(F,"targetLabelX","targetLabelY"),F)},R=function(F){return h(k(F))},_=function(F){return h(x(F))},z=function(F){return h(S(F))},V=function(F){var O=E(F),Y=h(E(F));if(F.isNode()){switch(F.pstyle("text-halign").value){case"left":Y.x=-O.w-(O.leftPad||0);break;case"right":Y.x=-(O.rightPad||0)}switch(F.pstyle("text-valign").value){case"top":Y.y=-O.h-(O.topPad||0);break;case"bottom":Y.y=-(O.botPad||0)}}return Y},L=t.data.eleTxrCache=new hr(t,{getKey:p,doesEleInvalidateKey:function(F){var O=F[0]._private;return O.oldBackgroundTimestamp!==O.backgroundTimestamp},drawElement:y,getBoundingBox:k,getRotationPoint:T,getRotationOffset:R,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),X=t.data.lblTxrCache=new hr(t,{getKey:f,drawElement:b,getBoundingBox:E,getRotationPoint:B,getRotationOffset:V,isVisible:P}),W=t.data.slbTxrCache=new hr(t,{getKey:g,drawElement:m,getBoundingBox:x,getRotationPoint:M,getRotationOffset:_,isVisible:P}),G=t.data.tlbTxrCache=new hr(t,{getKey:v,drawElement:w,getBoundingBox:S,getRotationPoint:I,getRotationOffset:z,isVisible:P}),U=t.data.lyrTxrCache=new Ic(t);t.onUpdateEleCalcs(function(F,O){L.invalidateElements(O),X.invalidateElements(O),W.invalidateElements(O),G.invalidateElements(O),U.invalidateElements(O);for(var Y=0;Y<O.length;Y++){var $=O[Y]._private;$.oldBackgroundTimestamp=$.backgroundTimestamp}});var Q=function(F){for(var O=0;O<F.length;O++)U.enqueueElementRefinement(F[O].ele)};L.onDequeue(Q),X.onDequeue(Q),W.onDequeue(Q),G.onDequeue(Q),e.webgl&&t.initWebgl(e,{getStyleKey:p,getLabelKey:f,getSourceLabelKey:g,getTargetLabelKey:v,drawElement:y,drawLabel:b,drawSourceLabel:m,drawTargetLabel:w,getElementBox:k,getLabelBox:E,getSourceLabelBox:x,getTargetLabelBox:S,getElementRotationPoint:T,getElementRotationOffset:R,getLabelRotationPoint:B,getSourceLabelRotationPoint:M,getTargetLabelRotationPoint:I,getLabelRotationOffset:V,getSourceLabelRotationOffset:_,getTargetLabelRotationOffset:z})}me.CANVAS_LAYERS=3,me.SELECT_BOX=0,me.DRAG=1,me.NODE=2,me.WEBGL=3,me.CANVAS_TYPES=["2d","2d","2d","webgl2"],me.BUFFER_COUNT=3,me.TEXTURE_BUFFER=0,me.MOTIONBLUR_BUFFER_NODE=1,me.MOTIONBLUR_BUFFER_DRAG=2,me.redrawHint=function(e,t){var n=this;switch(e){case"eles":n.data.canvasNeedsRedraw[me.NODE]=t;break;case"drag":n.data.canvasNeedsRedraw[me.DRAG]=t;break;case"select":n.data.canvasNeedsRedraw[me.SELECT_BOX]=t;break;case"gc":n.data.gc=!0}};var Ip=typeof Path2D<"u";me.path2dEnabled=function(e){if(e===void 0)return this.pathsEnabled;this.pathsEnabled=!!e},me.usePaths=function(){return Ip&&this.pathsEnabled},me.setImgSmoothing=function(e,t){e.imageSmoothingEnabled!=null?e.imageSmoothingEnabled=t:(e.webkitImageSmoothingEnabled=t,e.mozImageSmoothingEnabled=t,e.msImageSmoothingEnabled=t)},me.getImgSmoothing=function(e){return e.imageSmoothingEnabled!=null?e.imageSmoothingEnabled:e.webkitImageSmoothingEnabled||e.mozImageSmoothingEnabled||e.msImageSmoothingEnabled},me.makeOffscreenCanvas=function(e,t){var n;return(typeof OffscreenCanvas>"u"?"undefined":Ye(OffscreenCanvas))!=="undefined"?n=new OffscreenCanvas(e,t):((n=this.cy.window().document.createElement("canvas")).width=e,n.height=t),n},[Lc,Ln,Qt,xp,cn,dn,at,Uc,Jc,gr,Ap].forEach(function(e){ge(me,e)});var Np=[{type:"layout",extensions:$f},{type:"renderer",extensions:[{name:"null",impl:fc},{name:"base",impl:Ac},{name:"canvas",impl:Mp}]}],od={},sd={};function ld(e,t,n){var r=n,a=function(E){ke("Can not register `"+t+"` for `"+e+"` since `"+E+"` already exists in the prototype and can not be overridden")};if(e==="core"){if(ur.prototype[t])return a(t);ur.prototype[t]=n}else if(e==="collection"){if(Ze.prototype[t])return a(t);Ze.prototype[t]=n}else if(e==="layout"){for(var i=function(E){this.options=E,n.call(this,E),xe(this._private)||(this._private={}),this._private.cy=E.cy,this._private.listeners=[],this.createEmitter()},o=i.prototype=Object.create(n.prototype),s=[],l=0;l<s.length;l++){var u=s[l];o[u]=o[u]||function(){return this}}o.start&&!o.run?o.run=function(){return this.start(),this}:!o.start&&o.run&&(o.start=function(){return this.run(),this});var c=n.prototype.stop;o.stop=function(){var E=this.options;if(E&&E.animate){var x=this.animations;if(x)for(var S=0;S<x.length;S++)x[S].stop()}return c?c.call(this):this.emit("layoutstop"),this},o.destroy||(o.destroy=function(){return this}),o.cy=function(){return this._private.cy};var d=function(E){return E._private.cy},h={addEventFields:function(E,x){x.layout=E,x.cy=d(E),x.target=E},bubble:function(){return!0},parent:function(E){return d(E)}};ge(o,{createEmitter:function(){return this._private.emitter=new Zr(h,this),this},emitter:function(){return this._private.emitter},on:function(E,x){return this.emitter().on(E,x),this},one:function(E,x){return this.emitter().one(E,x),this},once:function(E,x){return this.emitter().one(E,x),this},removeListener:function(E,x){return this.emitter().removeListener(E,x),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(E,x){return this.emitter().emit(E,x),this}}),Te.eventAliasesOn(o),r=i}else if(e==="renderer"&&t!=="null"&&t!=="base"){var p=ud("renderer","base"),f=p.prototype,g=n,v=n.prototype,y=function(){p.apply(this,arguments),g.apply(this,arguments)},b=y.prototype;for(var m in f){var w=f[m];if(v[m]!=null)return a(m);b[m]=w}for(var k in v)b[k]=v[k];f.clientFunctions.forEach(function(E){b[E]=b[E]||function(){Me("Renderer does not implement `renderer."+E+"()` on its prototype")}}),r=y}else if(e==="__proto__"||e==="constructor"||e==="prototype")return Me(e+" is an illegal type to be registered, possibly lead to prototype pollutions");return Yo({map:od,keys:[e,t],value:r})}function ud(e,t){return jo({map:od,keys:[e,t]})}function Rp(e,t,n,r,a){return Yo({map:sd,keys:[e,t,n,r],value:a})}function Lp(e,t,n,r){return jo({map:sd,keys:[e,t,n,r]})}var eo=function(){return arguments.length===2?ud.apply(null,arguments):arguments.length===3?ld.apply(null,arguments):arguments.length===4?Lp.apply(null,arguments):arguments.length===5?Rp.apply(null,arguments):void Me("Invalid extension access syntax")};ur.prototype.extension=eo,Np.forEach(function(e){e.extensions.forEach(function(t){ld(e.type,t.name,t.impl)})});var fa=function(){if(!(this instanceof fa))return new fa;this.length=0},fn=fa.prototype;fn.instanceString=function(){return"stylesheet"},fn.selector=function(e){return this[this.length++]={selector:e,properties:[]},this},fn.css=function(e,t){var n=this.length-1;if(pe(e))this[n].properties.push({name:e,value:t});else if(xe(e))for(var r=e,a=Object.keys(r),i=0;i<a.length;i++){var o=a[i],s=r[o];if(s!=null){var l=Ge.properties[o]||Ge.properties[br(o)];if(l!=null){var u=l.name,c=s;this[n].properties.push({name:u,value:c})}}}return this},fn.style=fn.css,fn.generateStyle=function(e){var t=new Ge(e);return this.appendToStyle(t)},fn.appendToStyle=function(e){for(var t=0;t<this.length;t++){var n=this[t],r=n.selector,a=n.properties;e.selector(r);for(var i=0;i<a.length;i++){var o=a[i];e.css(o.name,o.value)}}return e};var pn=function(e){return e===void 0&&(e={}),xe(e)?new ur(e):pe(e)?eo.apply(eo,arguments):void 0};pn.use=function(e){var t=Array.prototype.slice.call(arguments,1);return t.unshift(pn),e.apply(null,t),this},pn.warnings=function(e){return $o(e)},pn.version="3.33.1",pn.stylesheet=pn.Stylesheet=fa;export{pn as c};
