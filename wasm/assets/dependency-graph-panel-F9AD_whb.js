var Vr=Object.defineProperty;var Fr=(t,e,n)=>e in t?Vr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ie=(t,e,n)=>Fr(t,typeof e!="symbol"?e+"":e,n);import{s as ye,t as q}from"./chunk-DZLz74EQ.js";import{n as fn,o as pn,r as Xr}from"./react-7g8sREeT.js";import{t as Yr}from"./react-BcIddLXZ.js";import{In as Zr,Kn as Kr,O as Wr,j as yn,mt as Gr,p as Ur,ut as qr}from"./cells-Dd1FatlG.js";import{t as Qr}from"./react-dom-D6bRRS5R.js";import"./zod-BEi78Y5d.js";import{n as Ae,t as Jr}from"./jsx-runtime-DvsdsEjx.js";import"./_Uint8Array-CPNtPV0k.js";import"./isSymbol-D1Vf4s0g.js";import"./_arrayMap-DQI2GUNb.js";import"./toString-pPvo2488.js";import"./toNumber-Bjr00yqN.js";import"./toInteger-Qi6pclEF.js";import"./isArrayLikeObject-CQy5-FN4.js";import"./_getTag-C4fv2peH.js";import"./_baseIsEqual-Cdnsi4t8.js";import"./merge-DrdmtLTL.js";import"./_baseSlice-B27Cqkm6.js";import"./upperFirst-CVedXayx.js";import"./_hasUnicode-CPHpt5EV.js";import"./_arrayReduce-DDpPg0Qh.js";import"./startCase-D58-CT5H.js";import"./_baseProperty-CIKnF2iY.js";import"./now-CKgsywea.js";import"./debounce-Bzqd6azt.js";import{r as gt}from"./invariant-91cSKJcr.js";import"./Logger-BkkOJyg0.js";import"./hotkeys-CBY41Jr2.js";import"./utils-DBmmAf_K.js";import"./constants-Cv7-oioA.js";import"./config-DXGmIv9f.js";import"./dist-CLazWf1X.js";import{t as vn}from"./cn-Dr9kMPPj.js";import"./dist-D-dnh2ed.js";import"./useEventListener-g9rPKvBX.js";import{t as ea}from"./events-BGfCi1Xy.js";import{t as Xe}from"./button-Bxk0BtBn.js";import"./dist-CoL9j4yJ.js";import"./dist-Cs8TISgf.js";import{r as bn}from"./once-8ZDiGGtA.js";import"./documentation-B7z6bB-t.js";import"./createReducer-CFr1RdS2.js";import"./key-D4QiH_7H.js";import"./preload-helper-DImqtvgl.js";import"./dist-Bz53xjA5.js";import"./dist-CyqTsfyg.js";import"./dist-CjoeBoZ9.js";import"./dist-Dlusp3mb.js";import"./dist-DzUKODTF.js";import"./dist-Dm8m1boP.js";import"./stex-BrOrfhKB.js";import"./Deferred-Mppm0cvJ.js";import"./uuid-4lb_EYpq.js";import"./use-toast-D6NNsC80.js";import"./main-CfqcqCNp.js";import"./marked.esm-C_54K2ke.js";import"./connection-D2GvycR9.js";import"./dist-DvDyxv8b.js";import"./useTheme-oPMxEKRc.js";import{t as mt}from"./createLucideIcon-QLW8E4z5.js";import{n as ta,r as na}from"./cell-actions-hNx4EMmZ.js";import"./type-kF6pOJbH.js";import"./check-C5PVLNkJ.js";import{h as oa}from"./select-DKRTzlUU.js";import"./download-B4_BX7gi.js";import"./chevron-right-BDEhimQq.js";import{o as xn}from"./useCellActionButton-BAG0Vvnt.js";import"./circle-plus-CfdbDkkn.js";import"./toDate-Daj1hQSF.js";import"./circle-x-BsVcxKkV.js";import"./dropdown-menu-CJDB1PNI.js";import"./eye-off-9UMe_Y7D.js";import{t as ra}from"./ellipsis-vertical-DK--y082.js";import"./image-DTv0Ic6H.js";import"./link-CDOxp9sn.js";import{r as aa}from"./name-cell-input-DQd65hJw.js";import"./input-C1RzjWSK.js";import{t as ia}from"./settings-6ySBJQ7Y.js";import"./useDeleteCell-CJaipocw.js";import{t as sa}from"./square-function-DBJINsmk.js";import"./trash-2-3UJSaMKF.js";import{t as la}from"./workflow-DA01FBLw.js";import"./useNonce-BbWkd3B4.js";import"./badge-DJuT6BaT.js";import"./namespace-CnoeT75h.js";import{t as da}from"./tooltip-ULHbIsj9.js";import"./useLifecycle-BfeAlD80.js";import"./menu-items-Bo6Dyd_Q.js";import"./fullscreen-DTPr3iBY.js";import"./tslib.es6-dlz5WbC8.js";import"./mode-DQPKc-Hp.js";import"./alert-dialog-BO8sf-73.js";import"./dialog-CR68_CUl.js";import"./useNumberFormatter-D21brJ0f.js";import"./shim-CWt9rDBn.js";import{n as En}from"./useEvent-BOb1a9d1.js";import{n as ca}from"./useDebounce-_ztZiL0I.js";import"./ImperativeModal-BG5LTpV0.js";import"./strings-DYBy5ejj.js";import"./copy-CkZsxeON.js";import"./extends-Bwhapo2B.js";import"./objectWithoutPropertiesLoose-CDpgRi8_.js";import{n as ua,t as ha}from"./with-selector-BmLsipPw.js";import"./kbd-BQFiWIjd.js";import"./renderShortcut-C9_NT6sD.js";import{t as ga}from"./label-BEUjZsdo.js";import{i as ma,r as fa,t as pa}from"./popover-DW0D4l0O.js";import"./es-BVCqnQhJ.js";import"./esm-7XxuulnL.js";import"./add-missing-import-CfRgNApn.js";import"./icons-CLD-J5J3.js";import"./command-BZVf1cJP.js";import"./state-jvUYiWCG.js";import"./filename-B5Yo1bOu.js";import{i as wn,t as Dt}from"./cell-link-_kF38gGF.js";import{i as ya}from"./focus-Bnk25hTp.js";import"./switch-B5bMMWJn.js";import{b as va}from"./timer-m_pEB4Lb.js";import{a as It,c as jt,i as ba,l as Rt,n as Ye,o as xa,r as Ea,s as Sn,t as wa,u as ft}from"./src--EmJf_Ct.js";import"./multi-icon-Dcch0iBY.js";import"./useSplitCell-Dodncnp8.js";import{n as Sa,t as Cn}from"./common-DW3bNKWY.js";var Ca=mt("arrow-right-from-line",[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M21 12H7",key:"13ipq5"}],["path",{d:"m15 18 6-6-6-6",key:"6tx3qv"}]]),Na=mt("arrow-right-to-line",[["path",{d:"M17 12H3",key:"8awo09"}],["path",{d:"m11 18 6-6-6-6",key:"8c2y43"}],["path",{d:"M21 5v14",key:"nzette"}]]),ka=mt("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Ma=mt("rows-3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M21 9H3",key:"1338ky"}],["path",{d:"M21 15H3",key:"9uk58r"}]]);function he(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let n=0,o;n<t.length;n++)(o=he(t[n]))!==""&&(e+=(e&&" ")+o);else for(let n in t)t[n]&&(e+=(e&&" ")+n);return e}var y=ye(Yr(),1),_a=ye(ha(),1),{useDebugValue:Oa}=y.default,{useSyncExternalStoreWithSelector:Pa}=_a.default,Da=t=>t;function Nn(t,e=Da,n){let o=Pa(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return Oa(o),o}var kn=(t,e)=>{let n=ua(t),o=(i,d=e)=>Nn(n,i,d);return Object.assign(o,n),o},Ia=(t,e)=>t?kn(t,e):kn;function ue(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||!t||typeof e!="object"||!e)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(let[o,i]of t)if(!Object.is(i,e.get(o)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(let o of t)if(!e.has(o))return!1;return!0}let n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(let o of n)if(!Object.prototype.hasOwnProperty.call(e,o)||!Object.is(t[o],e[o]))return!1;return!0}var pt=t=>()=>t;function At(t,{sourceEvent:e,subject:n,target:o,identifier:i,active:d,x:r,y:l,dx:s,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:d,enumerable:!0,configurable:!0},x:{value:r,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:s,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}At.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function ja(t){return!t.ctrlKey&&!t.button}function Ra(){return this.parentNode}function Aa(t,e){return e??{x:t.x,y:t.y}}function Ba(){return navigator.maxTouchPoints||"ontouchstart"in this}function za(){var t=ja,e=Ra,n=Aa,o=Ba,i={},d=va("start","drag","end"),r=0,l,s,u,c,a=0;function g(f){f.on("mousedown.drag",h).filter(o).on("touchstart.drag",v).on("touchmove.drag",b,xa).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(f,C){if(!(c||!t.call(this,f,C))){var k=_(this,e.call(this,f,C),f,C,"mouse");k&&(ft(f.view).on("mousemove.drag",p,Sn).on("mouseup.drag",m,Sn),Ea(f.view),jt(f),u=!1,l=f.clientX,s=f.clientY,k("start",f))}}function p(f){if(It(f),!u){var C=f.clientX-l,k=f.clientY-s;u=C*C+k*k>a}i.mouse("drag",f)}function m(f){ft(f.view).on("mousemove.drag mouseup.drag",null),ba(f.view,u),It(f),i.mouse("end",f)}function v(f,C){if(t.call(this,f,C)){var k=f.changedTouches,O=e.call(this,f,C),D=k.length,P,E;for(P=0;P<D;++P)(E=_(this,O,f,C,k[P].identifier,k[P]))&&(jt(f),E("start",f,k[P]))}}function b(f){var C=f.changedTouches,k=C.length,O,D;for(O=0;O<k;++O)(D=i[C[O].identifier])&&(It(f),D("drag",f,C[O]))}function x(f){var C=f.changedTouches,k=C.length,O,D;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),O=0;O<k;++O)(D=i[C[O].identifier])&&(jt(f),D("end",f,C[O]))}function _(f,C,k,O,D,P){var E=d.copy(),w=Rt(P||k,C),M,N,S;if((S=n.call(f,new At("beforestart",{sourceEvent:k,target:g,identifier:D,active:r,x:w[0],y:w[1],dx:0,dy:0,dispatch:E}),O))!=null)return M=S.x-w[0]||0,N=S.y-w[1]||0,function R(B,L,V){var j=w,T;switch(B){case"start":i[D]=R,T=r++;break;case"end":delete i[D],--r;case"drag":w=Rt(V||L,C),T=r;break}E.call(B,f,new At(B,{sourceEvent:L,subject:S,target:g,identifier:D,active:T,x:w[0]+M,y:w[1]+N,dx:w[0]-j[0],dy:w[1]-j[1],dispatch:E}),O)}}return g.filter=function(f){return arguments.length?(t=typeof f=="function"?f:pt(!!f),g):t},g.container=function(f){return arguments.length?(e=typeof f=="function"?f:pt(f),g):e},g.subject=function(f){return arguments.length?(n=typeof f=="function"?f:pt(f),g):n},g.touchable=function(f){return arguments.length?(o=typeof f=="function"?f:pt(!!f),g):o},g.on=function(){var f=d.on.apply(d,arguments);return f===d?g:f},g.clickDistance=function(f){return arguments.length?(a=(f=+f)*f,g):Math.sqrt(a)},g}Qr();var yt=(0,y.createContext)(null),La=yt.Provider,Ee={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,e)=>`Couldn't create edge for ${t?"target":"source"} handle id: "${t?e.targetHandle:e.sourceHandle}", edge id: ${e.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Mn=Ee.error001();function ne(t,e){let n=(0,y.useContext)(yt);if(n===null)throw Error(Mn);return Nn(n,t,e)}var le=()=>{let t=(0,y.useContext)(yt);if(t===null)throw Error(Mn);return(0,y.useMemo)(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe,destroy:t.destroy}),[t])},$a=t=>t.userSelectionActive?"none":"all";function vt({position:t,children:e,className:n,style:o,...i}){let d=ne($a),r=`${t}`.split("-");return y.createElement("div",{className:he(["react-flow__panel",n,...r]),style:{...o,pointerEvents:d},...i},e)}function Ta({proOptions:t,position:e="bottom-right"}){return t!=null&&t.hideAttribution?null:y.createElement(vt,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},y.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}var Ha=(0,y.memo)(({x:t,y:e,label:n,labelStyle:o={},labelShowBg:i=!0,labelBgStyle:d={},labelBgPadding:r=[2,4],labelBgBorderRadius:l=2,children:s,className:u,...c})=>{let a=(0,y.useRef)(null),[g,h]=(0,y.useState)({x:0,y:0,width:0,height:0}),p=he(["react-flow__edge-textwrapper",u]);return(0,y.useEffect)(()=>{if(a.current){let m=a.current.getBBox();h({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),n===void 0||!n?null:y.createElement("g",{transform:`translate(${t-g.width/2} ${e-g.height/2})`,className:p,visibility:g.width?"visible":"hidden",...c},i&&y.createElement("rect",{width:g.width+2*r[0],x:-r[0],y:-r[1],height:g.height+2*r[1],className:"react-flow__edge-textbg",style:d,rx:l,ry:l}),y.createElement("text",{className:"react-flow__edge-text",y:g.height/2,dy:"0.3em",ref:a,style:o},n),s)}),Bt=t=>({width:t.offsetWidth,height:t.offsetHeight}),Ze=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),zt=(t={x:0,y:0},e)=>({x:Ze(t.x,e[0][0],e[1][0]),y:Ze(t.y,e[0][1],e[1][1])}),_n=(t,e,n)=>t<e?Ze(Math.abs(t-e),1,50)/50:t>n?-Ze(Math.abs(t-n),1,50)/50:0,On=(t,e)=>{let n=_n(t.x,35,e.width-35)*20,o=_n(t.y,35,e.height-35)*20;return[n,o]},Pn=t=>{var e;return((e=t.getRootNode)==null?void 0:e.call(t))||(window==null?void 0:window.document)},Va=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),Lt=({x:t,y:e,width:n,height:o})=>({x:t,y:e,x2:t+n,y2:e+o}),Fa=({x:t,y:e,x2:n,y2:o})=>({x:t,y:e,width:n-t,height:o-e}),Dn=t=>({...t.positionAbsolute||{x:0,y:0},width:t.width||0,height:t.height||0}),$t=(t,e)=>{let n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),o=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*o)},Xa=t=>pe(t.width)&&pe(t.height)&&pe(t.x)&&pe(t.y),pe=t=>!isNaN(t)&&isFinite(t),re=Symbol.for("internals"),In=["Enter"," ","Escape"],Ya=(t,e)=>{},Za=t=>"nativeEvent"in t;function Tt(t){var n,o,i;let e=((i=(o=(n=Za(t)?t.nativeEvent:t).composedPath)==null?void 0:o.call(n))==null?void 0:i[0])||t.target;return["INPUT","SELECT","TEXTAREA"].includes(e==null?void 0:e.nodeName)||(e==null?void 0:e.hasAttribute("contenteditable"))||!!(e!=null&&e.closest(".nokey"))}var jn=t=>"clientX"in t,Ce=(t,e)=>{var d,r;let n=jn(t),o=n?t.clientX:(d=t.touches)==null?void 0:d[0].clientX,i=n?t.clientY:(r=t.touches)==null?void 0:r[0].clientY;return{x:o-((e==null?void 0:e.left)??0),y:i-((e==null?void 0:e.top)??0)}},bt=()=>{var t;return typeof navigator<"u"&&((t=navigator==null?void 0:navigator.userAgent)==null?void 0:t.indexOf("Mac"))>=0},at=({id:t,path:e,labelX:n,labelY:o,label:i,labelStyle:d,labelShowBg:r,labelBgStyle:l,labelBgPadding:s,labelBgBorderRadius:u,style:c,markerEnd:a,markerStart:g,interactionWidth:h=20})=>y.createElement(y.Fragment,null,y.createElement("path",{id:t,style:c,d:e,fill:"none",className:"react-flow__edge-path",markerEnd:a,markerStart:g}),h&&y.createElement("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),i&&pe(n)&&pe(o)?y.createElement(Ha,{x:n,y:o,label:i,labelStyle:d,labelShowBg:r,labelBgStyle:l,labelBgPadding:s,labelBgBorderRadius:u}):null);at.displayName="BaseEdge";function it(t,e,n){return n===void 0?n:o=>{let i=e().edges.find(d=>d.id===t);i&&n(o,{...i})}}function Rn({sourceX:t,sourceY:e,targetX:n,targetY:o}){let i=Math.abs(n-t)/2,d=n<t?n+i:n-i,r=Math.abs(o-e)/2,l=o<e?o+r:o-r;return[d,l,i,r]}function An({sourceX:t,sourceY:e,targetX:n,targetY:o,sourceControlX:i,sourceControlY:d,targetControlX:r,targetControlY:l}){let s=t*.125+i*.375+r*.375+n*.125,u=e*.125+d*.375+l*.375+o*.125,c=Math.abs(s-t),a=Math.abs(u-e);return[s,u,c,a]}var Ke;(function(t){t.Strict="strict",t.Loose="loose"})(Ke||(Ke={}));var Be;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(Be||(Be={}));var xt;(function(t){t.Partial="partial",t.Full="full"})(xt||(xt={}));var ze;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(ze||(ze={}));var st;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(st||(st={}));var Y;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(Y||(Y={}));function Bn({pos:t,x1:e,y1:n,x2:o,y2:i}){return t===Y.Left||t===Y.Right?[.5*(e+o),n]:[e,.5*(n+i)]}function zn({sourceX:t,sourceY:e,sourcePosition:n=Y.Bottom,targetX:o,targetY:i,targetPosition:d=Y.Top}){let[r,l]=Bn({pos:n,x1:t,y1:e,x2:o,y2:i}),[s,u]=Bn({pos:d,x1:o,y1:i,x2:t,y2:e}),[c,a,g,h]=An({sourceX:t,sourceY:e,targetX:o,targetY:i,sourceControlX:r,sourceControlY:l,targetControlX:s,targetControlY:u});return[`M${t},${e} C${r},${l} ${s},${u} ${o},${i}`,c,a,g,h]}var Ht=(0,y.memo)(({sourceX:t,sourceY:e,targetX:n,targetY:o,sourcePosition:i=Y.Bottom,targetPosition:d=Y.Top,label:r,labelStyle:l,labelShowBg:s,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:a,style:g,markerEnd:h,markerStart:p,interactionWidth:m})=>{let[v,b,x]=zn({sourceX:t,sourceY:e,sourcePosition:i,targetX:n,targetY:o,targetPosition:d});return y.createElement(at,{path:v,labelX:b,labelY:x,label:r,labelStyle:l,labelShowBg:s,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:a,style:g,markerEnd:h,markerStart:p,interactionWidth:m})});Ht.displayName="SimpleBezierEdge";var Ln={[Y.Left]:{x:-1,y:0},[Y.Right]:{x:1,y:0},[Y.Top]:{x:0,y:-1},[Y.Bottom]:{x:0,y:1}},Ka=({source:t,sourcePosition:e=Y.Bottom,target:n})=>e===Y.Left||e===Y.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},$n=(t,e)=>Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2);function Wa({source:t,sourcePosition:e=Y.Bottom,target:n,targetPosition:o=Y.Top,center:i,offset:d}){let r=Ln[e],l=Ln[o],s={x:t.x+r.x*d,y:t.y+r.y*d},u={x:n.x+l.x*d,y:n.y+l.y*d},c=Ka({source:s,sourcePosition:e,target:u}),a=c.x===0?"y":"x",g=c[a],h=[],p,m,v={x:0,y:0},b={x:0,y:0},[x,_,f,C]=Rn({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(r[a]*l[a]===-1){p=i.x??x,m=i.y??_;let k=[{x:p,y:s.y},{x:p,y:u.y}],O=[{x:s.x,y:m},{x:u.x,y:m}];h=r[a]===g?a==="x"?k:O:a==="x"?O:k}else{let k=[{x:s.x,y:u.y}],O=[{x:u.x,y:s.y}];if(h=a==="x"?r.x===g?O:k:r.y===g?k:O,e===o){let M=Math.abs(t[a]-n[a]);if(M<=d){let N=Math.min(d-1,d-M);r[a]===g?v[a]=(s[a]>t[a]?-1:1)*N:b[a]=(u[a]>n[a]?-1:1)*N}}if(e!==o){let M=a==="x"?"y":"x",N=r[a]===l[M],S=s[M]>u[M],R=s[M]<u[M];(r[a]===1&&(!N&&S||N&&R)||r[a]!==1&&(!N&&R||N&&S))&&(h=a==="x"?k:O)}let D={x:s.x+v.x,y:s.y+v.y},P={x:u.x+b.x,y:u.y+b.y},E=Math.max(Math.abs(D.x-h[0].x),Math.abs(P.x-h[0].x)),w=Math.max(Math.abs(D.y-h[0].y),Math.abs(P.y-h[0].y));E>=w?(p=(D.x+P.x)/2,m=h[0].y):(p=h[0].x,m=(D.y+P.y)/2)}return[[t,{x:s.x+v.x,y:s.y+v.y},...h,{x:u.x+b.x,y:u.y+b.y},n],p,m,f,C]}function Ga(t,e,n,o){let i=Math.min($n(t,e)/2,$n(e,n)/2,o),{x:d,y:r}=e;if(t.x===d&&d===n.x||t.y===r&&r===n.y)return`L${d} ${r}`;if(t.y===r){let u=t.x<n.x?-1:1,c=t.y<n.y?1:-1;return`L ${d+i*u},${r}Q ${d},${r} ${d},${r+i*c}`}let l=t.x<n.x?1:-1,s=t.y<n.y?-1:1;return`L ${d},${r+i*s}Q ${d},${r} ${d+i*l},${r}`}function Vt({sourceX:t,sourceY:e,sourcePosition:n=Y.Bottom,targetX:o,targetY:i,targetPosition:d=Y.Top,borderRadius:r=5,centerX:l,centerY:s,offset:u=20}){let[c,a,g,h,p]=Wa({source:{x:t,y:e},sourcePosition:n,target:{x:o,y:i},targetPosition:d,center:{x:l,y:s},offset:u});return[c.reduce((m,v,b)=>{let x="";return x=b>0&&b<c.length-1?Ga(c[b-1],v,c[b+1],r):`${b===0?"M":"L"}${v.x} ${v.y}`,m+=x,m},""),a,g,h,p]}var Et=(0,y.memo)(({sourceX:t,sourceY:e,targetX:n,targetY:o,label:i,labelStyle:d,labelShowBg:r,labelBgStyle:l,labelBgPadding:s,labelBgBorderRadius:u,style:c,sourcePosition:a=Y.Bottom,targetPosition:g=Y.Top,markerEnd:h,markerStart:p,pathOptions:m,interactionWidth:v})=>{let[b,x,_]=Vt({sourceX:t,sourceY:e,sourcePosition:a,targetX:n,targetY:o,targetPosition:g,borderRadius:m==null?void 0:m.borderRadius,offset:m==null?void 0:m.offset});return y.createElement(at,{path:b,labelX:x,labelY:_,label:i,labelStyle:d,labelShowBg:r,labelBgStyle:l,labelBgPadding:s,labelBgBorderRadius:u,style:c,markerEnd:h,markerStart:p,interactionWidth:v})});Et.displayName="SmoothStepEdge";var Ft=(0,y.memo)(t=>{var e;return y.createElement(Et,{...t,pathOptions:(0,y.useMemo)(()=>{var n;return{borderRadius:0,offset:(n=t.pathOptions)==null?void 0:n.offset}},[(e=t.pathOptions)==null?void 0:e.offset])})});Ft.displayName="StepEdge";function Ua({sourceX:t,sourceY:e,targetX:n,targetY:o}){let[i,d,r,l]=Rn({sourceX:t,sourceY:e,targetX:n,targetY:o});return[`M ${t},${e}L ${n},${o}`,i,d,r,l]}var Xt=(0,y.memo)(({sourceX:t,sourceY:e,targetX:n,targetY:o,label:i,labelStyle:d,labelShowBg:r,labelBgStyle:l,labelBgPadding:s,labelBgBorderRadius:u,style:c,markerEnd:a,markerStart:g,interactionWidth:h})=>{let[p,m,v]=Ua({sourceX:t,sourceY:e,targetX:n,targetY:o});return y.createElement(at,{path:p,labelX:m,labelY:v,label:i,labelStyle:d,labelShowBg:r,labelBgStyle:l,labelBgPadding:s,labelBgBorderRadius:u,style:c,markerEnd:a,markerStart:g,interactionWidth:h})});Xt.displayName="StraightEdge";function wt(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function Tn({pos:t,x1:e,y1:n,x2:o,y2:i,c:d}){switch(t){case Y.Left:return[e-wt(e-o,d),n];case Y.Right:return[e+wt(o-e,d),n];case Y.Top:return[e,n-wt(n-i,d)];case Y.Bottom:return[e,n+wt(i-n,d)]}}function Hn({sourceX:t,sourceY:e,sourcePosition:n=Y.Bottom,targetX:o,targetY:i,targetPosition:d=Y.Top,curvature:r=.25}){let[l,s]=Tn({pos:n,x1:t,y1:e,x2:o,y2:i,c:r}),[u,c]=Tn({pos:d,x1:o,y1:i,x2:t,y2:e,c:r}),[a,g,h,p]=An({sourceX:t,sourceY:e,targetX:o,targetY:i,sourceControlX:l,sourceControlY:s,targetControlX:u,targetControlY:c});return[`M${t},${e} C${l},${s} ${u},${c} ${o},${i}`,a,g,h,p]}var St=(0,y.memo)(({sourceX:t,sourceY:e,targetX:n,targetY:o,sourcePosition:i=Y.Bottom,targetPosition:d=Y.Top,label:r,labelStyle:l,labelShowBg:s,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:a,style:g,markerEnd:h,markerStart:p,pathOptions:m,interactionWidth:v})=>{let[b,x,_]=Hn({sourceX:t,sourceY:e,sourcePosition:i,targetX:n,targetY:o,targetPosition:d,curvature:m==null?void 0:m.curvature});return y.createElement(at,{path:b,labelX:x,labelY:_,label:r,labelStyle:l,labelShowBg:s,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:a,style:g,markerEnd:h,markerStart:p,interactionWidth:v})});St.displayName="BezierEdge";var Yt=(0,y.createContext)(null),qa=Yt.Provider;Yt.Consumer;var Qa=()=>(0,y.useContext)(Yt),Ja=t=>"id"in t&&"source"in t&&"target"in t,ei=({source:t,sourceHandle:e,target:n,targetHandle:o})=>`reactflow__edge-${t}${e||""}-${n}${o||""}`,Zt=(t,e)=>t===void 0?"":typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(n=>`${n}=${t[n]}`).join("&")}`,ti=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),ni=(t,e)=>{if(!t.source||!t.target)return Ee.error006(),e;let n;return n=Ja(t)?{...t}:{...t,id:ei(t)},ti(n,e)?e:e.concat(n)},Kt=({x:t,y:e},[n,o,i],d,[r,l])=>{let s={x:(t-n)/i,y:(e-o)/i};return d?{x:r*Math.round(s.x/r),y:l*Math.round(s.y/l)}:s},Vn=({x:t,y:e},[n,o,i])=>({x:t*i+n,y:e*i+o}),We=(t,e=[0,0])=>{if(!t)return{x:0,y:0,positionAbsolute:{x:0,y:0}};let n=(t.width??0)*e[0],o=(t.height??0)*e[1],i={x:t.position.x-n,y:t.position.y-o};return{...i,positionAbsolute:t.positionAbsolute?{x:t.positionAbsolute.x-n,y:t.positionAbsolute.y-o}:i}},Wt=(t,e=[0,0])=>{if(t.length===0)return{x:0,y:0,width:0,height:0};let n=t.reduce((o,i)=>{let{x:d,y:r}=We(i,e).positionAbsolute;return Va(o,Lt({x:d,y:r,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Fa(n)},Fn=(t,e,[n,o,i]=[0,0,1],d=!1,r=!1,l=[0,0])=>{let s={x:(e.x-n)/i,y:(e.y-o)/i,width:e.width/i,height:e.height/i},u=[];return t.forEach(c=>{let{width:a,height:g,selectable:h=!0,hidden:p=!1}=c;if(r&&!h||p)return!1;let{positionAbsolute:m}=We(c,l),v={x:m.x,y:m.y,width:a||0,height:g||0},b=$t(s,v),x=a===void 0||g===void 0||a===null||g===null,_=d&&b>0,f=(a||0)*(g||0);(x||_||b>=f||c.dragging)&&u.push(c)}),u},Xn=(t,e)=>{let n=t.map(o=>o.id);return e.filter(o=>n.includes(o.source)||n.includes(o.target))},Yn=(t,e,n,o,i,d=.1)=>{let r=e/(t.width*(1+d)),l=n/(t.height*(1+d)),s=Ze(Math.min(r,l),o,i),u=t.x+t.width/2,c=t.y+t.height/2,a=e/2-u*s,g=n/2-c*s;return{x:a,y:g,zoom:s}},Le=(t,e=0)=>t.transition().duration(e);function Zn(t,e,n,o){return(e[n]||[]).reduce((i,d)=>{var r,l;return`${t.id}-${d.id}-${n}`!==o&&i.push({id:d.id||null,type:n,nodeId:t.id,x:(((r=t.positionAbsolute)==null?void 0:r.x)??0)+d.x+d.width/2,y:(((l=t.positionAbsolute)==null?void 0:l.y)??0)+d.y+d.height/2}),i},[])}function oi(t,e,n,o,i,d){let{x:r,y:l}=Ce(t),s=e.elementsFromPoint(r,l).find(h=>h.classList.contains("react-flow__handle"));if(s){let h=s.getAttribute("data-nodeid");if(h){let p=Gt(void 0,s),m=s.getAttribute("data-handleid"),v=d({nodeId:h,id:m,type:p});if(v){let b=i.find(x=>x.nodeId===h&&x.type===p&&x.id===m);return{handle:{id:m,type:p,nodeId:h,x:(b==null?void 0:b.x)||n.x,y:(b==null?void 0:b.y)||n.y},validHandleResult:v}}}}let u=[],c=1/0;if(i.forEach(h=>{let p=Math.sqrt((h.x-n.x)**2+(h.y-n.y)**2);if(p<=o){let m=d(h);p<=c&&(p<c?u=[{handle:h,validHandleResult:m}]:p===c&&u.push({handle:h,validHandleResult:m}),c=p)}}),!u.length)return{handle:null,validHandleResult:Kn()};if(u.length===1)return u[0];let a=u.some(({validHandleResult:h})=>h.isValid),g=u.some(({handle:h})=>h.type==="target");return u.find(({handle:h,validHandleResult:p})=>g?h.type==="target":a?p.isValid:!0)||u[0]}var ri={source:null,target:null,sourceHandle:null,targetHandle:null},Kn=()=>({handleDomNode:null,isValid:!1,connection:ri,endHandle:null});function Wn(t,e,n,o,i,d,r){let l=i==="target",s=r.querySelector(`.react-flow__handle[data-id="${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`),u={...Kn(),handleDomNode:s};if(s){let c=Gt(void 0,s),a=s.getAttribute("data-nodeid"),g=s.getAttribute("data-handleid"),h=s.classList.contains("connectable"),p=s.classList.contains("connectableend"),m={source:l?a:n,sourceHandle:l?g:o,target:l?n:a,targetHandle:l?o:g};u.connection=m,h&&p&&(e===Ke.Strict?l&&c==="source"||!l&&c==="target":a!==n||g!==o)&&(u.endHandle={nodeId:a,handleId:g,type:c},u.isValid=d(m))}return u}function ai({nodes:t,nodeId:e,handleId:n,handleType:o}){return t.reduce((i,d)=>{if(d[re]){let{handleBounds:r}=d[re],l=[],s=[];r&&(l=Zn(d,r,"source",`${e}-${n}-${o}`),s=Zn(d,r,"target",`${e}-${n}-${o}`)),i.push(...l,...s)}return i},[])}function Gt(t,e){return t||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function Ut(t){t==null||t.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function ii(t,e){let n=null;return e?n="valid":t&&!e&&(n="invalid"),n}function Gn({event:t,handleId:e,nodeId:n,onConnect:o,isTarget:i,getState:d,setState:r,isValidConnection:l,edgeUpdaterType:s,onReconnectEnd:u}){let c=Pn(t.target),{connectionMode:a,domNode:g,autoPanOnConnect:h,connectionRadius:p,onConnectStart:m,panBy:v,getNodes:b,cancelConnection:x}=d(),_=0,f,{x:C,y:k}=Ce(t),O=c==null?void 0:c.elementFromPoint(C,k),D=Gt(s,O),P=g==null?void 0:g.getBoundingClientRect();if(!P||!D)return;let E,w=Ce(t,P),M=!1,N=null,S=!1,R=null,B=ai({nodes:b(),nodeId:n,handleId:e,handleType:D}),L=()=>{if(!h)return;let[T,F]=On(w,P);v({x:T,y:F}),_=requestAnimationFrame(L)};r({connectionPosition:w,connectionStatus:null,connectionNodeId:n,connectionHandleId:e,connectionHandleType:D,connectionStartHandle:{nodeId:n,handleId:e,type:D},connectionEndHandle:null}),m==null||m(t,{nodeId:n,handleId:e,handleType:D});function V(T){let{transform:F}=d();w=Ce(T,P);let{handle:X,validHandleResult:Z}=oi(T,c,Kt(w,F,!1,[1,1]),p,B,U=>Wn(U,a,n,e,i?"target":"source",l,c));if(f=X,M||(M=(L(),!0)),R=Z.handleDomNode,N=Z.connection,S=Z.isValid,r({connectionPosition:f&&S?Vn({x:f.x,y:f.y},F):w,connectionStatus:ii(!!f,S),connectionEndHandle:Z.endHandle}),!f&&!S&&!R)return Ut(E);N.source!==N.target&&R&&(Ut(E),E=R,R.classList.add("connecting","react-flow__handle-connecting"),R.classList.toggle("valid",S),R.classList.toggle("react-flow__handle-valid",S))}function j(T){var F,X;(f||R)&&N&&S&&(o==null||o(N)),(X=(F=d()).onConnectEnd)==null||X.call(F,T),s&&(u==null||u(T)),Ut(E),x(),cancelAnimationFrame(_),M=!1,S=!1,N=null,R=null,c.removeEventListener("mousemove",V),c.removeEventListener("mouseup",j),c.removeEventListener("touchmove",V),c.removeEventListener("touchend",j)}c.addEventListener("mousemove",V),c.addEventListener("mouseup",j),c.addEventListener("touchmove",V),c.addEventListener("touchend",j)}var Un=()=>!0,si=t=>({connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName}),li=(t,e,n)=>o=>{let{connectionStartHandle:i,connectionEndHandle:d,connectionClickStartHandle:r}=o;return{connecting:(i==null?void 0:i.nodeId)===t&&(i==null?void 0:i.handleId)===e&&(i==null?void 0:i.type)===n||(d==null?void 0:d.nodeId)===t&&(d==null?void 0:d.handleId)===e&&(d==null?void 0:d.type)===n,clickConnecting:(r==null?void 0:r.nodeId)===t&&(r==null?void 0:r.handleId)===e&&(r==null?void 0:r.type)===n}},qn=(0,y.forwardRef)(({type:t="source",position:e=Y.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:i=!0,isConnectableEnd:d=!0,id:r,onConnect:l,children:s,className:u,onMouseDown:c,onTouchStart:a,...g},h)=>{var P,E;let p=r||null,m=t==="target",v=le(),b=Qa(),{connectOnClick:x,noPanClassName:_}=ne(si,ue),{connecting:f,clickConnecting:C}=ne(li(b,p,t),ue);b||((E=(P=v.getState()).onError)==null||E.call(P,"010",Ee.error010()));let k=w=>{let{defaultEdgeOptions:M,onConnect:N,hasDefaultEdges:S}=v.getState(),R={...M,...w};if(S){let{edges:B,setEdges:L}=v.getState();L(ni(R,B))}N==null||N(R),l==null||l(R)},O=w=>{if(!b)return;let M=jn(w);i&&(M&&w.button===0||!M)&&Gn({event:w,handleId:p,nodeId:b,onConnect:k,isTarget:m,getState:v.getState,setState:v.setState,isValidConnection:n||v.getState().isValidConnection||Un}),M?c==null||c(w):a==null||a(w)},D=w=>{let{onClickConnectStart:M,onClickConnectEnd:N,connectionClickStartHandle:S,connectionMode:R,isValidConnection:B}=v.getState();if(!b||!S&&!i)return;if(!S){M==null||M(w,{nodeId:b,handleId:p,handleType:t}),v.setState({connectionClickStartHandle:{nodeId:b,type:t,handleId:p}});return}let L=Pn(w.target),V=n||B||Un,{connection:j,isValid:T}=Wn({nodeId:b,id:p,type:t},R,S.nodeId,S.handleId||null,S.type,V,L);T&&k(j),N==null||N(w),v.setState({connectionClickStartHandle:null})};return y.createElement("div",{"data-handleid":p,"data-nodeid":b,"data-handlepos":e,"data-id":`${b}-${p}-${t}`,className:he(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",_,u,{source:!m,target:m,connectable:o,connectablestart:i,connectableend:d,connecting:C,connectionindicator:o&&(i&&!f||d&&f)}]),onMouseDown:O,onTouchStart:O,onClick:x?D:void 0,ref:h,...g},s)});qn.displayName="Handle";var Ne=(0,y.memo)(qn),Qn=({data:t,isConnectable:e,targetPosition:n=Y.Top,sourcePosition:o=Y.Bottom})=>y.createElement(y.Fragment,null,y.createElement(Ne,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label,y.createElement(Ne,{type:"source",position:o,isConnectable:e}));Qn.displayName="DefaultNode";var qt=(0,y.memo)(Qn),Jn=({data:t,isConnectable:e,sourcePosition:n=Y.Bottom})=>y.createElement(y.Fragment,null,t==null?void 0:t.label,y.createElement(Ne,{type:"source",position:n,isConnectable:e}));Jn.displayName="InputNode";var eo=(0,y.memo)(Jn),to=({data:t,isConnectable:e,targetPosition:n=Y.Top})=>y.createElement(y.Fragment,null,y.createElement(Ne,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label);to.displayName="OutputNode";var no=(0,y.memo)(to),Qt=()=>null;Qt.displayName="GroupNode";var di=t=>({selectedNodes:t.getNodes().filter(e=>e.selected),selectedEdges:t.edges.filter(e=>e.selected).map(e=>({...e}))}),Ct=t=>t.id;function ci(t,e){return ue(t.selectedNodes.map(Ct),e.selectedNodes.map(Ct))&&ue(t.selectedEdges.map(Ct),e.selectedEdges.map(Ct))}var oo=(0,y.memo)(({onSelectionChange:t})=>{let e=le(),{selectedNodes:n,selectedEdges:o}=ne(di,ci);return(0,y.useEffect)(()=>{let i={nodes:n,edges:o};t==null||t(i),e.getState().onSelectionChange.forEach(d=>d(i))},[n,o,t]),null});oo.displayName="SelectionListener";var ui=t=>!!t.onSelectionChange;function hi({onSelectionChange:t}){let e=ne(ui);return t||e?y.createElement(oo,{onSelectionChange:t}):null}var gi=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset});function Ge(t,e){(0,y.useEffect)(()=>{t!==void 0&&e(t)},[t])}function Q(t,e,n){(0,y.useEffect)(()=>{e!==void 0&&n({[t]:e})},[e])}var mi=({nodes:t,edges:e,defaultNodes:n,defaultEdges:o,onConnect:i,onConnectStart:d,onConnectEnd:r,onClickConnectStart:l,onClickConnectEnd:s,nodesDraggable:u,nodesConnectable:c,nodesFocusable:a,edgesFocusable:g,edgesUpdatable:h,elevateNodesOnSelect:p,minZoom:m,maxZoom:v,nodeExtent:b,onNodesChange:x,onEdgesChange:_,elementsSelectable:f,connectionMode:C,snapGrid:k,snapToGrid:O,translateExtent:D,connectOnClick:P,defaultEdgeOptions:E,fitView:w,fitViewOptions:M,onNodesDelete:N,onEdgesDelete:S,onNodeDrag:R,onNodeDragStart:B,onNodeDragStop:L,onSelectionDrag:V,onSelectionDragStart:j,onSelectionDragStop:T,noPanClassName:F,nodeOrigin:X,rfId:Z,autoPanOnConnect:U,autoPanOnNodeDrag:I,onError:A,connectionRadius:z,isValidConnection:H,nodeDragThreshold:K})=>{let{setNodes:G,setEdges:J,setDefaultNodesAndEdges:ae,setMinZoom:ge,setMaxZoom:oe,setTranslateExtent:ee,setNodeExtent:de,reset:te}=ne(gi,ue),W=le();return(0,y.useEffect)(()=>{let me=o==null?void 0:o.map(_e=>({..._e,...E}));return ae(n,me),()=>{te()}},[]),Q("defaultEdgeOptions",E,W.setState),Q("connectionMode",C,W.setState),Q("onConnect",i,W.setState),Q("onConnectStart",d,W.setState),Q("onConnectEnd",r,W.setState),Q("onClickConnectStart",l,W.setState),Q("onClickConnectEnd",s,W.setState),Q("nodesDraggable",u,W.setState),Q("nodesConnectable",c,W.setState),Q("nodesFocusable",a,W.setState),Q("edgesFocusable",g,W.setState),Q("edgesUpdatable",h,W.setState),Q("elementsSelectable",f,W.setState),Q("elevateNodesOnSelect",p,W.setState),Q("snapToGrid",O,W.setState),Q("snapGrid",k,W.setState),Q("onNodesChange",x,W.setState),Q("onEdgesChange",_,W.setState),Q("connectOnClick",P,W.setState),Q("fitViewOnInit",w,W.setState),Q("fitViewOnInitOptions",M,W.setState),Q("onNodesDelete",N,W.setState),Q("onEdgesDelete",S,W.setState),Q("onNodeDrag",R,W.setState),Q("onNodeDragStart",B,W.setState),Q("onNodeDragStop",L,W.setState),Q("onSelectionDrag",V,W.setState),Q("onSelectionDragStart",j,W.setState),Q("onSelectionDragStop",T,W.setState),Q("noPanClassName",F,W.setState),Q("nodeOrigin",X,W.setState),Q("rfId",Z,W.setState),Q("autoPanOnConnect",U,W.setState),Q("autoPanOnNodeDrag",I,W.setState),Q("onError",A,W.setState),Q("connectionRadius",z,W.setState),Q("isValidConnection",H,W.setState),Q("nodeDragThreshold",K,W.setState),Ge(t,G),Ge(e,J),Ge(m,ge),Ge(v,oe),Ge(D,ee),Ge(b,de),null},ro={display:"none"},fi={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ao="react-flow__node-desc",io="react-flow__edge-desc",pi="react-flow__aria-live",yi=t=>t.ariaLiveMessage;function vi({rfId:t}){let e=ne(yi);return y.createElement("div",{id:`${pi}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:fi},e)}function bi({rfId:t,disableKeyboardA11y:e}){return y.createElement(y.Fragment,null,y.createElement("div",{id:`${ao}-${t}`,style:ro},"Press enter or space to select a node.",!e&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),y.createElement("div",{id:`${io}-${t}`,style:ro},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!e&&y.createElement(vi,{rfId:t}))}var lt=(t=null,e={actInsideInputWithModifier:!0})=>{let[n,o]=(0,y.useState)(!1),i=(0,y.useRef)(!1),d=(0,y.useRef)(new Set([])),[r,l]=(0,y.useMemo)(()=>{if(t!==null){let s=(Array.isArray(t)?t:[t]).filter(c=>typeof c=="string").map(c=>c.split("+")),u=s.reduce((c,a)=>c.concat(...a),[]);return[s,u]}return[[],[]]},[t]);return(0,y.useEffect)(()=>{let s=typeof document<"u"?document:null,u=(e==null?void 0:e.target)||s;if(t!==null){let c=h=>{if(i.current=h.ctrlKey||h.metaKey||h.shiftKey,(!i.current||i.current&&!e.actInsideInputWithModifier)&&Tt(h))return!1;let p=lo(h.code,l);d.current.add(h[p]),so(r,d.current,!1)&&(h.preventDefault(),o(!0))},a=h=>{if((!i.current||i.current&&!e.actInsideInputWithModifier)&&Tt(h))return!1;let p=lo(h.code,l);so(r,d.current,!0)?(o(!1),d.current.clear()):d.current.delete(h[p]),h.key==="Meta"&&d.current.clear(),i.current=!1},g=()=>{d.current.clear(),o(!1)};return u==null||u.addEventListener("keydown",c),u==null||u.addEventListener("keyup",a),window.addEventListener("blur",g),()=>{u==null||u.removeEventListener("keydown",c),u==null||u.removeEventListener("keyup",a),window.removeEventListener("blur",g)}}},[t,o]),n};function so(t,e,n){return t.filter(o=>n||o.length===e.size).some(o=>o.every(i=>e.has(i)))}function lo(t,e){return e.includes(t)?"code":"key"}function co(t,e,n,o){var l,s;let i=t.parentNode||t.parentId;if(!i)return n;let d=e.get(i),r=We(d,o);return co(d,e,{x:(n.x??0)+r.x,y:(n.y??0)+r.y,z:(((l=d[re])==null?void 0:l.z)??0)>(n.z??0)?((s=d[re])==null?void 0:s.z)??0:n.z??0},o)}function uo(t,e,n){t.forEach(o=>{var d;let i=o.parentNode||o.parentId;if(i&&!t.has(i))throw Error(`Parent node ${i} not found`);if(i||n!=null&&n[o.id]){let{x:r,y:l,z:s}=co(o,t,{...o.position,z:((d=o[re])==null?void 0:d.z)??0},e);o.positionAbsolute={x:r,y:l},o[re].z=s,n!=null&&n[o.id]&&(o[re].isParent=!0)}})}function Jt(t,e,n,o){let i=new Map,d={},r=o?1e3:0;return t.forEach(l=>{var h;let s=(pe(l.zIndex)?l.zIndex:0)+(l.selected?r:0),u=e.get(l.id),c={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},a=l.parentNode||l.parentId;a&&(d[a]=!0);let g=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==l.type;Object.defineProperty(c,re,{enumerable:!1,value:{handleBounds:g||(h=u==null?void 0:u[re])==null?void 0:h.handleBounds,z:s}}),i.set(l.id,c)}),uo(i,n,d),i}function ho(t,e={}){let{getNodes:n,width:o,height:i,minZoom:d,maxZoom:r,d3Zoom:l,d3Selection:s,fitViewOnInitDone:u,fitViewOnInit:c,nodeOrigin:a}=t(),g=e.initial&&!u&&c;if(l&&s&&(g||!e.initial)){let h=n().filter(m=>{var b;let v=e.includeHiddenNodes?m.width&&m.height:!m.hidden;return(b=e.nodes)!=null&&b.length?v&&e.nodes.some(x=>x.id===m.id):v}),p=h.every(m=>m.width&&m.height);if(h.length>0&&p){let m=Wt(h,a),{x:v,y:b,zoom:x}=Yn(m,o,i,e.minZoom??d,e.maxZoom??r,e.padding??.1),_=Ye.translate(v,b).scale(x);return typeof e.duration=="number"&&e.duration>0?l.transform(Le(s,e.duration),_):l.transform(s,_),!0}}return!1}function xi(t,e){return t.forEach(n=>{let o=e.get(n.id);o&&e.set(o.id,{...o,[re]:o[re],selected:n.selected})}),new Map(e)}function Ei(t,e){return e.map(n=>{let o=t.find(i=>i.id===n.id);return o&&(n.selected=o.selected),n})}function Nt({changedNodes:t,changedEdges:e,get:n,set:o}){let{nodeInternals:i,edges:d,onNodesChange:r,onEdgesChange:l,hasDefaultNodes:s,hasDefaultEdges:u}=n();t!=null&&t.length&&(s&&o({nodeInternals:xi(t,i)}),r==null||r(t)),e!=null&&e.length&&(u&&o({edges:Ei(e,d)}),l==null||l(e))}var Ue=()=>{},wi={zoomIn:Ue,zoomOut:Ue,zoomTo:Ue,getZoom:()=>1,setViewport:Ue,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Ue,fitBounds:Ue,project:t=>t,screenToFlowPosition:t=>t,flowToScreenPosition:t=>t,viewportInitialized:!1},Si=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}),Ci=()=>{let t=le(),{d3Zoom:e,d3Selection:n}=ne(Si,ue);return(0,y.useMemo)(()=>n&&e?{zoomIn:o=>e.scaleBy(Le(n,o==null?void 0:o.duration),1.2),zoomOut:o=>e.scaleBy(Le(n,o==null?void 0:o.duration),1/1.2),zoomTo:(o,i)=>e.scaleTo(Le(n,i==null?void 0:i.duration),o),getZoom:()=>t.getState().transform[2],setViewport:(o,i)=>{let[d,r,l]=t.getState().transform,s=Ye.translate(o.x??d,o.y??r).scale(o.zoom??l);e.transform(Le(n,i==null?void 0:i.duration),s)},getViewport:()=>{let[o,i,d]=t.getState().transform;return{x:o,y:i,zoom:d}},fitView:o=>ho(t.getState,o),setCenter:(o,i,d)=>{let{width:r,height:l,maxZoom:s}=t.getState(),u=(d==null?void 0:d.zoom)===void 0?s:d.zoom,c=r/2-o*u,a=l/2-i*u,g=Ye.translate(c,a).scale(u);e.transform(Le(n,d==null?void 0:d.duration),g)},fitBounds:(o,i)=>{let{width:d,height:r,minZoom:l,maxZoom:s}=t.getState(),{x:u,y:c,zoom:a}=Yn(o,d,r,l,s,(i==null?void 0:i.padding)??.1),g=Ye.translate(u,c).scale(a);e.transform(Le(n,i==null?void 0:i.duration),g)},project:o=>{let{transform:i,snapToGrid:d,snapGrid:r}=t.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Kt(o,i,d,r)},screenToFlowPosition:o=>{let{transform:i,snapToGrid:d,snapGrid:r,domNode:l}=t.getState();if(!l)return o;let{x:s,y:u}=l.getBoundingClientRect(),c={x:o.x-s,y:o.y-u};return Kt(c,i,d,r)},flowToScreenPosition:o=>{let{transform:i,domNode:d}=t.getState();if(!d)return o;let{x:r,y:l}=d.getBoundingClientRect(),s=Vn(o,i);return{x:s.x+r,y:s.y+l}},viewportInitialized:!0}:wi,[e,n])};function dt(){let t=Ci(),e=le(),n=(0,y.useCallback)(()=>e.getState().getNodes().map(m=>({...m})),[]),o=(0,y.useCallback)(m=>e.getState().nodeInternals.get(m),[]),i=(0,y.useCallback)(()=>{let{edges:m=[]}=e.getState();return m.map(v=>({...v}))},[]),d=(0,y.useCallback)(m=>{let{edges:v=[]}=e.getState();return v.find(b=>b.id===m)},[]),r=(0,y.useCallback)(m=>{let{getNodes:v,setNodes:b,hasDefaultNodes:x,onNodesChange:_}=e.getState(),f=v(),C=typeof m=="function"?m(f):m;if(x)b(C);else if(_){let k=C.length===0?f.map(O=>({type:"remove",id:O.id})):C.map(O=>({item:O,type:"reset"}));_(k)}},[]),l=(0,y.useCallback)(m=>{let{edges:v=[],setEdges:b,hasDefaultEdges:x,onEdgesChange:_}=e.getState(),f=typeof m=="function"?m(v):m;if(x)b(f);else if(_){let C=f.length===0?v.map(k=>({type:"remove",id:k.id})):f.map(k=>({item:k,type:"reset"}));_(C)}},[]),s=(0,y.useCallback)(m=>{let v=Array.isArray(m)?m:[m],{getNodes:b,setNodes:x,hasDefaultNodes:_,onNodesChange:f}=e.getState();if(_){let C=[...b(),...v];x(C)}else if(f){let C=v.map(k=>({item:k,type:"add"}));f(C)}},[]),u=(0,y.useCallback)(m=>{let v=Array.isArray(m)?m:[m],{edges:b=[],setEdges:x,hasDefaultEdges:_,onEdgesChange:f}=e.getState();if(_)x([...b,...v]);else if(f){let C=v.map(k=>({item:k,type:"add"}));f(C)}},[]),c=(0,y.useCallback)(()=>{let{getNodes:m,edges:v=[],transform:b}=e.getState(),[x,_,f]=b;return{nodes:m().map(C=>({...C})),edges:v.map(C=>({...C})),viewport:{x,y:_,zoom:f}}},[]),a=(0,y.useCallback)(({nodes:m,edges:v})=>{let{nodeInternals:b,getNodes:x,edges:_,hasDefaultNodes:f,hasDefaultEdges:C,onNodesDelete:k,onEdgesDelete:O,onNodesChange:D,onEdgesChange:P}=e.getState(),E=(m||[]).map(R=>R.id),w=(v||[]).map(R=>R.id),M=x().reduce((R,B)=>{let L=B.parentNode||B.parentId,V=!E.includes(B.id)&&L&&R.find(j=>j.id===L);return(typeof B.deletable!="boolean"||B.deletable)&&(E.includes(B.id)||V)&&R.push(B),R},[]),N=_.filter(R=>typeof R.deletable=="boolean"?R.deletable:!0),S=N.filter(R=>w.includes(R.id));if(M||S){let R=Xn(M,N),B=[...S,...R],L=B.reduce((V,j)=>(V.includes(j.id)||V.push(j.id),V),[]);if((C||f)&&(C&&e.setState({edges:_.filter(V=>!L.includes(V.id))}),f&&(M.forEach(V=>{b.delete(V.id)}),e.setState({nodeInternals:new Map(b)}))),L.length>0&&(O==null||O(B),P&&P(L.map(V=>({id:V,type:"remove"})))),M.length>0&&(k==null||k(M),D)){let V=M.map(j=>({id:j.id,type:"remove"}));D(V)}}},[]),g=(0,y.useCallback)(m=>{let v=Xa(m),b=v?null:e.getState().nodeInternals.get(m.id);return!v&&!b?[null,null,v]:[v?m:Dn(b),b,v]},[]),h=(0,y.useCallback)((m,v=!0,b)=>{let[x,_,f]=g(m);return x?(b||e.getState().getNodes()).filter(C=>{if(!f&&(C.id===_.id||!C.positionAbsolute))return!1;let k=Dn(C),O=$t(k,x);return v&&O>0||O>=x.width*x.height}):[]},[]),p=(0,y.useCallback)((m,v,b=!0)=>{let[x]=g(m);if(!x)return!1;let _=$t(x,v);return b&&_>0||_>=x.width*x.height},[]);return(0,y.useMemo)(()=>({...t,getNodes:n,getNode:o,getEdges:i,getEdge:d,setNodes:r,setEdges:l,addNodes:s,addEdges:u,toObject:c,deleteElements:a,getIntersectingNodes:h,isNodeIntersecting:p}),[t,n,o,i,d,r,l,s,u,c,a,h,p])}var Ni={actInsideInputWithModifier:!1},ki=({deleteKeyCode:t,multiSelectionKeyCode:e})=>{let n=le(),{deleteElements:o}=dt(),i=lt(t,Ni),d=lt(e);(0,y.useEffect)(()=>{if(i){let{edges:r,getNodes:l}=n.getState(),s=l().filter(c=>c.selected),u=r.filter(c=>c.selected);o({nodes:s,edges:u}),n.setState({nodesSelectionActive:!1})}},[i]),(0,y.useEffect)(()=>{n.setState({multiSelectionActive:d})},[d])};function Mi(t){let e=le();(0,y.useEffect)(()=>{let n,o=()=>{var d,r;if(!t.current)return;let i=Bt(t.current);(i.height===0||i.width===0)&&((r=(d=e.getState()).onError)==null||r.call(d,"004",Ee.error004())),e.setState({width:i.width||500,height:i.height||500})};return o(),window.addEventListener("resize",o),t.current&&(n=new ResizeObserver(()=>o()),n.observe(t.current)),()=>{window.removeEventListener("resize",o),n&&t.current&&n.unobserve(t.current)}},[])}var en={position:"absolute",width:"100%",height:"100%",top:0,left:0},_i=(t,e)=>t.x!==e.x||t.y!==e.y||t.zoom!==e.k,kt=t=>({x:t.x,y:t.y,zoom:t.k}),qe=(t,e)=>t.target.closest(`.${e}`),go=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),mo=t=>{let e=t.ctrlKey&&bt()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e},Oi=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler,userSelectionActive:t.userSelectionActive}),Pi=({onMove:t,onMoveStart:e,onMoveEnd:n,onPaneContextMenu:o,zoomOnScroll:i=!0,zoomOnPinch:d=!0,panOnScroll:r=!1,panOnScrollSpeed:l=.5,panOnScrollMode:s=Be.Free,zoomOnDoubleClick:u=!0,elementsSelectable:c,panOnDrag:a=!0,defaultViewport:g,translateExtent:h,minZoom:p,maxZoom:m,zoomActivationKeyCode:v,preventScrolling:b=!0,children:x,noWheelClassName:_,noPanClassName:f})=>{let C=(0,y.useRef)(),k=le(),O=(0,y.useRef)(!1),D=(0,y.useRef)(!1),P=(0,y.useRef)(null),E=(0,y.useRef)({x:0,y:0,zoom:0}),{d3Zoom:w,d3Selection:M,d3ZoomHandler:N,userSelectionActive:S}=ne(Oi,ue),R=lt(v),B=(0,y.useRef)(0),L=(0,y.useRef)(!1),V=(0,y.useRef)();return Mi(P),(0,y.useEffect)(()=>{if(P.current){let j=P.current.getBoundingClientRect(),T=wa().scaleExtent([p,m]).translateExtent(h),F=ft(P.current).call(T),X=Ye.translate(g.x,g.y).scale(Ze(g.zoom,p,m)),Z=[[0,0],[j.width,j.height]],U=T.constrain()(X,Z,h);T.transform(F,U),T.wheelDelta(mo),k.setState({d3Zoom:T,d3Selection:F,d3ZoomHandler:F.on("wheel.zoom"),transform:[U.x,U.y,U.k],domNode:P.current.closest(".react-flow")})}},[]),(0,y.useEffect)(()=>{M&&w&&(r&&!R&&!S?M.on("wheel.zoom",j=>{if(qe(j,_))return!1;j.preventDefault(),j.stopImmediatePropagation();let T=M.property("__zoom").k||1;if(j.ctrlKey&&d){let H=Rt(j),K=mo(j),G=T*2**K;w.scaleTo(M,G,H,j);return}let F=j.deltaMode===1?20:1,X=s===Be.Vertical?0:j.deltaX*F,Z=s===Be.Horizontal?0:j.deltaY*F;!bt()&&j.shiftKey&&s!==Be.Vertical&&(X=j.deltaY*F,Z=0),w.translateBy(M,-(X/T)*l,-(Z/T)*l,{internal:!0});let U=kt(M.property("__zoom")),{onViewportChangeStart:I,onViewportChange:A,onViewportChangeEnd:z}=k.getState();clearTimeout(V.current),L.current||(L.current=!0,e==null||e(j,U),I==null||I(U)),L.current&&(t==null||t(j,U),A==null||A(U),V.current=setTimeout(()=>{n==null||n(j,U),z==null||z(U),L.current=!1},150))},{passive:!1}):N!==void 0&&M.on("wheel.zoom",function(j,T){if(!b&&j.type==="wheel"&&!j.ctrlKey||qe(j,_))return null;j.preventDefault(),N.call(this,j,T)},{passive:!1}))},[S,r,s,M,w,N,R,d,b,_,e,t,n]),(0,y.useEffect)(()=>{w&&w.on("start",j=>{var X,Z;if(!j.sourceEvent||j.sourceEvent.internal)return null;B.current=(X=j.sourceEvent)==null?void 0:X.button;let{onViewportChangeStart:T}=k.getState(),F=kt(j.transform);O.current=!0,E.current=F,((Z=j.sourceEvent)==null?void 0:Z.type)==="mousedown"&&k.setState({paneDragging:!0}),T==null||T(F),e==null||e(j.sourceEvent,F)})},[w,e]),(0,y.useEffect)(()=>{w&&(S&&!O.current?w.on("zoom",null):S||w.on("zoom",j=>{var F;let{onViewportChange:T}=k.getState();if(k.setState({transform:[j.transform.x,j.transform.y,j.transform.k]}),D.current=!!(o&&go(a,B.current??0)),(t||T)&&!((F=j.sourceEvent)!=null&&F.internal)){let X=kt(j.transform);T==null||T(X),t==null||t(j.sourceEvent,X)}}))},[S,w,t,a,o]),(0,y.useEffect)(()=>{w&&w.on("end",j=>{if(!j.sourceEvent||j.sourceEvent.internal)return null;let{onViewportChangeEnd:T}=k.getState();if(O.current=!1,k.setState({paneDragging:!1}),o&&go(a,B.current??0)&&!D.current&&o(j.sourceEvent),D.current=!1,(n||T)&&_i(E.current,j.transform)){let F=kt(j.transform);E.current=F,clearTimeout(C.current),C.current=setTimeout(()=>{T==null||T(F),n==null||n(j.sourceEvent,F)},r?150:0)}})},[w,r,a,n,o]),(0,y.useEffect)(()=>{w&&w.filter(j=>{let T=R||i,F=d&&j.ctrlKey;if((a===!0||Array.isArray(a)&&a.includes(1))&&j.button===1&&j.type==="mousedown"&&(qe(j,"react-flow__node")||qe(j,"react-flow__edge")))return!0;if(!a&&!T&&!r&&!u&&!d||S||!u&&j.type==="dblclick"||qe(j,_)&&j.type==="wheel"||qe(j,f)&&(j.type!=="wheel"||r&&j.type==="wheel"&&!R)||!d&&j.ctrlKey&&j.type==="wheel"||!T&&!r&&!F&&j.type==="wheel"||!a&&(j.type==="mousedown"||j.type==="touchstart")||Array.isArray(a)&&!a.includes(j.button)&&j.type==="mousedown")return!1;let X=Array.isArray(a)&&a.includes(j.button)||!j.button||j.button<=1;return(!j.ctrlKey||j.type==="wheel")&&X})},[S,w,i,d,r,u,a,c,R]),y.createElement("div",{className:"react-flow__renderer",ref:P,style:en},x)},Di=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function Ii(){let{userSelectionActive:t,userSelectionRect:e}=ne(Di,ue);return t&&e?y.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}function fo(t,e){let n=e.parentNode||e.parentId,o=t.find(i=>i.id===n);if(o){let i=e.position.x+e.width-o.width,d=e.position.y+e.height-o.height;if(i>0||d>0||e.position.x<0||e.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,i>0&&(o.style.width+=i),d>0&&(o.style.height+=d),e.position.x<0){let r=Math.abs(e.position.x);o.position.x=o.position.x-r,o.style.width+=r,e.position.x=0}if(e.position.y<0){let r=Math.abs(e.position.y);o.position.y=o.position.y-r,o.style.height+=r,e.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function po(t,e){if(t.some(o=>o.type==="reset"))return t.filter(o=>o.type==="reset").map(o=>o.item);let n=t.filter(o=>o.type==="add").map(o=>o.item);return e.reduce((o,i)=>{let d=t.filter(l=>l.id===i.id);if(d.length===0)return o.push(i),o;let r={...i};for(let l of d)if(l)switch(l.type){case"select":r.selected=l.selected;break;case"position":l.position!==void 0&&(r.position=l.position),l.positionAbsolute!==void 0&&(r.positionAbsolute=l.positionAbsolute),l.dragging!==void 0&&(r.dragging=l.dragging),r.expandParent&&fo(o,r);break;case"dimensions":l.dimensions!==void 0&&(r.width=l.dimensions.width,r.height=l.dimensions.height),l.updateStyle!==void 0&&(r.style={...r.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(r.resizing=l.resizing),r.expandParent&&fo(o,r);break;case"remove":return o}return o.push(r),o},n)}function yo(t,e){return po(t,e)}function ji(t,e){return po(t,e)}var ke=(t,e)=>({id:t,type:"select",selected:e});function Qe(t,e){return t.reduce((n,o)=>{let i=e.includes(o.id);return!o.selected&&i?(o.selected=!0,n.push(ke(o.id,!0))):o.selected&&!i&&(o.selected=!1,n.push(ke(o.id,!1))),n},[])}var tn=(t,e)=>n=>{n.target===e.current&&(t==null||t(n))},Ri=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,dragging:t.paneDragging}),vo=(0,y.memo)(({isSelecting:t,selectionMode:e=xt.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:i,onPaneClick:d,onPaneContextMenu:r,onPaneScroll:l,onPaneMouseEnter:s,onPaneMouseMove:u,onPaneMouseLeave:c,children:a})=>{let g=(0,y.useRef)(null),h=le(),p=(0,y.useRef)(0),m=(0,y.useRef)(0),v=(0,y.useRef)(),{userSelectionActive:b,elementsSelectable:x,dragging:_}=ne(Ri,ue),f=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),p.current=0,m.current=0},C=N=>{d==null||d(N),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},k=N=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){N.preventDefault();return}r==null||r(N)},O=l?N=>l(N):void 0,D=N=>{let{resetSelectedElements:S,domNode:R}=h.getState();if(v.current=R==null?void 0:R.getBoundingClientRect(),!x||!t||N.button!==0||N.target!==g.current||!v.current)return;let{x:B,y:L}=Ce(N,v.current);S(),h.setState({userSelectionRect:{width:0,height:0,startX:B,startY:L,x:B,y:L}}),o==null||o(N)},P=N=>{let{userSelectionRect:S,nodeInternals:R,edges:B,transform:L,onNodesChange:V,onEdgesChange:j,nodeOrigin:T,getNodes:F}=h.getState();if(!t||!v.current||!S)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});let X=Ce(N,v.current),Z=S.startX??0,U=S.startY??0,I={...S,x:X.x<Z?X.x:Z,y:X.y<U?X.y:U,width:Math.abs(X.x-Z),height:Math.abs(X.y-U)},A=F(),z=Fn(R,I,L,e===xt.Partial,!0,T),H=Xn(z,B).map(G=>G.id),K=z.map(G=>G.id);if(p.current!==K.length){p.current=K.length;let G=Qe(A,K);G.length&&(V==null||V(G))}if(m.current!==H.length){m.current=H.length;let G=Qe(B,H);G.length&&(j==null||j(G))}h.setState({userSelectionRect:I})},E=N=>{if(N.button!==0)return;let{userSelectionRect:S}=h.getState();!b&&S&&N.target===g.current&&(C==null||C(N)),h.setState({nodesSelectionActive:p.current>0}),f(),i==null||i(N)},w=N=>{b&&(h.setState({nodesSelectionActive:p.current>0}),i==null||i(N)),f()},M=x&&(t||b);return y.createElement("div",{className:he(["react-flow__pane",{dragging:_,selection:t}]),onClick:M?void 0:tn(C,g),onContextMenu:tn(k,g),onWheel:tn(O,g),onMouseEnter:M?void 0:s,onMouseDown:M?D:void 0,onMouseMove:M?P:u,onMouseUp:M?E:void 0,onMouseLeave:M?w:c,ref:g,style:en},a,y.createElement(Ii,null))});vo.displayName="Pane";function bo(t,e){let n=t.parentNode||t.parentId;if(!n)return!1;let o=e.get(n);return o?o.selected?!0:bo(o,e):!1}function xo(t,e,n){let o=t;do{if(o!=null&&o.matches(e))return!0;if(o===n.current)return!1;o=o.parentElement}while(o);return!1}function Ai(t,e,n,o){return Array.from(t.values()).filter(i=>(i.selected||i.id===o)&&(!i.parentNode||i.parentId||!bo(i,t))&&(i.draggable||e&&i.draggable===void 0)).map(i=>{var d,r;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((d=i.positionAbsolute)==null?void 0:d.x)??0),y:n.y-(((r=i.positionAbsolute)==null?void 0:r.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function Bi(t,e){return!e||e==="parent"?e:[e[0],[e[1][0]-(t.width||0),e[1][1]-(t.height||0)]]}function Eo(t,e,n,o,i=[0,0],d){let r=Bi(t,t.extent||o),l=r,s=t.parentNode||t.parentId;if(t.extent==="parent"&&!t.expandParent)if(s&&t.width&&t.height){let a=n.get(s),{x:g,y:h}=We(a,i).positionAbsolute;l=a&&pe(g)&&pe(h)&&pe(a.width)&&pe(a.height)?[[g+t.width*i[0],h+t.height*i[1]],[g+a.width-t.width+t.width*i[0],h+a.height-t.height+t.height*i[1]]]:l}else d==null||d("005",Ee.error005()),l=r;else if(t.extent&&s&&t.extent!=="parent"){let a=n.get(s),{x:g,y:h}=We(a,i).positionAbsolute;l=[[t.extent[0][0]+g,t.extent[0][1]+h],[t.extent[1][0]+g,t.extent[1][1]+h]]}let u={x:0,y:0};if(s){let a=n.get(s);u=We(a,i).positionAbsolute}let c=l&&l!=="parent"?zt(e,l):e;return{position:{x:c.x-u.x,y:c.y-u.y},positionAbsolute:c}}function nn({nodeId:t,dragItems:e,nodeInternals:n}){let o=e.map(i=>({...n.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[t?o.find(i=>i.id===t):o[0],o]}var wo=(t,e,n,o)=>{let i=e.querySelectorAll(t);if(!i||!i.length)return null;let d=Array.from(i),r=e.getBoundingClientRect(),l={x:r.width*o[0],y:r.height*o[1]};return d.map(s=>{let u=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),position:s.getAttribute("data-handlepos"),x:(u.left-r.left-l.x)/n,y:(u.top-r.top-l.y)/n,...Bt(s)}})};function ct(t,e,n){return n===void 0?n:o=>{let i=e().nodeInternals.get(t);i&&n(o,{...i})}}function on({id:t,store:e,unselect:n=!1,nodeRef:o}){let{addSelectedNodes:i,unselectNodesAndEdges:d,multiSelectionActive:r,nodeInternals:l,onError:s}=e.getState(),u=l.get(t);if(!u){s==null||s("012",Ee.error012(t));return}e.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&r)&&(d({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var c;return(c=o==null?void 0:o.current)==null?void 0:c.blur()})):i([t])}function zi(){let t=le();return(0,y.useCallback)(({sourceEvent:e})=>{let{transform:n,snapGrid:o,snapToGrid:i}=t.getState(),d=e.touches?e.touches[0].clientX:e.clientX,r=e.touches?e.touches[0].clientY:e.clientY,l={x:(d-n[0])/n[2],y:(r-n[1])/n[2]};return{xSnapped:i?o[0]*Math.round(l.x/o[0]):l.x,ySnapped:i?o[1]*Math.round(l.y/o[1]):l.y,...l}},[])}function rn(t){return(e,n,o)=>t==null?void 0:t(e,o)}function So({nodeRef:t,disabled:e=!1,noDragClassName:n,handleSelector:o,nodeId:i,isSelectable:d,selectNodesOnDrag:r}){let l=le(),[s,u]=(0,y.useState)(!1),c=(0,y.useRef)([]),a=(0,y.useRef)({x:null,y:null}),g=(0,y.useRef)(0),h=(0,y.useRef)(null),p=(0,y.useRef)({x:0,y:0}),m=(0,y.useRef)(null),v=(0,y.useRef)(!1),b=(0,y.useRef)(!1),x=(0,y.useRef)(!1),_=zi();return(0,y.useEffect)(()=>{if(t!=null&&t.current){let f=ft(t.current),C=({x:D,y:P})=>{let{nodeInternals:E,onNodeDrag:w,onSelectionDrag:M,updateNodePositions:N,nodeExtent:S,snapGrid:R,snapToGrid:B,nodeOrigin:L,onError:V}=l.getState();a.current={x:D,y:P};let j=!1,T={x:0,y:0,x2:0,y2:0};if(c.current.length>1&&S){let X=Wt(c.current,L);T=Lt(X)}if(c.current=c.current.map(X=>{let Z={x:D-X.distance.x,y:P-X.distance.y};B&&(Z.x=R[0]*Math.round(Z.x/R[0]),Z.y=R[1]*Math.round(Z.y/R[1]));let U=[[S[0][0],S[0][1]],[S[1][0],S[1][1]]];c.current.length>1&&S&&!X.extent&&(U[0][0]=X.positionAbsolute.x-T.x+S[0][0],U[1][0]=X.positionAbsolute.x+(X.width??0)-T.x2+S[1][0],U[0][1]=X.positionAbsolute.y-T.y+S[0][1],U[1][1]=X.positionAbsolute.y+(X.height??0)-T.y2+S[1][1]);let I=Eo(X,Z,E,U,L,V);return j=j||X.position.x!==I.position.x||X.position.y!==I.position.y,X.position=I.position,X.positionAbsolute=I.positionAbsolute,X}),!j)return;N(c.current,!0,!0),u(!0);let F=i?w:rn(M);if(F&&m.current){let[X,Z]=nn({nodeId:i,dragItems:c.current,nodeInternals:E});F(m.current,X,Z)}},k=()=>{if(!h.current)return;let[D,P]=On(p.current,h.current);if(D!==0||P!==0){let{transform:E,panBy:w}=l.getState();a.current.x=(a.current.x??0)-D/E[2],a.current.y=(a.current.y??0)-P/E[2],w({x:D,y:P})&&C(a.current)}g.current=requestAnimationFrame(k)},O=D=>{var L;let{nodeInternals:P,multiSelectionActive:E,nodesDraggable:w,unselectNodesAndEdges:M,onNodeDragStart:N,onSelectionDragStart:S}=l.getState();b.current=!0;let R=i?N:rn(S);(!r||!d)&&!E&&i&&((L=P.get(i))!=null&&L.selected||M()),i&&d&&r&&on({id:i,store:l,nodeRef:t});let B=_(D);if(a.current=B,c.current=Ai(P,w,B,i),R&&c.current){let[V,j]=nn({nodeId:i,dragItems:c.current,nodeInternals:P});R(D.sourceEvent,V,j)}};if(e)f.on(".drag",null);else{let D=za().on("start",P=>{let{domNode:E,nodeDragThreshold:w}=l.getState();w===0&&O(P),x.current=!1,a.current=_(P),h.current=(E==null?void 0:E.getBoundingClientRect())||null,p.current=Ce(P.sourceEvent,h.current)}).on("drag",P=>{var N,S;let E=_(P),{autoPanOnNodeDrag:w,nodeDragThreshold:M}=l.getState();if(P.sourceEvent.type==="touchmove"&&P.sourceEvent.touches.length>1&&(x.current=!0),!x.current){if(!v.current&&b.current&&w&&(v.current=!0,k()),!b.current){let R=E.xSnapped-(((N=a==null?void 0:a.current)==null?void 0:N.x)??0),B=E.ySnapped-(((S=a==null?void 0:a.current)==null?void 0:S.y)??0);Math.sqrt(R*R+B*B)>M&&O(P)}(a.current.x!==E.xSnapped||a.current.y!==E.ySnapped)&&c.current&&b.current&&(m.current=P.sourceEvent,p.current=Ce(P.sourceEvent,h.current),C(E))}}).on("end",P=>{if(!(!b.current||x.current)&&(u(!1),v.current=!1,b.current=!1,cancelAnimationFrame(g.current),c.current)){let{updateNodePositions:E,nodeInternals:w,onNodeDragStop:M,onSelectionDragStop:N}=l.getState(),S=i?M:rn(N);if(E(c.current,!1,!1),S){let[R,B]=nn({nodeId:i,dragItems:c.current,nodeInternals:w});S(P.sourceEvent,R,B)}}}).filter(P=>{let E=P.target;return!P.button&&(!n||!xo(E,`.${n}`,t))&&(!o||xo(E,o,t))});return f.call(D),()=>{f.on(".drag",null)}}}},[t,e,n,o,d,l,i,r,_]),s}function Co(){let t=le();return(0,y.useCallback)(e=>{let{nodeInternals:n,nodeExtent:o,updateNodePositions:i,getNodes:d,snapToGrid:r,snapGrid:l,onError:s,nodesDraggable:u}=t.getState(),c=d().filter(b=>b.selected&&(b.draggable||u&&b.draggable===void 0)),a=r?l[0]:5,g=r?l[1]:5,h=e.isShiftPressed?4:1,p=e.x*a*h,m=e.y*g*h,v=c.map(b=>{if(b.positionAbsolute){let x={x:b.positionAbsolute.x+p,y:b.positionAbsolute.y+m};r&&(x.x=l[0]*Math.round(x.x/l[0]),x.y=l[1]*Math.round(x.y/l[1]));let{positionAbsolute:_,position:f}=Eo(b,x,n,o,void 0,s);b.position=f,b.positionAbsolute=_}return b});i(v,!0,!1)},[])}var Je={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},ut=t=>{let e=({id:n,type:o,data:i,xPos:d,yPos:r,xPosOrigin:l,yPosOrigin:s,selected:u,onClick:c,onMouseEnter:a,onMouseMove:g,onMouseLeave:h,onContextMenu:p,onDoubleClick:m,style:v,className:b,isDraggable:x,isSelectable:_,isConnectable:f,isFocusable:C,selectNodesOnDrag:k,sourcePosition:O,targetPosition:D,hidden:P,resizeObserver:E,dragHandle:w,zIndex:M,isParent:N,noDragClassName:S,noPanClassName:R,initialized:B,disableKeyboardA11y:L,ariaLabel:V,rfId:j,hasHandleBounds:T})=>{let F=le(),X=(0,y.useRef)(null),Z=(0,y.useRef)(null),U=(0,y.useRef)(O),I=(0,y.useRef)(D),A=(0,y.useRef)(o),z=_||x||c||a||g||h,H=Co(),K=ct(n,F.getState,a),G=ct(n,F.getState,g),J=ct(n,F.getState,h),ae=ct(n,F.getState,p),ge=ct(n,F.getState,m),oe=te=>{let{nodeDragThreshold:W}=F.getState();if(_&&(!k||!x||W>0)&&on({id:n,store:F,nodeRef:X}),c){let me=F.getState().nodeInternals.get(n);me&&c(te,{...me})}},ee=te=>{if(!Tt(te)&&!L)if(In.includes(te.key)&&_){let W=te.key==="Escape";on({id:n,store:F,unselect:W,nodeRef:X})}else x&&u&&Object.prototype.hasOwnProperty.call(Je,te.key)&&(F.setState({ariaLiveMessage:`Moved selected node ${te.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~d}, y: ${~~r}`}),H({x:Je[te.key].x,y:Je[te.key].y,isShiftPressed:te.shiftKey}))};(0,y.useEffect)(()=>()=>{Z.current&&(Z.current=(E==null||E.unobserve(Z.current),null))},[]),(0,y.useEffect)(()=>{if(X.current&&!P){let te=X.current;(!B||!T||Z.current!==te)&&(Z.current&&(E==null||E.unobserve(Z.current)),E==null||E.observe(te),Z.current=te)}},[P,B,T]),(0,y.useEffect)(()=>{let te=A.current!==o,W=U.current!==O,me=I.current!==D;X.current&&(te||W||me)&&(te&&(A.current=o),W&&(U.current=O),me&&(I.current=D),F.getState().updateNodeDimensions([{id:n,nodeElement:X.current,forceUpdate:!0}]))},[n,o,O,D]);let de=So({nodeRef:X,disabled:P||!x,noDragClassName:S,handleSelector:w,nodeId:n,isSelectable:_,selectNodesOnDrag:k});return P?null:y.createElement("div",{className:he(["react-flow__node",`react-flow__node-${o}`,{[R]:x},b,{selected:u,selectable:_,parent:N,dragging:de}]),ref:X,style:{zIndex:M,transform:`translate(${l}px,${s}px)`,pointerEvents:z?"all":"none",visibility:B?"visible":"hidden",...v},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:K,onMouseMove:G,onMouseLeave:J,onContextMenu:ae,onClick:oe,onDoubleClick:ge,onKeyDown:C?ee:void 0,tabIndex:C?0:void 0,role:C?"button":void 0,"aria-describedby":L?void 0:`${ao}-${j}`,"aria-label":V},y.createElement(qa,{value:n},y.createElement(t,{id:n,data:i,type:o,xPos:d,yPos:r,selected:u,isConnectable:f,sourcePosition:O,targetPosition:D,dragging:de,dragHandle:w,zIndex:M})))};return e.displayName="NodeWrapper",(0,y.memo)(e)},Li=t=>{let e=t.getNodes().filter(n=>n.selected);return{...Wt(e,t.nodeOrigin),transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`,userSelectionActive:t.userSelectionActive}};function $i({onSelectionContextMenu:t,noPanClassName:e,disableKeyboardA11y:n}){let o=le(),{width:i,height:d,x:r,y:l,transformString:s,userSelectionActive:u}=ne(Li,ue),c=Co(),a=(0,y.useRef)(null);if((0,y.useEffect)(()=>{var h;n||((h=a.current)==null||h.focus({preventScroll:!0}))},[n]),So({nodeRef:a}),u||!i||!d)return null;let g=t?h=>{let p=o.getState().getNodes().filter(m=>m.selected);t(h,p)}:void 0;return y.createElement("div",{className:he(["react-flow__nodesselection","react-flow__container",e]),style:{transform:s}},y.createElement("div",{ref:a,className:"react-flow__nodesselection-rect",onContextMenu:g,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h=>{Object.prototype.hasOwnProperty.call(Je,h.key)&&c({x:Je[h.key].x,y:Je[h.key].y,isShiftPressed:h.shiftKey})},style:{width:i,height:d,top:l,left:r}}))}var Ti=(0,y.memo)($i),Hi=t=>t.nodesSelectionActive,No=({children:t,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:i,onPaneContextMenu:d,onPaneScroll:r,deleteKeyCode:l,onMove:s,onMoveStart:u,onMoveEnd:c,selectionKeyCode:a,selectionOnDrag:g,selectionMode:h,onSelectionStart:p,onSelectionEnd:m,multiSelectionKeyCode:v,panActivationKeyCode:b,zoomActivationKeyCode:x,elementsSelectable:_,zoomOnScroll:f,zoomOnPinch:C,panOnScroll:k,panOnScrollSpeed:O,panOnScrollMode:D,zoomOnDoubleClick:P,panOnDrag:E,defaultViewport:w,translateExtent:M,minZoom:N,maxZoom:S,preventScrolling:R,onSelectionContextMenu:B,noWheelClassName:L,noPanClassName:V,disableKeyboardA11y:j})=>{let T=ne(Hi),F=lt(a),X=lt(b),Z=X||E,U=X||k,I=F||g&&Z!==!0;return ki({deleteKeyCode:l,multiSelectionKeyCode:v}),y.createElement(Pi,{onMove:s,onMoveStart:u,onMoveEnd:c,onPaneContextMenu:d,elementsSelectable:_,zoomOnScroll:f,zoomOnPinch:C,panOnScroll:U,panOnScrollSpeed:O,panOnScrollMode:D,zoomOnDoubleClick:P,panOnDrag:!F&&Z,defaultViewport:w,translateExtent:M,minZoom:N,maxZoom:S,zoomActivationKeyCode:x,preventScrolling:R,noWheelClassName:L,noPanClassName:V},y.createElement(vo,{onSelectionStart:p,onSelectionEnd:m,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:i,onPaneContextMenu:d,onPaneScroll:r,panOnDrag:Z,isSelecting:!!I,selectionMode:h},t,T&&y.createElement(Ti,{onSelectionContextMenu:B,noPanClassName:V,disableKeyboardA11y:j})))};No.displayName="FlowRenderer";var Vi=(0,y.memo)(No);function Fi(t){return ne((0,y.useCallback)(e=>t?Fn(e.nodeInternals,{x:0,y:0,width:e.width,height:e.height},e.transform,!0):e.getNodes(),[t]))}function Xi(t){let e={input:ut(t.input||eo),default:ut(t.default||qt),output:ut(t.output||no),group:ut(t.group||Qt)},n=Object.keys(t).filter(o=>!["input","default","output","group"].includes(o)).reduce((o,i)=>(o[i]=ut(t[i]||qt),o),{});return{...e,...n}}var Yi=({x:t,y:e,width:n,height:o,origin:i})=>!n||!o||i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:t,y:e}:{x:t-n*i[0],y:e-o*i[1]},Zi=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions,onError:t.onError}),ko=t=>{let{nodesDraggable:e,nodesConnectable:n,nodesFocusable:o,elementsSelectable:i,updateNodeDimensions:d,onError:r}=ne(Zi,ue),l=Fi(t.onlyRenderVisibleElements),s=(0,y.useRef)(),u=(0,y.useMemo)(()=>{if(typeof ResizeObserver>"u")return null;let c=new ResizeObserver(a=>{let g=a.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));d(g)});return s.current=c,c},[]);return(0,y.useEffect)(()=>()=>{var c;(c=s==null?void 0:s.current)==null||c.disconnect()},[]),y.createElement("div",{className:"react-flow__nodes",style:en},l.map(c=>{var C,k,O;let a=c.type||"default";t.nodeTypes[a]||(r==null||r("003",Ee.error003(a)),a="default");let g=t.nodeTypes[a]||t.nodeTypes.default,h=!!(c.draggable||e&&c.draggable===void 0),p=!!(c.selectable||i&&c.selectable===void 0),m=!!(c.connectable||n&&c.connectable===void 0),v=!!(c.focusable||o&&c.focusable===void 0),b=t.nodeExtent?zt(c.positionAbsolute,t.nodeExtent):c.positionAbsolute,x=(b==null?void 0:b.x)??0,_=(b==null?void 0:b.y)??0,f=Yi({x,y:_,width:c.width??0,height:c.height??0,origin:t.nodeOrigin});return y.createElement(g,{key:c.id,id:c.id,className:c.className,style:c.style,type:a,data:c.data,sourcePosition:c.sourcePosition||Y.Bottom,targetPosition:c.targetPosition||Y.Top,hidden:c.hidden,xPos:x,yPos:_,xPosOrigin:f.x,yPosOrigin:f.y,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!c.selected,isDraggable:h,isSelectable:p,isConnectable:m,isFocusable:v,resizeObserver:u,dragHandle:c.dragHandle,zIndex:((C=c[re])==null?void 0:C.z)??0,isParent:!!((k=c[re])!=null&&k.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!c.width&&!!c.height,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,ariaLabel:c.ariaLabel,hasHandleBounds:!!((O=c[re])!=null&&O.handleBounds)})}))};ko.displayName="NodeRenderer";var Ki=(0,y.memo)(ko),Wi=(t,e,n)=>n===Y.Left?t-e:n===Y.Right?t+e:t,Gi=(t,e,n)=>n===Y.Top?t-e:n===Y.Bottom?t+e:t,Mo="react-flow__edgeupdater",_o=({position:t,centerX:e,centerY:n,radius:o=10,onMouseDown:i,onMouseEnter:d,onMouseOut:r,type:l})=>y.createElement("circle",{onMouseDown:i,onMouseEnter:d,onMouseOut:r,className:he([Mo,`${Mo}-${l}`]),cx:Wi(e,o,t),cy:Gi(n,o,t),r:o,stroke:"transparent",fill:"transparent"}),Ui=()=>!0,et=t=>{let e=({id:n,className:o,type:i,data:d,onClick:r,onEdgeDoubleClick:l,selected:s,animated:u,label:c,labelStyle:a,labelShowBg:g,labelBgStyle:h,labelBgPadding:p,labelBgBorderRadius:m,style:v,source:b,target:x,sourceX:_,sourceY:f,targetX:C,targetY:k,sourcePosition:O,targetPosition:D,elementsSelectable:P,hidden:E,sourceHandleId:w,targetHandleId:M,onContextMenu:N,onMouseEnter:S,onMouseMove:R,onMouseLeave:B,reconnectRadius:L,onReconnect:V,onReconnectStart:j,onReconnectEnd:T,markerEnd:F,markerStart:X,rfId:Z,ariaLabel:U,isFocusable:I,isReconnectable:A,pathOptions:z,interactionWidth:H,disableKeyboardA11y:K})=>{let G=(0,y.useRef)(null),[J,ae]=(0,y.useState)(!1),[ge,oe]=(0,y.useState)(!1),ee=le(),de=(0,y.useMemo)(()=>`url('#${Zt(X,Z)}')`,[X,Z]),te=(0,y.useMemo)(()=>`url('#${Zt(F,Z)}')`,[F,Z]);if(E)return null;let W=ce=>{var Se;let{edges:fe,addSelectedEdges:De,unselectNodesAndEdges:Ie,multiSelectionActive:je}=ee.getState(),xe=fe.find(ot=>ot.id===n);xe&&(P&&(ee.setState({nodesSelectionActive:!1}),xe.selected&&je?(Ie({nodes:[],edges:[xe]}),(Se=G.current)==null||Se.blur()):De([n])),r&&r(ce,xe))},me=it(n,ee.getState,l),_e=it(n,ee.getState,N),nt=it(n,ee.getState,S),$e=it(n,ee.getState,R),Te=it(n,ee.getState,B),we=(ce,fe)=>{if(ce.button!==0)return;let{edges:De,isValidConnection:Ie}=ee.getState(),je=fe?x:b,xe=(fe?M:w)||null,Se=fe?"target":"source",ot=Ie||Ui,Ot=fe,rt=De.find(Re=>Re.id===n);oe(!0),j==null||j(ce,rt,Se),Gn({event:ce,handleId:xe,nodeId:je,onConnect:Re=>V==null?void 0:V(rt,Re),isTarget:Ot,getState:ee.getState,setState:ee.setState,isValidConnection:ot,edgeUpdaterType:Se,onReconnectEnd:Re=>{oe(!1),T==null||T(Re,rt,Se)}})},He=ce=>we(ce,!0),Oe=ce=>we(ce,!1),Pe=()=>ae(!0),Ve=()=>ae(!1),Fe=!P&&!r;return y.createElement("g",{className:he(["react-flow__edge",`react-flow__edge-${i}`,o,{selected:s,animated:u,inactive:Fe,updating:J}]),onClick:W,onDoubleClick:me,onContextMenu:_e,onMouseEnter:nt,onMouseMove:$e,onMouseLeave:Te,onKeyDown:I?ce=>{var fe;if(!K&&In.includes(ce.key)&&P){let{unselectNodesAndEdges:De,addSelectedEdges:Ie,edges:je}=ee.getState();ce.key==="Escape"?((fe=G.current)==null||fe.blur(),De({edges:[je.find(xe=>xe.id===n)]})):Ie([n])}}:void 0,tabIndex:I?0:void 0,role:I?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":U===null?void 0:U||`Edge from ${b} to ${x}`,"aria-describedby":I?`${io}-${Z}`:void 0,ref:G},!ge&&y.createElement(t,{id:n,source:b,target:x,selected:s,animated:u,label:c,labelStyle:a,labelShowBg:g,labelBgStyle:h,labelBgPadding:p,labelBgBorderRadius:m,data:d,style:v,sourceX:_,sourceY:f,targetX:C,targetY:k,sourcePosition:O,targetPosition:D,sourceHandleId:w,targetHandleId:M,markerStart:de,markerEnd:te,pathOptions:z,interactionWidth:H}),A&&y.createElement(y.Fragment,null,(A==="source"||A===!0)&&y.createElement(_o,{position:O,centerX:_,centerY:f,radius:L,onMouseDown:He,onMouseEnter:Pe,onMouseOut:Ve,type:"source"}),(A==="target"||A===!0)&&y.createElement(_o,{position:D,centerX:C,centerY:k,radius:L,onMouseDown:Oe,onMouseEnter:Pe,onMouseOut:Ve,type:"target"})))};return e.displayName="EdgeWrapper",(0,y.memo)(e)};function qi(t){let e={default:et(t.default||St),straight:et(t.bezier||Xt),step:et(t.step||Ft),smoothstep:et(t.step||Et),simplebezier:et(t.simplebezier||Ht)},n=Object.keys(t).filter(o=>!["default","bezier"].includes(o)).reduce((o,i)=>(o[i]=et(t[i]||St),o),{});return{...e,...n}}function Oo(t,e,n=null){let o=((n==null?void 0:n.x)||0)+e.x,i=((n==null?void 0:n.y)||0)+e.y,d=(n==null?void 0:n.width)||e.width,r=(n==null?void 0:n.height)||e.height;switch(t){case Y.Top:return{x:o+d/2,y:i};case Y.Right:return{x:o+d,y:i+r/2};case Y.Bottom:return{x:o+d/2,y:i+r};case Y.Left:return{x:o,y:i+r/2}}}function Po(t,e){return t?t.length===1||!e?t[0]:e&&t.find(n=>n.id===e)||null:null}var Qi=(t,e,n,o,i,d)=>{let r=Oo(n,t,e),l=Oo(d,o,i);return{sourceX:r.x,sourceY:r.y,targetX:l.x,targetY:l.y}};function Ji({sourcePos:t,targetPos:e,sourceWidth:n,sourceHeight:o,targetWidth:i,targetHeight:d,width:r,height:l,transform:s}){let u={x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x+n,e.x+i),y2:Math.max(t.y+o,e.y+d)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);let c=Lt({x:(0-s[0])/s[2],y:(0-s[1])/s[2],width:r/s[2],height:l/s[2]}),a=Math.max(0,Math.min(c.x2,u.x2)-Math.max(c.x,u.x)),g=Math.max(0,Math.min(c.y2,u.y2)-Math.max(c.y,u.y));return Math.ceil(a*g)>0}function Do(t){var o,i,d,r,l;let e=((o=t==null?void 0:t[re])==null?void 0:o.handleBounds)||null,n=e&&(t==null?void 0:t.width)&&(t==null?void 0:t.height)&&((i=t==null?void 0:t.positionAbsolute)==null?void 0:i.x)!==void 0&&((d=t==null?void 0:t.positionAbsolute)==null?void 0:d.y)!==void 0;return[{x:((r=t==null?void 0:t.positionAbsolute)==null?void 0:r.x)||0,y:((l=t==null?void 0:t.positionAbsolute)==null?void 0:l.y)||0,width:(t==null?void 0:t.width)||0,height:(t==null?void 0:t.height)||0},e,!!n]}var es=[{level:0,isMaxLevel:!0,edges:[]}];function ts(t,e,n=!1){let o=-1,i=t.reduce((r,l)=>{var c,a;let s=pe(l.zIndex),u=s?l.zIndex:0;if(n){let g=e.get(l.target),h=e.get(l.source),p=l.selected||(g==null?void 0:g.selected)||(h==null?void 0:h.selected),m=Math.max(((c=h==null?void 0:h[re])==null?void 0:c.z)||0,((a=g==null?void 0:g[re])==null?void 0:a.z)||0,1e3);u=(s?l.zIndex:0)+(p?m:0)}return r[u]?r[u].push(l):r[u]=[l],o=u>o?u:o,r},{}),d=Object.entries(i).map(([r,l])=>{let s=+r;return{edges:l,level:s,isMaxLevel:s===o}});return d.length===0?es:d}function ns(t,e,n){let o=ne((0,y.useCallback)(i=>t?i.edges.filter(d=>{let r=e.get(d.source),l=e.get(d.target);return(r==null?void 0:r.width)&&(r==null?void 0:r.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&Ji({sourcePos:r.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:r.width,sourceHeight:r.height,targetWidth:l.width,targetHeight:l.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[t,e]));return ts(o,e,n)}var os=({color:t="none",strokeWidth:e=1})=>y.createElement("polyline",{style:{stroke:t,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),rs=({color:t="none",strokeWidth:e=1})=>y.createElement("polyline",{style:{stroke:t,fill:t,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Io={[st.Arrow]:os,[st.ArrowClosed]:rs};function as(t){let e=le();return(0,y.useMemo)(()=>{var n,o;return Object.prototype.hasOwnProperty.call(Io,t)?Io[t]:((o=(n=e.getState()).onError)==null||o.call(n,"009",Ee.error009(t)),null)},[t])}var is=({id:t,type:e,color:n,width:o=12.5,height:i=12.5,markerUnits:d="strokeWidth",strokeWidth:r,orient:l="auto-start-reverse"})=>{let s=as(e);return s?y.createElement("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${o}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:d,orient:l,refX:"0",refY:"0"},y.createElement(s,{color:n,strokeWidth:r})):null},ss=({defaultColor:t,rfId:e})=>n=>{let o=[];return n.edges.reduce((i,d)=>([d.markerStart,d.markerEnd].forEach(r=>{if(r&&typeof r=="object"){let l=Zt(r,e);o.includes(l)||(i.push({id:l,color:r.color||t,...r}),o.push(l))}}),i),[]).sort((i,d)=>i.id.localeCompare(d.id))},jo=({defaultColor:t,rfId:e})=>{let n=ne((0,y.useCallback)(ss({defaultColor:t,rfId:e}),[t,e]),(o,i)=>!(o.length!==i.length||o.some((d,r)=>d.id!==i[r].id)));return y.createElement("defs",null,n.map(o=>y.createElement(is,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};jo.displayName="MarkerDefinitions";var ls=(0,y.memo)(jo),ds=t=>({nodesConnectable:t.nodesConnectable,edgesFocusable:t.edgesFocusable,edgesUpdatable:t.edgesUpdatable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals,onError:t.onError}),Ro=({defaultMarkerColor:t,onlyRenderVisibleElements:e,elevateEdgesOnSelect:n,rfId:o,edgeTypes:i,noPanClassName:d,onEdgeContextMenu:r,onEdgeMouseEnter:l,onEdgeMouseMove:s,onEdgeMouseLeave:u,onEdgeClick:c,onEdgeDoubleClick:a,onReconnect:g,onReconnectStart:h,onReconnectEnd:p,reconnectRadius:m,children:v,disableKeyboardA11y:b})=>{let{edgesFocusable:x,edgesUpdatable:_,elementsSelectable:f,width:C,height:k,connectionMode:O,nodeInternals:D,onError:P}=ne(ds,ue),E=ns(e,D,n);return C?y.createElement(y.Fragment,null,E.map(({level:w,edges:M,isMaxLevel:N})=>y.createElement("svg",{key:w,style:{zIndex:w},width:C,height:k,className:"react-flow__edges react-flow__container"},N&&y.createElement(ls,{defaultColor:t,rfId:o}),y.createElement("g",null,M.map(S=>{let[R,B,L]=Do(D.get(S.source)),[V,j,T]=Do(D.get(S.target));if(!L||!T)return null;let F=S.type||"default";i[F]||(P==null||P("011",Ee.error011(F)),F="default");let X=i[F]||i.default,Z=O===Ke.Strict?j.target:(j.target??[]).concat(j.source??[]),U=Po(B.source,S.sourceHandle),I=Po(Z,S.targetHandle),A=(U==null?void 0:U.position)||Y.Bottom,z=(I==null?void 0:I.position)||Y.Top,H=!!(S.focusable||x&&S.focusable===void 0),K=S.reconnectable||S.updatable,G=g!==void 0&&(K||_&&K===void 0);if(!U||!I)return P==null||P("008",Ee.error008(U,S)),null;let{sourceX:J,sourceY:ae,targetX:ge,targetY:oe}=Qi(R,U,A,V,I,z);return y.createElement(X,{key:S.id,id:S.id,className:he([S.className,d]),type:F,data:S.data,selected:!!S.selected,animated:!!S.animated,hidden:!!S.hidden,label:S.label,labelStyle:S.labelStyle,labelShowBg:S.labelShowBg,labelBgStyle:S.labelBgStyle,labelBgPadding:S.labelBgPadding,labelBgBorderRadius:S.labelBgBorderRadius,style:S.style,source:S.source,target:S.target,sourceHandleId:S.sourceHandle,targetHandleId:S.targetHandle,markerEnd:S.markerEnd,markerStart:S.markerStart,sourceX:J,sourceY:ae,targetX:ge,targetY:oe,sourcePosition:A,targetPosition:z,elementsSelectable:f,onContextMenu:r,onMouseEnter:l,onMouseMove:s,onMouseLeave:u,onClick:c,onEdgeDoubleClick:a,onReconnect:g,onReconnectStart:h,onReconnectEnd:p,reconnectRadius:m,rfId:o,ariaLabel:S.ariaLabel,isFocusable:H,isReconnectable:G,pathOptions:"pathOptions"in S?S.pathOptions:void 0,interactionWidth:S.interactionWidth,disableKeyboardA11y:b})})))),v):null};Ro.displayName="EdgeRenderer";var cs=(0,y.memo)(Ro),us=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function hs({children:t}){let e=ne(us);return y.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:e}},t)}function gs(t){let e=dt(),n=(0,y.useRef)(!1);(0,y.useEffect)(()=>{!n.current&&e.viewportInitialized&&t&&(setTimeout(()=>t(e),1),n.current=!0)},[t,e.viewportInitialized])}var ms={[Y.Left]:Y.Right,[Y.Right]:Y.Left,[Y.Top]:Y.Bottom,[Y.Bottom]:Y.Top},Ao=({nodeId:t,handleType:e,style:n,type:o=ze.Bezier,CustomComponent:i,connectionStatus:d})=>{var k,O,D;let{fromNode:r,handleId:l,toX:s,toY:u,connectionMode:c}=ne((0,y.useCallback)(P=>({fromNode:P.nodeInternals.get(t),handleId:P.connectionHandleId,toX:(P.connectionPosition.x-P.transform[0])/P.transform[2],toY:(P.connectionPosition.y-P.transform[1])/P.transform[2],connectionMode:P.connectionMode}),[t]),ue),a=(k=r==null?void 0:r[re])==null?void 0:k.handleBounds,g=a==null?void 0:a[e];if(c===Ke.Loose&&(g||(g=a==null?void 0:a[e==="source"?"target":"source"])),!r||!g)return null;let h=l?g.find(P=>P.id===l):g[0],p=h?h.x+h.width/2:(r.width??0)/2,m=h?h.y+h.height/2:r.height??0,v=(((O=r.positionAbsolute)==null?void 0:O.x)??0)+p,b=(((D=r.positionAbsolute)==null?void 0:D.y)??0)+m,x=h==null?void 0:h.position,_=x?ms[x]:null;if(!x||!_)return null;if(i)return y.createElement(i,{connectionLineType:o,connectionLineStyle:n,fromNode:r,fromHandle:h,fromX:v,fromY:b,toX:s,toY:u,fromPosition:x,toPosition:_,connectionStatus:d});let f="",C={sourceX:v,sourceY:b,sourcePosition:x,targetX:s,targetY:u,targetPosition:_};return o===ze.Bezier?[f]=Hn(C):o===ze.Step?[f]=Vt({...C,borderRadius:0}):o===ze.SmoothStep?[f]=Vt(C):o===ze.SimpleBezier?[f]=zn(C):f=`M${v},${b} ${s},${u}`,y.createElement("path",{d:f,fill:"none",className:"react-flow__connection-path",style:n})};Ao.displayName="ConnectionLine";var fs=t=>({nodeId:t.connectionNodeId,handleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,connectionStatus:t.connectionStatus,width:t.width,height:t.height});function ps({containerStyle:t,style:e,type:n,component:o}){let{nodeId:i,handleType:d,nodesConnectable:r,width:l,height:s,connectionStatus:u}=ne(fs,ue);return i&&d&&l&&r?y.createElement("svg",{style:t,width:l,height:s,className:"react-flow__edges react-flow__connectionline react-flow__container"},y.createElement("g",{className:he(["react-flow__connection",u])},y.createElement(Ao,{nodeId:i,handleType:d,style:e,type:n,CustomComponent:o,connectionStatus:u}))):null}function Bo(t,e){return(0,y.useRef)(null),le(),(0,y.useMemo)(()=>e(t),[t])}var zo=({nodeTypes:t,edgeTypes:e,onMove:n,onMoveStart:o,onMoveEnd:i,onInit:d,onNodeClick:r,onEdgeClick:l,onNodeDoubleClick:s,onEdgeDoubleClick:u,onNodeMouseEnter:c,onNodeMouseMove:a,onNodeMouseLeave:g,onNodeContextMenu:h,onSelectionContextMenu:p,onSelectionStart:m,onSelectionEnd:v,connectionLineType:b,connectionLineStyle:x,connectionLineComponent:_,connectionLineContainerStyle:f,selectionKeyCode:C,selectionOnDrag:k,selectionMode:O,multiSelectionKeyCode:D,panActivationKeyCode:P,zoomActivationKeyCode:E,deleteKeyCode:w,onlyRenderVisibleElements:M,elementsSelectable:N,selectNodesOnDrag:S,defaultViewport:R,translateExtent:B,minZoom:L,maxZoom:V,preventScrolling:j,defaultMarkerColor:T,zoomOnScroll:F,zoomOnPinch:X,panOnScroll:Z,panOnScrollSpeed:U,panOnScrollMode:I,zoomOnDoubleClick:A,panOnDrag:z,onPaneClick:H,onPaneMouseEnter:K,onPaneMouseMove:G,onPaneMouseLeave:J,onPaneScroll:ae,onPaneContextMenu:ge,onEdgeContextMenu:oe,onEdgeMouseEnter:ee,onEdgeMouseMove:de,onEdgeMouseLeave:te,onReconnect:W,onReconnectStart:me,onReconnectEnd:_e,reconnectRadius:nt,noDragClassName:$e,noWheelClassName:Te,noPanClassName:we,elevateEdgesOnSelect:He,disableKeyboardA11y:Oe,nodeOrigin:Pe,nodeExtent:Ve,rfId:Fe})=>{let ce=Bo(t,Xi),fe=Bo(e,qi);return gs(d),y.createElement(Vi,{onPaneClick:H,onPaneMouseEnter:K,onPaneMouseMove:G,onPaneMouseLeave:J,onPaneContextMenu:ge,onPaneScroll:ae,deleteKeyCode:w,selectionKeyCode:C,selectionOnDrag:k,selectionMode:O,onSelectionStart:m,onSelectionEnd:v,multiSelectionKeyCode:D,panActivationKeyCode:P,zoomActivationKeyCode:E,elementsSelectable:N,onMove:n,onMoveStart:o,onMoveEnd:i,zoomOnScroll:F,zoomOnPinch:X,zoomOnDoubleClick:A,panOnScroll:Z,panOnScrollSpeed:U,panOnScrollMode:I,panOnDrag:z,defaultViewport:R,translateExtent:B,minZoom:L,maxZoom:V,onSelectionContextMenu:p,preventScrolling:j,noDragClassName:$e,noWheelClassName:Te,noPanClassName:we,disableKeyboardA11y:Oe},y.createElement(hs,null,y.createElement(cs,{edgeTypes:fe,onEdgeClick:l,onEdgeDoubleClick:u,onlyRenderVisibleElements:M,onEdgeContextMenu:oe,onEdgeMouseEnter:ee,onEdgeMouseMove:de,onEdgeMouseLeave:te,onReconnect:W,onReconnectStart:me,onReconnectEnd:_e,reconnectRadius:nt,defaultMarkerColor:T,noPanClassName:we,elevateEdgesOnSelect:!!He,disableKeyboardA11y:Oe,rfId:Fe},y.createElement(ps,{style:x,type:b,component:_,containerStyle:f})),y.createElement("div",{className:"react-flow__edgelabel-renderer"}),y.createElement(Ki,{nodeTypes:ce,onNodeClick:r,onNodeDoubleClick:s,onNodeMouseEnter:c,onNodeMouseMove:a,onNodeMouseLeave:g,onNodeContextMenu:h,selectNodesOnDrag:S,onlyRenderVisibleElements:M,noPanClassName:we,noDragClassName:$e,disableKeyboardA11y:Oe,nodeOrigin:Pe,nodeExtent:Ve,rfId:Fe})))};zo.displayName="GraphView";var ys=(0,y.memo)(zo),an=[[-1/0,-1/0],[1/0,1/0]],Me={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:an,nodeExtent:an,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ke.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Ya,isValidConnection:void 0},vs=()=>Ia((t,e)=>({...Me,setNodes:n=>{let{nodeInternals:o,nodeOrigin:i,elevateNodesOnSelect:d}=e();t({nodeInternals:Jt(n,o,i,d)})},getNodes:()=>Array.from(e().nodeInternals.values()),setEdges:n=>{let{defaultEdgeOptions:o={}}=e();t({edges:n.map(i=>({...o,...i}))})},setDefaultNodesAndEdges:(n,o)=>{let i=n!==void 0,d=o!==void 0,r=i?Jt(n,new Map,e().nodeOrigin,e().elevateNodesOnSelect):new Map;t({nodeInternals:r,edges:d?o:[],hasDefaultNodes:i,hasDefaultEdges:d})},updateNodeDimensions:n=>{let{onNodesChange:o,nodeInternals:i,fitViewOnInit:d,fitViewOnInitDone:r,fitViewOnInitOptions:l,domNode:s,nodeOrigin:u}=e(),c=s==null?void 0:s.querySelector(".react-flow__viewport");if(!c)return;let a=window.getComputedStyle(c),{m22:g}=new window.DOMMatrixReadOnly(a.transform),h=n.reduce((m,v)=>{let b=i.get(v.id);if(b!=null&&b.hidden)i.set(b.id,{...b,[re]:{...b[re],handleBounds:void 0}});else if(b){let x=Bt(v.nodeElement);x.width&&x.height&&(b.width!==x.width||b.height!==x.height||v.forceUpdate)&&(i.set(b.id,{...b,[re]:{...b[re],handleBounds:{source:wo(".source",v.nodeElement,g,u),target:wo(".target",v.nodeElement,g,u)}},...x}),m.push({id:b.id,type:"dimensions",dimensions:x}))}return m},[]);uo(i,u);let p=r||d&&!r&&ho(e,{initial:!0,...l});t({nodeInternals:new Map(i),fitViewOnInitDone:p}),(h==null?void 0:h.length)>0&&(o==null||o(h))},updateNodePositions:(n,o=!0,i=!1)=>{let{triggerNodeChanges:d}=e(),r=n.map(l=>{let s={id:l.id,type:"position",dragging:i};return o&&(s.positionAbsolute=l.positionAbsolute,s.position=l.position),s});d(r)},triggerNodeChanges:n=>{let{onNodesChange:o,nodeInternals:i,hasDefaultNodes:d,nodeOrigin:r,getNodes:l,elevateNodesOnSelect:s}=e();if(n!=null&&n.length){if(d){let u=yo(n,l()),c=Jt(u,i,r,s);t({nodeInternals:c})}o==null||o(n)}},addSelectedNodes:n=>{let{multiSelectionActive:o,edges:i,getNodes:d}=e(),r,l=null;o?r=n.map(s=>ke(s,!0)):(r=Qe(d(),n),l=Qe(i,[])),Nt({changedNodes:r,changedEdges:l,get:e,set:t})},addSelectedEdges:n=>{let{multiSelectionActive:o,edges:i,getNodes:d}=e(),r,l=null;o?r=n.map(s=>ke(s,!0)):(r=Qe(i,n),l=Qe(d(),[])),Nt({changedNodes:l,changedEdges:r,get:e,set:t})},unselectNodesAndEdges:({nodes:n,edges:o}={})=>{let{edges:i,getNodes:d}=e(),r=n||d(),l=o||i,s=r.map(c=>(c.selected=!1,ke(c.id,!1))),u=l.map(c=>ke(c.id,!1));Nt({changedNodes:s,changedEdges:u,get:e,set:t})},setMinZoom:n=>{let{d3Zoom:o,maxZoom:i}=e();o==null||o.scaleExtent([n,i]),t({minZoom:n})},setMaxZoom:n=>{let{d3Zoom:o,minZoom:i}=e();o==null||o.scaleExtent([i,n]),t({maxZoom:n})},setTranslateExtent:n=>{var o;(o=e().d3Zoom)==null||o.translateExtent(n),t({translateExtent:n})},resetSelectedElements:()=>{let{edges:n,getNodes:o}=e(),i=o().filter(r=>r.selected).map(r=>ke(r.id,!1)),d=n.filter(r=>r.selected).map(r=>ke(r.id,!1));Nt({changedNodes:i,changedEdges:d,get:e,set:t})},setNodeExtent:n=>{let{nodeInternals:o}=e();o.forEach(i=>{i.positionAbsolute=zt(i.position,n)}),t({nodeExtent:n,nodeInternals:new Map(o)})},panBy:n=>{let{transform:o,width:i,height:d,d3Zoom:r,d3Selection:l,translateExtent:s}=e();if(!r||!l||!n.x&&!n.y)return!1;let u=Ye.translate(o[0]+n.x,o[1]+n.y).scale(o[2]),c=[[0,0],[i,d]],a=r==null?void 0:r.constrain()(u,c,s);return r.transform(l,a),o[0]!==a.x||o[1]!==a.y||o[2]!==a.k},cancelConnection:()=>t({connectionNodeId:Me.connectionNodeId,connectionHandleId:Me.connectionHandleId,connectionHandleType:Me.connectionHandleType,connectionStatus:Me.connectionStatus,connectionStartHandle:Me.connectionStartHandle,connectionEndHandle:Me.connectionEndHandle}),reset:()=>t({...Me})}),Object.is),sn=({children:t})=>{let e=(0,y.useRef)(null);return e.current||(e.current=vs()),y.createElement(La,{value:e.current},t)};sn.displayName="ReactFlowProvider";var Lo=({children:t})=>(0,y.useContext)(yt)?y.createElement(y.Fragment,null,t):y.createElement(sn,null,t);Lo.displayName="ReactFlowWrapper";var bs={input:eo,default:qt,output:no,group:Qt},xs={default:St,straight:Xt,step:Ft,smoothstep:Et,simplebezier:Ht},Es=[0,0],ws=[15,15],Ss={x:0,y:0,zoom:1},Cs={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ln=(0,y.forwardRef)(({nodes:t,edges:e,defaultNodes:n,defaultEdges:o,className:i,nodeTypes:d=bs,edgeTypes:r=xs,onNodeClick:l,onEdgeClick:s,onInit:u,onMove:c,onMoveStart:a,onMoveEnd:g,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:b,onNodeMouseEnter:x,onNodeMouseMove:_,onNodeMouseLeave:f,onNodeContextMenu:C,onNodeDoubleClick:k,onNodeDragStart:O,onNodeDrag:D,onNodeDragStop:P,onNodesDelete:E,onEdgesDelete:w,onSelectionChange:M,onSelectionDragStart:N,onSelectionDrag:S,onSelectionDragStop:R,onSelectionContextMenu:B,onSelectionStart:L,onSelectionEnd:V,connectionMode:j=Ke.Strict,connectionLineType:T=ze.Bezier,connectionLineStyle:F,connectionLineComponent:X,connectionLineContainerStyle:Z,deleteKeyCode:U="Backspace",selectionKeyCode:I="Shift",selectionOnDrag:A=!1,selectionMode:z=xt.Full,panActivationKeyCode:H="Space",multiSelectionKeyCode:K=bt()?"Meta":"Control",zoomActivationKeyCode:G=bt()?"Meta":"Control",snapToGrid:J=!1,snapGrid:ae=ws,onlyRenderVisibleElements:ge=!1,selectNodesOnDrag:oe=!0,nodesDraggable:ee,nodesConnectable:de,nodesFocusable:te,nodeOrigin:W=Es,edgesFocusable:me,edgesUpdatable:_e,elementsSelectable:nt,defaultViewport:$e=Ss,minZoom:Te=.5,maxZoom:we=2,translateExtent:He=an,preventScrolling:Oe=!0,nodeExtent:Pe,defaultMarkerColor:Ve="#b1b1b7",zoomOnScroll:Fe=!0,zoomOnPinch:ce=!0,panOnScroll:fe=!1,panOnScrollSpeed:De=.5,panOnScrollMode:Ie=Be.Free,zoomOnDoubleClick:je=!0,panOnDrag:xe=!0,onPaneClick:Se,onPaneMouseEnter:ot,onPaneMouseMove:Ot,onPaneMouseLeave:rt,onPaneScroll:Re,onPaneContextMenu:ir,children:sr,onEdgeContextMenu:lr,onEdgeDoubleClick:dr,onEdgeMouseEnter:cr,onEdgeMouseMove:ur,onEdgeMouseLeave:hr,onEdgeUpdate:gr,onEdgeUpdateStart:mr,onEdgeUpdateEnd:fr,onReconnect:pr,onReconnectStart:yr,onReconnectEnd:vr,reconnectRadius:br=10,edgeUpdaterRadius:xr=10,onNodesChange:Er,onEdgesChange:wr,noDragClassName:Sr="nodrag",noWheelClassName:Cr="nowheel",noPanClassName:hn="nopan",fitView:Nr=!1,fitViewOptions:kr,connectOnClick:Mr=!0,attributionPosition:_r,proOptions:Or,defaultEdgeOptions:Pr,elevateNodesOnSelect:Dr=!0,elevateEdgesOnSelect:Ir=!1,disableKeyboardA11y:gn=!1,autoPanOnConnect:jr=!0,autoPanOnNodeDrag:Rr=!0,connectionRadius:Ar=20,isValidConnection:Br,onError:zr,style:Lr,id:mn,nodeDragThreshold:$r,...Tr},Hr)=>{let Pt=mn||"1";return y.createElement("div",{...Tr,style:{...Lr,...Cs},ref:Hr,className:he(["react-flow",i]),"data-testid":"rf__wrapper",id:mn},y.createElement(Lo,null,y.createElement(ys,{onInit:u,onMove:c,onMoveStart:a,onMoveEnd:g,onNodeClick:l,onEdgeClick:s,onNodeMouseEnter:x,onNodeMouseMove:_,onNodeMouseLeave:f,onNodeContextMenu:C,onNodeDoubleClick:k,nodeTypes:d,edgeTypes:r,connectionLineType:T,connectionLineStyle:F,connectionLineComponent:X,connectionLineContainerStyle:Z,selectionKeyCode:I,selectionOnDrag:A,selectionMode:z,deleteKeyCode:U,multiSelectionKeyCode:K,panActivationKeyCode:H,zoomActivationKeyCode:G,onlyRenderVisibleElements:ge,selectNodesOnDrag:oe,defaultViewport:$e,translateExtent:He,minZoom:Te,maxZoom:we,preventScrolling:Oe,zoomOnScroll:Fe,zoomOnPinch:ce,zoomOnDoubleClick:je,panOnScroll:fe,panOnScrollSpeed:De,panOnScrollMode:Ie,panOnDrag:xe,onPaneClick:Se,onPaneMouseEnter:ot,onPaneMouseMove:Ot,onPaneMouseLeave:rt,onPaneScroll:Re,onPaneContextMenu:ir,onSelectionContextMenu:B,onSelectionStart:L,onSelectionEnd:V,onEdgeContextMenu:lr,onEdgeDoubleClick:dr,onEdgeMouseEnter:cr,onEdgeMouseMove:ur,onEdgeMouseLeave:hr,onReconnect:pr??gr,onReconnectStart:yr??mr,onReconnectEnd:vr??fr,reconnectRadius:br??xr,defaultMarkerColor:Ve,noDragClassName:Sr,noWheelClassName:Cr,noPanClassName:hn,elevateEdgesOnSelect:Ir,rfId:Pt,disableKeyboardA11y:gn,nodeOrigin:W,nodeExtent:Pe}),y.createElement(mi,{nodes:t,edges:e,defaultNodes:n,defaultEdges:o,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:b,nodesDraggable:ee,nodesConnectable:de,nodesFocusable:te,edgesFocusable:me,edgesUpdatable:_e,elementsSelectable:nt,elevateNodesOnSelect:Dr,minZoom:Te,maxZoom:we,nodeExtent:Pe,onNodesChange:Er,onEdgesChange:wr,snapToGrid:J,snapGrid:ae,connectionMode:j,translateExtent:He,connectOnClick:Mr,defaultEdgeOptions:Pr,fitView:Nr,fitViewOptions:kr,onNodesDelete:E,onEdgesDelete:w,onNodeDragStart:O,onNodeDrag:D,onNodeDragStop:P,onSelectionDrag:S,onSelectionDragStart:N,onSelectionDragStop:R,noPanClassName:hn,nodeOrigin:W,rfId:Pt,autoPanOnConnect:jr,autoPanOnNodeDrag:Rr,onError:zr,connectionRadius:Ar,isValidConnection:Br,nodeDragThreshold:$r}),y.createElement(hi,{onSelectionChange:M}),sr,y.createElement(Ta,{proOptions:Or,position:_r}),y.createElement(bi,{rfId:Pt,disableKeyboardA11y:gn})))});ln.displayName="ReactFlow";function $o(t){return e=>{let[n,o]=(0,y.useState)(e),i=(0,y.useCallback)(d=>o(r=>t(d,r)),[]);return[n,o,i]}}var To=$o(yo),Ho=$o(ji);function Ns(){return y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},y.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function ks(){return y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},y.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Ms(){return y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},y.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function _s(){return y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},y.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Os(){return y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},y.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}var tt=({children:t,className:e,...n})=>y.createElement("button",{type:"button",className:he(["react-flow__controls-button",e]),...n},t);tt.displayName="ControlButton";var Ps=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom}),Vo=({style:t,showZoom:e=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:i,onZoomIn:d,onZoomOut:r,onFitView:l,onInteractiveChange:s,className:u,children:c,position:a="bottom-left"})=>{let g=le(),[h,p]=(0,y.useState)(!1),{isInteractive:m,minZoomReached:v,maxZoomReached:b}=ne(Ps,ue),{zoomIn:x,zoomOut:_,fitView:f}=dt();if((0,y.useEffect)(()=>{p(!0)},[]),!h)return null;let C=()=>{x(),d==null||d()},k=()=>{_(),r==null||r()},O=()=>{f(i),l==null||l()},D=()=>{g.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),s==null||s(!m)};return y.createElement(vt,{className:he(["react-flow__controls",u]),position:a,style:t,"data-testid":"rf__controls"},e&&y.createElement(y.Fragment,null,y.createElement(tt,{onClick:C,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b},y.createElement(Ns,null)),y.createElement(tt,{onClick:k,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v},y.createElement(ks,null))),n&&y.createElement(tt,{className:"react-flow__controls-fitview",onClick:O,title:"fit view","aria-label":"fit view"},y.createElement(Ms,null)),o&&y.createElement(tt,{className:"react-flow__controls-interactive",onClick:D,title:"toggle interactivity","aria-label":"toggle interactivity"},m?y.createElement(Os,null):y.createElement(_s,null)),c)};Vo.displayName="Controls";var Ds=(0,y.memo)(Vo),ve;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(ve||(ve={}));function Is({color:t,dimensions:e,lineWidth:n}){return y.createElement("path",{stroke:t,strokeWidth:n,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`})}function js({color:t,radius:e}){return y.createElement("circle",{cx:e,cy:e,r:e,fill:t})}var Rs={[ve.Dots]:"#91919a",[ve.Lines]:"#eee",[ve.Cross]:"#e2e2e2"},As={[ve.Dots]:1,[ve.Lines]:1,[ve.Cross]:6},Bs=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function Fo({id:t,variant:e=ve.Dots,gap:n=20,size:o,lineWidth:i=1,offset:d=2,color:r,style:l,className:s}){let u=(0,y.useRef)(null),{transform:c,patternId:a}=ne(Bs,ue),g=r||Rs[e],h=o||As[e],p=e===ve.Dots,m=e===ve.Cross,v=Array.isArray(n)?n:[n,n],b=[v[0]*c[2]||1,v[1]*c[2]||1],x=h*c[2],_=m?[x,x]:b,f=p?[x/d,x/d]:[_[0]/d,_[1]/d];return y.createElement("svg",{className:he(["react-flow__background",s]),style:{...l,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},y.createElement("pattern",{id:a+t,x:c[0]%b[0],y:c[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${f[0]},-${f[1]})`},p?y.createElement(js,{color:g,radius:x/d}):y.createElement(Is,{dimensions:_,color:g,lineWidth:i})),y.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${a+t})`}))}Fo.displayName="Background";var zs=(0,y.memo)(Fo),Ls=ye(Ae());function dn(t){return Math.min(t*11+35,200)}var $s=class{createEdge(t,e,n){return{type:"smoothstep",pathOptions:{offset:20,borderRadius:100},data:{direction:n},markerEnd:{type:st.Arrow},id:`${t}-${e}-${n}`,source:t,sourceHandle:n,targetHandle:n,target:e}}createNode(t,e,n){let o=gt.get(e).code.trim().split(`
`).length,i=dn(o);return{id:t,data:{atom:e},width:250,type:"custom",height:i,position:{x:0,y:n+20}}}createElements(t,e,n,o){let i=0,d=[],r=[];for(let[s,u]of bn.zip(t,e)){let c=this.createNode(s,u,i);d.push(c),i=c.position.y+(c.height||0)}let l=new Set;for(let s of Object.values(n)){let{declaredBy:u,usedBy:c}=s;for(let a of u)for(let g of c){let h=`${a}-${g}`;l.has(h)||(l.add(h),r.push(this.createEdge(a,g,"inputs"),this.createEdge(a,g,"outputs")))}}return{nodes:d,edges:r}}},Ts=class{createEdge(t,e){return{animated:!0,markerEnd:{type:st.ArrowClosed},id:`${t}-${e}`,style:{strokeWidth:2},source:t,sourceHandle:"outputs",targetHandle:"inputs",target:e}}createNode(t,e){let n=gt.get(e).code.trim().split(`
`).length,o=dn(n);return{id:t,data:{atom:e,forceWidth:300},width:300,type:"custom",height:o,position:{x:0,y:0}}}createElements(t,e,n,o){let i=[],d=[],r=new Set,l=new Set;for(let s of Object.values(n)){if(s.value==="marimo"&&s.name==="mo")continue;let{declaredBy:u,usedBy:c}=s;for(let a of u)for(let g of c){let h=`${a}-${g}`;l.has(h)||(l.add(h),r.add(a),r.add(g),d.push(this.createEdge(a,g)))}}for(let[s,u]of bn.zip(t,e)){o||i.push(this.createNode(s,u));let c=r.has(s),a=gt.get(u).code.trim().startsWith("mo.md");(c||!a)&&i.push(this.createNode(s,u))}return{nodes:i,edges:d}}},$=ye(Jr());function Hs(t){return Math.min(Math.max(t-100,100),400)}const Xo=y.createContext("LR"),Yo=(0,y.memo)(t=>{let e=(0,Ls.c)(57),{data:n,selected:o}=t,i=Xr(n.atom),d=yn().inOrderIds.indexOf(i.id),r=o?"var(--gray-9)":"var(--gray-3)",l=ne(Vs),s=(0,y.use)(Xo),u=(0,y.useId)(),c=(0,y.useId)(),a=(0,y.useId)(),g=(0,y.useId)(),h,p,m,v;if(e[0]!==i.code||e[1]!==r||e[2]!==s||e[3]!==u||e[4]!==c||e[5]!==o){let S=i.code.split(`
`).length,R=s==="LR"?Y.Left:Y.Top,B;e[10]===r?B=e[11]:(B={background:r},e[10]=r,e[11]=B),e[12]!==u||e[13]!==R||e[14]!==B?(m=(0,$.jsx)(Ne,{type:"target",id:u,"data-testid":"input-one",position:R,style:B}),e[12]=u,e[13]=R,e[14]=B,e[15]=m):m=e[15];let L=s==="LR"?Y.Left:Y.Top,V;e[16]===r?V=e[17]:(V={background:r},e[16]=r,e[17]=V),e[18]!==c||e[19]!==L||e[20]!==V?(v=(0,$.jsx)(Ne,{type:"source",id:c,"data-testid":"input-two",position:L,style:V}),e[18]=c,e[19]=L,e[20]=V,e[21]=v):v=e[21];let j=o&&"border-primary";e[22]===j?p=e[23]:(p=vn("flex flex-col bg-card border border-input/50 rounded-md mx-[2px] overflow-hidden",j),e[22]=j,e[23]=p),h=dn(S),e[0]=i.code,e[1]=r,e[2]=s,e[3]=u,e[4]=c,e[5]=o,e[6]=h,e[7]=p,e[8]=m,e[9]=v}else h=e[6],p=e[7],m=e[8],v=e[9];let b;e[24]!==n.forceWidth||e[25]!==l?(b=n.forceWidth||Hs(l),e[24]=n.forceWidth,e[25]=l,e[26]=b):b=e[26];let x;e[27]!==h||e[28]!==b?(x={height:h,width:b},e[27]=h,e[28]=b,e[29]=x):x=e[29];let _=qr(i.name,d),f;e[30]===_?f=e[31]:(f=(0,$.jsx)("div",{className:"text-muted-foreground font-semibold text-xs py-1 px-2 bg-muted border-b",children:_}),e[30]=_,e[31]=f);let C;e[32]===i.code?C=e[33]:(C=(0,$.jsx)(aa,{code:i.code}),e[32]=i.code,e[33]=C);let k;e[34]!==p||e[35]!==x||e[36]!==f||e[37]!==C?(k=(0,$.jsxs)("div",{className:p,style:x,children:[f,C]}),e[34]=p,e[35]=x,e[36]=f,e[37]=C,e[38]=k):k=e[38];let O=s==="LR"?Y.Right:Y.Bottom,D;e[39]===r?D=e[40]:(D={background:r},e[39]=r,e[40]=D);let P;e[41]!==a||e[42]!==O||e[43]!==D?(P=(0,$.jsx)(Ne,{type:"source",id:a,"data-testid":"output-one",position:O,style:D}),e[41]=a,e[42]=O,e[43]=D,e[44]=P):P=e[44];let E=s==="LR"?Y.Right:Y.Bottom,w;e[45]===r?w=e[46]:(w={background:r},e[45]=r,e[46]=w);let M;e[47]!==g||e[48]!==E||e[49]!==w?(M=(0,$.jsx)(Ne,{type:"target",id:g,"data-testid":"output-two",position:E,style:w}),e[47]=g,e[48]=E,e[49]=w,e[50]=M):M=e[50];let N;return e[51]!==k||e[52]!==P||e[53]!==M||e[54]!==m||e[55]!==v?(N=(0,$.jsxs)("div",{children:[m,v,k,P,M]}),e[51]=k,e[52]=P,e[53]=M,e[54]=m,e[55]=v,e[56]=N):N=e[56],N},(t,e)=>["data","selected","id"].every(n=>t[n]===e[n]));Yo.displayName="CustomNode";const Zo={custom:Yo};function Vs(t){let{width:e}=t;return e}var Ko=ye(Ae());const cn=(0,y.memo)(t=>{let e=(0,Ko.c)(38),{onChange:n,view:o,settings:i,onSettingsChange:d}=t,r;e[0]!==d||e[1]!==i?(r=(S,R)=>{d({...i,[S]:R})},e[0]=d,e[1]=i,e[2]=r):r=e[2];let l=r,s;e[3]===Symbol.for("react.memo_cache_sentinel")?(s=(0,$.jsx)(ma,{asChild:!0,children:(0,$.jsx)(Xe,{variant:"text",size:"xs",children:(0,$.jsx)(ia,{className:"w-4 h-4"})})}),e[3]=s):s=e[3];let u;e[4]===Symbol.for("react.memo_cache_sentinel")?(u=(0,$.jsx)("div",{className:"font-semibold pb-4",children:"Settings"}),e[4]=u):u=e[4];let c;e[5]===l?c=e[6]:(c=S=>l("hidePureMarkdown",!!S),e[5]=l,e[6]=c);let a;e[7]!==i.hidePureMarkdown||e[8]!==c?(a=(0,$.jsx)(Gr,{"data-testid":"hide-pure-markdown-checkbox",id:"hide-pure-markdown",checked:i.hidePureMarkdown,onCheckedChange:c}),e[7]=i.hidePureMarkdown,e[8]=c,e[9]=a):a=e[9];let g;e[10]===Symbol.for("react.memo_cache_sentinel")?(g=(0,$.jsx)(ga,{htmlFor:"hide-pure-markdown",children:"Hide pure markdown"}),e[10]=g):g=e[10];let h;e[11]===a?h=e[12]:(h=(0,$.jsxs)(pa,{children:[s,(0,$.jsxs)(fa,{className:"w-auto p-2 text-muted-foreground",children:[u,(0,$.jsxs)("div",{className:"flex items-center gap-2",children:[a,g]})]})]}),e[11]=a,e[12]=h);let p=h,m=o==="_minimap_",v;e[13]===n?v=e[14]:(v=()=>n("_minimap_"),e[13]=n,e[14]=v);let b;e[15]===Symbol.for("react.memo_cache_sentinel")?(b=(0,$.jsx)(Ma,{className:"w-4 h-4 mr-1"}),e[15]=b):b=e[15];let x;e[16]!==m||e[17]!==v?(x=(0,$.jsxs)(Xe,{variant:"outline",className:"bg-background","aria-selected":m,size:"xs",onClick:v,children:[b,"Mini Map"]}),e[16]=m,e[17]=v,e[18]=x):x=e[18];let _=o==="TB",f;e[19]===n?f=e[20]:(f=()=>n("TB"),e[19]=n,e[20]=f);let C;e[21]===Symbol.for("react.memo_cache_sentinel")?(C=(0,$.jsx)(xn,{className:"w-4 h-4 mr-1"}),e[21]=C):C=e[21];let k;e[22]!==_||e[23]!==f?(k=(0,$.jsxs)(Xe,{variant:"outline",className:"bg-background","aria-selected":_,size:"xs",onClick:f,children:[C,"Vertical Tree"]}),e[22]=_,e[23]=f,e[24]=k):k=e[24];let O=o==="LR",D;e[25]===n?D=e[26]:(D=()=>n("LR"),e[25]=n,e[26]=D);let P;e[27]===Symbol.for("react.memo_cache_sentinel")?(P=(0,$.jsx)(xn,{className:"w-4 h-4 mr-1 transform -rotate-90"}),e[27]=P):P=e[27];let E;e[28]!==O||e[29]!==D?(E=(0,$.jsxs)(Xe,{variant:"outline",className:"bg-background","aria-selected":O,size:"xs",onClick:D,children:[P," ","Horizontal Tree"]}),e[28]=O,e[29]=D,e[30]=E):E=e[30];let w;e[31]!==x||e[32]!==k||e[33]!==E?(w=(0,$.jsxs)("div",{className:"flex gap-2",children:[x,k,E]}),e[31]=x,e[32]=k,e[33]=E,e[34]=w):w=e[34];let M=o!=="_minimap_"&&p,N;return e[35]!==w||e[36]!==M?(N=(0,$.jsxs)(vt,{position:"top-right",className:"flex flex-col items-end gap-2",children:[w,M]}),e[35]=w,e[36]=M,e[37]=N):N=e[37],N});cn.displayName="GraphToolbar";const Mt=(0,y.memo)(t=>{let e=(0,Ko.c)(11),{selection:n,variables:o,onClearSelection:i}=t;if(!n)return null;let d=Fs,r;e[0]!==i||e[1]!==n.id||e[2]!==n.source||e[3]!==n.target||e[4]!==n.type||e[5]!==o?(r=()=>{if(n.type==="node"){let c=Object.values(o).filter(h=>h.usedBy.includes(n.id)),a=Object.values(o).filter(h=>h.declaredBy.includes(n.id)),g=(h,p)=>(0,$.jsxs)($.Fragment,{children:[h.length===0&&(0,$.jsx)("div",{className:"text-muted-foreground text-sm text-center",children:"--"}),(0,$.jsx)("div",{className:"grid grid-cols-5 gap-3 items-center text-sm py-1 flex-1 empty:hidden",children:h.map(m=>(0,$.jsxs)(y.Fragment,{children:[(0,$.jsx)(Cn,{declaredBy:m.declaredBy,name:m.name}),(0,$.jsxs)("div",{className:"truncate col-span-2",title:m.value??"",children:[m.value,(0,$.jsxs)("span",{className:"ml-1 truncate text-foreground/60 font-mono",children:["(",m.dataType,")"]})]}),(0,$.jsx)("div",{className:"truncate col-span-2 gap-1 items-center",children:(0,$.jsx)(Sa,{skipScroll:!0,onClick:()=>d(p==="in"?m.declaredBy[0]:m.usedBy[0],m.name),maxCount:3,cellIds:m.usedBy})})]},m.name))})]});return(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)("div",{className:"font-bold py-2 flex items-center gap-2 border-b px-3",children:[(0,$.jsx)(sa,{className:"w-5 h-5"}),(0,$.jsx)(Dt,{cellId:n.id}),(0,$.jsx)("div",{className:"flex-1"}),(0,$.jsx)(ta,{cellId:n.id,children:(0,$.jsx)(Xe,{variant:"ghost",size:"icon",children:(0,$.jsx)(ra,{className:"w-4 h-4"})})}),(0,$.jsx)(Xe,{variant:"text",size:"icon",onClick:()=>{i()},children:(0,$.jsx)(oa,{className:"w-4 h-4"})})]}),(0,$.jsxs)("div",{className:"text-sm flex flex-col py-3 pl-2 pr-4 flex-1 justify-center",children:[(0,$.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,$.jsxs)("span",{className:"flex items-center gap-2 font-semibold",children:[(0,$.jsx)(Ca,{className:"w-4 h-4"}),"Outputs"]}),g(a,"out")]}),(0,$.jsx)("hr",{className:"border-divider my-3"}),(0,$.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,$.jsxs)("span",{className:"flex items-center gap-2 font-semibold",children:[(0,$.jsx)(Na,{className:"w-4 h-4"}),"Inputs"]}),g(c,"in")]})]})]})}if(n.type==="edge"){let c=Object.values(o).filter(a=>a.declaredBy.includes(n.source)&&a.usedBy.includes(n.target));return(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)("div",{className:"font-bold py-2 flex items-center gap-2 border-b px-3",children:[(0,$.jsx)(la,{className:"w-4 h-4"}),(0,$.jsx)(Dt,{cellId:n.source}),(0,$.jsx)(na,{className:"w-4 h-4"}),(0,$.jsx)(Dt,{cellId:n.target})]}),(0,$.jsx)("div",{className:"grid grid-cols-4 gap-3 max-w-[350px] items-center text-sm p-3 flex-1",children:c.map(a=>(0,$.jsxs)(y.Fragment,{children:[(0,$.jsx)(Cn,{declaredBy:a.declaredBy,name:a.name,onClick:()=>{d(a.declaredBy[0],a.name)}}),(0,$.jsx)("div",{className:"truncate text-foreground/60 font-mono",children:a.dataType}),(0,$.jsx)("div",{className:"truncate col-span-2",title:a.value??"",children:a.value})]},a.name))})]})}},e[0]=i,e[1]=n.id,e[2]=n.source,e[3]=n.target,e[4]=n.type,e[5]=o,e[6]=r):r=e[6];let l=r,s;e[7]===l?s=e[8]:(s=l(),e[7]=l,e[8]=s);let u;return e[9]===s?u=e[10]:(u=(0,$.jsx)(vt,{position:"bottom-left",className:"max-h-[90%] flex flex-col w-[calc(100%-5rem)]",children:(0,$.jsx)("div",{className:"min-h-[100px] shadow-md rounded-md border max-w-[550px] border-primary/40 my-4 min-w-[240px] bg-(--slate-1) text-muted-foreground/80 flex flex-col overflow-y-auto",children:s})}),e[9]=s,e[10]=u),u});Mt.displayName="GraphSelectionPanel";function Fs(t,e){let n=Ur(t);n&&Zr(n,e)}var Xs=ye(Ae());function Wo(){let t=(0,Xs.c)(7),e=dt(),n=ne(Zs),o=ne(Ys),i;t[0]===e?i=t[1]:(i=()=>{e.fitView({duration:100})},t[0]=e,t[1]=i);let d=ca(i,100),r,l;t[2]!==d||t[3]!==o||t[4]!==n?(r=()=>{!n||!o||d()},l=[n,o,d],t[2]=d,t[3]=o,t[4]=n,t[5]=r,t[6]=l):(r=t[5],l=t[6]),(0,y.useEffect)(r,l)}function Ys(t){let{height:e}=t;return e}function Zs(t){let{width:e}=t;return e}var Go=ye(Ae()),Uo=new $s;const Ks=t=>{let e=(0,Go.c)(37),{cellIds:n,variables:o,cellAtoms:i,children:d}=t,r;e[0]!==i||e[1]!==n||e[2]!==o?(r=Uo.createElements(n,i,o,!1),e[0]=i,e[1]=n,e[2]=o,e[3]=r):r=e[3];let{nodes:l,edges:s}=r,u;e[4]===Symbol.for("react.memo_cache_sentinel")?(u=[],e[4]=u):u=e[4];let[c,a]=Ho(u),[g,h]=To(l),[p,m]=(0,y.useState)(),[v,b]=(0,y.useState)(),x=(0,y.useRef)(!1);Wo();let _=ne(Gs),f;e[5]!==a||e[6]!==h?(f=j=>{h(j.nodes),a([])},e[5]=a,e[6]=h,e[7]=f):f=e[7];let C=En(f),k,O;e[8]!==i||e[9]!==n||e[10]!==C||e[11]!==o?(k=()=>{if(!x.current){x.current=!0;return}C(Uo.createElements(n,i,o,!1))},O=[n,o,i,C],e[8]=i,e[9]=n,e[10]=C,e[11]=o,e[12]=k,e[13]=O):(k=e[12],O=e[13]),(0,y.useEffect)(k,O);let D,P;e[14]!==s||e[15]!==p||e[16]!==a?(D=()=>{if(p){let j=s.filter(T=>{let{source:F,target:X,data:Z}=T;return F===p&&Z.direction==="outputs"||X===p&&Z.direction==="inputs"});a(j)}},P=[p,a,s],e[14]=s,e[15]=p,e[16]=a,e[17]=D,e[18]=P):(D=e[17],P=e[18]),(0,y.useEffect)(D,P);let E=Ws(g,_),w;e[19]===Symbol.for("react.memo_cache_sentinel")?(w=()=>{m(void 0),b(void 0)},e[19]=w):w=e[19];let M=w,N;e[20]!==c||e[21]!==v||e[22]!==p||e[23]!==o?(N=()=>v?(0,$.jsx)(Mt,{selection:{type:"edge",source:v.source,target:v.target},onClearSelection:M,variables:o,edges:c}):p?(0,$.jsx)(Mt,{selection:{type:"node",id:p},variables:o,edges:c,onClearSelection:M}):null,e[20]=c,e[21]=v,e[22]=p,e[23]=o,e[24]=N):N=e[24];let S=N,R;e[25]===a?R=e[26]:(R=(j,T)=>{let F=T.id;m(F),b(void 0),a([])},e[25]=a,e[26]=R);let B;e[27]===Symbol.for("react.memo_cache_sentinel")?(B=(j,T)=>{b(T)},e[27]=B):B=e[27];let L;e[28]===S?L=e[29]:(L=S(),e[28]=S,e[29]=L);let V;return e[30]!==d||e[31]!==c||e[32]!==g||e[33]!==R||e[34]!==L||e[35]!==E?(V=(0,$.jsxs)(ln,{nodes:g,edges:c,nodeTypes:Zo,translateExtent:E,onNodeClick:R,onNodeDoubleClick:Us,onEdgeClick:B,snapToGrid:!0,fitView:!0,elementsSelectable:!0,minZoom:1,maxZoom:1,draggable:!1,panOnScrollMode:Be.Vertical,zoomOnDoubleClick:!1,nodesDraggable:!1,nodesConnectable:!1,nodesFocusable:!1,edgesFocusable:!1,selectNodesOnDrag:!1,panOnDrag:!1,preventScrolling:!1,zoomOnPinch:!1,panOnScroll:!0,autoPanOnNodeDrag:!1,autoPanOnConnect:!1,children:[L,d]}),e[30]=d,e[31]=c,e[32]=g,e[33]=R,e[34]=L,e[35]=E,e[36]=V):V=e[36],V};function Ws(t,e){let n=(0,Go.c)(17),o;if(n[0]!==e||n[1]!==t){let c;n[3]===e?c=n[4]:(c=(a,g)=>{let{position:h}=g;return Math.min(a,h.y-e/2-10)},n[3]=e,n[4]=c),o=t.reduce(c,1/0),n[0]=e,n[1]=t,n[2]=o}else o=n[2];let i=o,d;if(n[5]!==e||n[6]!==t){let c;n[8]===e?c=n[9]:(c=(a,g)=>{let{position:h}=g;return Math.max(a,h.y+e/2+10)},n[8]=e,n[9]=c),d=t.reduce(c,-1/0),n[5]=e,n[6]=t,n[7]=d}else d=n[7];let r=d,l;n[10]===i?l=n[11]:(l=[-1/0,i],n[10]=i,n[11]=l);let s;n[12]===r?s=n[13]:(s=[1/0,r],n[12]=r,n[13]=s);let u;return n[14]!==l||n[15]!==s?(u=[l,s],n[14]=l,n[15]=s,n[16]=u):u=n[16],u}function Gs(t){let{height:e}=t;return e}function Us(t,e){wn(e.id,"focus")}var un=q(((t,e)=>{var n="\0",o="\0",i="",d=class{constructor(a){ie(this,"_isDirected",!0);ie(this,"_isMultigraph",!1);ie(this,"_isCompound",!1);ie(this,"_label");ie(this,"_defaultNodeLabelFn",()=>{});ie(this,"_defaultEdgeLabelFn",()=>{});ie(this,"_nodes",{});ie(this,"_in",{});ie(this,"_preds",{});ie(this,"_out",{});ie(this,"_sucs",{});ie(this,"_edgeObjs",{});ie(this,"_edgeLabels",{});ie(this,"_nodeCount",0);ie(this,"_edgeCount",0);ie(this,"_parent");ie(this,"_children");a&&(this._isDirected=Object.hasOwn(a,"directed")?a.directed:!0,this._isMultigraph=Object.hasOwn(a,"multigraph")?a.multigraph:!1,this._isCompound=Object.hasOwn(a,"compound")?a.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[o]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(a){return this._label=a,this}graph(){return this._label}setDefaultNodeLabel(a){return this._defaultNodeLabelFn=a,typeof a!="function"&&(this._defaultNodeLabelFn=()=>a),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var a=this;return this.nodes().filter(g=>Object.keys(a._in[g]).length===0)}sinks(){var a=this;return this.nodes().filter(g=>Object.keys(a._out[g]).length===0)}setNodes(a,g){var h=arguments,p=this;return a.forEach(function(m){h.length>1?p.setNode(m,g):p.setNode(m)}),this}setNode(a,g){return Object.hasOwn(this._nodes,a)?(arguments.length>1&&(this._nodes[a]=g),this):(this._nodes[a]=arguments.length>1?g:this._defaultNodeLabelFn(a),this._isCompound&&(this._parent[a]=o,this._children[a]={},this._children[o][a]=!0),this._in[a]={},this._preds[a]={},this._out[a]={},this._sucs[a]={},++this._nodeCount,this)}node(a){return this._nodes[a]}hasNode(a){return Object.hasOwn(this._nodes,a)}removeNode(a){var g=this;if(Object.hasOwn(this._nodes,a)){var h=p=>g.removeEdge(g._edgeObjs[p]);delete this._nodes[a],this._isCompound&&(this._removeFromParentsChildList(a),delete this._parent[a],this.children(a).forEach(function(p){g.setParent(p)}),delete this._children[a]),Object.keys(this._in[a]).forEach(h),delete this._in[a],delete this._preds[a],Object.keys(this._out[a]).forEach(h),delete this._out[a],delete this._sucs[a],--this._nodeCount}return this}setParent(a,g){if(!this._isCompound)throw Error("Cannot set parent in a non-compound graph");if(g===void 0)g=o;else{g+="";for(var h=g;h!==void 0;h=this.parent(h))if(h===a)throw Error("Setting "+g+" as parent of "+a+" would create a cycle");this.setNode(g)}return this.setNode(a),this._removeFromParentsChildList(a),this._parent[a]=g,this._children[g][a]=!0,this}_removeFromParentsChildList(a){delete this._children[this._parent[a]][a]}parent(a){if(this._isCompound){var g=this._parent[a];if(g!==o)return g}}children(a=o){if(this._isCompound){var g=this._children[a];if(g)return Object.keys(g)}else{if(a===o)return this.nodes();if(this.hasNode(a))return[]}}predecessors(a){var g=this._preds[a];if(g)return Object.keys(g)}successors(a){var g=this._sucs[a];if(g)return Object.keys(g)}neighbors(a){var g=this.predecessors(a);if(g){let p=new Set(g);for(var h of this.successors(a))p.add(h);return Array.from(p.values())}}isLeaf(a){return(this.isDirected()?this.successors(a):this.neighbors(a)).length===0}filterNodes(a){var g=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});g.setGraph(this.graph());var h=this;Object.entries(this._nodes).forEach(function([v,b]){a(v)&&g.setNode(v,b)}),Object.values(this._edgeObjs).forEach(function(v){g.hasNode(v.v)&&g.hasNode(v.w)&&g.setEdge(v,h.edge(v))});var p={};function m(v){var b=h.parent(v);return b===void 0||g.hasNode(b)?(p[v]=b,b):b in p?p[b]:m(b)}return this._isCompound&&g.nodes().forEach(v=>g.setParent(v,m(v))),g}setDefaultEdgeLabel(a){return this._defaultEdgeLabelFn=a,typeof a!="function"&&(this._defaultEdgeLabelFn=()=>a),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(a,g){var h=this,p=arguments;return a.reduce(function(m,v){return p.length>1?h.setEdge(m,v,g):h.setEdge(m,v),v}),this}setEdge(){var a,g,h,p,m=!1,v=arguments[0];typeof v=="object"&&v&&"v"in v?(a=v.v,g=v.w,h=v.name,arguments.length===2&&(p=arguments[1],m=!0)):(a=v,g=arguments[1],h=arguments[3],arguments.length>2&&(p=arguments[2],m=!0)),a=""+a,g=""+g,h!==void 0&&(h=""+h);var b=s(this._isDirected,a,g,h);if(Object.hasOwn(this._edgeLabels,b))return m&&(this._edgeLabels[b]=p),this;if(h!==void 0&&!this._isMultigraph)throw Error("Cannot set a named edge when isMultigraph = false");this.setNode(a),this.setNode(g),this._edgeLabels[b]=m?p:this._defaultEdgeLabelFn(a,g,h);var x=u(this._isDirected,a,g,h);return a=x.v,g=x.w,Object.freeze(x),this._edgeObjs[b]=x,r(this._preds[g],a),r(this._sucs[a],g),this._in[g][b]=x,this._out[a][b]=x,this._edgeCount++,this}edge(a,g,h){var p=arguments.length===1?c(this._isDirected,arguments[0]):s(this._isDirected,a,g,h);return this._edgeLabels[p]}edgeAsObj(){let a=this.edge(...arguments);return typeof a=="object"?a:{label:a}}hasEdge(a,g,h){var p=arguments.length===1?c(this._isDirected,arguments[0]):s(this._isDirected,a,g,h);return Object.hasOwn(this._edgeLabels,p)}removeEdge(a,g,h){var p=arguments.length===1?c(this._isDirected,arguments[0]):s(this._isDirected,a,g,h),m=this._edgeObjs[p];return m&&(a=m.v,g=m.w,delete this._edgeLabels[p],delete this._edgeObjs[p],l(this._preds[g],a),l(this._sucs[a],g),delete this._in[g][p],delete this._out[a][p],this._edgeCount--),this}inEdges(a,g){var h=this._in[a];if(h){var p=Object.values(h);return g?p.filter(m=>m.v===g):p}}outEdges(a,g){var h=this._out[a];if(h){var p=Object.values(h);return g?p.filter(m=>m.w===g):p}}nodeEdges(a,g){var h=this.inEdges(a,g);if(h)return h.concat(this.outEdges(a,g))}};function r(a,g){a[g]?a[g]++:a[g]=1}function l(a,g){--a[g]||delete a[g]}function s(a,g,h,p){var m=""+g,v=""+h;if(!a&&m>v){var b=m;m=v,v=b}return m+i+v+i+(p===void 0?n:p)}function u(a,g,h,p){var m=""+g,v=""+h;if(!a&&m>v){var b=m;m=v,v=b}var x={v:m,w:v};return p&&(x.name=p),x}function c(a,g){return s(a,g.v,g.w,g.name)}e.exports=d})),qs=q(((t,e)=>{e.exports="2.2.4"})),Qs=q(((t,e)=>{e.exports={Graph:un(),version:qs()}})),Js=q(((t,e)=>{var n=un();e.exports={write:o,read:r};function o(l){var s={options:{directed:l.isDirected(),multigraph:l.isMultigraph(),compound:l.isCompound()},nodes:i(l),edges:d(l)};return l.graph()!==void 0&&(s.value=structuredClone(l.graph())),s}function i(l){return l.nodes().map(function(s){var u=l.node(s),c=l.parent(s),a={v:s};return u!==void 0&&(a.value=u),c!==void 0&&(a.parent=c),a})}function d(l){return l.edges().map(function(s){var u=l.edge(s),c={v:s.v,w:s.w};return s.name!==void 0&&(c.name=s.name),u!==void 0&&(c.value=u),c})}function r(l){var s=new n(l.options).setGraph(l.value);return l.nodes.forEach(function(u){s.setNode(u.v,u.value),u.parent&&s.setParent(u.v,u.parent)}),l.edges.forEach(function(u){s.setEdge({v:u.v,w:u.w,name:u.name},u.value)}),s}})),el=q(((t,e)=>{e.exports=n;function n(o){var i={},d=[],r;function l(s){Object.hasOwn(i,s)||(i[s]=!0,r.push(s),o.successors(s).forEach(l),o.predecessors(s).forEach(l))}return o.nodes().forEach(function(s){r=[],l(s),r.length&&d.push(r)}),d}})),qo=q(((t,e)=>{e.exports=class{constructor(){ie(this,"_arr",[]);ie(this,"_keyIndices",{})}size(){return this._arr.length}keys(){return this._arr.map(function(n){return n.key})}has(n){return Object.hasOwn(this._keyIndices,n)}priority(n){var o=this._keyIndices[n];if(o!==void 0)return this._arr[o].priority}min(){if(this.size()===0)throw Error("Queue underflow");return this._arr[0].key}add(n,o){var i=this._keyIndices;if(n=String(n),!Object.hasOwn(i,n)){var d=this._arr,r=d.length;return i[n]=r,d.push({key:n,priority:o}),this._decrease(r),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var n=this._arr.pop();return delete this._keyIndices[n.key],this._heapify(0),n.key}decrease(n,o){var i=this._keyIndices[n];if(o>this._arr[i].priority)throw Error("New priority is greater than current priority. Key: "+n+" Old: "+this._arr[i].priority+" New: "+o);this._arr[i].priority=o,this._decrease(i)}_heapify(n){var o=this._arr,i=2*n,d=i+1,r=n;i<o.length&&(r=o[i].priority<o[r].priority?i:r,d<o.length&&(r=o[d].priority<o[r].priority?d:r),r!==n&&(this._swap(n,r),this._heapify(r)))}_decrease(n){for(var o=this._arr,i=o[n].priority,d;n!==0&&(d=n>>1,!(o[d].priority<i));)this._swap(n,d),n=d}_swap(n,o){var i=this._arr,d=this._keyIndices,r=i[n],l=i[o];i[n]=l,i[o]=r,d[l.key]=n,d[r.key]=o}}})),Qo=q(((t,e)=>{var n=qo();e.exports=i;var o=()=>1;function i(r,l,s,u){return d(r,String(l),s||o,u||function(c){return r.outEdges(c)})}function d(r,l,s,u){var c={},a=new n,g,h,p=function(m){var v=m.v===g?m.w:m.v,b=c[v],x=s(m),_=h.distance+x;if(x<0)throw Error("dijkstra does not allow negative edge weights. Bad edge: "+m+" Weight: "+x);_<b.distance&&(b.distance=_,b.predecessor=g,a.decrease(v,_))};for(r.nodes().forEach(function(m){var v=m===l?0:1/0;c[m]={distance:v},a.add(m,v)});a.size()>0&&(g=a.removeMin(),h=c[g],h.distance!==1/0);)u(g).forEach(p);return c}})),tl=q(((t,e)=>{var n=Qo();e.exports=o;function o(i,d,r){return i.nodes().reduce(function(l,s){return l[s]=n(i,s,d,r),l},{})}})),Jo=q(((t,e)=>{e.exports=n;function n(o){var i=0,d=[],r={},l=[];function s(u){var c=r[u]={onStack:!0,lowlink:i,index:i++};if(d.push(u),o.successors(u).forEach(function(h){Object.hasOwn(r,h)?r[h].onStack&&(c.lowlink=Math.min(c.lowlink,r[h].index)):(s(h),c.lowlink=Math.min(c.lowlink,r[h].lowlink))}),c.lowlink===c.index){var a=[],g;do g=d.pop(),r[g].onStack=!1,a.push(g);while(u!==g);l.push(a)}}return o.nodes().forEach(function(u){Object.hasOwn(r,u)||s(u)}),l}})),nl=q(((t,e)=>{var n=Jo();e.exports=o;function o(i){return n(i).filter(function(d){return d.length>1||d.length===1&&i.hasEdge(d[0],d[0])})}})),ol=q(((t,e)=>{e.exports=o;var n=()=>1;function o(d,r,l){return i(d,r||n,l||function(s){return d.outEdges(s)})}function i(d,r,l){var s={},u=d.nodes();return u.forEach(function(c){s[c]={},s[c][c]={distance:0},u.forEach(function(a){c!==a&&(s[c][a]={distance:1/0})}),l(c).forEach(function(a){var g=a.v===c?a.w:a.v,h=r(a);s[c][g]={distance:h,predecessor:c}})}),u.forEach(function(c){var a=s[c];u.forEach(function(g){var h=s[g];u.forEach(function(p){var m=h[c],v=a[p],b=h[p],x=m.distance+v.distance;x<b.distance&&(b.distance=x,b.predecessor=v.predecessor)})})}),s}})),er=q(((t,e)=>{function n(i){var d={},r={},l=[];function s(u){if(Object.hasOwn(r,u))throw new o;Object.hasOwn(d,u)||(r[u]=!0,d[u]=!0,i.predecessors(u).forEach(s),delete r[u],l.push(u))}if(i.sinks().forEach(s),Object.keys(d).length!==i.nodeCount())throw new o;return l}var o=class extends Error{constructor(){super(...arguments)}};e.exports=n,n.CycleException=o})),rl=q(((t,e)=>{var n=er();e.exports=o;function o(i){try{n(i)}catch(d){if(d instanceof n.CycleException)return!1;throw d}return!0}})),tr=q(((t,e)=>{e.exports=n;function n(r,l,s){Array.isArray(l)||(l=[l]);var u=r.isDirected()?h=>r.successors(h):h=>r.neighbors(h),c=s==="post"?o:i,a=[],g={};return l.forEach(h=>{if(!r.hasNode(h))throw Error("Graph does not have node: "+h);c(h,u,g,a)}),a}function o(r,l,s,u){for(var c=[[r,!1]];c.length>0;){var a=c.pop();a[1]?u.push(a[0]):Object.hasOwn(s,a[0])||(s[a[0]]=!0,c.push([a[0],!0]),d(l(a[0]),g=>c.push([g,!1])))}}function i(r,l,s,u){for(var c=[r];c.length>0;){var a=c.pop();Object.hasOwn(s,a)||(s[a]=!0,u.push(a),d(l(a),g=>c.push(g)))}}function d(r,l){for(var s=r.length;s--;)l(r[s],s,r);return r}})),al=q(((t,e)=>{var n=tr();e.exports=o;function o(i,d){return n(i,d,"post")}})),il=q(((t,e)=>{var n=tr();e.exports=o;function o(i,d){return n(i,d,"pre")}})),sl=q(((t,e)=>{var n=un(),o=qo();e.exports=i;function i(d,r){var l=new n,s={},u=new o,c;function a(h){var p=h.v===c?h.w:h.v,m=u.priority(p);if(m!==void 0){var v=r(h);v<m&&(s[p]=c,u.decrease(p,v))}}if(d.nodeCount()===0)return l;d.nodes().forEach(function(h){u.add(h,1/0),l.setNode(h)}),u.decrease(d.nodes()[0],0);for(var g=!1;u.size()>0;){if(c=u.removeMin(),Object.hasOwn(s,c))l.setEdge(c,s[c]);else{if(g)throw Error("Input graph is not connected: "+d);g=!0}d.nodeEdges(c).forEach(a)}return l}})),ll=q(((t,e)=>{e.exports={components:el(),dijkstra:Qo(),dijkstraAll:tl(),findCycles:nl(),floydWarshall:ol(),isAcyclic:rl(),postorder:al(),preorder:il(),prim:sl(),tarjan:Jo(),topsort:er()}})),be=q(((t,e)=>{var n=Qs();e.exports={Graph:n.Graph,json:Js(),alg:ll(),version:n.version}})),dl=q(((t,e)=>{var n=class{constructor(){let d={};d._next=d._prev=d,this._sentinel=d}dequeue(){let d=this._sentinel,r=d._prev;if(r!==d)return o(r),r}enqueue(d){let r=this._sentinel;d._prev&&d._next&&o(d),d._next=r._next,r._next._prev=d,r._next=d,d._prev=r}toString(){let d=[],r=this._sentinel,l=r._prev;for(;l!==r;)d.push(JSON.stringify(l,i)),l=l._prev;return"["+d.join(", ")+"]"}};function o(d){d._prev._next=d._next,d._next._prev=d._prev,delete d._next,delete d._prev}function i(d,r){if(d!=="_next"&&d!=="_prev")return r}e.exports=n})),cl=q(((t,e)=>{var n=be().Graph,o=dl();e.exports=d;var i=()=>1;function d(a,g){if(a.nodeCount()<=1)return[];let h=s(a,g||i);return r(h.graph,h.buckets,h.zeroIdx).flatMap(p=>a.outEdges(p.v,p.w))}function r(a,g,h){let p=[],m=g[g.length-1],v=g[0],b;for(;a.nodeCount();){for(;b=v.dequeue();)l(a,g,h,b);for(;b=m.dequeue();)l(a,g,h,b);if(a.nodeCount()){for(let x=g.length-2;x>0;--x)if(b=g[x].dequeue(),b){p=p.concat(l(a,g,h,b,!0));break}}}return p}function l(a,g,h,p,m){let v=m?[]:void 0;return a.inEdges(p.v).forEach(b=>{let x=a.edge(b),_=a.node(b.v);m&&v.push({v:b.v,w:b.w}),_.out-=x,u(g,h,_)}),a.outEdges(p.v).forEach(b=>{let x=a.edge(b),_=b.w,f=a.node(_);f.in-=x,u(g,h,f)}),a.removeNode(p.v),v}function s(a,g){let h=new n,p=0,m=0;a.nodes().forEach(x=>{h.setNode(x,{v:x,in:0,out:0})}),a.edges().forEach(x=>{let _=h.edge(x.v,x.w)||0,f=g(x),C=_+f;h.setEdge(x.v,x.w,C),m=Math.max(m,h.node(x.v).out+=f),p=Math.max(p,h.node(x.w).in+=f)});let v=c(m+p+3).map(()=>new o),b=p+1;return h.nodes().forEach(x=>{u(v,b,h.node(x))}),{graph:h,buckets:v,zeroIdx:b}}function u(a,g,h){h.out?h.in?a[h.out-h.in+g].enqueue(h):a[a.length-1].enqueue(h):a[0].enqueue(h)}function c(a){let g=[];for(let h=0;h<a;h++)g.push(h);return g}})),se=q(((t,e)=>{var n=be().Graph;e.exports={addBorderNode:g,addDummyNode:o,applyWithChunking:m,asNonCompoundGraph:d,buildLayerMatrix:u,intersectRect:s,mapValues:D,maxRank:v,normalizeRanks:c,notime:_,partition:b,pick:O,predecessorWeights:l,range:k,removeEmptyRanks:a,simplify:i,successorWeights:r,time:x,uniqueId:C,zipObject:P};function o(E,w,M,N){for(var S=N;E.hasNode(S);)S=C(N);return M.dummy=w,E.setNode(S,M),S}function i(E){let w=new n().setGraph(E.graph());return E.nodes().forEach(M=>w.setNode(M,E.node(M))),E.edges().forEach(M=>{let N=w.edge(M.v,M.w)||{weight:0,minlen:1},S=E.edge(M);w.setEdge(M.v,M.w,{weight:N.weight+S.weight,minlen:Math.max(N.minlen,S.minlen)})}),w}function d(E){let w=new n({multigraph:E.isMultigraph()}).setGraph(E.graph());return E.nodes().forEach(M=>{E.children(M).length||w.setNode(M,E.node(M))}),E.edges().forEach(M=>{w.setEdge(M,E.edge(M))}),w}function r(E){let w=E.nodes().map(M=>{let N={};return E.outEdges(M).forEach(S=>{N[S.w]=(N[S.w]||0)+E.edge(S).weight}),N});return P(E.nodes(),w)}function l(E){let w=E.nodes().map(M=>{let N={};return E.inEdges(M).forEach(S=>{N[S.v]=(N[S.v]||0)+E.edge(S).weight}),N});return P(E.nodes(),w)}function s(E,w){let M=E.x,N=E.y,S=w.x-M,R=w.y-N,B=E.width/2,L=E.height/2;if(!S&&!R)throw Error("Not possible to find intersection inside of the rectangle");let V,j;return Math.abs(R)*B>Math.abs(S)*L?(R<0&&(L=-L),V=L*S/R,j=L):(S<0&&(B=-B),V=B,j=B*R/S),{x:M+V,y:N+j}}function u(E){let w=k(v(E)+1).map(()=>[]);return E.nodes().forEach(M=>{let N=E.node(M),S=N.rank;S!==void 0&&(w[S][N.order]=M)}),w}function c(E){let w=E.nodes().map(N=>{let S=E.node(N).rank;return S===void 0?Number.MAX_VALUE:S}),M=m(Math.min,w);E.nodes().forEach(N=>{let S=E.node(N);Object.hasOwn(S,"rank")&&(S.rank-=M)})}function a(E){let w=E.nodes().map(B=>E.node(B).rank),M=m(Math.min,w),N=[];E.nodes().forEach(B=>{let L=E.node(B).rank-M;N[L]||(N[L]=[]),N[L].push(B)});let S=0,R=E.graph().nodeRankFactor;Array.from(N).forEach((B,L)=>{B===void 0&&L%R!==0?--S:B!==void 0&&S&&B.forEach(V=>E.node(V).rank+=S)})}function g(E,w,M,N){let S={width:0,height:0};return arguments.length>=4&&(S.rank=M,S.order=N),o(E,"border",S,w)}function h(E,w=p){let M=[];for(let N=0;N<E.length;N+=w){let S=E.slice(N,N+w);M.push(S)}return M}var p=65535;function m(E,w){if(w.length>p){let M=h(w);return E.apply(null,M.map(N=>E.apply(null,N)))}else return E.apply(null,w)}function v(E){let w=E.nodes().map(M=>{let N=E.node(M).rank;return N===void 0?Number.MIN_VALUE:N});return m(Math.max,w)}function b(E,w){let M={lhs:[],rhs:[]};return E.forEach(N=>{w(N)?M.lhs.push(N):M.rhs.push(N)}),M}function x(E,w){let M=Date.now();try{return w()}finally{console.log(E+" time: "+(Date.now()-M)+"ms")}}function _(E,w){return w()}var f=0;function C(E){var w=++f;return E+(""+w)}function k(E,w,M=1){w??(w=E,E=0);let N=R=>R<w;M<0&&(N=R=>w<R);let S=[];for(let R=E;N(R);R+=M)S.push(R);return S}function O(E,w){let M={};for(let N of w)E[N]!==void 0&&(M[N]=E[N]);return M}function D(E,w){let M=w;return typeof w=="string"&&(M=N=>N[w]),Object.entries(E).reduce((N,[S,R])=>(N[S]=M(R,S),N),{})}function P(E,w){return E.reduce((M,N,S)=>(M[N]=w[S],M),{})}})),ul=q(((t,e)=>{var n=cl(),o=se().uniqueId;e.exports={run:i,undo:r};function i(l){(l.graph().acyclicer==="greedy"?n(l,s(l)):d(l)).forEach(u=>{let c=l.edge(u);l.removeEdge(u),c.forwardName=u.name,c.reversed=!0,l.setEdge(u.w,u.v,c,o("rev"))});function s(u){return c=>u.edge(c).weight}}function d(l){let s=[],u={},c={};function a(g){Object.hasOwn(c,g)||(c[g]=!0,u[g]=!0,l.outEdges(g).forEach(h=>{Object.hasOwn(u,h.w)?s.push(h):a(h.w)}),delete u[g])}return l.nodes().forEach(a),s}function r(l){l.edges().forEach(s=>{let u=l.edge(s);if(u.reversed){l.removeEdge(s);let c=u.forwardName;delete u.reversed,delete u.forwardName,l.setEdge(s.w,s.v,u,c)}})}})),hl=q(((t,e)=>{var n=se();e.exports={run:o,undo:d};function o(r){r.graph().dummyChains=[],r.edges().forEach(l=>i(r,l))}function i(r,l){let s=l.v,u=r.node(s).rank,c=l.w,a=r.node(c).rank,g=l.name,h=r.edge(l),p=h.labelRank;if(a===u+1)return;r.removeEdge(l);let m,v,b;for(b=0,++u;u<a;++b,++u)h.points=[],v={width:0,height:0,edgeLabel:h,edgeObj:l,rank:u},m=n.addDummyNode(r,"edge",v,"_d"),u===p&&(v.width=h.width,v.height=h.height,v.dummy="edge-label",v.labelpos=h.labelpos),r.setEdge(s,m,{weight:h.weight},g),b===0&&r.graph().dummyChains.push(m),s=m;r.setEdge(s,c,{weight:h.weight},g)}function d(r){r.graph().dummyChains.forEach(l=>{let s=r.node(l),u=s.edgeLabel,c;for(r.setEdge(s.edgeObj,u);s.dummy;)c=r.successors(l)[0],r.removeNode(l),u.points.push({x:s.x,y:s.y}),s.dummy==="edge-label"&&(u.x=s.x,u.y=s.y,u.width=s.width,u.height=s.height),l=c,s=r.node(l)})}})),_t=q(((t,e)=>{var{applyWithChunking:n}=se();e.exports={longestPath:o,slack:i};function o(d){var r={};function l(s){var u=d.node(s);if(Object.hasOwn(r,s))return u.rank;r[s]=!0;let c=d.outEdges(s).map(g=>g==null?1/0:l(g.w)-d.edge(g).minlen);var a=n(Math.min,c);return a===1/0&&(a=0),u.rank=a}d.sources().forEach(l)}function i(d,r){return d.node(r.w).rank-d.node(r.v).rank-d.edge(r).minlen}})),nr=q(((t,e)=>{var n=be().Graph,o=_t().slack;e.exports=i;function i(s){var u=new n({directed:!1}),c=s.nodes()[0],a=s.nodeCount();u.setNode(c,{});for(var g,h;d(u,s)<a;)g=r(u,s),h=u.hasNode(g.v)?o(s,g):-o(s,g),l(u,s,h);return u}function d(s,u){function c(a){u.nodeEdges(a).forEach(g=>{var h=g.v,p=a===h?g.w:h;!s.hasNode(p)&&!o(u,g)&&(s.setNode(p,{}),s.setEdge(a,p,{}),c(p))})}return s.nodes().forEach(c),s.nodeCount()}function r(s,u){return u.edges().reduce((c,a)=>{let g=1/0;return s.hasNode(a.v)!==s.hasNode(a.w)&&(g=o(u,a)),g<c[0]?[g,a]:c},[1/0,null])[1]}function l(s,u,c){s.nodes().forEach(a=>u.node(a).rank+=c)}})),gl=q(((t,e)=>{var n=nr(),o=_t().slack,i=_t().longestPath,d=be().alg.preorder,r=be().alg.postorder,l=se().simplify;e.exports=s,s.initLowLimValues=g,s.initCutValues=u,s.calcCutValue=a,s.leaveEdge=p,s.enterEdge=m,s.exchangeEdges=v;function s(f){f=l(f),i(f);var C=n(f);g(C),u(C,f);for(var k,O;k=p(C);)O=m(C,f,k),v(C,f,k,O)}function u(f,C){var k=r(f,f.nodes());k=k.slice(0,k.length-1),k.forEach(O=>c(f,C,O))}function c(f,C,k){var O=f.node(k).parent;f.edge(k,O).cutvalue=a(f,C,k)}function a(f,C,k){var O=f.node(k).parent,D=!0,P=C.edge(k,O),E=0;return P||(P=(D=!1,C.edge(O,k))),E=P.weight,C.nodeEdges(k).forEach(w=>{var M=w.v===k,N=M?w.w:w.v;if(N!==O){var S=M===D,R=C.edge(w).weight;if(E+=S?R:-R,x(f,k,N)){var B=f.edge(k,N).cutvalue;E+=S?-B:B}}}),E}function g(f,C){arguments.length<2&&(C=f.nodes()[0]),h(f,{},1,C)}function h(f,C,k,O,D){var P=k,E=f.node(O);return C[O]=!0,f.neighbors(O).forEach(w=>{Object.hasOwn(C,w)||(k=h(f,C,k,w,O))}),E.low=P,E.lim=k++,D?E.parent=D:delete E.parent,k}function p(f){return f.edges().find(C=>f.edge(C).cutvalue<0)}function m(f,C,k){var O=k.v,D=k.w;C.hasEdge(O,D)||(O=k.w,D=k.v);var P=f.node(O),E=f.node(D),w=P,M=!1;return P.lim>E.lim&&(w=E,M=!0),C.edges().filter(N=>M===_(f,f.node(N.v),w)&&M!==_(f,f.node(N.w),w)).reduce((N,S)=>o(C,S)<o(C,N)?S:N)}function v(f,C,k,O){var D=k.v,P=k.w;f.removeEdge(D,P),f.setEdge(O.v,O.w,{}),g(f),u(f,C),b(f,C)}function b(f,C){var k=f.nodes().find(D=>!C.node(D).parent),O=d(f,k);O=O.slice(1),O.forEach(D=>{var P=f.node(D).parent,E=C.edge(D,P),w=!1;E||(E=C.edge(P,D),w=!0),C.node(D).rank=C.node(P).rank+(w?E.minlen:-E.minlen)})}function x(f,C,k){return f.hasEdge(C,k)}function _(f,C,k){return k.low<=C.lim&&C.lim<=k.lim}})),ml=q(((t,e)=>{var n=_t().longestPath,o=nr(),i=gl();e.exports=d;function d(u){var c=u.graph().ranker;if(c instanceof Function)return c(u);switch(u.graph().ranker){case"network-simplex":s(u);break;case"tight-tree":l(u);break;case"longest-path":r(u);break;case"none":break;default:s(u)}}var r=n;function l(u){n(u),o(u)}function s(u){i(u)}})),fl=q(((t,e)=>{e.exports=n;function n(d){let r=i(d);d.graph().dummyChains.forEach(l=>{let s=d.node(l),u=s.edgeObj,c=o(d,r,u.v,u.w),a=c.path,g=c.lca,h=0,p=a[h],m=!0;for(;l!==u.w;){if(s=d.node(l),m){for(;(p=a[h])!==g&&d.node(p).maxRank<s.rank;)h++;p===g&&(m=!1)}if(!m){for(;h<a.length-1&&d.node(p=a[h+1]).minRank<=s.rank;)h++;p=a[h]}d.setParent(l,p),l=d.successors(l)[0]}})}function o(d,r,l,s){let u=[],c=[],a=Math.min(r[l].low,r[s].low),g=Math.max(r[l].lim,r[s].lim),h,p;h=l;do h=d.parent(h),u.push(h);while(h&&(r[h].low>a||g>r[h].lim));for(p=h,h=s;(h=d.parent(h))!==p;)c.push(h);return{path:u.concat(c.reverse()),lca:p}}function i(d){let r={},l=0;function s(u){let c=l;d.children(u).forEach(s),r[u]={low:c,lim:l++}}return d.children().forEach(s),r}})),pl=q(((t,e)=>{var n=se();e.exports={run:o,cleanup:l};function o(s){let u=n.addDummyNode(s,"root",{},"_root"),c=d(s),a=Object.values(c),g=n.applyWithChunking(Math.max,a)-1,h=2*g+1;s.graph().nestingRoot=u,s.edges().forEach(m=>s.edge(m).minlen*=h);let p=r(s)+1;s.children().forEach(m=>i(s,u,h,p,g,c,m)),s.graph().nodeRankFactor=h}function i(s,u,c,a,g,h,p){let m=s.children(p);if(!m.length){p!==u&&s.setEdge(u,p,{weight:0,minlen:c});return}let v=n.addBorderNode(s,"_bt"),b=n.addBorderNode(s,"_bb"),x=s.node(p);s.setParent(v,p),x.borderTop=v,s.setParent(b,p),x.borderBottom=b,m.forEach(_=>{i(s,u,c,a,g,h,_);let f=s.node(_),C=f.borderTop?f.borderTop:_,k=f.borderBottom?f.borderBottom:_,O=f.borderTop?a:2*a,D=C===k?g-h[p]+1:1;s.setEdge(v,C,{weight:O,minlen:D,nestingEdge:!0}),s.setEdge(k,b,{weight:O,minlen:D,nestingEdge:!0})}),s.parent(p)||s.setEdge(u,v,{weight:0,minlen:g+h[p]})}function d(s){var u={};function c(a,g){var h=s.children(a);h&&h.length&&h.forEach(p=>c(p,g+1)),u[a]=g}return s.children().forEach(a=>c(a,1)),u}function r(s){return s.edges().reduce((u,c)=>u+s.edge(c).weight,0)}function l(s){var u=s.graph();s.removeNode(u.nestingRoot),delete u.nestingRoot,s.edges().forEach(c=>{s.edge(c).nestingEdge&&s.removeEdge(c)})}})),yl=q(((t,e)=>{var n=se();e.exports=o;function o(d){function r(l){let s=d.children(l),u=d.node(l);if(s.length&&s.forEach(r),Object.hasOwn(u,"minRank")){u.borderLeft=[],u.borderRight=[];for(let c=u.minRank,a=u.maxRank+1;c<a;++c)i(d,"borderLeft","_bl",l,u,c),i(d,"borderRight","_br",l,u,c)}}d.children().forEach(r)}function i(d,r,l,s,u,c){let a={width:0,height:0,rank:c,borderType:r},g=u[r][c-1],h=n.addDummyNode(d,"border",a,l);u[r][c]=h,d.setParent(h,s),g&&d.setEdge(g,h,{weight:1})}})),vl=q(((t,e)=>{e.exports={adjust:n,undo:o};function n(c){let a=c.graph().rankdir.toLowerCase();(a==="lr"||a==="rl")&&i(c)}function o(c){let a=c.graph().rankdir.toLowerCase();(a==="bt"||a==="rl")&&r(c),(a==="lr"||a==="rl")&&(s(c),i(c))}function i(c){c.nodes().forEach(a=>d(c.node(a))),c.edges().forEach(a=>d(c.edge(a)))}function d(c){let a=c.width;c.width=c.height,c.height=a}function r(c){c.nodes().forEach(a=>l(c.node(a))),c.edges().forEach(a=>{let g=c.edge(a);g.points.forEach(l),Object.hasOwn(g,"y")&&l(g)})}function l(c){c.y=-c.y}function s(c){c.nodes().forEach(a=>u(c.node(a))),c.edges().forEach(a=>{let g=c.edge(a);g.points.forEach(u),Object.hasOwn(g,"x")&&u(g)})}function u(c){let a=c.x;c.x=c.y,c.y=a}})),bl=q(((t,e)=>{var n=se();e.exports=o;function o(i){let d={},r=i.nodes().filter(a=>!i.children(a).length),l=r.map(a=>i.node(a).rank),s=n.applyWithChunking(Math.max,l),u=n.range(s+1).map(()=>[]);function c(a){if(d[a])return;d[a]=!0;let g=i.node(a);u[g.rank].push(a),i.successors(a).forEach(c)}return r.sort((a,g)=>i.node(a).rank-i.node(g).rank).forEach(c),u}})),xl=q(((t,e)=>{var n=se().zipObject;e.exports=o;function o(d,r){let l=0;for(let s=1;s<r.length;++s)l+=i(d,r[s-1],r[s]);return l}function i(d,r,l){let s=n(l,l.map((p,m)=>m)),u=r.flatMap(p=>d.outEdges(p).map(m=>({pos:s[m.w],weight:d.edge(m).weight})).sort((m,v)=>m.pos-v.pos)),c=1;for(;c<l.length;)c<<=1;let a=2*c-1;--c;let g=Array(a).fill(0),h=0;return u.forEach(p=>{let m=p.pos+c;g[m]+=p.weight;let v=0;for(;m>0;)m%2&&(v+=g[m+1]),m=m-1>>1,g[m]+=p.weight;h+=p.weight*v}),h}})),El=q(((t,e)=>{e.exports=n;function n(o,i=[]){return i.map(d=>{let r=o.inEdges(d);if(r.length){let l=r.reduce((s,u)=>{let c=o.edge(u),a=o.node(u.v);return{sum:s.sum+c.weight*a.order,weight:s.weight+c.weight}},{sum:0,weight:0});return{v:d,barycenter:l.sum/l.weight,weight:l.weight}}else return{v:d}})}})),wl=q(((t,e)=>{var n=se();e.exports=o;function o(r,l){let s={};r.forEach((c,a)=>{let g=s[c.v]={indegree:0,in:[],out:[],vs:[c.v],i:a};c.barycenter!==void 0&&(g.barycenter=c.barycenter,g.weight=c.weight)}),l.edges().forEach(c=>{let a=s[c.v],g=s[c.w];a!==void 0&&g!==void 0&&(g.indegree++,a.out.push(s[c.w]))});let u=Object.values(s).filter(c=>!c.indegree);return i(u)}function i(r){let l=[];function s(c){return a=>{a.merged||(a.barycenter===void 0||c.barycenter===void 0||a.barycenter>=c.barycenter)&&d(c,a)}}function u(c){return a=>{a.in.push(c),--a.indegree===0&&r.push(a)}}for(;r.length;){let c=r.pop();l.push(c),c.in.reverse().forEach(s(c)),c.out.forEach(u(c))}return l.filter(c=>!c.merged).map(c=>n.pick(c,["vs","i","barycenter","weight"]))}function d(r,l){let s=0,u=0;r.weight&&(s+=r.barycenter*r.weight,u+=r.weight),l.weight&&(s+=l.barycenter*l.weight,u+=l.weight),r.vs=l.vs.concat(r.vs),r.barycenter=s/u,r.weight=u,r.i=Math.min(l.i,r.i),l.merged=!0}})),Sl=q(((t,e)=>{var n=se();e.exports=o;function o(r,l){let s=n.partition(r,v=>Object.hasOwn(v,"barycenter")),u=s.lhs,c=s.rhs.sort((v,b)=>b.i-v.i),a=[],g=0,h=0,p=0;u.sort(d(!!l)),p=i(a,c,p),u.forEach(v=>{p+=v.vs.length,a.push(v.vs),g+=v.barycenter*v.weight,h+=v.weight,p=i(a,c,p)});let m={vs:a.flat(!0)};return h&&(m.barycenter=g/h,m.weight=h),m}function i(r,l,s){let u;for(;l.length&&(u=l[l.length-1]).i<=s;)l.pop(),r.push(u.vs),s++;return s}function d(r){return(l,s)=>l.barycenter<s.barycenter?-1:l.barycenter>s.barycenter?1:r?s.i-l.i:l.i-s.i}})),Cl=q(((t,e)=>{var n=El(),o=wl(),i=Sl();e.exports=d;function d(s,u,c,a){let g=s.children(u),h=s.node(u),p=h?h.borderLeft:void 0,m=h?h.borderRight:void 0,v={};p&&(g=g.filter(f=>f!==p&&f!==m));let b=n(s,g);b.forEach(f=>{if(s.children(f.v).length){let C=d(s,f.v,c,a);v[f.v]=C,Object.hasOwn(C,"barycenter")&&l(f,C)}});let x=o(b,c);r(x,v);let _=i(x,a);if(p&&(_.vs=[p,_.vs,m].flat(!0),s.predecessors(p).length)){let f=s.node(s.predecessors(p)[0]),C=s.node(s.predecessors(m)[0]);Object.hasOwn(_,"barycenter")||(_.barycenter=0,_.weight=0),_.barycenter=(_.barycenter*_.weight+f.order+C.order)/(_.weight+2),_.weight+=2}return _}function r(s,u){s.forEach(c=>{c.vs=c.vs.flatMap(a=>u[a]?u[a].vs:a)})}function l(s,u){s.barycenter===void 0?(s.barycenter=u.barycenter,s.weight=u.weight):(s.barycenter=(s.barycenter*s.weight+u.barycenter*u.weight)/(s.weight+u.weight),s.weight+=u.weight)}})),Nl=q(((t,e)=>{var n=be().Graph,o=se();e.exports=i;function i(r,l,s){let u=d(r),c=new n({compound:!0}).setGraph({root:u}).setDefaultNodeLabel(a=>r.node(a));return r.nodes().forEach(a=>{let g=r.node(a),h=r.parent(a);(g.rank===l||g.minRank<=l&&l<=g.maxRank)&&(c.setNode(a),c.setParent(a,h||u),r[s](a).forEach(p=>{let m=p.v===a?p.w:p.v,v=c.edge(m,a),b=v===void 0?0:v.weight;c.setEdge(m,a,{weight:r.edge(p).weight+b})}),Object.hasOwn(g,"minRank")&&c.setNode(a,{borderLeft:g.borderLeft[l],borderRight:g.borderRight[l]}))}),c}function d(r){for(var l;r.hasNode(l=o.uniqueId("_root")););return l}})),kl=q(((t,e)=>{e.exports=n;function n(o,i,d){let r={},l;d.forEach(s=>{let u=o.parent(s),c,a;for(;u;){if(c=o.parent(u),c?(a=r[c],r[c]=u):(a=l,l=u),a&&a!==u){i.setEdge(a,u);return}u=c}})}})),Ml=q(((t,e)=>{var n=bl(),o=xl(),i=Cl(),d=Nl(),r=kl(),l=be().Graph,s=se();e.exports=u;function u(h,p){if(p&&typeof p.customOrder=="function"){p.customOrder(h,u);return}let m=s.maxRank(h),v=c(h,s.range(1,m+1),"inEdges"),b=c(h,s.range(m-1,-1,-1),"outEdges"),x=n(h);if(g(h,x),p&&p.disableOptimalOrderHeuristic)return;let _=1/0,f;for(let C=0,k=0;k<4;++C,++k){a(C%2?v:b,C%4>=2),x=s.buildLayerMatrix(h);let O=o(h,x);O<_&&(k=0,f=Object.assign({},x),_=O)}g(h,f)}function c(h,p,m){return p.map(function(v){return d(h,v,m)})}function a(h,p){let m=new l;h.forEach(function(v){let b=v.graph().root,x=i(v,b,m,p);x.vs.forEach((_,f)=>v.node(_).order=f),r(v,m,x.vs)})}function g(h,p){Object.values(p).forEach(m=>m.forEach((v,b)=>h.node(v).order=b))}})),_l=q(((t,e)=>{var n=be().Graph,o=se();e.exports={positionX:m,findType1Conflicts:i,findType2Conflicts:d,addConflict:l,hasConflict:s,verticalAlignment:u,horizontalCompaction:c,alignCoordinates:h,findSmallestWidthAlignment:g,balance:p};function i(x,_){let f={};function C(k,O){let D=0,P=0,E=k.length,w=O[O.length-1];return O.forEach((M,N)=>{let S=r(x,M),R=S?x.node(S).order:E;(S||M===w)&&(O.slice(P,N+1).forEach(B=>{x.predecessors(B).forEach(L=>{let V=x.node(L),j=V.order;(j<D||R<j)&&!(V.dummy&&x.node(B).dummy)&&l(f,L,B)})}),P=N+1,D=R)}),O}return _.length&&_.reduce(C),f}function d(x,_){let f={};function C(O,D,P,E,w){let M;o.range(D,P).forEach(N=>{M=O[N],x.node(M).dummy&&x.predecessors(M).forEach(S=>{let R=x.node(S);R.dummy&&(R.order<E||R.order>w)&&l(f,S,M)})})}function k(O,D){let P=-1,E,w=0;return D.forEach((M,N)=>{if(x.node(M).dummy==="border"){let S=x.predecessors(M);S.length&&(E=x.node(S[0]).order,C(D,w,N,P,E),w=N,P=E)}C(D,w,D.length,E,O.length)}),D}return _.length&&_.reduce(k),f}function r(x,_){if(x.node(_).dummy)return x.predecessors(_).find(f=>x.node(f).dummy)}function l(x,_,f){if(_>f){let k=_;_=f,f=k}let C=x[_];C||(x[_]=C={}),C[f]=!0}function s(x,_,f){if(_>f){let C=_;_=f,f=C}return!!x[_]&&Object.hasOwn(x[_],f)}function u(x,_,f,C){let k={},O={},D={};return _.forEach(P=>{P.forEach((E,w)=>{k[E]=E,O[E]=E,D[E]=w})}),_.forEach(P=>{let E=-1;P.forEach(w=>{let M=C(w);if(M.length){M=M.sort((S,R)=>D[S]-D[R]);let N=(M.length-1)/2;for(let S=Math.floor(N),R=Math.ceil(N);S<=R;++S){let B=M[S];O[w]===w&&E<D[B]&&!s(f,w,B)&&(O[B]=w,O[w]=k[w]=k[B],E=D[B])}}})}),{root:k,align:O}}function c(x,_,f,C,k){let O={},D=a(x,_,f,k),P=k?"borderLeft":"borderRight";function E(N,S){let R=D.nodes(),B=R.pop(),L={};for(;B;)L[B]?N(B):(L[B]=!0,R.push(B),R=R.concat(S(B))),B=R.pop()}function w(N){O[N]=D.inEdges(N).reduce((S,R)=>Math.max(S,O[R.v]+D.edge(R)),0)}function M(N){let S=D.outEdges(N).reduce((B,L)=>Math.min(B,O[L.w]-D.edge(L)),1/0),R=x.node(N);S!==1/0&&R.borderType!==P&&(O[N]=Math.max(O[N],S))}return E(w,D.predecessors.bind(D)),E(M,D.successors.bind(D)),Object.keys(C).forEach(N=>O[N]=O[f[N]]),O}function a(x,_,f,C){let k=new n,O=x.graph(),D=v(O.nodesep,O.edgesep,C);return _.forEach(P=>{let E;P.forEach(w=>{let M=f[w];if(k.setNode(M),E){var N=f[E],S=k.edge(N,M);k.setEdge(N,M,Math.max(D(x,w,E),S||0))}E=w})}),k}function g(x,_){return Object.values(_).reduce((f,C)=>{let k=-1/0,O=1/0;Object.entries(C).forEach(([P,E])=>{let w=b(x,P)/2;k=Math.max(E+w,k),O=Math.min(E-w,O)});let D=k-O;return D<f[0]&&(f=[D,C]),f},[1/0,null])[1]}function h(x,_){let f=Object.values(_),C=o.applyWithChunking(Math.min,f),k=o.applyWithChunking(Math.max,f);["u","d"].forEach(O=>{["l","r"].forEach(D=>{let P=O+D,E=x[P];if(E===_)return;let w=Object.values(E),M=C-o.applyWithChunking(Math.min,w);D!=="l"&&(M=k-o.applyWithChunking(Math.max,w)),M&&(x[P]=o.mapValues(E,N=>N+M))})})}function p(x,_){return o.mapValues(x.ul,(f,C)=>{if(_)return x[_.toLowerCase()][C];{let k=Object.values(x).map(O=>O[C]).sort((O,D)=>O-D);return(k[1]+k[2])/2}})}function m(x){let _=o.buildLayerMatrix(x),f=Object.assign(i(x,_),d(x,_)),C={},k;["u","d"].forEach(D=>{k=D==="u"?_:Object.values(_).reverse(),["l","r"].forEach(P=>{P==="r"&&(k=k.map(N=>Object.values(N).reverse()));let E=(D==="u"?x.predecessors:x.successors).bind(x),w=u(x,k,f,E),M=c(x,k,w.root,w.align,P==="r");P==="r"&&(M=o.mapValues(M,N=>-N)),C[D+P]=M})});let O=g(x,C);return h(C,O),p(C,x.graph().align)}function v(x,_,f){return(C,k,O)=>{let D=C.node(k),P=C.node(O),E=0,w;if(E+=D.width/2,Object.hasOwn(D,"labelpos"))switch(D.labelpos.toLowerCase()){case"l":w=-D.width/2;break;case"r":w=D.width/2;break}if(w&&(E+=f?w:-w),w=0,E+=(D.dummy?_:x)/2,E+=(P.dummy?_:x)/2,E+=P.width/2,Object.hasOwn(P,"labelpos"))switch(P.labelpos.toLowerCase()){case"l":w=P.width/2;break;case"r":w=-P.width/2;break}return w&&(E+=f?w:-w),w=0,E}}function b(x,_){return x.node(_).width}})),Ol=q(((t,e)=>{var n=se(),o=_l().positionX;e.exports=i;function i(r){r=n.asNonCompoundGraph(r),d(r),Object.entries(o(r)).forEach(([l,s])=>r.node(l).x=s)}function d(r){let l=n.buildLayerMatrix(r),s=r.graph().ranksep,u=0;l.forEach(c=>{let a=c.reduce((g,h)=>{let p=r.node(h).height;return g>p?g:p},0);c.forEach(g=>r.node(g).y=u+a/2),u+=a+s})}})),Pl=q(((t,e)=>{var n=ul(),o=hl(),i=ml(),d=se().normalizeRanks,r=fl(),l=se().removeEmptyRanks,s=pl(),u=yl(),c=vl(),a=Ml(),g=Ol(),h=se(),p=be().Graph;e.exports=m;function m(I,A){let z=A&&A.debugTiming?h.time:h.notime;z("layout",()=>{let H=z("  buildLayoutGraph",()=>E(I));z("  runLayout",()=>v(H,z,A)),z("  updateInputGraph",()=>b(I,H))})}function v(I,A,z){A("    makeSpaceForEdgeLabels",()=>w(I)),A("    removeSelfEdges",()=>T(I)),A("    acyclic",()=>n.run(I)),A("    nestingGraph.run",()=>s.run(I)),A("    rank",()=>i(h.asNonCompoundGraph(I))),A("    injectEdgeLabelProxies",()=>M(I)),A("    removeEmptyRanks",()=>l(I)),A("    nestingGraph.cleanup",()=>s.cleanup(I)),A("    normalizeRanks",()=>d(I)),A("    assignRankMinMax",()=>N(I)),A("    removeEdgeLabelProxies",()=>S(I)),A("    normalize.run",()=>o.run(I)),A("    parentDummyChains",()=>r(I)),A("    addBorderSegments",()=>u(I)),A("    order",()=>a(I,z)),A("    insertSelfEdges",()=>F(I)),A("    adjustCoordinateSystem",()=>c.adjust(I)),A("    position",()=>g(I)),A("    positionSelfEdges",()=>X(I)),A("    removeBorderNodes",()=>j(I)),A("    normalize.undo",()=>o.undo(I)),A("    fixupEdgeLabelCoords",()=>L(I)),A("    undoCoordinateSystem",()=>c.undo(I)),A("    translateGraph",()=>R(I)),A("    assignNodeIntersects",()=>B(I)),A("    reversePoints",()=>V(I)),A("    acyclic.undo",()=>n.undo(I))}function b(I,A){I.nodes().forEach(z=>{let H=I.node(z),K=A.node(z);H&&(H.x=K.x,H.y=K.y,H.rank=K.rank,A.children(z).length&&(H.width=K.width,H.height=K.height))}),I.edges().forEach(z=>{let H=I.edge(z),K=A.edge(z);H.points=K.points,Object.hasOwn(K,"x")&&(H.x=K.x,H.y=K.y)}),I.graph().width=A.graph().width,I.graph().height=A.graph().height}var x=["nodesep","edgesep","ranksep","marginx","marginy"],_={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},f=["acyclicer","ranker","rankdir","align"],C=["width","height","rank"],k={width:0,height:0},O=["minlen","weight","width","height","labeloffset"],D={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},P=["labelpos"];function E(I){let A=new p({multigraph:!0,compound:!0}),z=U(I.graph());return A.setGraph(Object.assign({},_,Z(z,x),h.pick(z,f))),I.nodes().forEach(H=>{let K=U(I.node(H)),G=Z(K,C);Object.keys(k).forEach(J=>{G[J]===void 0&&(G[J]=k[J])}),A.setNode(H,G),A.setParent(H,I.parent(H))}),I.edges().forEach(H=>{let K=U(I.edge(H));A.setEdge(H,Object.assign({},D,Z(K,O),h.pick(K,P)))}),A}function w(I){let A=I.graph();A.ranksep/=2,I.edges().forEach(z=>{let H=I.edge(z);H.minlen*=2,H.labelpos.toLowerCase()!=="c"&&(A.rankdir==="TB"||A.rankdir==="BT"?H.width+=H.labeloffset:H.height+=H.labeloffset)})}function M(I){I.edges().forEach(A=>{let z=I.edge(A);if(z.width&&z.height){let H=I.node(A.v),K={rank:(I.node(A.w).rank-H.rank)/2+H.rank,e:A};h.addDummyNode(I,"edge-proxy",K,"_ep")}})}function N(I){let A=0;I.nodes().forEach(z=>{let H=I.node(z);H.borderTop&&(H.minRank=I.node(H.borderTop).rank,H.maxRank=I.node(H.borderBottom).rank,A=Math.max(A,H.maxRank))}),I.graph().maxRank=A}function S(I){I.nodes().forEach(A=>{let z=I.node(A);z.dummy==="edge-proxy"&&(I.edge(z.e).labelRank=z.rank,I.removeNode(A))})}function R(I){let A=1/0,z=0,H=1/0,K=0,G=I.graph(),J=G.marginx||0,ae=G.marginy||0;function ge(oe){let ee=oe.x,de=oe.y,te=oe.width,W=oe.height;A=Math.min(A,ee-te/2),z=Math.max(z,ee+te/2),H=Math.min(H,de-W/2),K=Math.max(K,de+W/2)}I.nodes().forEach(oe=>ge(I.node(oe))),I.edges().forEach(oe=>{let ee=I.edge(oe);Object.hasOwn(ee,"x")&&ge(ee)}),A-=J,H-=ae,I.nodes().forEach(oe=>{let ee=I.node(oe);ee.x-=A,ee.y-=H}),I.edges().forEach(oe=>{let ee=I.edge(oe);ee.points.forEach(de=>{de.x-=A,de.y-=H}),Object.hasOwn(ee,"x")&&(ee.x-=A),Object.hasOwn(ee,"y")&&(ee.y-=H)}),G.width=z-A+J,G.height=K-H+ae}function B(I){I.edges().forEach(A=>{let z=I.edge(A),H=I.node(A.v),K=I.node(A.w),G,J;z.points?(G=z.points[0],J=z.points[z.points.length-1]):(z.points=[],G=K,J=H),z.points.unshift(h.intersectRect(H,G)),z.points.push(h.intersectRect(K,J))})}function L(I){I.edges().forEach(A=>{let z=I.edge(A);if(Object.hasOwn(z,"x"))switch((z.labelpos==="l"||z.labelpos==="r")&&(z.width-=z.labeloffset),z.labelpos){case"l":z.x-=z.width/2+z.labeloffset;break;case"r":z.x+=z.width/2+z.labeloffset;break}})}function V(I){I.edges().forEach(A=>{let z=I.edge(A);z.reversed&&z.points.reverse()})}function j(I){I.nodes().forEach(A=>{if(I.children(A).length){let z=I.node(A),H=I.node(z.borderTop),K=I.node(z.borderBottom),G=I.node(z.borderLeft[z.borderLeft.length-1]),J=I.node(z.borderRight[z.borderRight.length-1]);z.width=Math.abs(J.x-G.x),z.height=Math.abs(K.y-H.y),z.x=G.x+z.width/2,z.y=H.y+z.height/2}}),I.nodes().forEach(A=>{I.node(A).dummy==="border"&&I.removeNode(A)})}function T(I){I.edges().forEach(A=>{if(A.v===A.w){var z=I.node(A.v);z.selfEdges||(z.selfEdges=[]),z.selfEdges.push({e:A,label:I.edge(A)}),I.removeEdge(A)}})}function F(I){h.buildLayerMatrix(I).forEach(A=>{var z=0;A.forEach((H,K)=>{var G=I.node(H);G.order=K+z,(G.selfEdges||[]).forEach(J=>{h.addDummyNode(I,"selfedge",{width:J.label.width,height:J.label.height,rank:G.rank,order:K+ ++z,e:J.e,label:J.label},"_se")}),delete G.selfEdges})})}function X(I){I.nodes().forEach(A=>{var z=I.node(A);if(z.dummy==="selfedge"){var H=I.node(z.e.v),K=H.x+H.width/2,G=H.y,J=z.x-K,ae=H.height/2;I.setEdge(z.e,z.label),I.removeNode(A),z.label.points=[{x:K+2*J/3,y:G-ae},{x:K+5*J/6,y:G-ae},{x:K+J,y:G},{x:K+5*J/6,y:G+ae},{x:K+2*J/3,y:G+ae}],z.label.x=z.x,z.label.y=z.y}})}function Z(I,A){return h.mapValues(h.pick(I,A),Number)}function U(I){var A={};return I&&Object.entries(I).forEach(([z,H])=>{typeof z=="string"&&(z=z.toLowerCase()),A[z]=H}),A}})),Dl=q(((t,e)=>{var n=se(),o=be().Graph;e.exports={debugOrdering:i};function i(d){let r=n.buildLayerMatrix(d),l=new o({compound:!0,multigraph:!0}).setGraph({});return d.nodes().forEach(s=>{l.setNode(s,{label:s}),l.setParent(s,"layer"+d.node(s).rank)}),d.edges().forEach(s=>l.setEdge(s.v,s.w,{},s.name)),r.forEach((s,u)=>{let c="layer"+u;l.setNode(c,{rank:"same"}),s.reduce((a,g)=>(l.setEdge(a,g,{style:"invis"}),g))}),l}})),Il=q(((t,e)=>{e.exports="1.1.5"})),or=ye(q(((t,e)=>{e.exports={graphlib:be(),layout:Pl(),debug:Dl(),util:{time:se().time,notime:se().notime},version:Il()}}))()),ht=new or.graphlib.Graph().setDefaultEdgeLabel(()=>({}));const rr=({nodes:t,edges:e,direction:n})=>(ht.setGraph({rankdir:n,nodesep:150,ranksep:200,ranker:"longest-path"}),e.forEach(o=>ht.setEdge(o.source,o.target)),t.forEach(o=>ht.setNode(o.id,{...o,width:o.width??0,height:o.height??0})),(0,or.layout)(ht),{nodes:t.map(o=>{let{x:i,y:d}=ht.node(o.id);return{...o,position:{x:i,y:d}}}),edges:e});var jl=ye(Ae()),ar=new Ts;const Rl=t=>{let e=(0,jl.c)(43),{cellIds:n,variables:o,cellAtoms:i,children:d,layoutDirection:r,settings:l}=t,s;e[0]!==i||e[1]!==n||e[2]!==r||e[3]!==l.hidePureMarkdown||e[4]!==o?(s=()=>{let j=ar.createElements(n,i,o,l.hidePureMarkdown);return j=rr({nodes:j.nodes,edges:j.edges,direction:r}),j},e[0]=i,e[1]=n,e[2]=r,e[3]=l.hidePureMarkdown,e[4]=o,e[5]=s):s=e[5];let[u]=(0,y.useState)(s),[c,a,g]=To(u.nodes),[h,p,m]=Ho(u.edges),v=dt(),b;e[6]!==r||e[7]!==p||e[8]!==a?(b=j=>{let T=rr({nodes:j.nodes,edges:j.edges,direction:r});a(T.nodes),p(T.edges)},e[6]=r,e[7]=p,e[8]=a,e[9]=b):b=e[9];let x=En(b),_,f;e[10]!==i||e[11]!==n||e[12]!==l.hidePureMarkdown||e[13]!==x||e[14]!==o?(_=()=>{x(ar.createElements(n,i,o,l.hidePureMarkdown))},f=[n,o,i,x,l.hidePureMarkdown],e[10]=i,e[11]=n,e[12]=l.hidePureMarkdown,e[13]=x,e[14]=o,e[15]=_,e[16]=f):(_=e[15],f=e[16]),(0,y.useEffect)(_,f);let[C,k]=(0,y.useState)();Wo();let O;e[17]===Symbol.for("react.memo_cache_sentinel")?(O=()=>{k(void 0)},e[17]=O):O=e[17];let D=O,P,E,w;e[18]===Symbol.for("react.memo_cache_sentinel")?(P={minZoom:.5,maxZoom:1.5},E=(j,T)=>{k({type:"node",id:T.id})},w=(j,T)=>{let{source:F,target:X}=T;k({type:"edge",source:F,target:X})},e[18]=P,e[19]=E,e[20]=w):(P=e[18],E=e[19],w=e[20]);let M;e[21]===Symbol.for("react.memo_cache_sentinel")?(M=(0,$.jsx)(zs,{color:"#ccc",variant:ve.Dots}),e[21]=M):M=e[21];let N;e[22]!==v||e[23]!==c?(N=()=>{let j=gt.get(ya);if(j){let T=c.find(F=>F.id===j);T&&(v.fitView({padding:1,duration:600,nodes:[T]}),k({type:"node",id:j}))}},e[22]=v,e[23]=c,e[24]=N):N=e[24];let S;e[25]===Symbol.for("react.memo_cache_sentinel")?(S=(0,$.jsx)(ka,{className:"size-4"}),e[25]=S):S=e[25];let R;e[26]===N?R=e[27]:(R=(0,$.jsx)(Ds,{position:"bottom-right",showInteractive:!1,children:(0,$.jsx)(da,{content:"Jump to focused cell",delayDuration:200,side:"left",asChild:!1,children:(0,$.jsx)(tt,{onMouseDown:ea.preventFocus,onClick:N,children:S})})}),e[26]=N,e[27]=R);let B;e[28]!==h||e[29]!==C||e[30]!==o?(B=(0,$.jsx)(Mt,{selection:C,variables:o,edges:h,onClearSelection:D}),e[28]=h,e[29]=C,e[30]=o,e[31]=B):B=e[31];let L;e[32]!==d||e[33]!==h||e[34]!==c||e[35]!==m||e[36]!==g||e[37]!==R||e[38]!==B?(L=(0,$.jsxs)(ln,{nodes:c,edges:h,nodeTypes:Zo,minZoom:.2,fitViewOptions:P,onNodeClick:E,onEdgeClick:w,onNodeDoubleClick:Al,fitView:!0,onNodesChange:g,onEdgesChange:m,zoomOnDoubleClick:!1,nodesConnectable:!1,children:[M,R,B,d]}),e[32]=d,e[33]=h,e[34]=c,e[35]=m,e[36]=g,e[37]=R,e[38]=B,e[39]=L):L=e[39];let V;return e[40]!==r||e[41]!==L?(V=(0,$.jsx)(Xo,{value:r,children:L}),e[40]=r,e[41]=L,e[42]=V):V=e[42],V};function Al(t,e){wn(e.id,"focus")}var Bl=ye(Ae()),zl=pn("_minimap_"),Ll=pn({hidePureMarkdown:!0});const $l=t=>{let e=(0,Bl.c)(11),[n,o]=fn(zl),[i,d]=fn(Ll),r;e[0]!==n||e[1]!==t||e[2]!==o||e[3]!==d||e[4]!==i?(r=()=>n==="_minimap_"?(0,$.jsx)(Ks,{...t,children:(0,$.jsx)(cn,{settings:i,onSettingsChange:d,view:n,onChange:o})}):(0,$.jsx)(Rl,{...t,settings:i,layoutDirection:n,children:(0,$.jsx)(cn,{settings:i,onSettingsChange:d,view:n,onChange:o})}),e[0]=n,e[1]=t,e[2]=o,e[3]=d,e[4]=i,e[5]=r):r=e[5];let l=r,s;e[6]===l?s=e[7]:(s=l(),e[6]=l,e[7]=s);let u;return e[8]!==n||e[9]!==s?(u=(0,$.jsx)(sn,{children:s},n),e[8]=n,e[9]=s,e[10]=u):u=e[10],u};var Tl=ye(Ae()),Hl=()=>{let t=(0,Tl.c)(5),e=Kr(),n=yn(),[o]=Wr(),i;t[0]===Symbol.for("react.memo_cache_sentinel")?(i=vn("w-full h-full flex-1 mx-auto -mb-4 relative"),t[0]=i):i=t[0];let d;return t[1]!==n.inOrderIds||t[2]!==o||t[3]!==e?(d=(0,$.jsx)("div",{className:i,children:(0,$.jsx)($l,{cellAtoms:o,variables:e,cellIds:n.inOrderIds})}),t[1]=n.inOrderIds,t[2]=o,t[3]=e,t[4]=d):d=t[4],d};export{Hl as default};
