function j(n){var t=0,e=n.children,u=e&&e.length;if(u)for(;--u>=0;)t+=e[u].value;else t=1;n.value=t}function L(n,t){n instanceof Map?(n=[void 0,n],t===void 0&&(t=D)):t===void 0&&(t=C);for(var e,u,i,o,f,h=new A(n),c=[h];e=c.pop();)if((i=t(e.data))&&(f=(i=Array.from(i)).length))for(e.children=i,o=f-1;o>=0;--o)c.push(u=i[o]=new A(i[o])),u.parent=e,u.depth=e.depth+1;return h.eachBefore(O)}function C(n){return n.children}function D(n){return Array.isArray(n)?n[1]:null}function F(n){n.data.value!==void 0&&(n.value=n.data.value),n.data=n.data.data}function O(n){var t=0;do n.height=t;while((n=n.parent)&&n.height<++t)}function A(n){this.data=n,this.depth=this.height=0,this.parent=null}function G(n){return n==null?null:R(n)}function R(n){if(typeof n!="function")throw new Error;return n}function M(){return 0}function B(n){return function(){return n}}function q(n){n.x0=Math.round(n.x0),n.y0=Math.round(n.y0),n.x1=Math.round(n.x1),n.y1=Math.round(n.y1)}function w(n,t,e,u,i){for(var o,f=n.children,h=-1,c=f.length,s=n.value&&(u-t)/n.value;++h<c;)(o=f[h]).y0=e,o.y1=i,o.x0=t,o.x1=t+=o.value*s}function z(n,t,e,u,i){for(var o,f=n.children,h=-1,c=f.length,s=n.value&&(i-e)/n.value;++h<c;)(o=f[h]).x0=t,o.x1=u,o.y0=e,o.y1=e+=o.value*s}A.prototype=L.prototype={constructor:A,count:function(){return this.eachAfter(j)},each:function(n,t){let e=-1;for(const u of this)n.call(t,u,++e,this);return this},eachAfter:function(n,t){for(var e,u,i,o=this,f=[o],h=[],c=-1;o=f.pop();)if(h.push(o),e=o.children)for(u=0,i=e.length;u<i;++u)f.push(e[u]);for(;o=h.pop();)n.call(t,o,++c,this);return this},eachBefore:function(n,t){for(var e,u,i=this,o=[i],f=-1;i=o.pop();)if(n.call(t,i,++f,this),e=i.children)for(u=e.length-1;u>=0;--u)o.push(e[u]);return this},find:function(n,t){let e=-1;for(const u of this)if(n.call(t,u,++e,this))return u},sum:function(n){return this.eachAfter(function(t){for(var e=+n(t.data)||0,u=t.children,i=u&&u.length;--i>=0;)e+=u[i].value;t.value=e})},sort:function(n){return this.eachBefore(function(t){t.children&&t.children.sort(n)})},path:function(n){for(var t=this,e=function(o,f){if(o===f)return o;var h=o.ancestors(),c=f.ancestors(),s=null;for(o=h.pop(),f=c.pop();o===f;)s=o,o=h.pop(),f=c.pop();return s}(t,n),u=[t];t!==e;)t=t.parent,u.push(t);for(var i=u.length;n!==e;)u.splice(i,0,n),n=n.parent;return u},ancestors:function(){for(var n=this,t=[n];n=n.parent;)t.push(n);return t},descendants:function(){return Array.from(this)},leaves:function(){var n=[];return this.eachBefore(function(t){t.children||n.push(t)}),n},links:function(){var n=this,t=[];return n.each(function(e){e!==n&&t.push({source:e.parent,target:e})}),t},copy:function(){return L(this).eachBefore(F)},[Symbol.iterator]:function*(){var n,t,e,u,i=this,o=[i];do for(n=o.reverse(),o=[];i=n.pop();)if(yield i,t=i.children)for(e=0,u=t.length;e<u;++e)o.push(t[e]);while(o.length)}};var E=(1+Math.sqrt(5))/2;function N(n,t,e,u,i,o){for(var f,h,c,s,a,y,r,p,d,g,l,v=[],I=t.children,T=0,m=0,k=I.length,x=t.value;T<k;){c=i-e,s=o-u;do a=I[m++].value;while(!a&&m<k);for(y=r=a,l=a*a*(g=Math.max(s/c,c/s)/(x*n)),d=Math.max(r/l,l/y);m<k;++m){if(a+=h=I[m].value,h<y&&(y=h),h>r&&(r=h),l=a*a*g,(p=Math.max(r/l,l/y))>d){a-=h;break}d=p}v.push(f={value:a,dice:c<s,children:I.slice(T,m)}),f.dice?w(f,e,u,i,x?u+=s*a/x:o):z(f,e,u,x?e+=c*a/x:i,o),x-=a,T=m}return v}const S=function n(t){function e(u,i,o,f,h){N(t,u,i,o,f,h)}return e.ratio=function(u){return n((u=+u)>1?u:1)},e}(E);function H(){var n=S,t=!1,e=1,u=1,i=[0],o=M,f=M,h=M,c=M,s=M;function a(r){return r.x0=r.y0=0,r.x1=e,r.y1=u,r.eachBefore(y),i=[0],t&&r.eachBefore(q),r}function y(r){var p=i[r.depth],d=r.x0+p,g=r.y0+p,l=r.x1-p,v=r.y1-p;l<d&&(d=l=(d+l)/2),v<g&&(g=v=(g+v)/2),r.x0=d,r.y0=g,r.x1=l,r.y1=v,r.children&&(p=i[r.depth+1]=o(r)/2,d+=s(r)-p,g+=f(r)-p,(l-=h(r)-p)<d&&(d=l=(d+l)/2),(v-=c(r)-p)<g&&(g=v=(g+v)/2),n(r,d,g,l,v))}return a.round=function(r){return arguments.length?(t=!!r,a):t},a.size=function(r){return arguments.length?(e=+r[0],u=+r[1],a):[e,u]},a.tile=function(r){return arguments.length?(n=R(r),a):n},a.padding=function(r){return arguments.length?a.paddingInner(r).paddingOuter(r):a.paddingInner()},a.paddingInner=function(r){return arguments.length?(o=typeof r=="function"?r:B(+r),a):o},a.paddingOuter=function(r){return arguments.length?a.paddingTop(r).paddingRight(r).paddingBottom(r).paddingLeft(r):a.paddingTop()},a.paddingTop=function(r){return arguments.length?(f=typeof r=="function"?r:B(+r),a):f},a.paddingRight=function(r){return arguments.length?(h=typeof r=="function"?r:B(+r),a):h},a.paddingBottom=function(r){return arguments.length?(c=typeof r=="function"?r:B(+r),a):c},a.paddingLeft=function(r){return arguments.length?(s=typeof r=="function"?r:B(+r),a):s},a}export{A as N,B as a,w as b,M as c,O as d,z as e,S as f,L as h,G as o,E as p,q as r,N as s,H as t};
