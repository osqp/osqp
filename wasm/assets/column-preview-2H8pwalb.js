const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./esm-DjUQOOJ2.js","./precisionRound-TxjBk8nN.js","./defaultLocale-DPsgYaXf.js","./linear-nWRf49aw.js","./timer-m_pEB4Lb.js","./chunk-DZLz74EQ.js","./init-BEfLCoUT.js","./src-KuQao6GK.js","./time-BkIHCvH2.js","./defaultLocale-C6TNIE_k.js","./range-BPiwmiGf.js","./vega-loader.browser.module-BkWiTok0.js","./treemap-CMOdyZ8L.js","./path-Gc-fQZTe.js","./colors-BlRVeShK.js","./ordinal-CHS6rGcb.js","./arc-De5rudRM.js","./math-BsaXoFIn.js","./array-DZFD9yN1.js","./step-aJ-oEw6-.js","./line-1VYCafWO.js","./fast-deep-equal-BdzBWnNx.js","./esm-BBn_y9Ew.js","./prop-types-CHKlDUlJ.js","./react-BcIddLXZ.js","./tslib.es6-dlz5WbC8.js"])))=>i.map(i=>d[i]);
import{s as _}from"./chunk-DZLz74EQ.js";import{r as re}from"./react-7g8sREeT.js";import{t as le}from"./react-BcIddLXZ.js";import{E as ne,Jt as oe,Xt as X,bt as ce,xt as ie,__tla as me}from"./cells-Dd1FatlG.js";import{n as L,t as de}from"./jsx-runtime-DvsdsEjx.js";import{o as pe}from"./utils-DBmmAf_K.js";import{t as g}from"./cn-Dr9kMPPj.js";import{t as q}from"./events-BGfCi1Xy.js";import{t as A}from"./button-Bxk0BtBn.js";import{a as ue}from"./key-D4QiH_7H.js";import{t as xe}from"./preload-helper-DImqtvgl.js";import{r as he}from"./useTheme-oPMxEKRc.js";import{t as fe}from"./createLucideIcon-QLW8E4z5.js";import{h as ge}from"./select-DKRTzlUU.js";import{t as _e}from"./chevron-right-BDEhimQq.js";import{n as ye,t as be}from"./spinner-BhnfQOEl.js";import{c as je}from"./input-C1RzjWSK.js";import{t as B}from"./tooltip-ULHbIsj9.js";import{t as Ne}from"./useLifecycle-BfeAlD80.js";import{r as ke}from"./useNumberFormatter-D21brJ0f.js";import{t as ve}from"./copy-icon-6ICckC-p.js";import{t as we}from"./add-missing-import-CfRgNApn.js";import{o as Ce}from"./focus-Bnk25hTp.js";import{t as Pe}from"./useInstallPackage-DoKAq17E.js";let M,F,G,H,O,K,U,W,y,$,J,Q,Y,Se=Promise.all([(()=>{try{return me}catch{}})()]).then(async()=>{let x,l;y=fe("square-plus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),x=_(L()),l=_(de()),H=o=>{let e=(0,x.c)(4),{isExpanded:a}=o,s=a&&"rotate-90",t;e[0]===s?t=e[1]:(t=g("h-3 w-3 transition-transform",s),e[0]=s,e[1]=t);let r;return e[2]===t?r=e[3]:(r=(0,l.jsx)(_e,{className:t}),e[2]=t,e[3]=r),r},F=o=>{let e=(0,x.c)(2),{children:a}=o,s;return e[0]===a?s=e[1]:(s=(0,l.jsx)("div",{className:"flex gap-1.5 items-center font-bold px-2 py-1.5 text-muted-foreground bg-(--slate-2) text-sm",children:a}),e[0]=a,e[1]=s),s},K=o=>{let e=(0,x.c)(5),{content:a,className:s}=o,t;e[0]===s?t=e[1]:(t=g("text-sm text-muted-foreground py-1",s),e[0]=s,e[1]=t);let r;return e[2]!==a||e[3]!==t?(r=(0,l.jsx)("div",{className:t,children:a}),e[2]=a,e[3]=t,e[4]=r):r=e[4],r},Y=o=>{let e=(0,x.c)(6),{error:a,className:s}=o,t;e[0]===s?t=e[1]:(t=g("text-sm bg-red-50 dark:bg-red-900 text-red-600 dark:text-red-50 flex items-center gap-2 p-2 h-8",s),e[0]=s,e[1]=t);let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,l.jsx)(ge,{className:"h-4 w-4 mt-0.5"}),e[2]=r):r=e[2];let n;return e[3]!==a.message||e[4]!==t?(n=(0,l.jsxs)("div",{className:t,children:[r,a.message]}),e[3]=a.message,e[4]=t,e[5]=n):n=e[5],n},G=o=>{let e=(0,x.c)(6),{message:a,className:s}=o,t;e[0]===s?t=e[1]:(t=g("text-sm bg-blue-50 dark:bg-(--accent) text-blue-500 dark:text-blue-50 flex items-center gap-2 p-2 h-8",s),e[0]=s,e[1]=t);let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,l.jsx)(ye,{className:"h-4 w-4 animate-spin"}),e[2]=r):r=e[2];let n;return e[3]!==a||e[4]!==t?(n=(0,l.jsxs)("div",{className:t,children:[r,a]}),e[3]=a,e[4]=t,e[5]=n):n=e[5],n},J=o=>{let e=(0,x.c)(5),{children:a,className:s}=o,t;e[0]===s?t=e[1]:(t=g("flex flex-col gap-2 relative",s),e[0]=s,e[1]=t);let r;return e[2]!==a||e[3]!==t?(r=(0,l.jsx)("div",{className:t,children:a}),e[2]=a,e[3]=t,e[4]=r):r=e[4],r},W=o=>{let e=(0,x.c)(6),{columnName:a,dataType:s}=o,t=ce[s],r=`w-4 h-4 p-0.5 rounded-sm stroke-card-foreground ${ie(s)}`,n;e[0]!==t||e[1]!==r?(n=(0,l.jsx)(t,{className:r}),e[0]=t,e[1]=r,e[2]=n):n=e[2];let c;return e[3]!==a||e[4]!==n?(c=(0,l.jsxs)("div",{className:"flex flex-row items-center gap-1.5",children:[n,a]}),e[3]=a,e[4]=n,e[5]=c):c=e[5],c};var Z=_(L()),V=_(le());const ee=o=>{let e=(0,Z.c)(13),{packages:a,showMaxPackages:s,className:t,onInstall:r}=o,{handleInstallPackages:n}=Pe();if(!a||a.length===0)return null;let c;e[0]!==n||e[1]!==r||e[2]!==a?(c=()=>{n(a,r)},e[0]=n,e[1]=r,e[2]=a,e[3]=c):c=e[3];let i;e[4]===t?i=e[5]:(i=g("ml-2",t),e[4]=t,e[5]=i);let d;e[6]!==a||e[7]!==s?(d=s?a.slice(0,s).join(", "):a.join(", "),e[6]=a,e[7]=s,e[8]=d):d=e[8];let p;return e[9]!==c||e[10]!==i||e[11]!==d?(p=(0,l.jsxs)(A,{variant:"outline",size:"xs",onClick:c,className:i,children:["Install"," ",d]}),e[9]=c,e[10]=i,e[11]=d,e[12]=p):p=e[12],p};var R=_(L()),te=V.lazy(()=>xe(()=>import("./esm-DjUQOOJ2.js").then(async o=>(await o.__tla,o)),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]),import.meta.url).then(o=>({default:o.VegaLite})));U=o=>{let e=(0,R.c)(53),{table:a,column:s,preview:t,onAddColumnChart:r,sqlTableContext:n}=o,{theme:c}=he(),{previewDatasetColumn:i}=ue(),{locale:d}=ke(),p;e[0]!==s.name||e[1]!==i||e[2]!==n||e[3]!==a.name||e[4]!==a.source||e[5]!==a.source_type?(p=()=>{i({source:a.source,tableName:a.name,columnName:s.name,sourceType:a.source_type,fullyQualifiedTableName:n?`${n.database}.${n.schema}.${a.name}`:a.name})},e[0]=s.name,e[1]=i,e[2]=n,e[3]=a.name,e[4]=a.source,e[5]=a.source_type,e[6]=p):p=e[6];let u=p,b;if(e[7]!==t||e[8]!==u||e[9]!==a.source_type?(b=()=>{t||a.source_type==="connection"||a.source_type==="catalog"||u()},e[7]=t,e[8]=u,e[9]=a.source_type,e[10]=b):b=e[10],Ne(b),a.source_type==="connection"){let m=s.name,se=s.external_type,h;e[11]!==s.name||e[12]!==r||e[13]!==n||e[14]!==a?(h=q.stopPropagation(()=>{r(X({table:a,columnName:s.name,sqlTableContext:n}))}),e[11]=s.name,e[12]=r,e[13]=n,e[14]=a,e[15]=h):h=e[15];let T;e[16]===Symbol.for("react.memo_cache_sentinel")?(T=(0,l.jsx)(y,{className:"h-3 w-3 mr-1"}),e[16]=T):T=e[16];let f;e[17]===h?f=e[18]:(f=(0,l.jsxs)(A,{variant:"outline",size:"xs",onClick:h,children:[T," Add SQL cell"]}),e[17]=h,e[18]=f);let I;return e[19]!==s.external_type||e[20]!==s.name||e[21]!==f?(I=(0,l.jsxs)("span",{className:"text-xs text-muted-foreground gap-2 flex items-center justify-between pl-7",children:[m," (",se,")",f]}),e[19]=s.external_type,e[20]=s.name,e[21]=f,e[22]=I):I=e[22],I}if(a.source_type==="catalog"){let m;return e[23]!==s.external_type||e[24]!==s.name?(m=(0,l.jsxs)("span",{className:"text-xs text-muted-foreground gap-2 flex items-center justify-between pl-7",children:[s.name," (",s.external_type,")"]}),e[23]=s.external_type,e[24]=s.name,e[25]=m):m=e[25],m}if(!t){let m;return e[26]===Symbol.for("react.memo_cache_sentinel")?(m=(0,l.jsx)("span",{className:"text-xs text-muted-foreground",children:"Loading..."}),e[26]=m):m=e[26],m}let j;e[27]!==t.error||e[28]!==t.missing_packages||e[29]!==u?(j=t.error&&O({error:t.error,missingPackages:t.missing_packages,refetchPreview:u}),e[27]=t.error,e[28]=t.missing_packages,e[29]=u,e[30]=j):j=e[30];let N=j,k;e[31]!==s.type||e[32]!==d||e[33]!==t.stats?(k=t.stats&&M({stats:t.stats,dataType:s.type,locale:d}),e[31]=s.type,e[32]=d,e[33]=t.stats,e[34]=k):k=e[34];let v=k,w;e[35]!==t.chart_spec||e[36]!==c?(w=t.chart_spec&&$(t.chart_spec,c),e[35]=t.chart_spec,e[36]=c,e[37]=w):w=e[37];let C=w,P;e[38]!==t.chart_code||e[39]!==a.source_type?(P=t.chart_code&&a.source_type==="local"&&(0,l.jsx)(Q,{chartCode:t.chart_code}),e[38]=t.chart_code,e[39]=a.source_type,e[40]=P):P=e[40];let D=P,S;e[41]!==s.name||e[42]!==r||e[43]!==n||e[44]!==a?(S=a.source_type==="duckdb"&&(0,l.jsx)(B,{content:"Add SQL cell",delayDuration:400,children:(0,l.jsx)(A,{variant:"outline",size:"icon",className:"z-10 bg-background absolute right-1 -top-1",onClick:q.stopPropagation(()=>{r(X({table:a,columnName:s.name,sqlTableContext:n}))}),children:(0,l.jsx)(y,{className:"h-3 w-3"})})}),e[41]=s.name,e[42]=r,e[43]=n,e[44]=a,e[45]=S):S=e[45];let E=S;if(!N&&!v&&!C){let m;return e[46]===Symbol.for("react.memo_cache_sentinel")?(m=(0,l.jsx)("span",{className:"text-xs text-muted-foreground",children:"No data"}),e[46]=m):m=e[46],m}let z;return e[47]!==D||e[48]!==E||e[49]!==C||e[50]!==N||e[51]!==v?(z=(0,l.jsxs)(J,{children:[N,D,E,C,v]}),e[47]=D,e[48]=E,e[49]=C,e[50]=N,e[51]=v,e[52]=z):z=e[52],z},O=function({error:o,missingPackages:e,refetchPreview:a}){return(0,l.jsxs)("div",{className:"text-xs text-muted-foreground p-2 border border-border rounded flex items-center justify-between",children:[(0,l.jsx)("span",{children:o}),e&&(0,l.jsx)(ee,{packages:e,showMaxPackages:1,className:"w-32",onInstall:a})]})},M=function({stats:o,dataType:e,locale:a}){return(0,l.jsx)("div",{className:"gap-x-16 gap-y-1 grid grid-cols-2-fit border rounded p-2 empty:hidden",children:Object.entries(o).map(([s,t])=>t==null?null:(0,l.jsxs)("div",{className:"flex items-center gap-1 group",children:[(0,l.jsx)("span",{className:"text-xs min-w-[60px] capitalize",children:oe(s,e)}),(0,l.jsx)("span",{className:"text-xs font-bold text-muted-foreground tracking-wide",children:je(t,a)}),(0,l.jsx)(ve,{className:"h-3 w-3 invisible group-hover:visible",value:String(t)})]},s))})};var ae=(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(be,{className:"size-4"})});$=function(o,e){return(0,l.jsx)(V.Suspense,{fallback:ae,children:(0,l.jsx)(te,{spec:(a=>({...a,background:"transparent",config:{...a.config,background:"transparent"}}))(JSON.parse(o)),width:"container",height:100,actions:!1,theme:e==="dark"?"dark":"vox"})})},Q=o=>{let e=(0,R.c)(10),{chartCode:a}=o,s=re(pe),t=Ce(),{createNewCell:r}=ne(),n;e[0]!==s||e[1]!==r||e[2]!==t?(n=u=>{u.includes("alt")&&we({autoInstantiate:s,createNewCell:r,fromCellId:t}),r({code:u,before:!1,cellId:t??"__end__"})},e[0]=s,e[1]=r,e[2]=t,e[3]=n):n=e[3];let c=n,i;e[4]!==a||e[5]!==c?(i=q.stopPropagation(()=>c(a)),e[4]=a,e[5]=c,e[6]=i):i=e[6];let d;e[7]===Symbol.for("react.memo_cache_sentinel")?(d=(0,l.jsx)(y,{className:"h-3 w-3"}),e[7]=d):d=e[7];let p;return e[8]===i?p=e[9]:(p=(0,l.jsx)(B,{content:"Add chart to notebook",delayDuration:400,children:(0,l.jsx)(A,{variant:"outline",size:"icon",className:"z-10 bg-background absolute right-1 -top-0.5",onClick:i,children:d})}),e[8]=i,e[9]=p),p}});export{Se as __tla,M as a,F as c,G as d,H as f,O as i,K as l,U as n,W as o,y as p,$ as r,J as s,Q as t,Y as u};
