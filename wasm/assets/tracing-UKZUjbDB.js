const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./esm-DjUQOOJ2.js","./precisionRound-TxjBk8nN.js","./defaultLocale-DPsgYaXf.js","./linear-nWRf49aw.js","./timer-m_pEB4Lb.js","./chunk-DZLz74EQ.js","./init-BEfLCoUT.js","./src-KuQao6GK.js","./time-BkIHCvH2.js","./defaultLocale-C6TNIE_k.js","./range-BPiwmiGf.js","./vega-loader.browser.module-BkWiTok0.js","./treemap-CMOdyZ8L.js","./path-Gc-fQZTe.js","./colors-BlRVeShK.js","./ordinal-CHS6rGcb.js","./arc-De5rudRM.js","./math-BsaXoFIn.js","./array-DZFD9yN1.js","./step-aJ-oEw6-.js","./line-1VYCafWO.js","./fast-deep-equal-BdzBWnNx.js","./esm-BBn_y9Ew.js","./prop-types-CHKlDUlJ.js","./react-BcIddLXZ.js","./tslib.es6-dlz5WbC8.js"])))=>i.map(i=>d[i]);
import{s as E}from"./chunk-DZLz74EQ.js";import{i as Q,o as Z,r as D}from"./react-7g8sREeT.js";import{t as ee}from"./react-BcIddLXZ.js";import{W as H,j as te,__tla as re}from"./cells-Dd1FatlG.js";import"./react-dom-D6bRRS5R.js";import"./zod-BEi78Y5d.js";import{n as ie,t as se}from"./jsx-runtime-DvsdsEjx.js";import"./_Uint8Array-CPNtPV0k.js";import"./isSymbol-D1Vf4s0g.js";import"./_arrayMap-DQI2GUNb.js";import"./toNumber-Bjr00yqN.js";import"./toInteger-Qi6pclEF.js";import"./isArrayLikeObject-CQy5-FN4.js";import"./_getTag-C4fv2peH.js";import"./_baseIsEqual-Cdnsi4t8.js";import"./merge-DrdmtLTL.js";import"./_baseProperty-CIKnF2iY.js";import"./now-CKgsywea.js";import"./debounce-Bzqd6azt.js";import"./invariant-91cSKJcr.js";import"./Logger-BkkOJyg0.js";import"./hotkeys-CBY41Jr2.js";import"./utils-DBmmAf_K.js";import"./constants-Cv7-oioA.js";import"./config-DXGmIv9f.js";import"./dist-CLazWf1X.js";import{t as le}from"./cn-Dr9kMPPj.js";import"./dist-D-dnh2ed.js";import"./useEventListener-g9rPKvBX.js";import"./events-BGfCi1Xy.js";import"./button-Bxk0BtBn.js";import"./dist-CoL9j4yJ.js";import"./dist-Cs8TISgf.js";import"./once-8ZDiGGtA.js";import"./documentation-B7z6bB-t.js";import"./createReducer-CFr1RdS2.js";import"./key-D4QiH_7H.js";import{t as oe}from"./preload-helper-DImqtvgl.js";import"./dist-Bz53xjA5.js";import"./dist-CyqTsfyg.js";import"./dist-CjoeBoZ9.js";import"./dist-Dlusp3mb.js";import"./dist-DzUKODTF.js";import"./dist-Dm8m1boP.js";import"./stex-BrOrfhKB.js";import"./Deferred-Mppm0cvJ.js";import"./uuid-4lb_EYpq.js";import"./use-toast-D6NNsC80.js";import"./main-CfqcqCNp.js";import"./marked.esm-C_54K2ke.js";import"./connection-D2GvycR9.js";import"./dist-DvDyxv8b.js";import{r as ae}from"./useTheme-oPMxEKRc.js";import{t as me}from"./createLucideIcon-QLW8E4z5.js";import{t as ne}from"./activity-BhLNCNHF.js";import{i as pe,n as ce,r as O}from"./CellStatus-BJRDATxe.js";import"./type-kF6pOJbH.js";import"./check-C5PVLNkJ.js";import{_ as de}from"./select-DKRTzlUU.js";import{t as ue}from"./chevron-right-BDEhimQq.js";import{t as he}from"./circle-play-BnvyuDgL.js";import"./toDate-Daj1hQSF.js";import{t as xe}from"./circle-x-BsVcxKkV.js";import"./ellipsis-CJtiw1k3.js";import"./refresh-cw-B_tmnHav.js";import"./input-C1RzjWSK.js";import"./workflow-DA01FBLw.js";import"./useNonce-BbWkd3B4.js";import"./badge-DJuT6BaT.js";import"./namespace-CnoeT75h.js";import{t as q}from"./tooltip-ULHbIsj9.js";import"./useLifecycle-BfeAlD80.js";import"./menu-items-Bo6Dyd_Q.js";import"./fullscreen-DTPr3iBY.js";import"./tslib.es6-dlz5WbC8.js";import"./en-US-CjWuOpsV.js";import"./alert-dialog-BO8sf-73.js";import"./dialog-CR68_CUl.js";import"./useNumberFormatter-D21brJ0f.js";import"./useDateFormatter-DrFLqO1D.js";import"./useEvent-BOb1a9d1.js";import"./useDebounce-_ztZiL0I.js";import"./ImperativeModal-BG5LTpV0.js";import"./vega-loader.browser.module-BkWiTok0.js";import"./precisionRound-TxjBk8nN.js";import"./linear-nWRf49aw.js";import{n as fe}from"./src-KuQao6GK.js";import"./ordinal-CHS6rGcb.js";import"./time-BkIHCvH2.js";import"./range-BPiwmiGf.js";import"./defaultLocale-DPsgYaXf.js";import"./defaultLocale-C6TNIE_k.js";import"./filename-B5Yo1bOu.js";import{t as ge}from"./cell-link-_kF38gGF.js";import{t as ve}from"./bundle.esm-CSE5zS7V.js";import{t as je}from"./empty-state-TdWBDq6n.js";import"./timer-m_pEB4Lb.js";import"./multi-icon-Dcch0iBY.js";import{t as ye}from"./clear-button-CwNZhX7m.js";import{n as Ie,t as Se}from"./runs-BWcKkv9g.js";import"./path-Gc-fQZTe.js";import"./math-BsaXoFIn.js";import"./arc-De5rudRM.js";import"./array-DZFD9yN1.js";import"./step-aJ-oEw6-.js";import"./line-1VYCafWO.js";import"./init-BEfLCoUT.js";import"./colors-BlRVeShK.js";import"./treemap-CMOdyZ8L.js";let F,w,be=Promise.all([(()=>{try{return re}catch{}})()]).then(async()=>{var V=me("circle-ellipsis",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M17 12h.01",key:"1m0b6t"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M7 12h.01",key:"eqddd0"}]]),T=E(ie()),_=E(ee());const M="hoveredCellId",$="cellHover";var U="cellNum",P="cell",R="startTimestamp",C="endTimestamp",L="status";function A(t,e,r,a){let s="hoursminutessecondsmilliseconds";return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",background:a==="dark"?"black":void 0,mark:{type:"bar",cornerRadius:2},params:[{name:M,bind:{element:`#${e}`}},{name:$,select:{type:"point",on:"mouseover",fields:[P],clear:"mouseout"}}],height:{step:r==="sideBySide"?26:21},encoding:{y:{field:U,scale:{paddingInner:.2},sort:{field:"sortPriority"},title:"cell",axis:r==="sideBySide"?null:void 0},x:{field:R,type:"temporal",axis:{orient:"top",title:null}},x2:{field:C,type:"temporal"},tooltip:[{field:R,type:"temporal",timeUnit:s,title:"Start"},{field:C,type:"temporal",timeUnit:s,title:"End"}],size:{value:{expr:`${M} == toString(datum.${P}) ? 19.5 : 18`}},color:{field:L,scale:{domain:["success","error"],range:["#37BE5F","red"]},legend:null}},data:{values:t},transform:[{calculate:`datum.${L} === 'queued' ? 9999999999999 : datum.${R}`,as:"sortPriority"}],config:{view:{stroke:"transparent"}}}}var i=E(se()),z=Z(new Map);F=()=>{let t=(0,T.c)(28),{runIds:e,runMap:r}=D(Se),a=D(z),{clearRuns:s}=Ie(),{theme:o}=ae(),[l,u]=(0,_.useState)("above"),m;t[0]===l?m=t[1]:(m=()=>{u(l==="above"?"sideBySide":"above")},t[0]=l,t[1]=m);let x=m;if(e.length===0){let h;return t[2]===Symbol.for("react.memo_cache_sentinel")?(h=(0,i.jsx)(je,{title:"No traces",description:(0,i.jsx)("span",{children:"Cells that have ran will appear here."}),icon:(0,i.jsx)(ne,{})}),t[2]=h):h=t[2],h}let d;t[3]===Symbol.for("react.memo_cache_sentinel")?(d=(0,i.jsx)("label",{htmlFor:"chartPosition",className:"text-xs",children:"Inline chart"}),t[3]=d):d=t[3];let p=l==="sideBySide",f;t[4]!==p||t[5]!==x?(f=(0,i.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[d,(0,i.jsx)("input",{type:"checkbox",name:"chartPosition","data-testid":"chartPosition",onClick:x,defaultChecked:p,className:"h-3 cursor-pointer"})]}),t[4]=p,t[5]=x,t[6]=f):f=t[6];let c;t[7]===s?c=t[8]:(c=(0,i.jsx)(ye,{dataTestId:"clear-traces-button",onClick:s}),t[7]=s,t[8]=c);let j;t[9]!==f||t[10]!==c?(j=(0,i.jsxs)("div",{className:"flex flex-row justify-end gap-3",children:[f,c]}),t[9]=f,t[10]=c,t[11]=j):j=t[11];let g;if(t[12]!==l||t[13]!==a||t[14]!==e||t[15]!==r||t[16]!==o){let h;t[18]!==l||t[19]!==a||t[20]!==r||t[21]!==o?(h=(I,n)=>{let S=r.get(I);if(S)return(0,i.jsx)(Y,{run:S,isExpanded:a.get(S.runId),isMostRecentRun:n===0,chartPosition:l,theme:o},S.runId)},t[18]=l,t[19]=a,t[20]=r,t[21]=o,t[22]=h):h=t[22],g=e.map(h),t[12]=l,t[13]=a,t[14]=e,t[15]=r,t[16]=o,t[17]=g}else g=t[17];let v;t[23]===g?v=t[24]:(v=(0,i.jsx)("div",{className:"flex flex-col gap-3",children:g}),t[23]=g,t[24]=v);let y;return t[25]!==j||t[26]!==v?(y=(0,i.jsxs)("div",{className:"py-1 px-2 overflow-y-scroll",children:[j,v]}),t[25]=j,t[26]=v,t[27]=y):y=t[27],y};var W=_.lazy(()=>oe(()=>import("./esm-DjUQOOJ2.js").then(async t=>(await t.__tla,t)),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]),import.meta.url).then(t=>({default:t.Vega}))),B=t=>{let e=(0,T.c)(10),{ref:r,width:a}=ve(),s=a===void 0?300:a,o=t.theme==="dark"?"dark":void 0,l=s-50,u;e[0]!==t.height||e[1]!==t.signalListeners||e[2]!==t.vegaSpec||e[3]!==o||e[4]!==l?(u=(0,i.jsx)(_.Suspense,{children:(0,i.jsx)(W,{spec:t.vegaSpec,theme:o,width:l,height:t.height,signalListeners:t.signalListeners,actions:!1})}),e[0]=t.height,e[1]=t.signalListeners,e[2]=t.vegaSpec,e[3]=o,e[4]=l,e[5]=u):u=e[5];let m;return e[6]!==t.className||e[7]!==r||e[8]!==u?(m=(0,i.jsx)("div",{className:t.className,ref:r,children:u}),e[6]=t.className,e[7]=r,e[8]=u,e[9]=m):m=e[9],m},Y=({run:t,isMostRecentRun:e,chartPosition:r,isExpanded:a,theme:s})=>{let o=Q(z);a??(a=e);let l=()=>{o(x=>{let d=new Map(x);return d.set(t.runId,!a),d})},u=(0,i.jsx)(a?de:ue,{height:16,className:"inline"}),m=(0,i.jsxs)("span",{className:"text-sm cursor-pointer",onClick:l,children:["Run - ",H(t.runStartTime),u]});return a?(0,i.jsx)(G,{run:t,chartPosition:r,theme:s,title:m},t.runId):(0,i.jsx)("div",{className:"flex flex-col",children:(0,i.jsx)("pre",{className:"font-mono font-semibold",children:m})},t.runId)},G=t=>{let e=(0,T.c)(32),{run:r,chartPosition:a,theme:s,title:o}=t,[l,u]=(0,_.useState)(),m;e[0]===Symbol.for("react.memo_cache_sentinel")?(m={[$]:(I,n)=>{var b;let S=(b=n.cell)==null?void 0:b[0];u(S??null)}},e[0]=m):m=e[0];let x=m,d=te(),p,f;if(e[1]!==d||e[2]!==a||e[3]!==r.cellRuns||e[4]!==r.runId||e[5]!==s){let I=[...r.cellRuns.values()].map(n=>{let S=n.elapsedTime??0;return{cell:n.cellId,cellNum:d.inOrderIds.indexOf(n.cellId),startTimestamp:w(n.startTime),endTimestamp:w(n.startTime+S),elapsedTime:O(S*1e3),status:n.status}});p=`hiddenInputElement-${r.runId}`,f=fe(A(I,p,a,s)),e[1]=d,e[2]=a,e[3]=r.cellRuns,e[4]=r.runId,e[5]=s,e[6]=p,e[7]=f}else p=e[6],f=e[7];let c=f.spec,j;e[8]!==p||e[9]!==l||e[10]!==r?(j=(0,i.jsx)(J,{run:r,hoveredCellId:l,hiddenInputElementId:p}),e[8]=p,e[9]=l,e[10]=r,e[11]=j):j=e[11];let g=j;if(a==="above"){let I;e[12]!==s||e[13]!==c?(I=(0,i.jsx)(B,{vegaSpec:c,height:120,signalListeners:x,theme:s}),e[12]=s,e[13]=c,e[14]=I):I=e[14];let n;e[15]!==I||e[16]!==o||e[17]!==g?(n=(0,i.jsxs)("pre",{className:"font-mono font-semibold",children:[o,I,g]}),e[15]=I,e[16]=o,e[17]=g,e[18]=n):n=e[18];let S;return e[19]!==r.runId||e[20]!==n?(S=(0,i.jsx)("div",{className:"flex flex-col",children:n},r.runId),e[19]=r.runId,e[20]=n,e[21]=S):S=e[21],S}let v;e[22]!==o||e[23]!==g?(v=(0,i.jsxs)("pre",{className:"font-mono font-semibold",children:[o,g]}),e[22]=o,e[23]=g,e[24]=v):v=e[24];let y;e[25]!==s||e[26]!==c?(y=(0,i.jsx)(B,{className:"-mt-0.5 flex-1",vegaSpec:c,height:100,signalListeners:x,theme:s}),e[25]=s,e[26]=c,e[27]=y):y=e[27];let h;return e[28]!==r.runId||e[29]!==v||e[30]!==y?(h=(0,i.jsxs)("div",{className:"flex flex-row",children:[v,y]},r.runId),e[28]=r.runId,e[29]=v,e[30]=y,e[31]=h):h=e[31],h},J=t=>{let e=(0,T.c)(12),{run:r,hoveredCellId:a,hiddenInputElementId:s}=t,o=(0,_.useRef)(null),l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=c=>{o.current&&(o.current.value=String(c),o.current.dispatchEvent(new Event("input",{bubbles:!0})))},e[0]=l):l=e[0];let u=l,m=a||"",x;e[1]!==s||e[2]!==m?(x=(0,i.jsx)("input",{type:"text",id:s,defaultValue:m,hidden:!0,ref:o}),e[1]=s,e[2]=m,e[3]=x):x=e[3];let d;e[4]===r.cellRuns?d=e[5]:(d=[...r.cellRuns.values()],e[4]=r.cellRuns,e[5]=d);let p;e[6]!==a||e[7]!==d?(p=d.map(c=>(0,i.jsx)(X,{cellRun:c,hovered:c.cellId===a,dispatchHoverEvent:u},c.cellId)),e[6]=a,e[7]=d,e[8]=p):p=e[8];let f;return e[9]!==x||e[10]!==p?(f=(0,i.jsxs)("div",{className:"text-xs mt-0.5 ml-3 flex flex-col gap-0.5",children:[x,p]}),e[9]=x,e[10]=p,e[11]=f):f=e[11],f},K={success:(0,i.jsx)(pe,{color:"green",size:14}),running:(0,i.jsx)(he,{color:"var(--blue-10)",size:14}),error:(0,i.jsx)(xe,{color:"red",size:14}),queued:(0,i.jsx)(V,{color:"grey",size:14})},X=t=>{let e=(0,T.c)(39),{cellRun:r,hovered:a,dispatchHoverEvent:s}=t,o;e[0]===r.elapsedTime?o=e[1]:(o=r.elapsedTime?O(r.elapsedTime*1e3):"-",e[0]=r.elapsedTime,e[1]=o);let l=o,u;e[2]!==r.elapsedTime||e[3]!==l?(u=r.elapsedTime?(0,i.jsxs)("span",{children:["This cell took ",(0,i.jsx)(ce,{elapsedTime:l})," to run"]}):(0,i.jsx)("span",{children:"This cell has not been run"}),e[2]=r.elapsedTime,e[3]=l,e[4]=u):u=e[4];let m=u,x;e[5]!==r.cellId||e[6]!==s?(x=()=>{s(r.cellId)},e[5]=r.cellId,e[6]=s,e[7]=x):x=e[7];let d=x,p;e[8]===s?p=e[9]:(p=()=>{s(null)},e[8]=s,e[9]=p);let f=p,c=a&&"bg-(--gray-3) opacity-100",j;e[10]===c?j=e[11]:(j=le("flex flex-row gap-2 py-1 px-1 opacity-70 hover:bg-(--gray-3) hover:opacity-100",c),e[10]=c,e[11]=j);let g;e[12]===r.startTime?g=e[13]:(g=H(r.startTime),e[12]=r.startTime,e[13]=g);let v;e[14]===g?v=e[15]:(v=(0,i.jsxs)("span",{className:"text-(--gray-10) dark:text-(--gray-11)",children:["[",g,"]"]}),e[14]=g,e[15]=v);let y;e[16]===r.cellId?y=e[17]:(y=(0,i.jsxs)("span",{className:"text-(--gray-10) w-16",children:["(",(0,i.jsx)(ge,{cellId:r.cellId}),")"]}),e[16]=r.cellId,e[17]=y);let h;e[18]===r.code?h=e[19]:(h=(0,i.jsx)("span",{className:"w-40 truncate -ml-1",children:r.code}),e[18]=r.code,e[19]=h);let I;e[20]===l?I=e[21]:(I=(0,i.jsx)("span",{className:"text-(--gray-10) dark:text-(--gray-11)",children:l}),e[20]=l,e[21]=I);let n;e[22]!==m||e[23]!==I?(n=(0,i.jsx)(q,{content:m,children:I}),e[22]=m,e[23]=I,e[24]=n):n=e[24];let S=K[r.status],b;e[25]!==r.status||e[26]!==S?(b=(0,i.jsx)(q,{content:r.status,children:S}),e[25]=r.status,e[26]=S,e[27]=b):b=e[27];let N;e[28]!==n||e[29]!==b?(N=(0,i.jsxs)("div",{className:"flex flex-row gap-1 w-16 justify-end -ml-2",children:[n,b]}),e[28]=n,e[29]=b,e[30]=N):N=e[30];let k;return e[31]!==d||e[32]!==f||e[33]!==h||e[34]!==N||e[35]!==j||e[36]!==v||e[37]!==y?(k=(0,i.jsxs)("div",{className:j,onMouseEnter:d,onMouseLeave:f,children:[v,y,h,N]}),e[31]=d,e[32]=f,e[33]=h,e[34]=N,e[35]=j,e[36]=v,e[37]=y,e[38]=k):k=e[38],k};w=function(t){try{let e=new Date(t*1e3),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),o=String(e.getHours()).padStart(2,"0"),l=String(e.getMinutes()).padStart(2,"0"),u=String(e.getSeconds()).padStart(2,"0"),m=String(e.getMilliseconds()).padStart(3,"0");return`${r}-${a}-${s} ${o}:${l}:${u}.${m}`}catch{return""}}});export{F as Tracing,be as __tla,w as formatChartTime};
