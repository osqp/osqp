import{G as R}from"./graph-YDK6Hkng.js";import{b as Cn,e as on,c as h,i as I,f as S,v as M,r as q}from"./_baseUniq-CztUjN3r.js";import{b as an,a as Sn,m as k,c as G,h as un,f as J,l as Y,d as Gn}from"./min-Zg4iO1C5.js";import{cl as Fn,bT as Vn,d6 as Bn,az as qn,d7 as Yn,c$ as zn,d8 as F,d9 as L,M as Dn,al as An,da as z,db as $}from"./index-aRpq2G87.js";import{c as dn,a as cn}from"./_baseEach-B07JCD58.js";import{s as V}from"./sortBy-DSvxdc3a.js";function Jn(n,t){return n>t}function D(n,t){var r={};return t=cn(t),dn(n,function(u,a,c){Bn(r,a,t(u,a,c))}),r}function T(n){return n&&n.length?an(n,qn,Jn):void 0}function H(n,t){return n&&n.length?an(n,cn(t),Sn):void 0}var $n=0;function K(n){var t=++$n;return Yn(n)+t}class Hn{constructor(){var t={};t._next=t._prev=t,this._sentinel=t}dequeue(){var t=this._sentinel,r=t._prev;if(r!==t)return sn(r),r}enqueue(t){var r=this._sentinel;t._prev&&t._next&&sn(t),t._next=r._next,r._next._prev=t,r._next=t,t._prev=r}toString(){for(var t=[],r=this._sentinel,u=r._prev;u!==r;)t.push(JSON.stringify(u,Kn)),u=u._prev;return"["+t.join(", ")+"]"}}function sn(n){n._prev._next=n._next,n._next._prev=n._prev,delete n._next,delete n._prev}function Kn(n,t){if(n!=="_next"&&n!=="_prev")return t}var Qn=Dn(1);function Un(n,t){if(n.nodeCount()<=1)return[];var r=function(a,c){var e=new R,i=0,o=0;h(a.nodes(),function(s){e.setNode(s,{v:s,in:0,out:0})}),h(a.edges(),function(s){var g=e.edge(s.v,s.w)||0,v=c(s),p=g+v;e.setEdge(s.v,s.w,p),o=Math.max(o,e.node(s.v).out+=v),i=Math.max(i,e.node(s.w).in+=v)});var d=L(o+i+3).map(function(){return new Hn}),f=i+1;return h(e.nodes(),function(s){U(d,f,e.node(s))}),{graph:e,buckets:d,zeroIdx:f}}(n,t||Qn),u=function(a,c,e){for(var i,o=[],d=c[c.length-1],f=c[0];a.nodeCount();){for(;i=f.dequeue();)Q(a,c,e,i);for(;i=d.dequeue();)Q(a,c,e,i);if(a.nodeCount()){for(var s=c.length-2;s>0;--s)if(i=c[s].dequeue()){o=o.concat(Q(a,c,e,i,!0));break}}}return o}(r.graph,r.buckets,r.zeroIdx);return F(k(u,function(a){return n.outEdges(a.v,a.w)}))}function Q(n,t,r,u,a){var c=a?[]:void 0;return h(n.inEdges(u.v),function(e){var i=n.edge(e),o=n.node(e.v);a&&c.push({v:e.v,w:e.w}),o.out-=i,U(t,r,o)}),h(n.outEdges(u.v),function(e){var i=n.edge(e),o=e.w,d=n.node(o);d.in-=i,U(t,r,d)}),n.removeNode(u.v),c}function U(n,t,r){r.out?r.in?n[r.out-r.in+t].enqueue(r):n[n.length-1].enqueue(r):n[0].enqueue(r)}function Wn(n){var t=n.graph().acyclicer==="greedy"?Un(n,function(r){return function(u){return r.edge(u).weight}}(n)):function(r){var u=[],a={},c={};function e(i){Object.prototype.hasOwnProperty.call(c,i)||(c[i]=!0,a[i]=!0,h(r.outEdges(i),function(o){Object.prototype.hasOwnProperty.call(a,o.w)?u.push(o):e(o.w)}),delete a[i])}return h(r.nodes(),e),u}(n);h(t,function(r){var u=n.edge(r);n.removeEdge(r),u.forwardName=r.name,u.reversed=!0,n.setEdge(r.w,r.v,u,K("rev"))})}function C(n,t,r,u){var a;do a=K(u);while(n.hasNode(a));return r.dummy=t,n.setNode(a,r),a}function fn(n){var t=new R({multigraph:n.isMultigraph()}).setGraph(n.graph());return h(n.nodes(),function(r){n.children(r).length||t.setNode(r,n.node(r))}),h(n.edges(),function(r){t.setEdge(r,n.edge(r))}),t}function hn(n,t){var r,u,a=n.x,c=n.y,e=t.x-a,i=t.y-c,o=n.width/2,d=n.height/2;if(!e&&!i)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(i)*o>Math.abs(e)*d?(i<0&&(d=-d),r=d*e/i,u=d):(e<0&&(o=-o),r=o,u=o*i/e),{x:a+r,y:c+u}}function A(n){var t=k(L(vn(n)+1),function(){return[]});return h(n.nodes(),function(r){var u=n.node(r),a=u.rank;I(a)||(t[a][u.order]=r)}),t}function gn(n,t,r,u){var a={width:0,height:0};return arguments.length>=4&&(a.rank=r,a.order=u),C(n,"border",a,t)}function vn(n){return T(k(n.nodes(),function(t){var r=n.node(t).rank;if(!I(r))return r}))}function Xn(n,t){return t()}function ln(n,t,r,u,a,c){var e={width:0,height:0,rank:c,borderType:t},i=a[t][c-1],o=C(n,"border",e,r);a[t][c]=o,n.setParent(o,u),i&&n.setEdge(i,o,{weight:1})}function Zn(n){var t=n.graph().rankdir.toLowerCase();t!=="bt"&&t!=="rl"||function(r){h(r.nodes(),function(u){W(r.node(u))}),h(r.edges(),function(u){var a=r.edge(u);h(a.points,W),Object.prototype.hasOwnProperty.call(a,"y")&&W(a)})}(n),t!=="lr"&&t!=="rl"||(function(r){h(r.nodes(),function(u){X(r.node(u))}),h(r.edges(),function(u){var a=r.edge(u);h(a.points,X),Object.prototype.hasOwnProperty.call(a,"x")&&X(a)})}(n),pn(n))}function pn(n){h(n.nodes(),function(t){wn(n.node(t))}),h(n.edges(),function(t){wn(n.edge(t))})}function wn(n){var t=n.width;n.width=n.height,n.height=t}function W(n){n.y=-n.y}function X(n){var t=n.x;n.x=n.y,n.y=t}function ne(n){n.graph().dummyChains=[],h(n.edges(),function(t){(function(r,u){var a=u.v,c=r.node(a).rank,e=u.w,i=r.node(e).rank,o=u.name,d=r.edge(u),f=d.labelRank;if(i!==c+1){r.removeEdge(u);var s,g,v=void 0;for(g=0,++c;c<i;++g,++c)d.points=[],s=C(r,"edge",v={width:0,height:0,edgeLabel:d,edgeObj:u,rank:c},"_d"),c===f&&(v.width=d.width,v.height=d.height,v.dummy="edge-label",v.labelpos=d.labelpos),r.setEdge(a,s,{weight:d.weight},o),g===0&&r.graph().dummyChains.push(s),a=s;r.setEdge(a,e,{weight:d.weight},o)}})(n,t)})}function Z(n){var t={};h(n.sources(),function r(u){var a=n.node(u);if(Object.prototype.hasOwnProperty.call(t,u))return a.rank;t[u]=!0;var c=G(k(n.outEdges(u),function(e){return r(e.w)-n.edge(e).minlen}));return c!==Number.POSITIVE_INFINITY&&c!=null||(c=0),a.rank=c})}function B(n,t){return n.node(t.w).rank-n.node(t.v).rank-n.edge(t).minlen}function mn(n){var t,r,u=new R({directed:!1}),a=n.nodes()[0],c=n.nodeCount();for(u.setNode(a,{});ee(u,n)<c;)t=re(u,n),r=u.hasNode(t.v)?B(n,t):-B(n,t),te(u,n,r);return u}function ee(n,t){return h(n.nodes(),function r(u){h(t.nodeEdges(u),function(a){var c=a.v,e=u===c?a.w:c;n.hasNode(e)||B(t,a)||(n.setNode(e,{}),n.setEdge(u,e,{}),r(e))})}),n.nodeCount()}function re(n,t){return H(t.edges(),function(r){if(n.hasNode(r.v)!==n.hasNode(r.w))return B(t,r)})}function te(n,t,r){h(n.nodes(),function(u){t.node(u).rank+=r})}function bn(n,t,r){An(t)||(t=[t]);var u=(n.isDirected()?n.successors:n.neighbors).bind(n),a=[],c={};return h(t,function(e){if(!n.hasNode(e))throw new Error("Graph does not have node: "+e);yn(n,e,r==="post",c,u,a)}),a}function yn(n,t,r,u,a,c){Object.prototype.hasOwnProperty.call(u,t)||(u[t]=!0,r||c.push(t),h(a(t),function(e){yn(n,e,r,u,a,c)}),r&&c.push(t))}function j(n){n=function(u){var a=new R().setGraph(u.graph());return h(u.nodes(),function(c){a.setNode(c,u.node(c))}),h(u.edges(),function(c){var e=a.edge(c.v,c.w)||{weight:0,minlen:1},i=u.edge(c);a.setEdge(c.v,c.w,{weight:e.weight+i.weight,minlen:Math.max(e.minlen,i.minlen)})}),a}(n),Z(n);var t,r=mn(n);for(en(r),nn(r,n);t=En(r);)On(r,n,t,Nn(r,n,t))}function nn(n,t){var r=function(u,a){return bn(u,a,"post")}(n,n.nodes());r=r.slice(0,r.length-1),h(r,function(u){(function(a,c,e){var i=a.node(e),o=i.parent;a.edge(e,o).cutvalue=xn(a,c,e)})(n,t,u)})}function xn(n,t,r){var u=n.node(r).parent,a=!0,c=t.edge(r,u),e=0;return c||(a=!1,c=t.edge(u,r)),e=c.weight,h(t.nodeEdges(r),function(i){var o,d,f=i.v===r,s=f?i.w:i.v;if(s!==u){var g=f===a,v=t.edge(i).weight;if(e+=g?v:-v,o=r,d=s,n.hasEdge(o,d)){var p=n.edge(r,s).cutvalue;e+=g?-p:p}}}),e}function en(n,t){arguments.length<2&&(t=n.nodes()[0]),kn(n,{},1,t)}function kn(n,t,r,u,a){var c=r,e=n.node(u);return t[u]=!0,h(n.neighbors(u),function(i){Object.prototype.hasOwnProperty.call(t,i)||(r=kn(n,t,r,i,u))}),e.low=c,e.lim=r++,a?e.parent=a:delete e.parent,r}function En(n){return J(n.edges(),function(t){return n.edge(t).cutvalue<0})}function Nn(n,t,r){var u=r.v,a=r.w;t.hasEdge(u,a)||(u=r.w,a=r.v);var c=n.node(u),e=n.node(a),i=c,o=!1;c.lim>e.lim&&(i=e,o=!0);var d=S(t.edges(),function(f){return o===_n(n,n.node(f.v),i)&&o!==_n(n,n.node(f.w),i)});return H(d,function(f){return B(t,f)})}function On(n,t,r,u){var a=r.v,c=r.w;n.removeEdge(a,c),n.setEdge(u.v,u.w,{}),en(n),nn(n,t),function(e,i){var o=J(e.nodes(),function(f){return!i.node(f).parent}),d=function(f,s){return bn(f,s,"pre")}(e,o);d=d.slice(1),h(d,function(f){var s=e.node(f).parent,g=i.edge(f,s),v=!1;g||(g=i.edge(s,f),v=!0),i.node(f).rank=i.node(s).rank+(v?g.minlen:-g.minlen)})}(n,t)}function _n(n,t,r){return r.low<=t.lim&&t.lim<=r.lim}function oe(n){switch(n.graph().ranker){case"network-simplex":default:ae(n);break;case"tight-tree":(function(t){Z(t),mn(t)})(n);break;case"longest-path":ie(n)}}new Error,j.initLowLimValues=en,j.initCutValues=nn,j.calcCutValue=xn,j.leaveEdge=En,j.enterEdge=Nn,j.exchangeEdges=On;var ie=Z;function ae(n){j(n)}function ue(n){var t=C(n,"root",{},"_root"),r=function(e){var i={};function o(d,f){var s=e.children(d);s&&s.length&&h(s,function(g){o(g,f+1)}),i[d]=f}return h(e.children(),function(d){o(d,1)}),i}(n),u=T(M(r))-1,a=2*u+1;n.graph().nestingRoot=t,h(n.edges(),function(e){n.edge(e).minlen*=a});var c=function(e){return q(e.edges(),function(i,o){return i+e.edge(o).weight},0)}(n)+1;h(n.children(),function(e){In(n,t,a,c,u,r,e)}),n.graph().nodeRankFactor=a}function In(n,t,r,u,a,c,e){var i=n.children(e);if(i.length){var o=gn(n,"_bt"),d=gn(n,"_bb"),f=n.node(e);n.setParent(o,e),f.borderTop=o,n.setParent(d,e),f.borderBottom=d,h(i,function(s){In(n,t,r,u,a,c,s);var g=n.node(s),v=g.borderTop?g.borderTop:s,p=g.borderBottom?g.borderBottom:s,w=g.borderTop?u:2*u,l=v!==p?1:a-c[e]+1;n.setEdge(o,v,{weight:w,minlen:l,nestingEdge:!0}),n.setEdge(p,d,{weight:w,minlen:l,nestingEdge:!0})}),n.parent(e)||n.setEdge(t,o,{weight:0,minlen:a+c[e]})}else e!==t&&n.setEdge(t,e,{weight:0,minlen:r})}function de(n,t,r){var u=function(c){for(var e;c.hasNode(e=K("_root")););return e}(n),a=new R({compound:!0}).setGraph({root:u}).setDefaultNodeLabel(function(c){return n.node(c)});return h(n.nodes(),function(c){var e=n.node(c),i=n.parent(c);(e.rank===t||e.minRank<=t&&t<=e.maxRank)&&(a.setNode(c),a.setParent(c,i||u),h(n[r](c),function(o){var d=o.v===c?o.w:o.v,f=a.edge(d,c),s=I(f)?0:f.weight;a.setEdge(d,c,{weight:n.edge(o).weight+s})}),Object.prototype.hasOwnProperty.call(e,"minRank")&&a.setNode(c,{borderLeft:e.borderLeft[t],borderRight:e.borderRight[t]}))}),a}function ce(n,t){for(var r=0,u=1;u<t.length;++u)r+=se(n,t[u-1],t[u]);return r}function se(n,t,r){for(var u=function(d,f){return function(s,g,v){for(var p=-1,w=s.length,l=g.length,m={};++p<w;){var b=p<l?g[p]:void 0;v(m,s[p],b)}return m}(d||[],f||[],zn)}(r,k(r,function(d,f){return f})),a=F(k(t,function(d){return V(k(n.outEdges(d),function(f){return{pos:u[f.w],weight:n.edge(f).weight}}),"pos")})),c=1;c<r.length;)c<<=1;var e=2*c-1;c-=1;var i=k(new Array(e),function(){return 0}),o=0;return h(a.forEach(function(d){var f=d.pos+c;i[f]+=d.weight;for(var s=0;f>0;)f%2&&(s+=i[f+1]),i[f=f-1>>1]+=d.weight;o+=d.weight*s})),o}function fe(n,t){var r={};return h(n,function(u,a){var c=r[u.v]={indegree:0,in:[],out:[],vs:[u.v],i:a};I(u.barycenter)||(c.barycenter=u.barycenter,c.weight=u.weight)}),h(t.edges(),function(u){var a=r[u.v],c=r[u.w];I(a)||I(c)||(c.indegree++,a.out.push(r[u.w]))}),function(u){var a=[];function c(o){return function(d){d.merged||(I(d.barycenter)||I(o.barycenter)||d.barycenter>=o.barycenter)&&function(f,s){var g=0,v=0;f.weight&&(g+=f.barycenter*f.weight,v+=f.weight),s.weight&&(g+=s.barycenter*s.weight,v+=s.weight),f.vs=s.vs.concat(f.vs),f.barycenter=g/v,f.weight=v,f.i=Math.min(s.i,f.i),s.merged=!0}(o,d)}}function e(o){return function(d){d.in.push(o),--d.indegree==0&&u.push(d)}}for(;u.length;){var i=u.pop();a.push(i),h(i.in.reverse(),c(i)),h(i.out,e(i))}return k(S(a,function(o){return!o.merged}),function(o){return z(o,["vs","i","barycenter","weight"])})}(S(r,function(u){return!u.indegree}))}function he(n,t){var r,u=function(s,g){var v={lhs:[],rhs:[]};return h(s,function(p){g(p)?v.lhs.push(p):v.rhs.push(p)}),v}(n,function(s){return Object.prototype.hasOwnProperty.call(s,"barycenter")}),a=u.lhs,c=V(u.rhs,function(s){return-s.i}),e=[],i=0,o=0,d=0;a.sort((r=!!t,function(s,g){return s.barycenter<g.barycenter?-1:s.barycenter>g.barycenter?1:r?g.i-s.i:s.i-g.i})),d=Pn(e,c,d),h(a,function(s){d+=s.vs.length,e.push(s.vs),i+=s.barycenter*s.weight,o+=s.weight,d=Pn(e,c,d)});var f={vs:F(e)};return o&&(f.barycenter=i/o,f.weight=o),f}function Pn(n,t,r){for(var u;t.length&&(u=Y(t)).i<=r;)t.pop(),n.push(u.vs),r++;return r}function Rn(n,t,r,u){var a=n.children(t),c=n.node(t),e=c?c.borderLeft:void 0,i=c?c.borderRight:void 0,o={};e&&(a=S(a,function(p){return p!==e&&p!==i}));var d=function(p,w){return k(w,function(l){var m=p.inEdges(l);if(m.length){var b=q(m,function(y,x){var O=p.edge(x),E=p.node(x.v);return{sum:y.sum+O.weight*E.order,weight:y.weight+O.weight}},{sum:0,weight:0});return{v:l,barycenter:b.sum/b.weight,weight:b.weight}}return{v:l}})}(n,a);h(d,function(p){if(n.children(p.v).length){var w=Rn(n,p.v,r,u);o[p.v]=w,Object.prototype.hasOwnProperty.call(w,"barycenter")&&(m=w,I((l=p).barycenter)?(l.barycenter=m.barycenter,l.weight=m.weight):(l.barycenter=(l.barycenter*l.weight+m.barycenter*m.weight)/(l.weight+m.weight),l.weight+=m.weight))}var l,m});var f=fe(d,r);(function(p,w){h(p,function(l){l.vs=F(l.vs.map(function(m){return w[m]?w[m].vs:m}))})})(f,o);var s=he(f,u);if(e&&(s.vs=F([e,s.vs,i]),n.predecessors(e).length)){var g=n.node(n.predecessors(e)[0]),v=n.node(n.predecessors(i)[0]);Object.prototype.hasOwnProperty.call(s,"barycenter")||(s.barycenter=0,s.weight=0),s.barycenter=(s.barycenter*s.weight+g.order+v.order)/(s.weight+2),s.weight+=2}return s}function ge(n){var t=vn(n),r=Tn(n,L(1,t+1),"inEdges"),u=Tn(n,L(t-1,-1,-1),"outEdges"),a=function(f){var s={},g=S(f.nodes(),function(l){return!f.children(l).length}),v=T(k(g,function(l){return f.node(l).rank})),p=k(L(v+1),function(){return[]}),w=V(g,function(l){return f.node(l).rank});return h(w,function l(m){if(!un(s,m)){s[m]=!0;var b=f.node(m);p[b.rank].push(m),h(f.successors(m),l)}}),p}(n);jn(n,a);for(var c,e=Number.POSITIVE_INFINITY,i=0,o=0;o<4;++i,++o){ve(i%2?r:u,i%4>=2);var d=ce(n,a=A(n));d<e&&(o=0,c=Cn(a,5),e=d)}jn(n,c)}function Tn(n,t,r){return k(t,function(u){return de(n,u,r)})}function ve(n,t){var r=new R;h(n,function(u){var a=u.graph().root,c=Rn(u,a,r,t);h(c.vs,function(e,i){u.node(e).order=i}),function(e,i,o){var d,f={};h(o,function(s){for(var g,v,p=e.parent(s);p;){if((g=e.parent(p))?(v=f[g],f[g]=p):(v=d,d=p),v&&v!==p)return void i.setEdge(v,p);p=g}})}(u,r,c.vs)})}function jn(n,t){h(t,function(r){h(r,function(u,a){n.node(u).order=a})})}function le(n){var t=function(r){var u={},a=0;function c(e){var i=a;h(r.children(e),c),u[e]={low:i,lim:a++}}return h(r.children(),c),u}(n);h(n.graph().dummyChains,function(r){for(var u=n.node(r),a=u.edgeObj,c=function(s,g,v,p){var w,l,m=[],b=[],y=Math.min(g[v].low,g[p].low),x=Math.max(g[v].lim,g[p].lim);w=v;do w=s.parent(w),m.push(w);while(w&&(g[w].low>y||x>g[w].lim));for(l=w,w=p;(w=s.parent(w))!==l;)b.push(w);return{path:m.concat(b.reverse()),lca:l}}(n,t,a.v,a.w),e=c.path,i=c.lca,o=0,d=e[o],f=!0;r!==a.w;){if(u=n.node(r),f){for(;(d=e[o])!==i&&n.node(d).maxRank<u.rank;)o++;d===i&&(f=!1)}if(!f){for(;o<e.length-1&&n.node(d=e[o+1]).minRank<=u.rank;)o++;d=e[o]}n.setParent(r,d),r=n.successors(r)[0]}})}function pe(n,t){var r={};return q(t,function(u,a){var c=0,e=0,i=u.length,o=Y(a);return h(a,function(d,f){var s=function(v,p){if(v.node(p).dummy)return J(v.predecessors(p),function(w){return v.node(w).dummy})}(n,d),g=s?n.node(s).order:i;(s||d===o)&&(h(a.slice(e,f+1),function(v){h(n.predecessors(v),function(p){var w=n.node(p),l=w.order;!(l<c||g<l)||w.dummy&&n.node(v).dummy||Mn(r,p,v)})}),e=f+1,c=g)}),a}),r}function Mn(n,t,r){if(t>r){var u=t;t=r,r=u}var a=n[t];a||(n[t]=a={}),a[r]=!0}function we(n,t,r){if(t>r){var u=t;t=r,r=u}return!!n[t]&&Object.prototype.hasOwnProperty.call(n[t],r)}function me(n,t,r,u,a){var c={},e=function(d,f,s,g){var v=new R,p=d.graph(),w=function(l,m,b){return function(y,x,O){var E,_=y.node(x),P=y.node(O),N=0;if(N+=_.width/2,Object.prototype.hasOwnProperty.call(_,"labelpos"))switch(_.labelpos.toLowerCase()){case"l":E=-_.width/2;break;case"r":E=_.width/2}if(E&&(N+=b?E:-E),E=0,N+=(_.dummy?m:l)/2,N+=(P.dummy?m:l)/2,N+=P.width/2,Object.prototype.hasOwnProperty.call(P,"labelpos"))switch(P.labelpos.toLowerCase()){case"l":E=P.width/2;break;case"r":E=-P.width/2}return E&&(N+=b?E:-E),E=0,N}}(p.nodesep,p.edgesep,g);return h(f,function(l){var m;h(l,function(b){var y=s[b];if(v.setNode(y),m){var x=s[m],O=v.edge(x,y);v.setEdge(x,y,Math.max(w(d,b,m),O||0))}m=b})}),v}(n,t,r,a),i=a?"borderLeft":"borderRight";function o(d,f){for(var s=e.nodes(),g=s.pop(),v={};g;)v[g]?d(g):(v[g]=!0,s.push(g),s=s.concat(f(g))),g=s.pop()}return o(function(d){c[d]=e.inEdges(d).reduce(function(f,s){return Math.max(f,c[s.v]+e.edge(s))},0)},e.predecessors.bind(e)),o(function(d){var f=e.outEdges(d).reduce(function(g,v){return Math.min(g,c[v.w]-e.edge(v))},Number.POSITIVE_INFINITY),s=n.node(d);f!==Number.POSITIVE_INFINITY&&s.borderType!==i&&(c[d]=Math.max(c[d],f))},e.successors.bind(e)),h(u,function(d){c[d]=c[r[d]]}),c}function be(n,t){return H(M(t),function(r){var u,a,c=Number.NEGATIVE_INFINITY,e=Number.POSITIVE_INFINITY;return a=function(i,o){var d=function(f,s){return f.node(s).width}(n,o)/2;c=Math.max(i+d,c),e=Math.min(i-d,e)},(u=r)==null||Fn(u,on(a),Vn),c-e})}function ye(n){var t,r=A(n),u=$(pe(n,r),function(e,i){var o={};function d(f,s,g,v,p){var w;h(L(s,g),function(l){w=f[l],e.node(w).dummy&&h(e.predecessors(w),function(m){var b=e.node(m);b.dummy&&(b.order<v||b.order>p)&&Mn(o,m,w)})})}return q(i,function(f,s){var g,v=-1,p=0;return h(s,function(w,l){if(e.node(w).dummy==="border"){var m=e.predecessors(w);m.length&&(g=e.node(m[0]).order,d(s,p,l,v,g),p=l,v=g)}d(s,p,s.length,g,f.length)}),s}),o}(n,r)),a={};h(["u","d"],function(e){t=e==="u"?r:M(r).reverse(),h(["l","r"],function(i){i==="r"&&(t=k(t,function(s){return M(s).reverse()}));var o=(e==="u"?n.predecessors:n.successors).bind(n),d=function(s,g,v,p){var w={},l={},m={};return h(g,function(b){h(b,function(y,x){w[y]=y,l[y]=y,m[y]=x})}),h(g,function(b){var y=-1;h(b,function(x){var O=p(x);if(O.length){O=V(O,function(Ln){return m[Ln]});for(var E=(O.length-1)/2,_=Math.floor(E),P=Math.ceil(E);_<=P;++_){var N=O[_];l[x]===x&&y<m[N]&&!we(v,x,N)&&(l[N]=x,l[x]=w[x]=w[N],y=m[N])}}})}),{root:w,align:l}}(0,t,u,o),f=me(n,t,d.root,d.align,i==="r");i==="r"&&(f=D(f,function(s){return-s})),a[e+i]=f})});var c=be(n,a);return function(e,i){var o=M(i),d=G(o),f=T(o);h(["u","d"],function(s){h(["l","r"],function(g){var v,p=s+g,w=e[p];if(w!==i){var l=M(w);(v=g==="l"?d-G(l):f-T(l))&&(e[p]=D(w,function(m){return m+v}))}})})}(a,c),function(e,i){return D(e.ul,function(o,d){if(i)return e[i.toLowerCase()][d];var f=V(k(e,d));return(f[1]+f[2])/2})}(a,n.graph().align)}function xe(n){var t,r;(function(u){var a=A(u),c=u.graph().ranksep,e=0;h(a,function(i){var o=T(k(i,function(d){return u.node(d).height}));h(i,function(d){u.node(d).y=e+o/2}),e+=o+c})})(n=fn(n)),t=ye(n),r=function(u,a){n.node(a).x=u},t&&dn(t,on(r))}function ke(n,t){var r=Xn;r("layout",()=>{var u=r("  buildLayoutGraph",()=>function(a){var c=new R({multigraph:!0,compound:!0}),e=tn(a.graph());return c.setGraph($({},Ne,rn(e,Ee),z(e,Oe))),h(a.nodes(),function(i){var o=tn(a.node(i));c.setNode(i,Gn(rn(o,_e),Ie)),c.setParent(i,a.parent(i))}),h(a.edges(),function(i){var o=tn(a.edge(i));c.setEdge(i,$({},Re,rn(o,Pe),z(o,Te)))}),c}(n));r("  runLayout",()=>function(a,c){c("    makeSpaceForEdgeLabels",()=>function(e){var i=e.graph();i.ranksep/=2,h(e.edges(),function(o){var d=e.edge(o);d.minlen*=2,d.labelpos.toLowerCase()!=="c"&&(i.rankdir==="TB"||i.rankdir==="BT"?d.width+=d.labeloffset:d.height+=d.labeloffset)})}(a)),c("    removeSelfEdges",()=>function(e){h(e.edges(),function(i){if(i.v===i.w){var o=e.node(i.v);o.selfEdges||(o.selfEdges=[]),o.selfEdges.push({e:i,label:e.edge(i)}),e.removeEdge(i)}})}(a)),c("    acyclic",()=>Wn(a)),c("    nestingGraph.run",()=>ue(a)),c("    rank",()=>oe(fn(a))),c("    injectEdgeLabelProxies",()=>function(e){h(e.edges(),function(i){var o=e.edge(i);if(o.width&&o.height){var d=e.node(i.v),f={rank:(e.node(i.w).rank-d.rank)/2+d.rank,e:i};C(e,"edge-proxy",f,"_ep")}})}(a)),c("    removeEmptyRanks",()=>function(e){var i=G(k(e.nodes(),function(s){return e.node(s).rank})),o=[];h(e.nodes(),function(s){var g=e.node(s).rank-i;o[g]||(o[g]=[]),o[g].push(s)});var d=0,f=e.graph().nodeRankFactor;h(o,function(s,g){I(s)&&g%f!=0?--d:d&&h(s,function(v){e.node(v).rank+=d})})}(a)),c("    nestingGraph.cleanup",()=>function(e){var i=e.graph();e.removeNode(i.nestingRoot),delete i.nestingRoot,h(e.edges(),function(o){e.edge(o).nestingEdge&&e.removeEdge(o)})}(a)),c("    normalizeRanks",()=>function(e){var i=G(k(e.nodes(),function(o){return e.node(o).rank}));h(e.nodes(),function(o){var d=e.node(o);un(d,"rank")&&(d.rank-=i)})}(a)),c("    assignRankMinMax",()=>function(e){var i=0;h(e.nodes(),function(o){var d=e.node(o);d.borderTop&&(d.minRank=e.node(d.borderTop).rank,d.maxRank=e.node(d.borderBottom).rank,i=T(i,d.maxRank))}),e.graph().maxRank=i}(a)),c("    removeEdgeLabelProxies",()=>function(e){h(e.nodes(),function(i){var o=e.node(i);o.dummy==="edge-proxy"&&(e.edge(o.e).labelRank=o.rank,e.removeNode(i))})}(a)),c("    normalize.run",()=>ne(a)),c("    parentDummyChains",()=>le(a)),c("    addBorderSegments",()=>function(e){h(e.children(),function i(o){var d=e.children(o),f=e.node(o);if(d.length&&h(d,i),Object.prototype.hasOwnProperty.call(f,"minRank")){f.borderLeft=[],f.borderRight=[];for(var s=f.minRank,g=f.maxRank+1;s<g;++s)ln(e,"borderLeft","_bl",o,f,s),ln(e,"borderRight","_br",o,f,s)}})}(a)),c("    order",()=>ge(a)),c("    insertSelfEdges",()=>function(e){var i=A(e);h(i,function(o){var d=0;h(o,function(f,s){var g=e.node(f);g.order=s+d,h(g.selfEdges,function(v){C(e,"selfedge",{width:v.label.width,height:v.label.height,rank:g.rank,order:s+ ++d,e:v.e,label:v.label},"_se")}),delete g.selfEdges})})}(a)),c("    adjustCoordinateSystem",()=>function(e){var i=e.graph().rankdir.toLowerCase();i!=="lr"&&i!=="rl"||pn(e)}(a)),c("    position",()=>xe(a)),c("    positionSelfEdges",()=>function(e){h(e.nodes(),function(i){var o=e.node(i);if(o.dummy==="selfedge"){var d=e.node(o.e.v),f=d.x+d.width/2,s=d.y,g=o.x-f,v=d.height/2;e.setEdge(o.e,o.label),e.removeNode(i),o.label.points=[{x:f+2*g/3,y:s-v},{x:f+5*g/6,y:s-v},{x:f+g,y:s},{x:f+5*g/6,y:s+v},{x:f+2*g/3,y:s+v}],o.label.x=o.x,o.label.y=o.y}})}(a)),c("    removeBorderNodes",()=>function(e){h(e.nodes(),function(i){if(e.children(i).length){var o=e.node(i),d=e.node(o.borderTop),f=e.node(o.borderBottom),s=e.node(Y(o.borderLeft)),g=e.node(Y(o.borderRight));o.width=Math.abs(g.x-s.x),o.height=Math.abs(f.y-d.y),o.x=s.x+o.width/2,o.y=d.y+o.height/2}}),h(e.nodes(),function(i){e.node(i).dummy==="border"&&e.removeNode(i)})}(a)),c("    normalize.undo",()=>function(e){h(e.graph().dummyChains,function(i){var o,d=e.node(i),f=d.edgeLabel;for(e.setEdge(d.edgeObj,f);d.dummy;)o=e.successors(i)[0],e.removeNode(i),f.points.push({x:d.x,y:d.y}),d.dummy==="edge-label"&&(f.x=d.x,f.y=d.y,f.width=d.width,f.height=d.height),i=o,d=e.node(i)})}(a)),c("    fixupEdgeLabelCoords",()=>function(e){h(e.edges(),function(i){var o=e.edge(i);if(Object.prototype.hasOwnProperty.call(o,"x"))switch(o.labelpos!=="l"&&o.labelpos!=="r"||(o.width-=o.labeloffset),o.labelpos){case"l":o.x-=o.width/2+o.labeloffset;break;case"r":o.x+=o.width/2+o.labeloffset}})}(a)),c("    undoCoordinateSystem",()=>Zn(a)),c("    translateGraph",()=>function(e){var i=Number.POSITIVE_INFINITY,o=0,d=Number.POSITIVE_INFINITY,f=0,s=e.graph(),g=s.marginx||0,v=s.marginy||0;function p(w){var l=w.x,m=w.y,b=w.width,y=w.height;i=Math.min(i,l-b/2),o=Math.max(o,l+b/2),d=Math.min(d,m-y/2),f=Math.max(f,m+y/2)}h(e.nodes(),function(w){p(e.node(w))}),h(e.edges(),function(w){var l=e.edge(w);Object.prototype.hasOwnProperty.call(l,"x")&&p(l)}),i-=g,d-=v,h(e.nodes(),function(w){var l=e.node(w);l.x-=i,l.y-=d}),h(e.edges(),function(w){var l=e.edge(w);h(l.points,function(m){m.x-=i,m.y-=d}),Object.prototype.hasOwnProperty.call(l,"x")&&(l.x-=i),Object.prototype.hasOwnProperty.call(l,"y")&&(l.y-=d)}),s.width=o-i+g,s.height=f-d+v}(a)),c("    assignNodeIntersects",()=>function(e){h(e.edges(),function(i){var o,d,f=e.edge(i),s=e.node(i.v),g=e.node(i.w);f.points?(o=f.points[0],d=f.points[f.points.length-1]):(f.points=[],o=g,d=s),f.points.unshift(hn(s,o)),f.points.push(hn(g,d))})}(a)),c("    reversePoints",()=>function(e){h(e.edges(),function(i){var o=e.edge(i);o.reversed&&o.points.reverse()})}(a)),c("    acyclic.undo",()=>function(e){h(e.edges(),function(i){var o=e.edge(i);if(o.reversed){e.removeEdge(i);var d=o.forwardName;delete o.reversed,delete o.forwardName,e.setEdge(i.w,i.v,o,d)}})}(a))}(u,r)),r("  updateInputGraph",()=>function(a,c){h(a.nodes(),function(e){var i=a.node(e),o=c.node(e);i&&(i.x=o.x,i.y=o.y,c.children(e).length&&(i.width=o.width,i.height=o.height))}),h(a.edges(),function(e){var i=a.edge(e),o=c.edge(e);i.points=o.points,Object.prototype.hasOwnProperty.call(o,"x")&&(i.x=o.x,i.y=o.y)}),a.graph().width=c.graph().width,a.graph().height=c.graph().height}(n,u))})}var Ee=["nodesep","edgesep","ranksep","marginx","marginy"],Ne={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Oe=["acyclicer","ranker","rankdir","align"],_e=["width","height"],Ie={width:0,height:0},Pe=["minlen","weight","width","height","labeloffset"],Re={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Te=["labelpos"];function rn(n,t){return D(z(n,t),Number)}function tn(n){var t={};return h(n,function(r,u){t[u.toLowerCase()]=r}),t}export{ke as l};
